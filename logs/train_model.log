[2025-07-16 13:52:20] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: Entering train_signal_model
[2025-07-16 13:52:20] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:52:20] INFO train_model: Preparing target variable...
[2025-07-16 13:52:20] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:52:20] INFO train_model: Dropping NaN targets...
[2025-07-16 13:52:20] INFO train_model: Class distribution: [954 436]
[2025-07-16 13:52:20] INFO train_model: Upsampling successful.
[2025-07-16 13:52:20] INFO train_model: Splitting train/test...
[2025-07-16 13:52:20] INFO train_model: Scaling features...
[2025-07-16 13:52:20] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 13:52:20] INFO train_model: Fitting ensemble and calibrating...
[2025-07-16 13:52:21] INFO train_model: Model fit complete.
[2025-07-16 13:52:21] INFO train_model: Model Accuracy: 0.8613
[2025-07-16 13:52:21] INFO train_model: 
Classification Report:
[2025-07-16 13:52:21] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.88      0.86       191
           1       0.88      0.84      0.86       191

    accuracy                           0.86       382
   macro avg       0.86      0.86      0.86       382
weighted avg       0.86      0.86      0.86       382

[2025-07-16 13:52:21] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 13:52:21] INFO train_model: Feature distributions before training:
[2025-07-16 13:52:21] INFO train_model: atr_14: mean=0.3156, std=0.0620, min=0.1686, max=0.5768, unique=1390
[2025-07-16 13:52:21] INFO train_model: volatility_20: mean=0.3200, std=0.1713, min=0.0583, max=1.1795, unique=1390
[2025-07-16 13:52:21] INFO train_model: fib_0: mean=145.3840, std=1.4302, min=142.7570, max=149.1860, unique=386
[2025-07-16 13:52:21] INFO train_model: fib_236: mean=145.0720, std=1.4053, min=142.5675, max=149.0510, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_382: mean=144.8790, std=1.3949, min=142.4503, max=148.9675, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_500: mean=144.7230, std=1.3894, min=142.3555, max=148.9000, unique=708
[2025-07-16 13:52:21] INFO train_model: fib_618: mean=144.5670, std=1.3866, min=142.2607, max=148.8325, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_786: mean=144.3449, std=1.3872, min=142.1258, max=148.7364, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_100: mean=144.0620, std=1.3957, min=141.9540, max=148.6140, unique=375
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_0: mean=-0.6260, std=0.4834, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4498, min=-2.0190, max=0.7009, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_382: mean=-0.1210, std=0.4447, min=-1.5815, max=1.2515, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_500: mean=0.0350, std=0.4498, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_618: mean=0.1910, std=0.4629, min=-0.9192, max=2.1415, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_786: mean=0.4131, std=0.4940, min=-0.4582, max=2.7750, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_100: mean=0.6960, std=0.5510, min=0.0140, max=3.5820, unique=1034
[2025-07-16 13:52:21] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1180
[2025-07-16 13:52:21] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 13:52:21] INFO train_model: trendline_up: mean=0.5137, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: trendline_down: mean=0.4662, std=0.4990, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:52:21] INFO train_model: dist_to_high: mean=-0.6170, std=0.5079, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 13:52:21] INFO train_model: dist_to_low: mean=0.6998, std=0.5743, min=0.0020, max=3.5820, unique=1064
[2025-07-16 13:52:21] INFO train_model: pin_bar: mean=0.2820, std=0.4501, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: bullish_engulfing_bar: mean=0.0504, std=0.2188, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: inside_bar: mean=0.1324, std=0.3390, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0757, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: vol_spike_std: mean=0.1755, std=0.3806, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:52:21] INFO train_model: Auditing data quality before training...
[2025-07-16 13:52:21] INFO train_model: Entering audit_data_quality
[2025-07-16 13:59:38] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: Entering train_signal_model
[2025-07-16 13:59:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:59:38] INFO train_model: Preparing target variable...
[2025-07-16 13:59:38] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:59:38] INFO train_model: Dropping NaN targets...
[2025-07-16 13:59:39] INFO train_model: Class distribution: [954 436]
[2025-07-16 13:59:39] INFO train_model: Upsampling successful.
[2025-07-16 13:59:39] INFO train_model: Splitting train/test...
[2025-07-16 13:59:39] INFO train_model: Scaling features...
[2025-07-16 13:59:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 13:59:39] INFO train_model: Fitting ensemble and calibrating...
[2025-07-16 13:59:40] INFO train_model: Model fit complete.
[2025-07-16 13:59:40] INFO train_model: Model Accuracy: 0.8613
[2025-07-16 13:59:40] INFO train_model: 
Classification Report:
[2025-07-16 13:59:40] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.88      0.86       191
           1       0.88      0.84      0.86       191

    accuracy                           0.86       382
   macro avg       0.86      0.86      0.86       382
weighted avg       0.86      0.86      0.86       382

[2025-07-16 13:59:40] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 13:59:40] INFO train_model: Feature distributions before training:
[2025-07-16 13:59:40] INFO train_model: atr_14: mean=0.3156, std=0.0620, min=0.1686, max=0.5768, unique=1390
[2025-07-16 13:59:40] INFO train_model: volatility_20: mean=0.3200, std=0.1713, min=0.0583, max=1.1795, unique=1390
[2025-07-16 13:59:40] INFO train_model: fib_0: mean=145.3840, std=1.4302, min=142.7570, max=149.1860, unique=386
[2025-07-16 13:59:40] INFO train_model: fib_236: mean=145.0720, std=1.4053, min=142.5675, max=149.0510, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_382: mean=144.8790, std=1.3949, min=142.4503, max=148.9675, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_500: mean=144.7230, std=1.3894, min=142.3555, max=148.9000, unique=708
[2025-07-16 13:59:40] INFO train_model: fib_618: mean=144.5670, std=1.3866, min=142.2607, max=148.8325, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_786: mean=144.3449, std=1.3872, min=142.1258, max=148.7364, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_100: mean=144.0620, std=1.3957, min=141.9540, max=148.6140, unique=375
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_0: mean=-0.6260, std=0.4834, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4498, min=-2.0190, max=0.7009, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_382: mean=-0.1210, std=0.4447, min=-1.5815, max=1.2515, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_500: mean=0.0350, std=0.4498, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_618: mean=0.1910, std=0.4629, min=-0.9192, max=2.1415, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_786: mean=0.4131, std=0.4940, min=-0.4582, max=2.7750, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_100: mean=0.6960, std=0.5510, min=0.0140, max=3.5820, unique=1034
[2025-07-16 13:59:40] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1180
[2025-07-16 13:59:40] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 13:59:40] INFO train_model: trendline_up: mean=0.5137, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: trendline_down: mean=0.4662, std=0.4990, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:59:40] INFO train_model: dist_to_high: mean=-0.6170, std=0.5079, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 13:59:40] INFO train_model: dist_to_low: mean=0.6998, std=0.5743, min=0.0020, max=3.5820, unique=1064
[2025-07-16 13:59:40] INFO train_model: pin_bar: mean=0.2827, std=0.4505, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: bullish_engulfing_bar: mean=0.0504, std=0.2188, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: inside_bar: mean=0.1324, std=0.3390, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0757, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: vol_spike_std: mean=0.1755, std=0.3806, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:59:40] INFO train_model: Auditing data quality before training...
[2025-07-16 13:59:40] INFO train_model: Entering audit_data_quality
[2025-07-16 14:11:06] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: Model is starting a new training session...
[2025-07-16 14:11:06] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 14:11:06] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:11:06] INFO train_model: Preparing target variable...
[2025-07-16 14:11:06] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:11:06] INFO train_model: Dropping NaN targets...
[2025-07-16 14:11:06] INFO train_model: Class distribution: [955 436]
[2025-07-16 14:11:06] INFO train_model: Upsampling successful.
[2025-07-16 14:11:06] INFO train_model: Splitting train/test...
[2025-07-16 14:11:06] INFO train_model: Scaling features...
[2025-07-16 14:11:06] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 14:11:06] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 14:11:07] INFO train_model: Model fit complete.
[2025-07-16 14:11:07] INFO train_model: Model Accuracy: 0.8874
[2025-07-16 14:11:07] INFO train_model: 
Classification Report:
[2025-07-16 14:11:07] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.87      0.89       191
           1       0.87      0.91      0.89       191

    accuracy                           0.89       382
   macro avg       0.89      0.89      0.89       382
weighted avg       0.89      0.89      0.89       382

[2025-07-16 14:11:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 14:11:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 14:11:07] INFO train_model: Feature distributions before training:
[2025-07-16 14:11:07] INFO train_model: atr_14: mean=0.3155, std=0.0620, min=0.1686, max=0.5768, unique=1391
[2025-07-16 14:11:07] INFO train_model: volatility_20: mean=0.3199, std=0.1713, min=0.0583, max=1.1795, unique=1391
[2025-07-16 14:11:07] INFO train_model: fib_0: mean=145.3868, std=1.4334, min=142.7570, max=149.1860, unique=386
[2025-07-16 14:11:07] INFO train_model: fib_236: mean=145.0749, std=1.4088, min=142.5675, max=149.0510, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_382: mean=144.8819, std=1.3986, min=142.4503, max=148.9675, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_500: mean=144.7260, std=1.3933, min=142.3555, max=148.9000, unique=708
[2025-07-16 14:11:07] INFO train_model: fib_618: mean=144.5700, std=1.3907, min=142.2607, max=148.8325, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_786: mean=144.3480, std=1.3915, min=142.1258, max=148.7364, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_100: mean=144.0652, std=1.4003, min=141.9540, max=148.6140, unique=375
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_0: mean=-0.6259, std=0.4832, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4497, min=-2.0190, max=0.7009, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_382: mean=-0.1211, std=0.4446, min=-1.5815, max=1.2515, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_500: mean=0.0349, std=0.4497, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_618: mean=0.1908, std=0.4628, min=-0.9192, max=2.1415, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_786: mean=0.4128, std=0.4939, min=-0.4582, max=2.7750, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_100: mean=0.6957, std=0.5509, min=0.0140, max=3.5820, unique=1034
[2025-07-16 14:11:07] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1181
[2025-07-16 14:11:07] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 14:11:07] INFO train_model: trendline_up: mean=0.5133, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: trendline_down: mean=0.4666, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:11:07] INFO train_model: dist_to_high: mean=-0.6169, std=0.5077, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 14:11:07] INFO train_model: dist_to_low: mean=0.6995, std=0.5742, min=0.0020, max=3.5820, unique=1064
[2025-07-16 14:11:07] INFO train_model: pin_bar: mean=0.2832, std=0.4507, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: bullish_engulfing_bar: mean=0.0503, std=0.2187, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: inside_bar: mean=0.1330, std=0.3397, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0756, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: vol_spike_std: mean=0.1754, std=0.3805, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:11:07] INFO train_model: Auditing data quality before training...
[2025-07-16 14:11:07] INFO train_model: Entering audit_data_quality
[2025-07-16 14:13:57] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: Model is starting a new training session...
[2025-07-16 14:13:57] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 14:13:57] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:13:57] INFO train_model: Preparing target variable...
[2025-07-16 14:13:57] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:13:57] INFO train_model: Dropping NaN targets...
[2025-07-16 14:13:57] INFO train_model: Class distribution: [955 436]
[2025-07-16 14:13:57] INFO train_model: Upsampling successful.
[2025-07-16 14:13:57] INFO train_model: Splitting train/test...
[2025-07-16 14:13:57] INFO train_model: Scaling features...
[2025-07-16 14:13:57] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 14:13:57] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 14:13:58] INFO train_model: Model fit complete.
[2025-07-16 14:13:58] INFO train_model: Model Accuracy: 0.8874
[2025-07-16 14:13:58] INFO train_model: 
Classification Report:
[2025-07-16 14:13:58] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.87      0.89       191
           1       0.87      0.91      0.89       191

    accuracy                           0.89       382
   macro avg       0.89      0.89      0.89       382
weighted avg       0.89      0.89      0.89       382

[2025-07-16 14:13:58] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 14:13:58] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 14:13:58] INFO train_model: Feature distributions before training:
[2025-07-16 14:13:58] INFO train_model: atr_14: mean=0.3155, std=0.0620, min=0.1686, max=0.5768, unique=1391
[2025-07-16 14:13:58] INFO train_model: volatility_20: mean=0.3199, std=0.1713, min=0.0583, max=1.1795, unique=1391
[2025-07-16 14:13:58] INFO train_model: fib_0: mean=145.3868, std=1.4334, min=142.7570, max=149.1860, unique=386
[2025-07-16 14:13:58] INFO train_model: fib_236: mean=145.0749, std=1.4088, min=142.5675, max=149.0510, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_382: mean=144.8819, std=1.3986, min=142.4503, max=148.9675, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_500: mean=144.7260, std=1.3933, min=142.3555, max=148.9000, unique=708
[2025-07-16 14:13:58] INFO train_model: fib_618: mean=144.5700, std=1.3907, min=142.2607, max=148.8325, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_786: mean=144.3480, std=1.3915, min=142.1258, max=148.7364, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_100: mean=144.0652, std=1.4003, min=141.9540, max=148.6140, unique=375
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_0: mean=-0.6259, std=0.4832, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4497, min=-2.0190, max=0.7009, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_382: mean=-0.1211, std=0.4446, min=-1.5815, max=1.2515, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_500: mean=0.0349, std=0.4497, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_618: mean=0.1908, std=0.4628, min=-0.9192, max=2.1415, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_786: mean=0.4128, std=0.4939, min=-0.4582, max=2.7750, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_100: mean=0.6957, std=0.5509, min=0.0140, max=3.5820, unique=1034
[2025-07-16 14:13:58] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1181
[2025-07-16 14:13:58] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 14:13:58] INFO train_model: trendline_up: mean=0.5133, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: trendline_down: mean=0.4666, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:13:58] INFO train_model: dist_to_high: mean=-0.6169, std=0.5077, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 14:13:58] INFO train_model: dist_to_low: mean=0.6995, std=0.5742, min=0.0020, max=3.5820, unique=1064
[2025-07-16 14:13:58] INFO train_model: pin_bar: mean=0.2832, std=0.4507, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: bullish_engulfing_bar: mean=0.0503, std=0.2187, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: inside_bar: mean=0.1330, std=0.3397, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0756, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: vol_spike_std: mean=0.1754, std=0.3805, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:13:58] INFO train_model: Auditing data quality before training...
[2025-07-16 14:13:59] INFO train_model: Entering audit_data_quality
[2025-07-16 15:24:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: Model is starting a new training session...
[2025-07-16 15:24:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:24:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:24:47] INFO train_model: Preparing target variable...
[2025-07-16 15:24:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:24:47] INFO train_model: Dropping NaN targets...
[2025-07-16 15:24:47] INFO train_model: Class distribution: [972 439]
[2025-07-16 15:24:47] INFO train_model: Upsampling successful.
[2025-07-16 15:24:47] INFO train_model: Splitting train/test...
[2025-07-16 15:24:47] INFO train_model: Scaling features...
[2025-07-16 15:25:01] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: Model is starting a new training session...
[2025-07-16 15:25:01] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:25:01] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:01] INFO train_model: Preparing target variable...
[2025-07-16 15:25:01] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:01] INFO train_model: Dropping NaN targets...
[2025-07-16 15:25:01] INFO train_model: Class distribution: [817 614]
[2025-07-16 15:25:01] INFO train_model: Upsampling successful.
[2025-07-16 15:25:01] INFO train_model: Splitting train/test...
[2025-07-16 15:25:01] INFO train_model: Scaling features...
[2025-07-16 15:25:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: Model is starting a new training session...
[2025-07-16 15:25:46] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:25:46] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:46] INFO train_model: Preparing target variable...
[2025-07-16 15:25:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:47] INFO train_model: Dropping NaN targets...
[2025-07-16 15:25:47] INFO train_model: Class distribution: [1030  382]
[2025-07-16 15:25:47] INFO train_model: Upsampling successful.
[2025-07-16 15:25:47] INFO train_model: Splitting train/test...
[2025-07-16 15:25:47] INFO train_model: Scaling features...
[2025-07-16 15:26:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: Model is starting a new training session...
[2025-07-16 15:26:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:26:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:26:52] INFO train_model: Preparing target variable...
[2025-07-16 15:26:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:26:52] INFO train_model: Dropping NaN targets...
[2025-07-16 15:26:52] INFO train_model: Class distribution: [956 464]
[2025-07-16 15:26:52] INFO train_model: Upsampling successful.
[2025-07-16 15:26:52] INFO train_model: Splitting train/test...
[2025-07-16 15:26:52] INFO train_model: Scaling features...
[2025-07-16 15:36:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: Model is starting a new training session...
[2025-07-16 15:36:46] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:36:46] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:36:46] INFO train_model: Preparing target variable...
[2025-07-16 15:36:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:36:46] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:36:46] INFO train_model: Dropping NaN targets...
[2025-07-16 15:36:46] INFO train_model: Class distribution: [972 439]
[2025-07-16 15:36:46] INFO train_model: Upsampling successful.
[2025-07-16 15:36:46] INFO train_model: Splitting train/test...
[2025-07-16 15:36:46] INFO train_model: Scaling features...
[2025-07-16 15:36:46] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:36:46] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:36:47] INFO train_model: Model fit complete.
[2025-07-16 15:36:47] INFO train_model: Model Accuracy: 0.5347
[2025-07-16 15:36:47] INFO train_model: 
Classification Report:
[2025-07-16 15:36:47] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.56      0.55       195
           1       0.54      0.51      0.52       194

    accuracy                           0.53       389
   macro avg       0.53      0.53      0.53       389
weighted avg       0.53      0.53      0.53       389

[2025-07-16 15:36:47] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:36:47] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:36:47] INFO train_model: Feature distributions before training:
[2025-07-16 15:36:47] INFO train_model: supply_zone: mean=0.4437, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: demand_zone: mean=0.3834, std=0.4864, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: head_shoulders: mean=0.0319, std=0.1758, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: inv_head_shoulders: mean=0.0319, std=0.1758, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:36:47] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:36:47] INFO train_model: rising_wedge: mean=0.2530, std=0.4349, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: falling_wedge: mean=0.1942, std=0.3957, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:36:47] INFO train_model: Auditing data quality before training...
[2025-07-16 15:36:47] INFO train_model: Entering audit_data_quality
[2025-07-16 15:48:14] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:48:14] WARNING train_model: Removing constant feature: double_top
[2025-07-16 15:48:14] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 15:48:14] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 15:48:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 15:48:14] INFO train_model: Entering audit_data_quality
[2025-07-16 15:48:18] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:48:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 15:48:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:48:19] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 15:48:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:48:19] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 15:48:23] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: Model is starting a new training session...
[2025-07-16 15:48:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:48:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:48:23] INFO train_model: Preparing target variable...
[2025-07-16 15:48:23] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:48:23] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:48:23] INFO train_model: Dropping NaN targets...
[2025-07-16 15:48:23] INFO train_model: Class distribution: [817 614]
[2025-07-16 15:48:23] INFO train_model: Upsampling successful.
[2025-07-16 15:48:23] INFO train_model: Splitting train/test...
[2025-07-16 15:48:23] INFO train_model: Scaling features...
[2025-07-16 15:48:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:48:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:48:24] INFO train_model: Model fit complete.
[2025-07-16 15:48:24] INFO train_model: Model Accuracy: 0.5076
[2025-07-16 15:48:24] INFO train_model: 
Classification Report:
[2025-07-16 15:48:24] INFO train_model:               precision    recall  f1-score   support

           0       0.51      0.65      0.57       164
           1       0.51      0.37      0.43       163

    accuracy                           0.51       327
   macro avg       0.51      0.51      0.50       327
weighted avg       0.51      0.51      0.50       327

[2025-07-16 15:48:24] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:48:24] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:48:24] INFO train_model: Feature distributions before training:
[2025-07-16 15:48:24] INFO train_model: supply_zone: mean=0.2704, std=0.4443, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: demand_zone: mean=0.2006, std=0.4006, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1783, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:48:24] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:48:24] INFO train_model: rising_wedge: mean=0.2739, std=0.4461, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: falling_wedge: mean=0.2509, std=0.4337, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: fakeout_up: mean=0.0049, std=0.0698, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: fakeout_down: mean=0.0063, std=0.0791, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: Auditing data quality before training...
[2025-07-16 15:48:24] INFO train_model: Entering audit_data_quality
[2025-07-16 15:53:41] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:53:41] WARNING train_model: Removing constant feature: double_top
[2025-07-16 15:53:41] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 15:53:41] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 15:53:41] INFO train_model: Entering audit_data_quality
[2025-07-16 15:54:08] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:54:08] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 15:54:08] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:54:08] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 15:54:08] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:54:08] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 15:54:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: Model is starting a new training session...
[2025-07-16 15:54:16] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:54:16] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:54:16] INFO train_model: Preparing target variable...
[2025-07-16 15:54:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:54:16] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:54:16] INFO train_model: Dropping NaN targets...
[2025-07-16 15:54:16] INFO train_model: Class distribution: [1030  382]
[2025-07-16 15:54:16] INFO train_model: Upsampling successful.
[2025-07-16 15:54:16] INFO train_model: Splitting train/test...
[2025-07-16 15:54:16] INFO train_model: Scaling features...
[2025-07-16 15:54:16] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:54:16] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:54:17] INFO train_model: Model fit complete.
[2025-07-16 15:54:17] INFO train_model: Model Accuracy: 0.5243
[2025-07-16 15:54:17] INFO train_model: 
Classification Report:
[2025-07-16 15:54:17] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.80      0.63       206
           1       0.55      0.25      0.34       206

    accuracy                           0.52       412
   macro avg       0.53      0.52      0.48       412
weighted avg       0.53      0.52      0.48       412

[2025-07-16 15:54:17] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:54:17] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:54:17] INFO train_model: Feature distributions before training:
[2025-07-16 15:54:17] INFO train_model: supply_zone: mean=0.4193, std=0.4936, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: demand_zone: mean=0.4816, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: head_shoulders: mean=0.0340, std=0.1813, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:54:17] INFO train_model: double_bottom: mean=0.0127, std=0.1122, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: rising_wedge: mean=0.2040, std=0.4031, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: falling_wedge: mean=0.2252, std=0.4179, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:54:17] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:54:17] INFO train_model: Auditing data quality before training...
[2025-07-16 15:54:17] INFO train_model: Entering audit_data_quality
[2025-07-16 15:59:17] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:59:17] WARNING train_model: Removing constant feature: double_top
[2025-07-16 15:59:17] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 15:59:17] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 15:59:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 15:59:17] INFO train_model: Entering audit_data_quality
[2025-07-16 15:59:24] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:59:24] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 15:59:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:59:24] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 15:59:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:59:24] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 15:59:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: Model is starting a new training session...
[2025-07-16 15:59:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:59:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:59:28] INFO train_model: Preparing target variable...
[2025-07-16 15:59:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:59:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:59:28] INFO train_model: Dropping NaN targets...
[2025-07-16 15:59:28] INFO train_model: Class distribution: [956 464]
[2025-07-16 15:59:28] INFO train_model: Upsampling successful.
[2025-07-16 15:59:28] INFO train_model: Splitting train/test...
[2025-07-16 15:59:28] INFO train_model: Scaling features...
[2025-07-16 15:59:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:59:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:59:29] INFO train_model: Model fit complete.
[2025-07-16 15:59:29] INFO train_model: Model Accuracy: 0.5535
[2025-07-16 15:59:29] INFO train_model: 
Classification Report:
[2025-07-16 15:59:29] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.54      0.55       192
           1       0.55      0.57      0.56       191

    accuracy                           0.55       383
   macro avg       0.55      0.55      0.55       383
weighted avg       0.55      0.55      0.55       383

[2025-07-16 15:59:29] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:59:29] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:59:29] INFO train_model: Feature distributions before training:
[2025-07-16 15:59:29] INFO train_model: supply_zone: mean=0.4739, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: demand_zone: mean=0.3641, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: head_shoulders: mean=0.0345, std=0.1826, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: inv_head_shoulders: mean=0.0275, std=0.1635, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: rising_wedge: mean=0.2923, std=0.4550, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: falling_wedge: mean=0.2359, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: Auditing data quality before training...
[2025-07-16 15:59:29] INFO train_model: Entering audit_data_quality
[2025-07-16 16:03:25] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:03:25] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:03:25] INFO train_model: Entering audit_data_quality
[2025-07-16 16:07:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: Model is starting a new training session...
[2025-07-16 16:07:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:07:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:07:56] INFO train_model: Preparing target variable...
[2025-07-16 16:07:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:07:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:07:56] INFO train_model: Dropping NaN targets...
[2025-07-16 16:07:56] INFO train_model: Class distribution: [973 439]
[2025-07-16 16:07:56] INFO train_model: Upsampling successful.
[2025-07-16 16:07:56] INFO train_model: Splitting train/test...
[2025-07-16 16:07:56] INFO train_model: Scaling features...
[2025-07-16 16:07:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:07:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:07:57] INFO train_model: Model fit complete.
[2025-07-16 16:07:57] INFO train_model: Model Accuracy: 0.5897
[2025-07-16 16:07:57] INFO train_model: 
Classification Report:
[2025-07-16 16:07:57] INFO train_model:               precision    recall  f1-score   support

           0       0.62      0.45      0.52       195
           1       0.57      0.73      0.64       195

    accuracy                           0.59       390
   macro avg       0.60      0.59      0.58       390
weighted avg       0.60      0.59      0.58       390

[2025-07-16 16:07:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:07:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:07:57] INFO train_model: Feature distributions before training:
[2025-07-16 16:07:57] INFO train_model: supply_zone: mean=0.4433, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: demand_zone: mean=0.3839, std=0.4865, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: head_shoulders: mean=0.0319, std=0.1757, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: inv_head_shoulders: mean=0.0319, std=0.1757, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:07:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:07:57] INFO train_model: rising_wedge: mean=0.2528, std=0.4348, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: falling_wedge: mean=0.1948, std=0.3962, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:07:57] INFO train_model: Auditing data quality before training...
[2025-07-16 16:07:57] INFO train_model: Entering audit_data_quality
[2025-07-16 16:07:58] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:07:58] WARNING train_model: Removing constant feature: double_top
[2025-07-16 16:07:58] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 16:07:58] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 16:07:58] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:07:58] INFO train_model: Entering audit_data_quality
[2025-07-16 16:07:59] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:07:59] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:07:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:07:59] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:07:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:07:59] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:08:05] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: Model is starting a new training session...
[2025-07-16 16:08:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:08:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:05] INFO train_model: Preparing target variable...
[2025-07-16 16:08:05] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:05] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:08:05] INFO train_model: Dropping NaN targets...
[2025-07-16 16:08:05] INFO train_model: Class distribution: [817 615]
[2025-07-16 16:08:05] INFO train_model: Upsampling successful.
[2025-07-16 16:08:05] INFO train_model: Splitting train/test...
[2025-07-16 16:08:05] INFO train_model: Scaling features...
[2025-07-16 16:08:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:08:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:08:05] INFO train_model: Model fit complete.
[2025-07-16 16:08:05] INFO train_model: Model Accuracy: 0.5260
[2025-07-16 16:08:05] INFO train_model: 
Classification Report:
[2025-07-16 16:08:05] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.63      0.57       164
           1       0.53      0.42      0.47       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.52       327
weighted avg       0.53      0.53      0.52       327

[2025-07-16 16:08:05] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:08:05] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:08:05] INFO train_model: Feature distributions before training:
[2025-07-16 16:08:05] INFO train_model: supply_zone: mean=0.2716, std=0.4450, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: demand_zone: mean=0.2004, std=0.4005, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1782, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:05] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:05] INFO train_model: rising_wedge: mean=0.2744, std=0.4464, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: falling_wedge: mean=0.2507, std=0.4336, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: fakeout_up: mean=0.0049, std=0.0698, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: fakeout_down: mean=0.0063, std=0.0791, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: Auditing data quality before training...
[2025-07-16 16:08:05] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:06] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:06] WARNING train_model: Removing constant feature: double_top
[2025-07-16 16:08:06] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 16:08:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:08:06] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:07] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:08:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:08:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:08:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: Model is starting a new training session...
[2025-07-16 16:08:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:08:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:13] INFO train_model: Preparing target variable...
[2025-07-16 16:08:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:13] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:08:13] INFO train_model: Dropping NaN targets...
[2025-07-16 16:08:13] INFO train_model: Class distribution: [1030  383]
[2025-07-16 16:08:13] INFO train_model: Upsampling successful.
[2025-07-16 16:08:13] INFO train_model: Splitting train/test...
[2025-07-16 16:08:13] INFO train_model: Scaling features...
[2025-07-16 16:08:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:08:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:08:14] INFO train_model: Model fit complete.
[2025-07-16 16:08:14] INFO train_model: Model Accuracy: 0.5437
[2025-07-16 16:08:14] INFO train_model: 
Classification Report:
[2025-07-16 16:08:14] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.70      0.61       206
           1       0.56      0.39      0.46       206

    accuracy                           0.54       412
   macro avg       0.55      0.54      0.53       412
weighted avg       0.55      0.54      0.53       412

[2025-07-16 16:08:14] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:08:14] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:08:14] INFO train_model: Feature distributions before training:
[2025-07-16 16:08:14] INFO train_model: supply_zone: mean=0.4190, std=0.4936, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: demand_zone: mean=0.4812, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: head_shoulders: mean=0.0340, std=0.1812, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: inv_head_shoulders: mean=0.0304, std=0.1718, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:14] INFO train_model: double_bottom: mean=0.0127, std=0.1122, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: rising_wedge: mean=0.2038, std=0.4030, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: falling_wedge: mean=0.2251, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:14] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:14] INFO train_model: Auditing data quality before training...
[2025-07-16 16:08:14] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:15] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:15] WARNING train_model: Removing constant feature: double_top
[2025-07-16 16:08:15] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 16:08:15] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 16:08:15] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:08:15] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:15] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:15] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:08:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:15] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:08:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:15] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:08:19] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: Model is starting a new training session...
[2025-07-16 16:08:19] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:08:19] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:19] INFO train_model: Preparing target variable...
[2025-07-16 16:08:19] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:19] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:08:19] INFO train_model: Dropping NaN targets...
[2025-07-16 16:08:19] INFO train_model: Class distribution: [957 464]
[2025-07-16 16:08:19] INFO train_model: Upsampling successful.
[2025-07-16 16:08:19] INFO train_model: Splitting train/test...
[2025-07-16 16:08:19] INFO train_model: Scaling features...
[2025-07-16 16:08:19] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:08:19] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:08:20] INFO train_model: Model fit complete.
[2025-07-16 16:08:20] INFO train_model: Model Accuracy: 0.5326
[2025-07-16 16:08:20] INFO train_model: 
Classification Report:
[2025-07-16 16:08:20] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.47      0.50       192
           1       0.53      0.59      0.56       191

    accuracy                           0.53       383
   macro avg       0.53      0.53      0.53       383
weighted avg       0.53      0.53      0.53       383

[2025-07-16 16:08:20] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:08:20] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:08:20] INFO train_model: Feature distributions before training:
[2025-07-16 16:08:20] INFO train_model: supply_zone: mean=0.4736, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: demand_zone: mean=0.3645, std=0.4815, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: head_shoulders: mean=0.0345, std=0.1825, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1634, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: rising_wedge: mean=0.2920, std=0.4549, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: falling_wedge: mean=0.2365, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: Auditing data quality before training...
[2025-07-16 16:08:20] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:08:21] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:08:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:08:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:16:21] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:16:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:16:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:16:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:16:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:16:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:34:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: Model is starting a new training session...
[2025-07-16 18:34:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:34:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:34:56] INFO train_model: Preparing target variable...
[2025-07-16 18:34:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:34:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:34:56] INFO train_model: Dropping NaN targets...
[2025-07-16 18:34:56] INFO train_model: Class distribution: [975 439]
[2025-07-16 18:34:56] INFO train_model: Upsampling successful.
[2025-07-16 18:34:56] INFO train_model: Splitting train/test...
[2025-07-16 18:34:56] INFO train_model: Scaling features...
[2025-07-16 18:34:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:34:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:34:57] INFO train_model: Model fit complete.
[2025-07-16 18:34:57] INFO train_model: Model Accuracy: 0.5590
[2025-07-16 18:34:57] INFO train_model: 
Classification Report:
[2025-07-16 18:34:57] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.73      0.62       195
           1       0.59      0.39      0.47       195

    accuracy                           0.56       390
   macro avg       0.57      0.56      0.55       390
weighted avg       0.57      0.56      0.55       390

[2025-07-16 18:34:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:34:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:34:57] INFO train_model: Feature distributions before training:
[2025-07-16 18:34:57] INFO train_model: supply_zone: mean=0.4427, std=0.4969, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: demand_zone: mean=0.3833, std=0.4864, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:34:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:34:57] INFO train_model: rising_wedge: mean=0.2525, std=0.4346, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: falling_wedge: mean=0.1959, std=0.3970, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:34:57] INFO train_model: Auditing data quality before training...
[2025-07-16 18:34:57] INFO train_model: Entering audit_data_quality
[2025-07-16 18:34:58] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:34:58] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:34:58] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:34:58] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 18:34:58] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:34:58] INFO train_model: Entering audit_data_quality
[2025-07-16 18:34:58] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:34:58] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:34:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:34:59] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:34:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:34:59] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:35:00] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: Model is starting a new training session...
[2025-07-16 18:35:00] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:35:00] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:00] INFO train_model: Preparing target variable...
[2025-07-16 18:35:00] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:00] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:35:00] INFO train_model: Dropping NaN targets...
[2025-07-16 18:35:00] INFO train_model: Class distribution: [817 617]
[2025-07-16 18:35:00] INFO train_model: Upsampling successful.
[2025-07-16 18:35:00] INFO train_model: Splitting train/test...
[2025-07-16 18:35:00] INFO train_model: Scaling features...
[2025-07-16 18:35:00] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:35:00] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:35:01] INFO train_model: Model fit complete.
[2025-07-16 18:35:01] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 18:35:01] INFO train_model: 
Classification Report:
[2025-07-16 18:35:01] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 18:35:01] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:35:01] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:35:01] INFO train_model: Feature distributions before training:
[2025-07-16 18:35:01] INFO train_model: supply_zone: mean=0.2720, std=0.4451, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: demand_zone: mean=0.2001, std=0.4002, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: head_shoulders: mean=0.0342, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:01] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:01] INFO train_model: rising_wedge: mean=0.2741, std=0.4462, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: falling_wedge: mean=0.2503, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: Auditing data quality before training...
[2025-07-16 18:35:01] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:01] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:01] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:35:01] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:35:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:35:01] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:02] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:02] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:35:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:02] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:35:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:02] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:35:03] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: Model is starting a new training session...
[2025-07-16 18:35:03] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:35:03] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:03] INFO train_model: Preparing target variable...
[2025-07-16 18:35:03] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:03] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:35:03] INFO train_model: Dropping NaN targets...
[2025-07-16 18:35:03] INFO train_model: Class distribution: [1032  383]
[2025-07-16 18:35:03] INFO train_model: Upsampling successful.
[2025-07-16 18:35:03] INFO train_model: Splitting train/test...
[2025-07-16 18:35:03] INFO train_model: Scaling features...
[2025-07-16 18:35:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:35:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:35:04] INFO train_model: Model fit complete.
[2025-07-16 18:35:04] INFO train_model: Model Accuracy: 0.4964
[2025-07-16 18:35:04] INFO train_model: 
Classification Report:
[2025-07-16 18:35:04] INFO train_model:               precision    recall  f1-score   support

           0       0.50      0.55      0.52       207
           1       0.49      0.44      0.47       206

    accuracy                           0.50       413
   macro avg       0.50      0.50      0.49       413
weighted avg       0.50      0.50      0.49       413

[2025-07-16 18:35:04] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:35:04] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:35:04] INFO train_model: Feature distributions before training:
[2025-07-16 18:35:04] INFO train_model: supply_zone: mean=0.4184, std=0.4935, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: demand_zone: mean=0.4813, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: head_shoulders: mean=0.0339, std=0.1811, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:04] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: rising_wedge: mean=0.2035, std=0.4028, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: falling_wedge: mean=0.2247, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:04] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:04] INFO train_model: Auditing data quality before training...
[2025-07-16 18:35:04] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:05] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:05] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:35:05] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 18:35:05] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 18:35:05] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:35:05] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:05] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:05] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:35:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:05] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:35:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:05] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:35:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: Model is starting a new training session...
[2025-07-16 18:35:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:35:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:07] INFO train_model: Preparing target variable...
[2025-07-16 18:35:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:07] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:35:07] INFO train_model: Dropping NaN targets...
[2025-07-16 18:35:07] INFO train_model: Class distribution: [959 464]
[2025-07-16 18:35:07] INFO train_model: Upsampling successful.
[2025-07-16 18:35:07] INFO train_model: Splitting train/test...
[2025-07-16 18:35:07] INFO train_model: Scaling features...
[2025-07-16 18:35:07] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:35:07] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:35:07] INFO train_model: Model fit complete.
[2025-07-16 18:35:07] INFO train_model: Model Accuracy: 0.5443
[2025-07-16 18:35:07] INFO train_model: 
Classification Report:
[2025-07-16 18:35:07] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.64      0.58       192
           1       0.55      0.45      0.50       192

    accuracy                           0.54       384
   macro avg       0.55      0.54      0.54       384
weighted avg       0.55      0.54      0.54       384

[2025-07-16 18:35:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:35:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:35:07] INFO train_model: Feature distributions before training:
[2025-07-16 18:35:07] INFO train_model: supply_zone: mean=0.4729, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: demand_zone: mean=0.3640, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: head_shoulders: mean=0.0344, std=0.1824, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: rising_wedge: mean=0.2916, std=0.4547, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: falling_wedge: mean=0.2375, std=0.4257, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: Auditing data quality before training...
[2025-07-16 18:35:07] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:08] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:08] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:35:08] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:09] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:35:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:35:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:37:55] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: Model is starting a new training session...
[2025-07-16 18:37:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:37:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:37:55] INFO train_model: Preparing target variable...
[2025-07-16 18:37:55] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:37:55] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:37:55] INFO train_model: Dropping NaN targets...
[2025-07-16 18:37:55] INFO train_model: Class distribution: [975 439]
[2025-07-16 18:37:55] INFO train_model: Upsampling successful.
[2025-07-16 18:37:55] INFO train_model: Splitting train/test...
[2025-07-16 18:37:55] INFO train_model: Scaling features...
[2025-07-16 18:37:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:37:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:37:55] INFO train_model: Model fit complete.
[2025-07-16 18:37:55] INFO train_model: Model Accuracy: 0.5590
[2025-07-16 18:37:55] INFO train_model: 
Classification Report:
[2025-07-16 18:37:55] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.73      0.62       195
           1       0.59      0.39      0.47       195

    accuracy                           0.56       390
   macro avg       0.57      0.56      0.55       390
weighted avg       0.57      0.56      0.55       390

[2025-07-16 18:37:55] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:37:55] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:37:55] INFO train_model: Feature distributions before training:
[2025-07-16 18:37:55] INFO train_model: supply_zone: mean=0.4427, std=0.4969, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: demand_zone: mean=0.3833, std=0.4864, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:37:55] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:37:55] INFO train_model: rising_wedge: mean=0.2525, std=0.4346, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: falling_wedge: mean=0.1959, std=0.3970, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:37:55] INFO train_model: Auditing data quality before training...
[2025-07-16 18:37:56] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:00] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:00] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:38:00] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:38:00] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 18:38:00] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:38:00] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:05] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:05] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:38:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:05] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:38:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:05] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:38:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: Model is starting a new training session...
[2025-07-16 18:38:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:38:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:07] INFO train_model: Preparing target variable...
[2025-07-16 18:38:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:07] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:38:07] INFO train_model: Dropping NaN targets...
[2025-07-16 18:38:07] INFO train_model: Class distribution: [817 617]
[2025-07-16 18:38:07] INFO train_model: Upsampling successful.
[2025-07-16 18:38:07] INFO train_model: Splitting train/test...
[2025-07-16 18:38:07] INFO train_model: Scaling features...
[2025-07-16 18:38:07] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:38:07] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:38:07] INFO train_model: Model fit complete.
[2025-07-16 18:38:07] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 18:38:07] INFO train_model: 
Classification Report:
[2025-07-16 18:38:07] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 18:38:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:38:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:38:07] INFO train_model: Feature distributions before training:
[2025-07-16 18:38:07] INFO train_model: supply_zone: mean=0.2720, std=0.4451, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: demand_zone: mean=0.2001, std=0.4002, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: head_shoulders: mean=0.0342, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:07] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:07] INFO train_model: rising_wedge: mean=0.2741, std=0.4462, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: falling_wedge: mean=0.2503, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: Auditing data quality before training...
[2025-07-16 18:38:07] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:16] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:16] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:38:16] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:38:16] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:38:16] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:20] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:20] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:38:20] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:20] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:38:20] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:20] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:38:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: Model is starting a new training session...
[2025-07-16 18:38:21] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:38:21] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:21] INFO train_model: Preparing target variable...
[2025-07-16 18:38:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:21] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:38:21] INFO train_model: Dropping NaN targets...
[2025-07-16 18:38:21] INFO train_model: Class distribution: [1032  383]
[2025-07-16 18:38:21] INFO train_model: Upsampling successful.
[2025-07-16 18:38:21] INFO train_model: Splitting train/test...
[2025-07-16 18:38:21] INFO train_model: Scaling features...
[2025-07-16 18:38:21] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:38:21] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:38:22] INFO train_model: Model fit complete.
[2025-07-16 18:38:22] INFO train_model: Model Accuracy: 0.4964
[2025-07-16 18:38:22] INFO train_model: 
Classification Report:
[2025-07-16 18:38:22] INFO train_model:               precision    recall  f1-score   support

           0       0.50      0.55      0.52       207
           1       0.49      0.44      0.47       206

    accuracy                           0.50       413
   macro avg       0.50      0.50      0.49       413
weighted avg       0.50      0.50      0.49       413

[2025-07-16 18:38:22] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:38:22] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:38:22] INFO train_model: Feature distributions before training:
[2025-07-16 18:38:22] INFO train_model: supply_zone: mean=0.4184, std=0.4935, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: demand_zone: mean=0.4813, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: head_shoulders: mean=0.0339, std=0.1811, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:22] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: rising_wedge: mean=0.2035, std=0.4028, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: falling_wedge: mean=0.2247, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:22] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:22] INFO train_model: Auditing data quality before training...
[2025-07-16 18:38:22] INFO train_model: Entering audit_data_quality
[2025-07-16 18:49:19] INFO train_model: Training signal prediction model...
[2025-07-16 19:13:12] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:12] INFO train_model: Preparing target variable...
[2025-07-16 19:13:12] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:12] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:12] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:12] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:13:15] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:15] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:15] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:13:15] INFO train_model: Preparing target variable...
[2025-07-16 19:13:15] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:13:15] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:15] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:15] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:13:17] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:17] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:17] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:17] INFO train_model: Preparing target variable...
[2025-07-16 19:13:17] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:17] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:17] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:17] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:13:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:18] INFO train_model: Preparing target variable...
[2025-07-16 19:13:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:18] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:18] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:15:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:28] INFO train_model: Preparing target variable...
[2025-07-16 19:15:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:28] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:28] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:15:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:15:29] INFO train_model: Preparing target variable...
[2025-07-16 19:15:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:15:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:29] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:29] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:15:31] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:31] INFO train_model: Preparing target variable...
[2025-07-16 19:15:31] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:31] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:31] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:31] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:15:33] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:33] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:33] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:33] INFO train_model: Preparing target variable...
[2025-07-16 19:15:33] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:33] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:33] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:33] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:15:40] INFO train_model: Training signal prediction model...
[2025-07-16 19:16:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:25] INFO train_model: Preparing target variable...
[2025-07-16 19:16:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:25] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:25] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:25] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:16:26] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:26] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:26] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:26] INFO train_model: Preparing target variable...
[2025-07-16 19:16:26] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:26] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:26] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:26] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:16:27] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:27] INFO train_model: Preparing target variable...
[2025-07-16 19:16:27] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:27] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:27] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:27] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:16:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:29] INFO train_model: Preparing target variable...
[2025-07-16 19:16:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:29] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:29] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:20:37] INFO train_model: Training signal prediction model...
[2025-07-16 19:21:37] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:37] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:37] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:37] INFO train_model: Preparing target variable...
[2025-07-16 19:21:37] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:37] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:37] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:37] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:21:37] INFO train_model: Upsampling successful.
[2025-07-16 19:21:37] INFO train_model: Splitting train/test...
[2025-07-16 19:21:37] INFO train_model: Scaling features...
[2025-07-16 19:21:37] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:37] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:38] INFO train_model: Model fit complete.
[2025-07-16 19:21:38] INFO train_model: Model Accuracy: 0.5831
[2025-07-16 19:21:38] INFO train_model: 
Classification Report:
[2025-07-16 19:21:38] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.74      0.64       196
           1       0.62      0.43      0.50       195

    accuracy                           0.58       391
   macro avg       0.59      0.58      0.57       391
weighted avg       0.59      0.58      0.57       391

[2025-07-16 19:21:38] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:38] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:38] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:38] INFO train_model: supply_zone: mean=0.4424, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: demand_zone: mean=0.3830, std=0.4863, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_markdown: mean=0.4686, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_markup: mean=0.5032, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_unknown: mean=0.0283, std=0.1658, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: rising_wedge: mean=0.2523, std=0.4345, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: falling_wedge: mean=0.1965, std=0.3975, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:38] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:38] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:21:38] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:38] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:39] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:39] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:39] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:39] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:21:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:40] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:40] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:40] INFO train_model: Preparing target variable...
[2025-07-16 19:21:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:40] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:40] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:40] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:21:40] INFO train_model: Upsampling successful.
[2025-07-16 19:21:40] INFO train_model: Splitting train/test...
[2025-07-16 19:21:40] INFO train_model: Scaling features...
[2025-07-16 19:21:40] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:40] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:41] INFO train_model: Model fit complete.
[2025-07-16 19:21:41] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 19:21:41] INFO train_model: 
Classification Report:
[2025-07-16 19:21:41] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 19:21:41] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:41] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:41] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:41] INFO train_model: supply_zone: mean=0.2718, std=0.4450, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: demand_zone: mean=0.2000, std=0.4001, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_distribution: mean=0.1331, std=0.3398, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_markdown: mean=0.3805, std=0.4857, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_markup: mean=0.4578, std=0.4984, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_unknown: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: head_shoulders: mean=0.0341, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:41] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:41] INFO train_model: rising_wedge: mean=0.2739, std=0.4461, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: falling_wedge: mean=0.2502, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:41] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:41] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:41] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:21:41] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:21:41] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:41] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:42] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:42] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:42] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:42] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:21:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:43] INFO train_model: Preparing target variable...
[2025-07-16 19:21:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:43] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:43] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:21:43] INFO train_model: Upsampling successful.
[2025-07-16 19:21:43] INFO train_model: Splitting train/test...
[2025-07-16 19:21:43] INFO train_model: Scaling features...
[2025-07-16 19:21:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:44] INFO train_model: Model fit complete.
[2025-07-16 19:21:44] INFO train_model: Model Accuracy: 0.5266
[2025-07-16 19:21:44] INFO train_model: 
Classification Report:
[2025-07-16 19:21:44] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.57      0.55       207
           1       0.53      0.48      0.50       207

    accuracy                           0.53       414
   macro avg       0.53      0.53      0.53       414
weighted avg       0.53      0.53      0.53       414

[2025-07-16 19:21:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:44] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:44] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: demand_zone: mean=0.4809, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_markdown: mean=0.5304, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_markup: mean=0.4414, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: head_shoulders: mean=0.0339, std=0.1810, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: rising_wedge: mean=0.2034, std=0.4027, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: falling_wedge: mean=0.2246, std=0.4175, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:44] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:21:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:45] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:45] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:45] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:21:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:46] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:46] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:46] INFO train_model: Preparing target variable...
[2025-07-16 19:21:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:46] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:46] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:46] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:21:46] INFO train_model: Upsampling successful.
[2025-07-16 19:21:46] INFO train_model: Splitting train/test...
[2025-07-16 19:21:46] INFO train_model: Scaling features...
[2025-07-16 19:21:46] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:46] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:47] INFO train_model: Model fit complete.
[2025-07-16 19:21:47] INFO train_model: Model Accuracy: 0.5599
[2025-07-16 19:21:47] INFO train_model: 
Classification Report:
[2025-07-16 19:21:47] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.52      0.54       192
           1       0.56      0.60      0.58       192

    accuracy                           0.56       384
   macro avg       0.56      0.56      0.56       384
weighted avg       0.56      0.56      0.56       384

[2025-07-16 19:21:47] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:47] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:47] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:47] INFO train_model: supply_zone: mean=0.4726, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: demand_zone: mean=0.3638, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_markdown: mean=0.4087, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_markup: mean=0.5632, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_unknown: mean=0.0281, std=0.1653, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:47] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:47] INFO train_model: head_shoulders: mean=0.0344, std=0.1823, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: rising_wedge: mean=0.2914, std=0.4546, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: falling_wedge: mean=0.2381, std=0.4260, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:47] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:47] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:47] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:21:47] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:21:47] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:47] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:47] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:47] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:47] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:47] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:29:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: Model is starting a new training session...
[2025-07-16 19:29:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:29:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:29:43] INFO train_model: Preparing target variable...
[2025-07-16 19:29:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:29:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:29:43] INFO train_model: Dropping NaN targets...
[2025-07-16 19:29:43] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:29:43] INFO train_model: Upsampling successful.
[2025-07-16 19:29:43] INFO train_model: Splitting train/test...
[2025-07-16 19:29:43] INFO train_model: Scaling features...
[2025-07-16 19:29:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:29:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:29:44] INFO train_model: Model fit complete.
[2025-07-16 19:29:44] INFO train_model: Model Accuracy: 0.5831
[2025-07-16 19:29:44] INFO train_model: 
Classification Report:
[2025-07-16 19:29:44] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.74      0.64       196
           1       0.62      0.43      0.50       195

    accuracy                           0.58       391
   macro avg       0.59      0.58      0.57       391
weighted avg       0.59      0.58      0.57       391

[2025-07-16 19:29:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:29:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:29:44] INFO train_model: Feature distributions before training:
[2025-07-16 19:29:44] INFO train_model: supply_zone: mean=0.4424, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: demand_zone: mean=0.3830, std=0.4863, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_markdown: mean=0.4686, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_markup: mean=0.5032, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_unknown: mean=0.0283, std=0.1658, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: rising_wedge: mean=0.2523, std=0.4345, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: falling_wedge: mean=0.1965, std=0.3975, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: Auditing data quality before training...
[2025-07-16 19:29:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:29:44] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:29:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:29:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:29:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:29:45] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:29:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:29:45] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:29:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:29:45] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:30:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: Model is starting a new training session...
[2025-07-16 19:30:16] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:30:16] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:16] INFO train_model: Preparing target variable...
[2025-07-16 19:30:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:16] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:30:16] INFO train_model: Dropping NaN targets...
[2025-07-16 19:30:16] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:30:16] INFO train_model: Upsampling successful.
[2025-07-16 19:30:16] INFO train_model: Splitting train/test...
[2025-07-16 19:30:16] INFO train_model: Scaling features...
[2025-07-16 19:30:16] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:30:16] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:30:17] INFO train_model: Model fit complete.
[2025-07-16 19:30:17] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 19:30:17] INFO train_model: 
Classification Report:
[2025-07-16 19:30:17] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 19:30:17] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:30:17] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:30:17] INFO train_model: Feature distributions before training:
[2025-07-16 19:30:17] INFO train_model: supply_zone: mean=0.2718, std=0.4450, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: demand_zone: mean=0.2000, std=0.4001, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_distribution: mean=0.1338, std=0.3406, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_markdown: mean=0.3805, std=0.4857, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_markup: mean=0.4571, std=0.4983, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_unknown: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: head_shoulders: mean=0.0341, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:17] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:17] INFO train_model: rising_wedge: mean=0.2739, std=0.4461, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: falling_wedge: mean=0.2502, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: Auditing data quality before training...
[2025-07-16 19:30:17] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:17] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:17] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:30:17] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:30:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:30:17] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:18] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:30:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:18] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:30:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:18] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:30:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: Model is starting a new training session...
[2025-07-16 19:30:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:30:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:43] INFO train_model: Preparing target variable...
[2025-07-16 19:30:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:30:43] INFO train_model: Dropping NaN targets...
[2025-07-16 19:30:43] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:30:43] INFO train_model: Upsampling successful.
[2025-07-16 19:30:43] INFO train_model: Splitting train/test...
[2025-07-16 19:30:43] INFO train_model: Scaling features...
[2025-07-16 19:30:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:30:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:30:44] INFO train_model: Model fit complete.
[2025-07-16 19:30:44] INFO train_model: Model Accuracy: 0.5266
[2025-07-16 19:30:44] INFO train_model: 
Classification Report:
[2025-07-16 19:30:44] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.57      0.55       207
           1       0.53      0.48      0.50       207

    accuracy                           0.53       414
   macro avg       0.53      0.53      0.53       414
weighted avg       0.53      0.53      0.53       414

[2025-07-16 19:30:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:30:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:30:44] INFO train_model: Feature distributions before training:
[2025-07-16 19:30:44] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: demand_zone: mean=0.4809, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_markdown: mean=0.5304, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_markup: mean=0.4414, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: head_shoulders: mean=0.0339, std=0.1810, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: rising_wedge: mean=0.2034, std=0.4027, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: falling_wedge: mean=0.2246, std=0.4175, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: Auditing data quality before training...
[2025-07-16 19:30:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:30:45] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:30:45] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:45] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:30:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:45] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:30:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:45] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:31:08] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: Model is starting a new training session...
[2025-07-16 19:31:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:31:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:31:08] INFO train_model: Preparing target variable...
[2025-07-16 19:31:08] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:31:08] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:31:08] INFO train_model: Dropping NaN targets...
[2025-07-16 19:31:08] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:31:08] INFO train_model: Upsampling successful.
[2025-07-16 19:31:08] INFO train_model: Splitting train/test...
[2025-07-16 19:31:08] INFO train_model: Scaling features...
[2025-07-16 19:31:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:31:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:31:08] INFO train_model: Model fit complete.
[2025-07-16 19:31:08] INFO train_model: Model Accuracy: 0.5599
[2025-07-16 19:31:08] INFO train_model: 
Classification Report:
[2025-07-16 19:31:08] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.52      0.54       192
           1       0.56      0.60      0.58       192

    accuracy                           0.56       384
   macro avg       0.56      0.56      0.56       384
weighted avg       0.56      0.56      0.56       384

[2025-07-16 19:31:08] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:31:08] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:31:08] INFO train_model: Feature distributions before training:
[2025-07-16 19:31:08] INFO train_model: supply_zone: mean=0.4726, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: demand_zone: mean=0.3638, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_markdown: mean=0.4087, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_markup: mean=0.5632, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_unknown: mean=0.0281, std=0.1653, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:31:08] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:31:08] INFO train_model: head_shoulders: mean=0.0344, std=0.1823, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: rising_wedge: mean=0.2914, std=0.4546, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: falling_wedge: mean=0.2381, std=0.4260, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: Auditing data quality before training...
[2025-07-16 19:31:08] INFO train_model: Entering audit_data_quality
[2025-07-16 19:31:09] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:31:09] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:31:09] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:31:09] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:31:09] INFO train_model: Entering audit_data_quality
[2025-07-16 19:31:09] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:31:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:31:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:31:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:31:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:31:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:34:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: Model is starting a new training session...
[2025-07-16 19:34:21] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:34:21] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:21] INFO train_model: Preparing target variable...
[2025-07-16 19:34:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:21] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:34:21] INFO train_model: Dropping NaN targets...
[2025-07-16 19:34:21] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:34:21] INFO train_model: Upsampling successful.
[2025-07-16 19:34:21] INFO train_model: Splitting train/test...
[2025-07-16 19:34:21] INFO train_model: Scaling features...
[2025-07-16 19:34:21] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:34:21] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:34:22] INFO train_model: Model fit complete.
[2025-07-16 19:34:22] INFO train_model: Model Accuracy: 0.5266
[2025-07-16 19:34:22] INFO train_model: 
Classification Report:
[2025-07-16 19:34:22] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.57      0.55       207
           1       0.53      0.48      0.50       207

    accuracy                           0.53       414
   macro avg       0.53      0.53      0.53       414
weighted avg       0.53      0.53      0.53       414

[2025-07-16 19:34:22] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:34:22] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:34:22] INFO train_model: Feature distributions before training:
[2025-07-16 19:34:22] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: demand_zone: mean=0.4809, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_markdown: mean=0.5304, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_markup: mean=0.4414, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: head_shoulders: mean=0.0339, std=0.1810, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: rising_wedge: mean=0.2034, std=0.4027, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: falling_wedge: mean=0.2246, std=0.4175, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: Auditing data quality before training...
[2025-07-16 19:34:22] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:23] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:34:23] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:34:23] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:23] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:23] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:34:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:24] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:34:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:24] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:34:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: Model is starting a new training session...
[2025-07-16 19:34:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:34:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:25] INFO train_model: Preparing target variable...
[2025-07-16 19:34:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:25] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:34:25] INFO train_model: Dropping NaN targets...
[2025-07-16 19:34:25] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:34:25] INFO train_model: Upsampling successful.
[2025-07-16 19:34:25] INFO train_model: Splitting train/test...
[2025-07-16 19:34:25] INFO train_model: Scaling features...
[2025-07-16 19:34:25] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:34:25] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:34:26] INFO train_model: Model fit complete.
[2025-07-16 19:34:26] INFO train_model: Model Accuracy: 0.5599
[2025-07-16 19:34:26] INFO train_model: 
Classification Report:
[2025-07-16 19:34:26] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.52      0.54       192
           1       0.56      0.60      0.58       192

    accuracy                           0.56       384
   macro avg       0.56      0.56      0.56       384
weighted avg       0.56      0.56      0.56       384

[2025-07-16 19:34:26] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:34:26] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:34:26] INFO train_model: Feature distributions before training:
[2025-07-16 19:34:26] INFO train_model: supply_zone: mean=0.4726, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: demand_zone: mean=0.3638, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_markdown: mean=0.4087, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_markup: mean=0.5632, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_unknown: mean=0.0281, std=0.1653, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:26] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:26] INFO train_model: head_shoulders: mean=0.0344, std=0.1823, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: rising_wedge: mean=0.2914, std=0.4546, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: falling_wedge: mean=0.2381, std=0.4260, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: Auditing data quality before training...
[2025-07-16 19:34:26] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:26] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:26] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:34:26] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:34:26] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:34:26] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:26] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:26] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:34:26] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:26] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:34:26] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:26] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 20:05:23] INFO train_model: Training signal prediction model...
[2025-07-16 20:39:24] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: Model is starting a new training session...
[2025-07-16 20:39:24] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 20:39:24] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:39:24] INFO train_model: Preparing target variable...
[2025-07-16 20:39:24] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:39:24] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 20:39:24] INFO train_model: Dropping NaN targets...
[2025-07-16 20:39:24] INFO train_model: Class distribution: [977 439]
[2025-07-16 20:39:24] INFO train_model: Upsampling successful.
[2025-07-16 20:39:24] INFO train_model: Splitting train/test...
[2025-07-16 20:39:24] INFO train_model: Scaling features...
[2025-07-16 20:39:24] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 20:39:24] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 20:39:25] INFO train_model: Model fit complete.
[2025-07-16 20:39:25] INFO train_model: Model Accuracy: 0.5754
[2025-07-16 20:39:25] INFO train_model: 
Classification Report:
[2025-07-16 20:39:25] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.73      0.63       196
           1       0.61      0.42      0.49       195

    accuracy                           0.58       391
   macro avg       0.58      0.58      0.56       391
weighted avg       0.58      0.58      0.56       391

[2025-07-16 20:39:25] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 20:39:25] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 20:39:25] INFO train_model: Feature distributions before training:
[2025-07-16 20:39:25] INFO train_model: supply_zone: mean=0.4421, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: demand_zone: mean=0.3828, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_markdown: mean=0.4682, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_markup: mean=0.5035, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: rising_wedge: mean=0.2521, std=0.4344, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: falling_wedge: mean=0.1970, std=0.3979, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: Auditing data quality before training...
[2025-07-16 20:39:25] INFO train_model: Entering audit_data_quality
[2025-07-16 20:57:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: Model is starting a new training session...
[2025-07-16 20:57:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 20:57:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:57:29] INFO train_model: Preparing target variable...
[2025-07-16 20:57:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:57:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 20:57:29] INFO train_model: Dropping NaN targets...
[2025-07-16 20:57:29] INFO train_model: Class distribution: [977 439]
[2025-07-16 20:57:29] INFO train_model: Upsampling successful.
[2025-07-16 20:57:29] INFO train_model: Splitting train/test...
[2025-07-16 20:57:29] INFO train_model: Scaling features...
[2025-07-16 20:57:29] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 20:57:29] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 20:57:30] INFO train_model: Model fit complete.
[2025-07-16 20:57:30] INFO train_model: Model Accuracy: 0.5754
[2025-07-16 20:57:30] INFO train_model: 
Classification Report:
[2025-07-16 20:57:30] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.73      0.63       196
           1       0.61      0.42      0.49       195

    accuracy                           0.58       391
   macro avg       0.58      0.58      0.56       391
weighted avg       0.58      0.58      0.56       391

[2025-07-16 20:57:30] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 20:57:30] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 20:57:30] INFO train_model: Feature distributions before training:
[2025-07-16 20:57:30] INFO train_model: supply_zone: mean=0.4421, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: demand_zone: mean=0.3828, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_markdown: mean=0.4682, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_markup: mean=0.5035, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: rising_wedge: mean=0.2521, std=0.4344, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: falling_wedge: mean=0.1970, std=0.3979, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: Auditing data quality before training...
[2025-07-16 20:57:31] INFO train_model: Entering audit_data_quality
[2025-07-16 21:17:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: Model is starting a new training session...
[2025-07-16 21:17:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 21:17:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:17:47] INFO train_model: Preparing target variable...
[2025-07-16 21:17:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:17:47] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 21:17:47] INFO train_model: Dropping NaN targets...
[2025-07-16 21:17:48] INFO train_model: Class distribution: [978 439]
[2025-07-16 21:17:48] INFO train_model: Upsampling successful.
[2025-07-16 21:17:48] INFO train_model: Splitting train/test...
[2025-07-16 21:17:48] INFO train_model: Scaling features...
[2025-07-16 21:17:48] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 21:17:48] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 21:17:48] INFO train_model: Model fit complete.
[2025-07-16 21:17:48] INFO train_model: Model Accuracy: 0.5689
[2025-07-16 21:17:48] INFO train_model: 
Classification Report:
[2025-07-16 21:17:48] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.56      0.56       196
           1       0.57      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 21:17:48] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 21:17:48] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 21:17:48] INFO train_model: Feature distributions before training:
[2025-07-16 21:17:48] INFO train_model: supply_zone: mean=0.4418, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: demand_zone: mean=0.3825, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_markdown: mean=0.4679, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_markup: mean=0.5039, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: rising_wedge: mean=0.2519, std=0.4343, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: falling_wedge: mean=0.1976, std=0.3983, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: Auditing data quality before training...
[2025-07-16 21:17:48] INFO train_model: Entering audit_data_quality
[2025-07-16 21:50:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: Model is starting a new training session...
[2025-07-16 21:50:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 21:50:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:50:56] INFO train_model: Preparing target variable...
[2025-07-16 21:50:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:50:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 21:50:56] INFO train_model: Dropping NaN targets...
[2025-07-16 21:50:56] INFO train_model: Class distribution: [978 439]
[2025-07-16 21:50:56] INFO train_model: Upsampling successful.
[2025-07-16 21:50:56] INFO train_model: Splitting train/test...
[2025-07-16 21:50:56] INFO train_model: Scaling features...
[2025-07-16 21:50:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 21:50:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 21:50:57] INFO train_model: Model fit complete.
[2025-07-16 21:50:57] INFO train_model: Model Accuracy: 0.5689
[2025-07-16 21:50:57] INFO train_model: 
Classification Report:
[2025-07-16 21:50:57] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.56      0.56       196
           1       0.57      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 21:50:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 21:50:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 21:50:57] INFO train_model: Feature distributions before training:
[2025-07-16 21:50:57] INFO train_model: supply_zone: mean=0.4418, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: demand_zone: mean=0.3825, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_markdown: mean=0.4679, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_markup: mean=0.5039, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: rising_wedge: mean=0.2519, std=0.4343, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: falling_wedge: mean=0.1976, std=0.3983, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: Auditing data quality before training...
[2025-07-16 21:50:57] INFO train_model: Entering audit_data_quality
[2025-07-16 22:01:53] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: Model is starting a new training session...
[2025-07-16 22:01:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:01:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:01:53] INFO train_model: Preparing target variable...
[2025-07-16 22:01:53] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:01:53] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:01:53] INFO train_model: Dropping NaN targets...
[2025-07-16 22:01:53] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:01:53] INFO train_model: Upsampling successful.
[2025-07-16 22:01:53] INFO train_model: Splitting train/test...
[2025-07-16 22:01:53] INFO train_model: Scaling features...
[2025-07-16 22:01:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:01:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:01:54] INFO train_model: Model fit complete.
[2025-07-16 22:01:54] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:01:54] INFO train_model: 
Classification Report:
[2025-07-16 22:01:54] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:01:54] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:01:54] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:01:54] INFO train_model: Feature distributions before training:
[2025-07-16 22:01:54] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: Auditing data quality before training...
[2025-07-16 22:01:54] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:10] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:09:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:09:10] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:13] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:09:13] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:09:13] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:16] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:16] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:09:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:16] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:09:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:16] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:09:17] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:17] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:09:17] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:17] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:09:17] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:17] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:09:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: Model is starting a new training session...
[2025-07-16 22:09:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:09:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:18] INFO train_model: Preparing target variable...
[2025-07-16 22:09:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:09:18] INFO train_model: Dropping NaN targets...
[2025-07-16 22:09:18] INFO train_model: Class distribution: [817 621]
[2025-07-16 22:09:18] INFO train_model: Upsampling successful.
[2025-07-16 22:09:18] INFO train_model: Splitting train/test...
[2025-07-16 22:09:18] INFO train_model: Scaling features...
[2025-07-16 22:09:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:09:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:09:18] INFO train_model: Model fit complete.
[2025-07-16 22:09:18] INFO train_model: Model Accuracy: 0.5443
[2025-07-16 22:09:18] INFO train_model: 
Classification Report:
[2025-07-16 22:09:18] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.63      0.58       164
           1       0.55      0.46      0.50       163

    accuracy                           0.54       327
   macro avg       0.55      0.54      0.54       327
weighted avg       0.55      0.54      0.54       327

[2025-07-16 22:09:18] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:09:18] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:09:18] INFO train_model: Feature distributions before training:
[2025-07-16 22:09:18] INFO train_model: supply_zone: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: demand_zone: mean=0.1996, std=0.3998, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_distribution: mean=0.1328, std=0.3395, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_markdown: mean=0.3811, std=0.4858, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_markup: mean=0.4576, std=0.4984, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1645, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: head_shoulders: mean=0.0341, std=0.1815, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: inv_head_shoulders: mean=0.0327, std=0.1779, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:18] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:18] INFO train_model: rising_wedge: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: falling_wedge: mean=0.2497, std=0.4330, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: fakeout_up: mean=0.0049, std=0.0696, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: fakeout_down: mean=0.0063, std=0.0789, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: Auditing data quality before training...
[2025-07-16 22:09:18] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:32] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: Model is starting a new training session...
[2025-07-16 22:09:32] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:09:32] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:32] INFO train_model: Preparing target variable...
[2025-07-16 22:09:32] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:32] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:09:32] INFO train_model: Dropping NaN targets...
[2025-07-16 22:09:32] INFO train_model: Class distribution: [817 621]
[2025-07-16 22:09:32] INFO train_model: Upsampling successful.
[2025-07-16 22:09:32] INFO train_model: Splitting train/test...
[2025-07-16 22:09:32] INFO train_model: Scaling features...
[2025-07-16 22:09:32] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:09:32] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:09:33] INFO train_model: Model fit complete.
[2025-07-16 22:09:33] INFO train_model: Model Accuracy: 0.5443
[2025-07-16 22:09:33] INFO train_model: 
Classification Report:
[2025-07-16 22:09:33] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.63      0.58       164
           1       0.55      0.46      0.50       163

    accuracy                           0.54       327
   macro avg       0.55      0.54      0.54       327
weighted avg       0.55      0.54      0.54       327

[2025-07-16 22:09:33] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:09:33] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:09:33] INFO train_model: Feature distributions before training:
[2025-07-16 22:09:33] INFO train_model: supply_zone: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: demand_zone: mean=0.1996, std=0.3998, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_distribution: mean=0.1328, std=0.3395, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_markdown: mean=0.3811, std=0.4858, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_markup: mean=0.4576, std=0.4984, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1645, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: head_shoulders: mean=0.0341, std=0.1815, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: inv_head_shoulders: mean=0.0327, std=0.1779, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:33] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:33] INFO train_model: rising_wedge: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: falling_wedge: mean=0.2497, std=0.4330, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: fakeout_up: mean=0.0049, std=0.0696, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: fakeout_down: mean=0.0063, std=0.0789, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: Auditing data quality before training...
[2025-07-16 22:09:33] INFO train_model: Entering audit_data_quality
[2025-07-16 22:10:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: Model is starting a new training session...
[2025-07-16 22:10:40] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:10:40] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:10:40] INFO train_model: Preparing target variable...
[2025-07-16 22:10:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:10:40] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:10:40] INFO train_model: Dropping NaN targets...
[2025-07-16 22:10:40] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:10:40] INFO train_model: Upsampling successful.
[2025-07-16 22:10:40] INFO train_model: Splitting train/test...
[2025-07-16 22:10:40] INFO train_model: Scaling features...
[2025-07-16 22:10:40] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:10:40] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:10:40] INFO train_model: Model fit complete.
[2025-07-16 22:10:40] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:10:40] INFO train_model: 
Classification Report:
[2025-07-16 22:10:40] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:10:40] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:10:40] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:10:40] INFO train_model: Feature distributions before training:
[2025-07-16 22:10:40] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: Auditing data quality before training...
[2025-07-16 22:10:41] INFO train_model: Entering audit_data_quality
[2025-07-16 22:16:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: Model is starting a new training session...
[2025-07-16 22:16:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:16:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:16:13] INFO train_model: Preparing target variable...
[2025-07-16 22:16:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:16:13] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:16:13] INFO train_model: Dropping NaN targets...
[2025-07-16 22:16:13] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:16:13] INFO train_model: Upsampling successful.
[2025-07-16 22:16:13] INFO train_model: Splitting train/test...
[2025-07-16 22:16:13] INFO train_model: Scaling features...
[2025-07-16 22:16:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:16:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:16:14] INFO train_model: Model fit complete.
[2025-07-16 22:16:14] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:16:14] INFO train_model: 
Classification Report:
[2025-07-16 22:16:14] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:16:14] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:16:14] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:16:14] INFO train_model: Feature distributions before training:
[2025-07-16 22:16:14] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: Auditing data quality before training...
[2025-07-16 22:16:14] INFO train_model: Entering audit_data_quality
[2025-07-16 22:38:22] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: Model is starting a new training session...
[2025-07-16 22:38:22] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:38:22] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:38:22] INFO train_model: Preparing target variable...
[2025-07-16 22:38:22] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:38:22] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:38:22] INFO train_model: Dropping NaN targets...
[2025-07-16 22:38:22] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:38:22] INFO train_model: Upsampling successful.
[2025-07-16 22:38:22] INFO train_model: Splitting train/test...
[2025-07-16 22:38:22] INFO train_model: Scaling features...
[2025-07-16 22:38:22] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:38:22] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:38:22] INFO train_model: Model fit complete.
[2025-07-16 22:38:22] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:38:22] INFO train_model: 
Classification Report:
[2025-07-16 22:38:22] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:38:23] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:38:23] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:38:23] INFO train_model: Feature distributions before training:
[2025-07-16 22:38:23] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: Auditing data quality before training...
[2025-07-16 22:38:23] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:35] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:35] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:58:35] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:58:35] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:58:35] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:37] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:37] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:58:37] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:37] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:58:37] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:37] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:58:38] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:58:38] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:58:38] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:41] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: Model is starting a new training session...
[2025-07-16 22:58:41] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:58:41] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:58:41] INFO train_model: Preparing target variable...
[2025-07-16 22:58:41] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:58:41] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:58:41] INFO train_model: Dropping NaN targets...
[2025-07-16 22:58:41] INFO train_model: Class distribution: [1036  383]
[2025-07-16 22:58:41] INFO train_model: Upsampling successful.
[2025-07-16 22:58:41] INFO train_model: Splitting train/test...
[2025-07-16 22:58:41] INFO train_model: Scaling features...
[2025-07-16 22:58:41] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:58:41] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:58:41] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:41] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:58:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:42] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:58:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:42] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:58:42] INFO train_model: Model fit complete.
[2025-07-16 22:58:42] INFO train_model: Model Accuracy: 0.5735
[2025-07-16 22:58:42] INFO train_model: 
Classification Report:
[2025-07-16 22:58:42] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.64      0.60       208
           1       0.58      0.51      0.54       207

    accuracy                           0.57       415
   macro avg       0.57      0.57      0.57       415
weighted avg       0.57      0.57      0.57       415

[2025-07-16 22:58:42] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:58:42] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:58:42] INFO train_model: Feature distributions before training:
[2025-07-16 22:58:42] INFO train_model: supply_zone: mean=0.4172, std=0.4933, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: demand_zone: mean=0.4799, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_markdown: mean=0.5292, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_markup: mean=0.4426, std=0.4969, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: head_shoulders: mean=0.0338, std=0.1808, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: inv_head_shoulders: mean=0.0310, std=0.1734, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: double_bottom: mean=0.0127, std=0.1120, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: rising_wedge: mean=0.2030, std=0.4023, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: falling_wedge: mean=0.2241, std=0.4171, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: Auditing data quality before training...
[2025-07-16 22:58:42] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:58:45] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:58:45] INFO train_model: Entering audit_data_quality
[2025-07-16 23:03:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: Model is starting a new training session...
[2025-07-16 23:03:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 23:03:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:03:52] INFO train_model: Preparing target variable...
[2025-07-16 23:03:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:03:52] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 23:03:52] INFO train_model: Dropping NaN targets...
[2025-07-16 23:03:52] INFO train_model: Class distribution: [980 439]
[2025-07-16 23:03:52] INFO train_model: Upsampling successful.
[2025-07-16 23:03:52] INFO train_model: Splitting train/test...
[2025-07-16 23:03:52] INFO train_model: Scaling features...
[2025-07-16 23:03:52] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 23:03:52] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 23:03:53] INFO train_model: Model fit complete.
[2025-07-16 23:03:53] INFO train_model: Model Accuracy: 0.5944
[2025-07-16 23:03:53] INFO train_model: 
Classification Report:
[2025-07-16 23:03:53] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.76      0.65       196
           1       0.64      0.43      0.52       196

    accuracy                           0.59       392
   macro avg       0.61      0.59      0.58       392
weighted avg       0.61      0.59      0.58       392

[2025-07-16 23:03:53] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 23:03:53] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 23:03:53] INFO train_model: Feature distributions before training:
[2025-07-16 23:03:53] INFO train_model: supply_zone: mean=0.4412, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: demand_zone: mean=0.3820, std=0.4860, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_markdown: mean=0.4672, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_markup: mean=0.5046, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: rising_wedge: mean=0.2516, std=0.4341, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: falling_wedge: mean=0.1987, std=0.3992, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: fakeout_up: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: Auditing data quality before training...
[2025-07-16 23:03:53] INFO train_model: Entering audit_data_quality
[2025-07-16 23:53:30] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: Model is starting a new training session...
[2025-07-16 23:53:30] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 23:53:30] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:53:30] INFO train_model: Preparing target variable...
[2025-07-16 23:53:30] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:53:30] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 23:53:30] INFO train_model: Dropping NaN targets...
[2025-07-16 23:53:30] INFO train_model: Class distribution: [980 439]
[2025-07-16 23:53:30] INFO train_model: Upsampling successful.
[2025-07-16 23:53:30] INFO train_model: Splitting train/test...
[2025-07-16 23:53:30] INFO train_model: Scaling features...
[2025-07-16 23:53:30] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 23:53:30] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 23:53:31] INFO train_model: Model fit complete.
[2025-07-16 23:53:31] INFO train_model: Model Accuracy: 0.5944
[2025-07-16 23:53:31] INFO train_model: 
Classification Report:
[2025-07-16 23:53:31] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.76      0.65       196
           1       0.64      0.43      0.52       196

    accuracy                           0.59       392
   macro avg       0.61      0.59      0.58       392
weighted avg       0.61      0.59      0.58       392

[2025-07-16 23:53:31] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 23:53:31] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 23:53:31] INFO train_model: Feature distributions before training:
[2025-07-16 23:53:31] INFO train_model: supply_zone: mean=0.4412, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: demand_zone: mean=0.3820, std=0.4860, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_markdown: mean=0.4672, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_markup: mean=0.5046, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: rising_wedge: mean=0.2516, std=0.4341, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: falling_wedge: mean=0.1987, std=0.3992, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: fakeout_up: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: Auditing data quality before training...
[2025-07-16 23:53:31] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:26] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: Model is starting a new training session...
[2025-07-17 00:00:26] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:00:26] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:26] INFO train_model: Preparing target variable...
[2025-07-17 00:00:26] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:26] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:00:26] INFO train_model: Dropping NaN targets...
[2025-07-17 00:00:26] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:00:26] INFO train_model: Upsampling successful.
[2025-07-17 00:00:26] INFO train_model: Splitting train/test...
[2025-07-17 00:00:26] INFO train_model: Scaling features...
[2025-07-17 00:00:26] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:00:26] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:00:27] INFO train_model: Model fit complete.
[2025-07-17 00:00:27] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:00:27] INFO train_model: 
Classification Report:
[2025-07-17 00:00:27] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:00:27] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:00:27] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:00:27] INFO train_model: Feature distributions before training:
[2025-07-17 00:00:27] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: Auditing data quality before training...
[2025-07-17 00:00:27] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:28] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 00:00:28] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:00:28] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:28] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:28] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:00:28] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:28] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:00:28] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:28] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:00:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: Model is starting a new training session...
[2025-07-17 00:00:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:00:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:56] INFO train_model: Preparing target variable...
[2025-07-17 00:00:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:00:56] INFO train_model: Dropping NaN targets...
[2025-07-17 00:00:56] INFO train_model: Class distribution: [817 622]
[2025-07-17 00:00:56] INFO train_model: Upsampling successful.
[2025-07-17 00:00:56] INFO train_model: Splitting train/test...
[2025-07-17 00:00:56] INFO train_model: Scaling features...
[2025-07-17 00:00:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:00:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:00:57] INFO train_model: Model fit complete.
[2025-07-17 00:00:57] INFO train_model: Model Accuracy: 0.5443
[2025-07-17 00:00:57] INFO train_model: 
Classification Report:
[2025-07-17 00:00:57] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.63      0.58       164
           1       0.55      0.46      0.50       163

    accuracy                           0.54       327
   macro avg       0.55      0.54      0.54       327
weighted avg       0.55      0.54      0.54       327

[2025-07-17 00:00:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:00:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:00:57] INFO train_model: Feature distributions before training:
[2025-07-17 00:00:57] INFO train_model: supply_zone: mean=0.2731, std=0.4457, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: demand_zone: mean=0.1994, std=0.3997, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_distribution: mean=0.1334, std=0.3402, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_markdown: mean=0.3808, std=0.4858, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_markup: mean=0.4573, std=0.4983, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1644, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: head_shoulders: mean=0.0341, std=0.1814, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: inv_head_shoulders: mean=0.0327, std=0.1778, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:57] INFO train_model: rising_wedge: mean=0.2731, std=0.4457, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: falling_wedge: mean=0.2495, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: fakeout_up: mean=0.0049, std=0.0696, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: fakeout_down: mean=0.0063, std=0.0789, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: Auditing data quality before training...
[2025-07-17 00:00:57] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:57] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:00:57] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:00:57] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:00:57] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:00:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:00:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:01:19] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: Model is starting a new training session...
[2025-07-17 00:01:19] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:01:19] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:19] INFO train_model: Preparing target variable...
[2025-07-17 00:01:19] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:19] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:01:19] INFO train_model: Dropping NaN targets...
[2025-07-17 00:01:19] INFO train_model: Class distribution: [1021  374]
[2025-07-17 00:01:19] INFO train_model: Upsampling successful.
[2025-07-17 00:01:19] INFO train_model: Splitting train/test...
[2025-07-17 00:01:19] INFO train_model: Scaling features...
[2025-07-17 00:01:19] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:01:19] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:01:20] INFO train_model: Model fit complete.
[2025-07-17 00:01:20] INFO train_model: Model Accuracy: 0.5697
[2025-07-17 00:01:20] INFO train_model: 
Classification Report:
[2025-07-17 00:01:20] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.65      0.60       205
           1       0.58      0.49      0.53       204

    accuracy                           0.57       409
   macro avg       0.57      0.57      0.57       409
weighted avg       0.57      0.57      0.57       409

[2025-07-17 00:01:20] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:01:20] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:01:20] INFO train_model: Feature distributions before training:
[2025-07-17 00:01:20] INFO train_model: supply_zone: mean=0.4172, std=0.4933, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: demand_zone: mean=0.4810, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_markdown: mean=0.5333, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_markup: mean=0.4380, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1669, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: head_shoulders: mean=0.0337, std=0.1805, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: inv_head_shoulders: mean=0.0308, std=0.1729, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: double_bottom: mean=0.0108, std=0.1032, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: rising_wedge: mean=0.2029, std=0.4023, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: falling_wedge: mean=0.2237, std=0.4168, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: Auditing data quality before training...
[2025-07-17 00:01:20] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 00:01:21] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:01:21] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:01:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:01:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:01:43] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: Model is starting a new training session...
[2025-07-17 00:01:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:01:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:43] INFO train_model: Preparing target variable...
[2025-07-17 00:01:43] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:01:43] INFO train_model: Dropping NaN targets...
[2025-07-17 00:01:43] INFO train_model: Class distribution: [950 453]
[2025-07-17 00:01:43] INFO train_model: Upsampling successful.
[2025-07-17 00:01:43] INFO train_model: Splitting train/test...
[2025-07-17 00:01:43] INFO train_model: Scaling features...
[2025-07-17 00:01:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:01:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:01:44] INFO train_model: Model fit complete.
[2025-07-17 00:01:44] INFO train_model: Model Accuracy: 0.5895
[2025-07-17 00:01:44] INFO train_model: 
Classification Report:
[2025-07-17 00:01:44] INFO train_model:               precision    recall  f1-score   support

           0       0.58      0.62      0.60       190
           1       0.60      0.56      0.58       190

    accuracy                           0.59       380
   macro avg       0.59      0.59      0.59       380
weighted avg       0.59      0.59      0.59       380

[2025-07-17 00:01:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:01:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:01:44] INFO train_model: Feature distributions before training:
[2025-07-17 00:01:44] INFO train_model: supply_zone: mean=0.4669, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: demand_zone: mean=0.3699, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_markdown: mean=0.4120, std=0.4924, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_markup: mean=0.5595, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_unknown: mean=0.0285, std=0.1665, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:44] INFO train_model: head_shoulders: mean=0.0342, std=0.1818, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: inv_head_shoulders: mean=0.0278, std=0.1645, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: double_top: mean=0.0043, std=0.0653, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: double_bottom: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: rising_wedge: mean=0.2894, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: falling_wedge: mean=0.2438, std=0.4295, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: fakeout_up: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: fakeout_down: mean=0.0007, std=0.0267, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: Auditing data quality before training...
[2025-07-17 00:01:44] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:01:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:01:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:01:44] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:44] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:01:44] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:44] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:01:44] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:44] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:02:10] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: Model is starting a new training session...
[2025-07-17 00:02:10] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:02:10] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:02:10] INFO train_model: Preparing target variable...
[2025-07-17 00:02:10] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:02:10] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:02:10] INFO train_model: Dropping NaN targets...
[2025-07-17 00:02:10] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:02:10] INFO train_model: Upsampling successful.
[2025-07-17 00:02:10] INFO train_model: Splitting train/test...
[2025-07-17 00:02:10] INFO train_model: Scaling features...
[2025-07-17 00:02:10] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:02:10] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:02:11] INFO train_model: Model fit complete.
[2025-07-17 00:02:11] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:02:11] INFO train_model: 
Classification Report:
[2025-07-17 00:02:11] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:02:11] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:02:11] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:02:11] INFO train_model: Feature distributions before training:
[2025-07-17 00:02:11] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: Auditing data quality before training...
[2025-07-17 00:02:12] INFO train_model: Entering audit_data_quality
[2025-07-17 00:12:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: Model is starting a new training session...
[2025-07-17 00:12:51] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:12:51] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:12:51] INFO train_model: Preparing target variable...
[2025-07-17 00:12:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:12:51] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:12:51] INFO train_model: Dropping NaN targets...
[2025-07-17 00:12:51] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:12:51] INFO train_model: Upsampling successful.
[2025-07-17 00:12:51] INFO train_model: Splitting train/test...
[2025-07-17 00:12:51] INFO train_model: Scaling features...
[2025-07-17 00:12:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:12:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:12:51] INFO train_model: Model fit complete.
[2025-07-17 00:12:51] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:12:51] INFO train_model: 
Classification Report:
[2025-07-17 00:12:51] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:12:51] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:12:51] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:12:51] INFO train_model: Feature distributions before training:
[2025-07-17 00:12:51] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: Auditing data quality before training...
[2025-07-17 00:12:52] INFO train_model: Entering audit_data_quality
[2025-07-17 00:19:43] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 00:19:43] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:19:43] INFO train_model: Entering audit_data_quality
[2025-07-17 00:19:47] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:19:47] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:19:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:19:47] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:19:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:19:47] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:19:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: Model is starting a new training session...
[2025-07-17 00:19:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:19:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:19:55] INFO train_model: Preparing target variable...
[2025-07-17 00:19:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:19:55] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:19:55] INFO train_model: Dropping NaN targets...
[2025-07-17 00:19:55] INFO train_model: Class distribution: [818 622]
[2025-07-17 00:19:55] INFO train_model: Upsampling successful.
[2025-07-17 00:19:55] INFO train_model: Splitting train/test...
[2025-07-17 00:19:55] INFO train_model: Scaling features...
[2025-07-17 00:19:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:19:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:19:55] INFO train_model: Model fit complete.
[2025-07-17 00:19:55] INFO train_model: Model Accuracy: 0.5549
[2025-07-17 00:19:55] INFO train_model: 
Classification Report:
[2025-07-17 00:19:55] INFO train_model:               precision    recall  f1-score   support

           0       0.60      0.34      0.43       164
           1       0.54      0.77      0.64       164

    accuracy                           0.55       328
   macro avg       0.57      0.55      0.53       328
weighted avg       0.57      0.55      0.53       328

[2025-07-17 00:19:55] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:19:55] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:19:55] INFO train_model: Feature distributions before training:
[2025-07-17 00:19:55] INFO train_model: supply_zone: mean=0.2729, std=0.4456, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: demand_zone: mean=0.1993, std=0.3996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_distribution: mean=0.1340, std=0.3408, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_markdown: mean=0.3806, std=0.4857, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_markup: mean=0.4569, std=0.4983, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1644, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: head_shoulders: mean=0.0340, std=0.1814, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1778, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:19:55] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:19:55] INFO train_model: rising_wedge: mean=0.2729, std=0.4456, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: falling_wedge: mean=0.2493, std=0.4328, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: fakeout_up: mean=0.0056, std=0.0744, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: fakeout_down: mean=0.0063, std=0.0788, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: Auditing data quality before training...
[2025-07-17 00:19:55] INFO train_model: Entering audit_data_quality
[2025-07-17 00:20:01] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:20:01] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:20:01] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:20:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:20:01] INFO train_model: Entering audit_data_quality
[2025-07-17 00:37:25] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: Model is starting a new training session...
[2025-07-17 00:37:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:37:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:37:25] INFO train_model: Preparing target variable...
[2025-07-17 00:37:25] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:37:25] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:37:25] INFO train_model: Dropping NaN targets...
[2025-07-17 00:37:25] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:37:25] INFO train_model: Upsampling successful.
[2025-07-17 00:37:25] INFO train_model: Splitting train/test...
[2025-07-17 00:37:25] INFO train_model: Scaling features...
[2025-07-17 00:37:25] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:37:25] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:37:26] INFO train_model: Model fit complete.
[2025-07-17 00:37:26] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:37:26] INFO train_model: 
Classification Report:
[2025-07-17 00:37:26] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:37:26] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:37:26] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:37:26] INFO train_model: Feature distributions before training:
[2025-07-17 00:37:26] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: Auditing data quality before training...
[2025-07-17 00:37:26] INFO train_model: Entering audit_data_quality
[2025-07-17 00:42:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: Model is starting a new training session...
[2025-07-17 00:42:36] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:42:36] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:42:36] INFO train_model: Preparing target variable...
[2025-07-17 00:42:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:42:36] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:42:36] INFO train_model: Dropping NaN targets...
[2025-07-17 00:42:36] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:42:36] INFO train_model: Upsampling successful.
[2025-07-17 00:42:36] INFO train_model: Splitting train/test...
[2025-07-17 00:42:36] INFO train_model: Scaling features...
[2025-07-17 00:42:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:42:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:42:37] INFO train_model: Model fit complete.
[2025-07-17 00:42:37] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:42:37] INFO train_model: 
Classification Report:
[2025-07-17 00:42:37] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:42:37] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:42:37] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:42:37] INFO train_model: Feature distributions before training:
[2025-07-17 00:42:37] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: Auditing data quality before training...
[2025-07-17 00:42:37] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:05] INFO train_model: Preparing target variable...
[2025-07-17 01:30:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:05] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:05] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:05] INFO train_model: Class distribution: [961 434]
[2025-07-17 01:30:05] INFO train_model: Upsampling successful.
[2025-07-17 01:30:05] INFO train_model: Splitting train/test...
[2025-07-17 01:30:05] INFO train_model: Scaling features...
[2025-07-17 01:30:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:06] INFO train_model: Model fit complete.
[2025-07-17 01:30:06] INFO train_model: Model Accuracy: 0.5455
[2025-07-17 01:30:06] INFO train_model: 
Classification Report:
[2025-07-17 01:30:06] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.74      0.62       193
           1       0.57      0.35      0.43       192

    accuracy                           0.55       385
   macro avg       0.55      0.54      0.53       385
weighted avg       0.55      0.55      0.53       385

[2025-07-17 01:30:06] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:06] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:06] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:06] INFO train_model: supply_zone: mean=0.4452, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: demand_zone: mean=0.3778, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_markdown: mean=0.4753, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_markup: mean=0.4961, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1669, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: head_shoulders: mean=0.0315, std=0.1748, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: inv_head_shoulders: mean=0.0315, std=0.1748, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: rising_wedge: mean=0.2538, std=0.4353, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: falling_wedge: mean=0.2014, std=0.4012, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:06] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 01:30:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:06] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:07] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:30:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:08] INFO train_model: Preparing target variable...
[2025-07-17 01:30:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:08] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:08] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:08] INFO train_model: Class distribution: [809 605]
[2025-07-17 01:30:08] INFO train_model: Upsampling successful.
[2025-07-17 01:30:08] INFO train_model: Splitting train/test...
[2025-07-17 01:30:08] INFO train_model: Scaling features...
[2025-07-17 01:30:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:09] INFO train_model: Model fit complete.
[2025-07-17 01:30:09] INFO train_model: Model Accuracy: 0.4938
[2025-07-17 01:30:09] INFO train_model: 
Classification Report:
[2025-07-17 01:30:09] INFO train_model:               precision    recall  f1-score   support

           0       0.49      0.51      0.50       162
           1       0.49      0.48      0.48       162

    accuracy                           0.49       324
   macro avg       0.49      0.49      0.49       324
weighted avg       0.49      0.49      0.49       324

[2025-07-17 01:30:09] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:09] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:09] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:09] INFO train_model: supply_zone: mean=0.2624, std=0.4401, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: demand_zone: mean=0.2016, std=0.4013, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_distribution: mean=0.1337, std=0.3404, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_markdown: mean=0.3854, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_markup: mean=0.4519, std=0.4979, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_unknown: mean=0.0283, std=0.1659, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: head_shoulders: mean=0.0339, std=0.1812, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1775, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:09] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:09] INFO train_model: rising_wedge: mean=0.2779, std=0.4481, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: falling_wedge: mean=0.2525, std=0.4346, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: fakeout_up: mean=0.0042, std=0.0650, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: fakeout_down: mean=0.0064, std=0.0796, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:09] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:09] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:09] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:30:09] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:30:09] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:09] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:09] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:30:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:11] INFO train_model: Preparing target variable...
[2025-07-17 01:30:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:11] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:11] INFO train_model: Class distribution: [1022  374]
[2025-07-17 01:30:11] INFO train_model: Upsampling successful.
[2025-07-17 01:30:11] INFO train_model: Splitting train/test...
[2025-07-17 01:30:11] INFO train_model: Scaling features...
[2025-07-17 01:30:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:11] INFO train_model: Model fit complete.
[2025-07-17 01:30:11] INFO train_model: Model Accuracy: 0.5770
[2025-07-17 01:30:11] INFO train_model: 
Classification Report:
[2025-07-17 01:30:11] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.63      0.60       205
           1       0.59      0.52      0.55       204

    accuracy                           0.58       409
   macro avg       0.58      0.58      0.58       409
weighted avg       0.58      0.58      0.58       409

[2025-07-17 01:30:11] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:11] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:11] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:11] INFO train_model: supply_zone: mean=0.4169, std=0.4932, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: demand_zone: mean=0.4807, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_markdown: mean=0.5330, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_markup: mean=0.4384, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1669, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: head_shoulders: mean=0.0337, std=0.1804, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: inv_head_shoulders: mean=0.0308, std=0.1728, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: double_bottom: mean=0.0107, std=0.1031, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: rising_wedge: mean=0.2027, std=0.4022, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: falling_wedge: mean=0.2235, std=0.4167, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:11] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:12] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 01:30:12] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:12] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:12] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:12] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:12] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:12] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:12] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:12] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:30:13] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:13] INFO train_model: Preparing target variable...
[2025-07-17 01:30:13] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:13] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:13] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:13] INFO train_model: Class distribution: [950 454]
[2025-07-17 01:30:13] INFO train_model: Upsampling successful.
[2025-07-17 01:30:13] INFO train_model: Splitting train/test...
[2025-07-17 01:30:13] INFO train_model: Scaling features...
[2025-07-17 01:30:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:14] INFO train_model: Model fit complete.
[2025-07-17 01:30:14] INFO train_model: Model Accuracy: 0.5895
[2025-07-17 01:30:14] INFO train_model: 
Classification Report:
[2025-07-17 01:30:14] INFO train_model:               precision    recall  f1-score   support

           0       0.58      0.62      0.60       190
           1       0.60      0.56      0.58       190

    accuracy                           0.59       380
   macro avg       0.59      0.59      0.59       380
weighted avg       0.59      0.59      0.59       380

[2025-07-17 01:30:14] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:14] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:14] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:14] INFO train_model: supply_zone: mean=0.4665, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: demand_zone: mean=0.3697, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_markdown: mean=0.4124, std=0.4924, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_markup: mean=0.5591, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_unknown: mean=0.0285, std=0.1664, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:14] INFO train_model: head_shoulders: mean=0.0342, std=0.1818, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: inv_head_shoulders: mean=0.0278, std=0.1644, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: double_top: mean=0.0043, std=0.0653, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: double_bottom: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: rising_wedge: mean=0.2892, std=0.4535, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: falling_wedge: mean=0.2443, std=0.4298, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: fakeout_up: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: fakeout_down: mean=0.0007, std=0.0267, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:14] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:14] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:30:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:30:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:14] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:15] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:15] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:15] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:41:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: Model is starting a new training session...
[2025-07-17 01:41:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:41:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:41:56] INFO train_model: Preparing target variable...
[2025-07-17 01:41:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:41:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:41:56] INFO train_model: Dropping NaN targets...
[2025-07-17 01:41:56] INFO train_model: Class distribution: [1390  713]
[2025-07-17 01:41:56] INFO train_model: Upsampling successful.
[2025-07-17 01:41:56] INFO train_model: Splitting train/test...
[2025-07-17 01:41:56] INFO train_model: Scaling features...
[2025-07-17 01:41:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:41:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:41:57] INFO train_model: Model fit complete.
[2025-07-17 01:41:57] INFO train_model: Model Accuracy: 0.8849
[2025-07-17 01:41:57] INFO train_model: 
Classification Report:
[2025-07-17 01:41:57] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.86      0.88       278
           1       0.87      0.91      0.89       278

    accuracy                           0.88       556
   macro avg       0.89      0.88      0.88       556
weighted avg       0.89      0.88      0.88       556

[2025-07-17 01:41:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:41:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:41:57] INFO train_model: Feature distributions before training:
[2025-07-17 01:41:57] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 01:41:57] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 01:41:57] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 01:41:57] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 01:41:57] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 01:41:57] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 01:41:57] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 01:41:57] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 01:41:57] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 01:41:57] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 01:41:57] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 01:41:57] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 01:41:57] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 01:41:57] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 01:41:57] INFO train_model: Auditing data quality before training...
[2025-07-17 01:41:57] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: Model is starting a new training session...
[2025-07-17 01:51:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:51:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:35] INFO train_model: Preparing target variable...
[2025-07-17 01:51:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:35] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:51:35] INFO train_model: Dropping NaN targets...
[2025-07-17 01:51:35] INFO train_model: Class distribution: [1390  713]
[2025-07-17 01:51:35] INFO train_model: Upsampling successful.
[2025-07-17 01:51:35] INFO train_model: Splitting train/test...
[2025-07-17 01:51:35] INFO train_model: Scaling features...
[2025-07-17 01:51:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:51:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:51:36] INFO train_model: Model fit complete.
[2025-07-17 01:51:36] INFO train_model: Model Accuracy: 0.8849
[2025-07-17 01:51:36] INFO train_model: 
Classification Report:
[2025-07-17 01:51:36] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.87      0.88       278
           1       0.87      0.90      0.89       278

    accuracy                           0.88       556
   macro avg       0.89      0.88      0.88       556
weighted avg       0.89      0.88      0.88       556

[2025-07-17 01:51:36] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:51:36] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:51:36] INFO train_model: Feature distributions before training:
[2025-07-17 01:51:36] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 01:51:36] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 01:51:36] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 01:51:36] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 01:51:36] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 01:51:36] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 01:51:36] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 01:51:36] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 01:51:36] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 01:51:36] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 01:51:36] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 01:51:36] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 01:51:36] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 01:51:36] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 01:51:36] INFO train_model: Auditing data quality before training...
[2025-07-17 01:51:36] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:37] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 01:51:37] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:51:37] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:38] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:38] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:51:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:39] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:51:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:39] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:51:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: Model is starting a new training session...
[2025-07-17 01:51:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:51:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:53] INFO train_model: Preparing target variable...
[2025-07-17 01:51:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:53] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:51:53] INFO train_model: Dropping NaN targets...
[2025-07-17 01:51:53] INFO train_model: Class distribution: [764 725]
[2025-07-17 01:51:53] INFO train_model: Upsampling successful.
[2025-07-17 01:51:53] INFO train_model: Splitting train/test...
[2025-07-17 01:51:53] INFO train_model: Scaling features...
[2025-07-17 01:51:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:51:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:51:54] INFO train_model: Model fit complete.
[2025-07-17 01:51:54] INFO train_model: Model Accuracy: 0.7974
[2025-07-17 01:51:54] INFO train_model: 
Classification Report:
[2025-07-17 01:51:54] INFO train_model:               precision    recall  f1-score   support

           0       0.76      0.88      0.81       153
           1       0.85      0.72      0.78       153

    accuracy                           0.80       306
   macro avg       0.80      0.80      0.80       306
weighted avg       0.80      0.80      0.80       306

[2025-07-17 01:51:54] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:51:54] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:51:54] INFO train_model: Feature distributions before training:
[2025-07-17 01:51:54] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 01:51:54] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 01:51:54] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 01:51:54] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 01:51:54] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 01:51:54] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 01:51:54] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 01:51:54] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 01:51:54] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 01:51:54] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 01:51:54] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 01:51:54] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 01:51:54] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 01:51:54] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 01:51:54] INFO train_model: Auditing data quality before training...
[2025-07-17 01:51:54] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:55] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:51:55] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:51:55] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:56] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:56] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:51:56] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:56] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:51:56] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:56] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:52:02] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: Model is starting a new training session...
[2025-07-17 01:52:02] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:52:02] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:52:02] INFO train_model: Preparing target variable...
[2025-07-17 01:52:02] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:52:02] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:52:02] INFO train_model: Dropping NaN targets...
[2025-07-17 01:52:03] INFO train_model: Class distribution: [1331  772]
[2025-07-17 01:52:03] INFO train_model: Upsampling successful.
[2025-07-17 01:52:03] INFO train_model: Splitting train/test...
[2025-07-17 01:52:03] INFO train_model: Scaling features...
[2025-07-17 01:52:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:52:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:52:04] INFO train_model: Model fit complete.
[2025-07-17 01:52:04] INFO train_model: Model Accuracy: 0.8687
[2025-07-17 01:52:04] INFO train_model: 
Classification Report:
[2025-07-17 01:52:04] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.87      0.87       267
           1       0.87      0.86      0.87       266

    accuracy                           0.87       533
   macro avg       0.87      0.87      0.87       533
weighted avg       0.87      0.87      0.87       533

[2025-07-17 01:52:04] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:52:04] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:52:04] INFO train_model: Feature distributions before training:
[2025-07-17 01:52:04] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:52:04] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:52:04] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 01:52:04] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 01:52:04] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 01:52:04] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 01:52:04] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 01:52:04] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 01:52:04] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 01:52:04] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 01:52:04] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 01:52:04] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 01:52:04] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 01:52:04] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 01:52:04] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 01:52:04] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 01:52:04] INFO train_model: Auditing data quality before training...
[2025-07-17 01:52:04] INFO train_model: Entering audit_data_quality
[2025-07-17 01:52:05] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:52:05] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:52:05] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:52:05] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:52:05] INFO train_model: Entering audit_data_quality
[2025-07-17 01:52:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:52:06] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:52:06] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:52:06] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:52:06] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:52:06] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:08:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: Model is starting a new training session...
[2025-07-17 02:08:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:08:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:08:35] INFO train_model: Preparing target variable...
[2025-07-17 02:08:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:08:35] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:08:35] INFO train_model: Dropping NaN targets...
[2025-07-17 02:08:35] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:08:35] INFO train_model: Upsampling successful.
[2025-07-17 02:08:35] INFO train_model: Splitting train/test...
[2025-07-17 02:08:35] INFO train_model: Scaling features...
[2025-07-17 02:08:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:08:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:08:36] INFO train_model: Model fit complete.
[2025-07-17 02:08:36] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:08:36] INFO train_model: 
Classification Report:
[2025-07-17 02:08:36] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:08:36] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:08:36] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:08:36] INFO train_model: Feature distributions before training:
[2025-07-17 02:08:36] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:08:36] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:08:36] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:08:36] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:08:36] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:08:36] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:08:36] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:08:36] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:08:36] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:08:36] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:08:36] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:08:36] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:08:36] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:08:36] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:08:36] INFO train_model: Auditing data quality before training...
[2025-07-17 02:08:36] INFO train_model: Entering audit_data_quality
[2025-07-17 02:10:47] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: Model is starting a new training session...
[2025-07-17 02:10:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:10:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:10:47] INFO train_model: Preparing target variable...
[2025-07-17 02:10:47] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:10:47] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:10:47] INFO train_model: Dropping NaN targets...
[2025-07-17 02:10:47] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:10:47] INFO train_model: Upsampling successful.
[2025-07-17 02:10:47] INFO train_model: Splitting train/test...
[2025-07-17 02:10:47] INFO train_model: Scaling features...
[2025-07-17 02:10:47] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:10:47] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:10:49] INFO train_model: Model fit complete.
[2025-07-17 02:10:49] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:10:49] INFO train_model: 
Classification Report:
[2025-07-17 02:10:49] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:10:49] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:10:49] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:10:49] INFO train_model: Feature distributions before training:
[2025-07-17 02:10:49] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:10:49] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:10:49] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:10:49] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:10:49] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:10:49] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:10:49] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:10:49] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:10:49] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:10:49] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:10:49] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:10:49] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:10:49] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:10:49] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:10:49] INFO train_model: Auditing data quality before training...
[2025-07-17 02:10:49] INFO train_model: Entering audit_data_quality
[2025-07-17 02:10:50] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:10:50] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:10:50] INFO train_model: Entering audit_data_quality
[2025-07-17 02:10:51] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:10:51] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:10:52] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:10:52] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:10:52] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:10:52] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:11:04] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: Model is starting a new training session...
[2025-07-17 02:11:04] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:11:04] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:04] INFO train_model: Preparing target variable...
[2025-07-17 02:11:04] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:04] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:11:04] INFO train_model: Dropping NaN targets...
[2025-07-17 02:11:04] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:11:04] INFO train_model: Upsampling successful.
[2025-07-17 02:11:04] INFO train_model: Splitting train/test...
[2025-07-17 02:11:04] INFO train_model: Scaling features...
[2025-07-17 02:11:04] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:11:04] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:11:05] INFO train_model: Model fit complete.
[2025-07-17 02:11:05] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:11:05] INFO train_model: 
Classification Report:
[2025-07-17 02:11:05] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:11:05] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:11:05] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:11:05] INFO train_model: Feature distributions before training:
[2025-07-17 02:11:05] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:11:05] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:11:05] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:11:05] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:11:05] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:11:05] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:11:05] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:11:05] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:11:05] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:11:05] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:11:05] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:11:05] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:11:05] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:11:05] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:11:05] INFO train_model: Auditing data quality before training...
[2025-07-17 02:11:05] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:11:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:11:06] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:07] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:11:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:11:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:11:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: Model is starting a new training session...
[2025-07-17 02:11:14] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:11:14] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:14] INFO train_model: Preparing target variable...
[2025-07-17 02:11:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:14] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:11:14] INFO train_model: Dropping NaN targets...
[2025-07-17 02:11:14] INFO train_model: Class distribution: [1331  772]
[2025-07-17 02:11:14] INFO train_model: Upsampling successful.
[2025-07-17 02:11:14] INFO train_model: Splitting train/test...
[2025-07-17 02:11:14] INFO train_model: Scaling features...
[2025-07-17 02:11:14] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:11:14] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:11:15] INFO train_model: Model fit complete.
[2025-07-17 02:11:15] INFO train_model: Model Accuracy: 0.8593
[2025-07-17 02:11:15] INFO train_model: 
Classification Report:
[2025-07-17 02:11:15] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       267
           1       0.86      0.86      0.86       266

    accuracy                           0.86       533
   macro avg       0.86      0.86      0.86       533
weighted avg       0.86      0.86      0.86       533

[2025-07-17 02:11:15] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:11:15] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:11:15] INFO train_model: Feature distributions before training:
[2025-07-17 02:11:15] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:15] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:15] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:11:15] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:11:15] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:11:15] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:11:15] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:11:15] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:11:15] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:11:15] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:11:15] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:11:15] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:11:15] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:11:15] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:11:15] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:11:15] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:11:15] INFO train_model: Auditing data quality before training...
[2025-07-17 02:11:15] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:16] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:16] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:11:16] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:11:16] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:11:16] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:18] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:11:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:18] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:11:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:18] INFO train_model: Model training complete! Ready for new predictions.
