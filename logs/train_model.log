[2025-07-16 13:52:20] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: Entering train_signal_model
[2025-07-16 13:52:20] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:52:20] INFO train_model: Preparing target variable...
[2025-07-16 13:52:20] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:52:20] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:52:20] INFO train_model: Dropping NaN targets...
[2025-07-16 13:52:20] INFO train_model: Class distribution: [954 436]
[2025-07-16 13:52:20] INFO train_model: Upsampling successful.
[2025-07-16 13:52:20] INFO train_model: Splitting train/test...
[2025-07-16 13:52:20] INFO train_model: Scaling features...
[2025-07-16 13:52:20] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 13:52:20] INFO train_model: Fitting ensemble and calibrating...
[2025-07-16 13:52:21] INFO train_model: Model fit complete.
[2025-07-16 13:52:21] INFO train_model: Model Accuracy: 0.8613
[2025-07-16 13:52:21] INFO train_model: 
Classification Report:
[2025-07-16 13:52:21] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.88      0.86       191
           1       0.88      0.84      0.86       191

    accuracy                           0.86       382
   macro avg       0.86      0.86      0.86       382
weighted avg       0.86      0.86      0.86       382

[2025-07-16 13:52:21] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 13:52:21] INFO train_model: Feature distributions before training:
[2025-07-16 13:52:21] INFO train_model: atr_14: mean=0.3156, std=0.0620, min=0.1686, max=0.5768, unique=1390
[2025-07-16 13:52:21] INFO train_model: volatility_20: mean=0.3200, std=0.1713, min=0.0583, max=1.1795, unique=1390
[2025-07-16 13:52:21] INFO train_model: fib_0: mean=145.3840, std=1.4302, min=142.7570, max=149.1860, unique=386
[2025-07-16 13:52:21] INFO train_model: fib_236: mean=145.0720, std=1.4053, min=142.5675, max=149.0510, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_382: mean=144.8790, std=1.3949, min=142.4503, max=148.9675, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_500: mean=144.7230, std=1.3894, min=142.3555, max=148.9000, unique=708
[2025-07-16 13:52:21] INFO train_model: fib_618: mean=144.5670, std=1.3866, min=142.2607, max=148.8325, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_786: mean=144.3449, std=1.3872, min=142.1258, max=148.7364, unique=722
[2025-07-16 13:52:21] INFO train_model: fib_100: mean=144.0620, std=1.3957, min=141.9540, max=148.6140, unique=375
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_0: mean=-0.6260, std=0.4834, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4498, min=-2.0190, max=0.7009, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_382: mean=-0.1210, std=0.4447, min=-1.5815, max=1.2515, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_500: mean=0.0350, std=0.4498, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_618: mean=0.1910, std=0.4629, min=-0.9192, max=2.1415, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_786: mean=0.4131, std=0.4940, min=-0.4582, max=2.7750, unique=1368
[2025-07-16 13:52:21] INFO train_model: dist_to_fib_100: mean=0.6960, std=0.5510, min=0.0140, max=3.5820, unique=1034
[2025-07-16 13:52:21] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1180
[2025-07-16 13:52:21] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 13:52:21] INFO train_model: trendline_up: mean=0.5137, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: trendline_down: mean=0.4662, std=0.4990, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:52:21] INFO train_model: dist_to_high: mean=-0.6170, std=0.5079, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 13:52:21] INFO train_model: dist_to_low: mean=0.6998, std=0.5743, min=0.0020, max=3.5820, unique=1064
[2025-07-16 13:52:21] INFO train_model: pin_bar: mean=0.2820, std=0.4501, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: bullish_engulfing_bar: mean=0.0504, std=0.2188, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: inside_bar: mean=0.1324, std=0.3390, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0757, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: vol_spike_std: mean=0.1755, std=0.3806, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:52:21] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:52:21] INFO train_model: Auditing data quality before training...
[2025-07-16 13:52:21] INFO train_model: Entering audit_data_quality
[2025-07-16 13:59:38] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: Entering train_signal_model
[2025-07-16 13:59:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:59:38] INFO train_model: Preparing target variable...
[2025-07-16 13:59:38] INFO train_model: Entering prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: Exiting prepare_target_variable
[2025-07-16 13:59:38] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 13:59:38] INFO train_model: Dropping NaN targets...
[2025-07-16 13:59:39] INFO train_model: Class distribution: [954 436]
[2025-07-16 13:59:39] INFO train_model: Upsampling successful.
[2025-07-16 13:59:39] INFO train_model: Splitting train/test...
[2025-07-16 13:59:39] INFO train_model: Scaling features...
[2025-07-16 13:59:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 13:59:39] INFO train_model: Fitting ensemble and calibrating...
[2025-07-16 13:59:40] INFO train_model: Model fit complete.
[2025-07-16 13:59:40] INFO train_model: Model Accuracy: 0.8613
[2025-07-16 13:59:40] INFO train_model: 
Classification Report:
[2025-07-16 13:59:40] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.88      0.86       191
           1       0.88      0.84      0.86       191

    accuracy                           0.86       382
   macro avg       0.86      0.86      0.86       382
weighted avg       0.86      0.86      0.86       382

[2025-07-16 13:59:40] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 13:59:40] INFO train_model: Feature distributions before training:
[2025-07-16 13:59:40] INFO train_model: atr_14: mean=0.3156, std=0.0620, min=0.1686, max=0.5768, unique=1390
[2025-07-16 13:59:40] INFO train_model: volatility_20: mean=0.3200, std=0.1713, min=0.0583, max=1.1795, unique=1390
[2025-07-16 13:59:40] INFO train_model: fib_0: mean=145.3840, std=1.4302, min=142.7570, max=149.1860, unique=386
[2025-07-16 13:59:40] INFO train_model: fib_236: mean=145.0720, std=1.4053, min=142.5675, max=149.0510, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_382: mean=144.8790, std=1.3949, min=142.4503, max=148.9675, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_500: mean=144.7230, std=1.3894, min=142.3555, max=148.9000, unique=708
[2025-07-16 13:59:40] INFO train_model: fib_618: mean=144.5670, std=1.3866, min=142.2607, max=148.8325, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_786: mean=144.3449, std=1.3872, min=142.1258, max=148.7364, unique=722
[2025-07-16 13:59:40] INFO train_model: fib_100: mean=144.0620, std=1.3957, min=141.9540, max=148.6140, unique=375
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_0: mean=-0.6260, std=0.4834, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4498, min=-2.0190, max=0.7009, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_382: mean=-0.1210, std=0.4447, min=-1.5815, max=1.2515, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_500: mean=0.0350, std=0.4498, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_618: mean=0.1910, std=0.4629, min=-0.9192, max=2.1415, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_786: mean=0.4131, std=0.4940, min=-0.4582, max=2.7750, unique=1368
[2025-07-16 13:59:40] INFO train_model: dist_to_fib_100: mean=0.6960, std=0.5510, min=0.0140, max=3.5820, unique=1034
[2025-07-16 13:59:40] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1180
[2025-07-16 13:59:40] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 13:59:40] INFO train_model: trendline_up: mean=0.5137, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: trendline_down: mean=0.4662, std=0.4990, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:59:40] INFO train_model: dist_to_high: mean=-0.6170, std=0.5079, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 13:59:40] INFO train_model: dist_to_low: mean=0.6998, std=0.5743, min=0.0020, max=3.5820, unique=1064
[2025-07-16 13:59:40] INFO train_model: pin_bar: mean=0.2827, std=0.4505, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: bullish_engulfing_bar: mean=0.0504, std=0.2188, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: inside_bar: mean=0.1324, std=0.3390, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0757, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: vol_spike_std: mean=0.1755, std=0.3806, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 13:59:40] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 13:59:40] INFO train_model: Auditing data quality before training...
[2025-07-16 13:59:40] INFO train_model: Entering audit_data_quality
[2025-07-16 14:11:06] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: Model is starting a new training session...
[2025-07-16 14:11:06] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 14:11:06] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:11:06] INFO train_model: Preparing target variable...
[2025-07-16 14:11:06] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:11:06] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:11:06] INFO train_model: Dropping NaN targets...
[2025-07-16 14:11:06] INFO train_model: Class distribution: [955 436]
[2025-07-16 14:11:06] INFO train_model: Upsampling successful.
[2025-07-16 14:11:06] INFO train_model: Splitting train/test...
[2025-07-16 14:11:06] INFO train_model: Scaling features...
[2025-07-16 14:11:06] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 14:11:06] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 14:11:07] INFO train_model: Model fit complete.
[2025-07-16 14:11:07] INFO train_model: Model Accuracy: 0.8874
[2025-07-16 14:11:07] INFO train_model: 
Classification Report:
[2025-07-16 14:11:07] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.87      0.89       191
           1       0.87      0.91      0.89       191

    accuracy                           0.89       382
   macro avg       0.89      0.89      0.89       382
weighted avg       0.89      0.89      0.89       382

[2025-07-16 14:11:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 14:11:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 14:11:07] INFO train_model: Feature distributions before training:
[2025-07-16 14:11:07] INFO train_model: atr_14: mean=0.3155, std=0.0620, min=0.1686, max=0.5768, unique=1391
[2025-07-16 14:11:07] INFO train_model: volatility_20: mean=0.3199, std=0.1713, min=0.0583, max=1.1795, unique=1391
[2025-07-16 14:11:07] INFO train_model: fib_0: mean=145.3868, std=1.4334, min=142.7570, max=149.1860, unique=386
[2025-07-16 14:11:07] INFO train_model: fib_236: mean=145.0749, std=1.4088, min=142.5675, max=149.0510, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_382: mean=144.8819, std=1.3986, min=142.4503, max=148.9675, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_500: mean=144.7260, std=1.3933, min=142.3555, max=148.9000, unique=708
[2025-07-16 14:11:07] INFO train_model: fib_618: mean=144.5700, std=1.3907, min=142.2607, max=148.8325, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_786: mean=144.3480, std=1.3915, min=142.1258, max=148.7364, unique=722
[2025-07-16 14:11:07] INFO train_model: fib_100: mean=144.0652, std=1.4003, min=141.9540, max=148.6140, unique=375
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_0: mean=-0.6259, std=0.4832, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4497, min=-2.0190, max=0.7009, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_382: mean=-0.1211, std=0.4446, min=-1.5815, max=1.2515, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_500: mean=0.0349, std=0.4497, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_618: mean=0.1908, std=0.4628, min=-0.9192, max=2.1415, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_786: mean=0.4128, std=0.4939, min=-0.4582, max=2.7750, unique=1369
[2025-07-16 14:11:07] INFO train_model: dist_to_fib_100: mean=0.6957, std=0.5509, min=0.0140, max=3.5820, unique=1034
[2025-07-16 14:11:07] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1181
[2025-07-16 14:11:07] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 14:11:07] INFO train_model: trendline_up: mean=0.5133, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: trendline_down: mean=0.4666, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:11:07] INFO train_model: dist_to_high: mean=-0.6169, std=0.5077, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 14:11:07] INFO train_model: dist_to_low: mean=0.6995, std=0.5742, min=0.0020, max=3.5820, unique=1064
[2025-07-16 14:11:07] INFO train_model: pin_bar: mean=0.2832, std=0.4507, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: bullish_engulfing_bar: mean=0.0503, std=0.2187, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: inside_bar: mean=0.1330, std=0.3397, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0756, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: vol_spike_std: mean=0.1754, std=0.3805, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:11:07] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:11:07] INFO train_model: Auditing data quality before training...
[2025-07-16 14:11:07] INFO train_model: Entering audit_data_quality
[2025-07-16 14:13:57] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: Model is starting a new training session...
[2025-07-16 14:13:57] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 14:13:57] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:13:57] INFO train_model: Preparing target variable...
[2025-07-16 14:13:57] INFO train_model: Entering prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: Exiting prepare_target_variable
[2025-07-16 14:13:57] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'fib_0', 'fib_236', 'fib_382', 'fib_500', 'fib_618', 'fib_786',
       'fib_100', 'dist_to_fib_0', 'dist_to_fib_236', 'dist_to_fib_382',
       'dist_to_fib_500', 'dist_to_fib_618', 'dist_to_fib_786',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'pin_bar', 'bullish_engulfing_bar',
       'bearish_engulfing_bar', 'inside_bar', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'future_return', 'target'],
      dtype='object')
[2025-07-16 14:13:57] INFO train_model: Dropping NaN targets...
[2025-07-16 14:13:57] INFO train_model: Class distribution: [955 436]
[2025-07-16 14:13:57] INFO train_model: Upsampling successful.
[2025-07-16 14:13:57] INFO train_model: Splitting train/test...
[2025-07-16 14:13:57] INFO train_model: Scaling features...
[2025-07-16 14:13:57] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 14:13:57] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 14:13:58] INFO train_model: Model fit complete.
[2025-07-16 14:13:58] INFO train_model: Model Accuracy: 0.8874
[2025-07-16 14:13:58] INFO train_model: 
Classification Report:
[2025-07-16 14:13:58] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.87      0.89       191
           1       0.87      0.91      0.89       191

    accuracy                           0.89       382
   macro avg       0.89      0.89      0.89       382
weighted avg       0.89      0.89      0.89       382

[2025-07-16 14:13:58] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 14:13:58] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 14:13:58] INFO train_model: Feature distributions before training:
[2025-07-16 14:13:58] INFO train_model: atr_14: mean=0.3155, std=0.0620, min=0.1686, max=0.5768, unique=1391
[2025-07-16 14:13:58] INFO train_model: volatility_20: mean=0.3199, std=0.1713, min=0.0583, max=1.1795, unique=1391
[2025-07-16 14:13:58] INFO train_model: fib_0: mean=145.3868, std=1.4334, min=142.7570, max=149.1860, unique=386
[2025-07-16 14:13:58] INFO train_model: fib_236: mean=145.0749, std=1.4088, min=142.5675, max=149.0510, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_382: mean=144.8819, std=1.3986, min=142.4503, max=148.9675, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_500: mean=144.7260, std=1.3933, min=142.3555, max=148.9000, unique=708
[2025-07-16 14:13:58] INFO train_model: fib_618: mean=144.5700, std=1.3907, min=142.2607, max=148.8325, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_786: mean=144.3480, std=1.3915, min=142.1258, max=148.7364, unique=722
[2025-07-16 14:13:58] INFO train_model: fib_100: mean=144.0652, std=1.4003, min=141.9540, max=148.6140, unique=375
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_0: mean=-0.6259, std=0.4832, min=-2.7260, max=-0.0050, unique=1012
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_236: mean=-0.3140, std=0.4497, min=-2.0190, max=0.7009, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_382: mean=-0.1211, std=0.4446, min=-1.5815, max=1.2515, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_500: mean=0.0349, std=0.4497, min=-1.2430, max=1.6965, unique=1259
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_618: mean=0.1908, std=0.4628, min=-0.9192, max=2.1415, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_786: mean=0.4128, std=0.4939, min=-0.4582, max=2.7750, unique=1369
[2025-07-16 14:13:58] INFO train_model: dist_to_fib_100: mean=0.6957, std=0.5509, min=0.0140, max=3.5820, unique=1034
[2025-07-16 14:13:58] INFO train_model: trendline_slope_high: mean=0.0039, std=0.0443, min=-0.1358, max=0.1646, unique=1181
[2025-07-16 14:13:58] INFO train_model: trendline_slope_low: mean=0.0040, std=0.0436, min=-0.1243, max=0.1591, unique=1167
[2025-07-16 14:13:58] INFO train_model: trendline_up: mean=0.5133, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: trendline_down: mean=0.4666, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: breakout_high: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: breakout_low: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:13:58] INFO train_model: dist_to_high: mean=-0.6169, std=0.5077, min=-2.8340, max=0.1460, unique=1024
[2025-07-16 14:13:58] INFO train_model: dist_to_low: mean=0.6995, std=0.5742, min=0.0020, max=3.5820, unique=1064
[2025-07-16 14:13:58] INFO train_model: pin_bar: mean=0.2832, std=0.4507, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: bullish_engulfing_bar: mean=0.0503, std=0.2187, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: bearish_engulfing_bar: mean=0.0554, std=0.2288, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: inside_bar: mean=0.1330, std=0.3397, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: vol_spike_atr: mean=0.0058, std=0.0756, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: vol_spike_std: mean=0.1754, std=0.3805, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: is_trending: mean=0.0014, std=0.0379, min=0.0000, max=1.0000, unique=2
[2025-07-16 14:13:58] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 14:13:58] INFO train_model: Auditing data quality before training...
[2025-07-16 14:13:59] INFO train_model: Entering audit_data_quality
[2025-07-16 15:24:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: Model is starting a new training session...
[2025-07-16 15:24:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:24:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:24:47] INFO train_model: Preparing target variable...
[2025-07-16 15:24:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:24:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:24:47] INFO train_model: Dropping NaN targets...
[2025-07-16 15:24:47] INFO train_model: Class distribution: [972 439]
[2025-07-16 15:24:47] INFO train_model: Upsampling successful.
[2025-07-16 15:24:47] INFO train_model: Splitting train/test...
[2025-07-16 15:24:47] INFO train_model: Scaling features...
[2025-07-16 15:25:01] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: Model is starting a new training session...
[2025-07-16 15:25:01] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:25:01] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:01] INFO train_model: Preparing target variable...
[2025-07-16 15:25:01] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:01] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:01] INFO train_model: Dropping NaN targets...
[2025-07-16 15:25:01] INFO train_model: Class distribution: [817 614]
[2025-07-16 15:25:01] INFO train_model: Upsampling successful.
[2025-07-16 15:25:01] INFO train_model: Splitting train/test...
[2025-07-16 15:25:01] INFO train_model: Scaling features...
[2025-07-16 15:25:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: Model is starting a new training session...
[2025-07-16 15:25:46] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:25:46] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:46] INFO train_model: Preparing target variable...
[2025-07-16 15:25:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:25:46] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:25:47] INFO train_model: Dropping NaN targets...
[2025-07-16 15:25:47] INFO train_model: Class distribution: [1030  382]
[2025-07-16 15:25:47] INFO train_model: Upsampling successful.
[2025-07-16 15:25:47] INFO train_model: Splitting train/test...
[2025-07-16 15:25:47] INFO train_model: Scaling features...
[2025-07-16 15:26:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: Model is starting a new training session...
[2025-07-16 15:26:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:26:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:26:52] INFO train_model: Preparing target variable...
[2025-07-16 15:26:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:26:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:26:52] INFO train_model: Dropping NaN targets...
[2025-07-16 15:26:52] INFO train_model: Class distribution: [956 464]
[2025-07-16 15:26:52] INFO train_model: Upsampling successful.
[2025-07-16 15:26:52] INFO train_model: Splitting train/test...
[2025-07-16 15:26:52] INFO train_model: Scaling features...
[2025-07-16 15:36:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: Model is starting a new training session...
[2025-07-16 15:36:46] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:36:46] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:36:46] INFO train_model: Preparing target variable...
[2025-07-16 15:36:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:36:46] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:36:46] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:36:46] INFO train_model: Dropping NaN targets...
[2025-07-16 15:36:46] INFO train_model: Class distribution: [972 439]
[2025-07-16 15:36:46] INFO train_model: Upsampling successful.
[2025-07-16 15:36:46] INFO train_model: Splitting train/test...
[2025-07-16 15:36:46] INFO train_model: Scaling features...
[2025-07-16 15:36:46] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:36:46] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:36:47] INFO train_model: Model fit complete.
[2025-07-16 15:36:47] INFO train_model: Model Accuracy: 0.5347
[2025-07-16 15:36:47] INFO train_model: 
Classification Report:
[2025-07-16 15:36:47] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.56      0.55       195
           1       0.54      0.51      0.52       194

    accuracy                           0.53       389
   macro avg       0.53      0.53      0.53       389
weighted avg       0.53      0.53      0.53       389

[2025-07-16 15:36:47] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:36:47] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:36:47] INFO train_model: Feature distributions before training:
[2025-07-16 15:36:47] INFO train_model: supply_zone: mean=0.4437, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: demand_zone: mean=0.3834, std=0.4864, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: head_shoulders: mean=0.0319, std=0.1758, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: inv_head_shoulders: mean=0.0319, std=0.1758, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:36:47] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:36:47] INFO train_model: rising_wedge: mean=0.2530, std=0.4349, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: falling_wedge: mean=0.1942, std=0.3957, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:36:47] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:36:47] INFO train_model: Auditing data quality before training...
[2025-07-16 15:36:47] INFO train_model: Entering audit_data_quality
[2025-07-16 15:48:14] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:48:14] WARNING train_model: Removing constant feature: double_top
[2025-07-16 15:48:14] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 15:48:14] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 15:48:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 15:48:14] INFO train_model: Entering audit_data_quality
[2025-07-16 15:48:18] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:48:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 15:48:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:48:19] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 15:48:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:48:19] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 15:48:23] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: Model is starting a new training session...
[2025-07-16 15:48:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:48:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:48:23] INFO train_model: Preparing target variable...
[2025-07-16 15:48:23] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:48:23] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:48:23] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:48:23] INFO train_model: Dropping NaN targets...
[2025-07-16 15:48:23] INFO train_model: Class distribution: [817 614]
[2025-07-16 15:48:23] INFO train_model: Upsampling successful.
[2025-07-16 15:48:23] INFO train_model: Splitting train/test...
[2025-07-16 15:48:23] INFO train_model: Scaling features...
[2025-07-16 15:48:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:48:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:48:24] INFO train_model: Model fit complete.
[2025-07-16 15:48:24] INFO train_model: Model Accuracy: 0.5076
[2025-07-16 15:48:24] INFO train_model: 
Classification Report:
[2025-07-16 15:48:24] INFO train_model:               precision    recall  f1-score   support

           0       0.51      0.65      0.57       164
           1       0.51      0.37      0.43       163

    accuracy                           0.51       327
   macro avg       0.51      0.51      0.50       327
weighted avg       0.51      0.51      0.50       327

[2025-07-16 15:48:24] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:48:24] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:48:24] INFO train_model: Feature distributions before training:
[2025-07-16 15:48:24] INFO train_model: supply_zone: mean=0.2704, std=0.4443, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: demand_zone: mean=0.2006, std=0.4006, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1783, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:48:24] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:48:24] INFO train_model: rising_wedge: mean=0.2739, std=0.4461, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: falling_wedge: mean=0.2509, std=0.4337, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: fakeout_up: mean=0.0049, std=0.0698, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: fakeout_down: mean=0.0063, std=0.0791, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:48:24] INFO train_model: Auditing data quality before training...
[2025-07-16 15:48:24] INFO train_model: Entering audit_data_quality
[2025-07-16 15:53:41] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:53:41] WARNING train_model: Removing constant feature: double_top
[2025-07-16 15:53:41] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 15:53:41] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 15:53:41] INFO train_model: Entering audit_data_quality
[2025-07-16 15:54:08] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:54:08] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 15:54:08] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:54:08] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 15:54:08] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:54:08] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 15:54:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: Model is starting a new training session...
[2025-07-16 15:54:16] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:54:16] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:54:16] INFO train_model: Preparing target variable...
[2025-07-16 15:54:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:54:16] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:54:16] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:54:16] INFO train_model: Dropping NaN targets...
[2025-07-16 15:54:16] INFO train_model: Class distribution: [1030  382]
[2025-07-16 15:54:16] INFO train_model: Upsampling successful.
[2025-07-16 15:54:16] INFO train_model: Splitting train/test...
[2025-07-16 15:54:16] INFO train_model: Scaling features...
[2025-07-16 15:54:16] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:54:16] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:54:17] INFO train_model: Model fit complete.
[2025-07-16 15:54:17] INFO train_model: Model Accuracy: 0.5243
[2025-07-16 15:54:17] INFO train_model: 
Classification Report:
[2025-07-16 15:54:17] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.80      0.63       206
           1       0.55      0.25      0.34       206

    accuracy                           0.52       412
   macro avg       0.53      0.52      0.48       412
weighted avg       0.53      0.52      0.48       412

[2025-07-16 15:54:17] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:54:17] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:54:17] INFO train_model: Feature distributions before training:
[2025-07-16 15:54:17] INFO train_model: supply_zone: mean=0.4193, std=0.4936, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: demand_zone: mean=0.4816, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: head_shoulders: mean=0.0340, std=0.1813, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:54:17] INFO train_model: double_bottom: mean=0.0127, std=0.1122, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: rising_wedge: mean=0.2040, std=0.4031, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: falling_wedge: mean=0.2252, std=0.4179, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:54:17] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:54:17] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 15:54:17] INFO train_model: Auditing data quality before training...
[2025-07-16 15:54:17] INFO train_model: Entering audit_data_quality
[2025-07-16 15:59:17] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:59:17] WARNING train_model: Removing constant feature: double_top
[2025-07-16 15:59:17] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 15:59:17] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 15:59:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 15:59:17] INFO train_model: Entering audit_data_quality
[2025-07-16 15:59:24] INFO train_model: Exiting audit_data_quality
[2025-07-16 15:59:24] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 15:59:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:59:24] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 15:59:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 15:59:24] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 15:59:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: Model is starting a new training session...
[2025-07-16 15:59:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 15:59:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:59:28] INFO train_model: Preparing target variable...
[2025-07-16 15:59:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 15:59:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 15:59:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 15:59:28] INFO train_model: Dropping NaN targets...
[2025-07-16 15:59:28] INFO train_model: Class distribution: [956 464]
[2025-07-16 15:59:28] INFO train_model: Upsampling successful.
[2025-07-16 15:59:28] INFO train_model: Splitting train/test...
[2025-07-16 15:59:28] INFO train_model: Scaling features...
[2025-07-16 15:59:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 15:59:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 15:59:29] INFO train_model: Model fit complete.
[2025-07-16 15:59:29] INFO train_model: Model Accuracy: 0.5535
[2025-07-16 15:59:29] INFO train_model: 
Classification Report:
[2025-07-16 15:59:29] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.54      0.55       192
           1       0.55      0.57      0.56       191

    accuracy                           0.55       383
   macro avg       0.55      0.55      0.55       383
weighted avg       0.55      0.55      0.55       383

[2025-07-16 15:59:29] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 15:59:29] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 15:59:29] INFO train_model: Feature distributions before training:
[2025-07-16 15:59:29] INFO train_model: supply_zone: mean=0.4739, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: demand_zone: mean=0.3641, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: head_shoulders: mean=0.0345, std=0.1826, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: inv_head_shoulders: mean=0.0275, std=0.1635, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: rising_wedge: mean=0.2923, std=0.4550, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: falling_wedge: mean=0.2359, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 15:59:29] INFO train_model: Auditing data quality before training...
[2025-07-16 15:59:29] INFO train_model: Entering audit_data_quality
[2025-07-16 16:03:25] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:03:25] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:03:25] INFO train_model: Entering audit_data_quality
[2025-07-16 16:07:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: Model is starting a new training session...
[2025-07-16 16:07:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:07:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:07:56] INFO train_model: Preparing target variable...
[2025-07-16 16:07:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:07:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:07:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:07:56] INFO train_model: Dropping NaN targets...
[2025-07-16 16:07:56] INFO train_model: Class distribution: [973 439]
[2025-07-16 16:07:56] INFO train_model: Upsampling successful.
[2025-07-16 16:07:56] INFO train_model: Splitting train/test...
[2025-07-16 16:07:56] INFO train_model: Scaling features...
[2025-07-16 16:07:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:07:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:07:57] INFO train_model: Model fit complete.
[2025-07-16 16:07:57] INFO train_model: Model Accuracy: 0.5897
[2025-07-16 16:07:57] INFO train_model: 
Classification Report:
[2025-07-16 16:07:57] INFO train_model:               precision    recall  f1-score   support

           0       0.62      0.45      0.52       195
           1       0.57      0.73      0.64       195

    accuracy                           0.59       390
   macro avg       0.60      0.59      0.58       390
weighted avg       0.60      0.59      0.58       390

[2025-07-16 16:07:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:07:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:07:57] INFO train_model: Feature distributions before training:
[2025-07-16 16:07:57] INFO train_model: supply_zone: mean=0.4433, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: demand_zone: mean=0.3839, std=0.4865, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: head_shoulders: mean=0.0319, std=0.1757, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: inv_head_shoulders: mean=0.0319, std=0.1757, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:07:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:07:57] INFO train_model: rising_wedge: mean=0.2528, std=0.4348, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: falling_wedge: mean=0.1948, std=0.3962, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:07:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:07:57] INFO train_model: Auditing data quality before training...
[2025-07-16 16:07:57] INFO train_model: Entering audit_data_quality
[2025-07-16 16:07:58] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:07:58] WARNING train_model: Removing constant feature: double_top
[2025-07-16 16:07:58] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 16:07:58] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 16:07:58] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:07:58] INFO train_model: Entering audit_data_quality
[2025-07-16 16:07:59] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:07:59] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:07:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:07:59] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:07:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:07:59] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:08:05] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: Model is starting a new training session...
[2025-07-16 16:08:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:08:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:05] INFO train_model: Preparing target variable...
[2025-07-16 16:08:05] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:05] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:05] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:08:05] INFO train_model: Dropping NaN targets...
[2025-07-16 16:08:05] INFO train_model: Class distribution: [817 615]
[2025-07-16 16:08:05] INFO train_model: Upsampling successful.
[2025-07-16 16:08:05] INFO train_model: Splitting train/test...
[2025-07-16 16:08:05] INFO train_model: Scaling features...
[2025-07-16 16:08:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:08:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:08:05] INFO train_model: Model fit complete.
[2025-07-16 16:08:05] INFO train_model: Model Accuracy: 0.5260
[2025-07-16 16:08:05] INFO train_model: 
Classification Report:
[2025-07-16 16:08:05] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.63      0.57       164
           1       0.53      0.42      0.47       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.52       327
weighted avg       0.53      0.53      0.52       327

[2025-07-16 16:08:05] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:08:05] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:08:05] INFO train_model: Feature distributions before training:
[2025-07-16 16:08:05] INFO train_model: supply_zone: mean=0.2716, std=0.4450, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: demand_zone: mean=0.2004, std=0.4005, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1782, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:05] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:05] INFO train_model: rising_wedge: mean=0.2744, std=0.4464, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: falling_wedge: mean=0.2507, std=0.4336, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: fakeout_up: mean=0.0049, std=0.0698, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: fakeout_down: mean=0.0063, std=0.0791, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:05] INFO train_model: Auditing data quality before training...
[2025-07-16 16:08:05] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:06] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:06] WARNING train_model: Removing constant feature: double_top
[2025-07-16 16:08:06] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 16:08:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:08:06] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:07] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:08:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:08:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:08:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: Model is starting a new training session...
[2025-07-16 16:08:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:08:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:13] INFO train_model: Preparing target variable...
[2025-07-16 16:08:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:13] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:08:13] INFO train_model: Dropping NaN targets...
[2025-07-16 16:08:13] INFO train_model: Class distribution: [1030  383]
[2025-07-16 16:08:13] INFO train_model: Upsampling successful.
[2025-07-16 16:08:13] INFO train_model: Splitting train/test...
[2025-07-16 16:08:13] INFO train_model: Scaling features...
[2025-07-16 16:08:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:08:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:08:14] INFO train_model: Model fit complete.
[2025-07-16 16:08:14] INFO train_model: Model Accuracy: 0.5437
[2025-07-16 16:08:14] INFO train_model: 
Classification Report:
[2025-07-16 16:08:14] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.70      0.61       206
           1       0.56      0.39      0.46       206

    accuracy                           0.54       412
   macro avg       0.55      0.54      0.53       412
weighted avg       0.55      0.54      0.53       412

[2025-07-16 16:08:14] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:08:14] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:08:14] INFO train_model: Feature distributions before training:
[2025-07-16 16:08:14] INFO train_model: supply_zone: mean=0.4190, std=0.4936, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: demand_zone: mean=0.4812, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: head_shoulders: mean=0.0340, std=0.1812, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: inv_head_shoulders: mean=0.0304, std=0.1718, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:14] INFO train_model: double_bottom: mean=0.0127, std=0.1122, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: rising_wedge: mean=0.2038, std=0.4030, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: falling_wedge: mean=0.2251, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:14] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:14] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 16:08:14] INFO train_model: Auditing data quality before training...
[2025-07-16 16:08:14] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:15] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:15] WARNING train_model: Removing constant feature: double_top
[2025-07-16 16:08:15] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 16:08:15] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 16:08:15] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:08:15] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:15] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:15] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:08:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:15] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:08:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:15] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:08:19] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: Model is starting a new training session...
[2025-07-16 16:08:19] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 16:08:19] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:19] INFO train_model: Preparing target variable...
[2025-07-16 16:08:19] INFO train_model: Entering prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: Exiting prepare_target_variable
[2025-07-16 16:08:19] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 16:08:19] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 16:08:19] INFO train_model: Dropping NaN targets...
[2025-07-16 16:08:19] INFO train_model: Class distribution: [957 464]
[2025-07-16 16:08:19] INFO train_model: Upsampling successful.
[2025-07-16 16:08:19] INFO train_model: Splitting train/test...
[2025-07-16 16:08:19] INFO train_model: Scaling features...
[2025-07-16 16:08:19] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 16:08:19] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 16:08:20] INFO train_model: Model fit complete.
[2025-07-16 16:08:20] INFO train_model: Model Accuracy: 0.5326
[2025-07-16 16:08:20] INFO train_model: 
Classification Report:
[2025-07-16 16:08:20] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.47      0.50       192
           1       0.53      0.59      0.56       191

    accuracy                           0.53       383
   macro avg       0.53      0.53      0.53       383
weighted avg       0.53      0.53      0.53       383

[2025-07-16 16:08:20] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 16:08:20] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 16:08:20] INFO train_model: Feature distributions before training:
[2025-07-16 16:08:20] INFO train_model: supply_zone: mean=0.4736, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: demand_zone: mean=0.3645, std=0.4815, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: head_shoulders: mean=0.0345, std=0.1825, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1634, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: rising_wedge: mean=0.2920, std=0.4549, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: falling_wedge: mean=0.2365, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 16:08:20] INFO train_model: Auditing data quality before training...
[2025-07-16 16:08:20] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 16:08:21] INFO train_model: Entering audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:08:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:08:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:08:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:08:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 16:16:21] INFO train_model: Exiting audit_data_quality
[2025-07-16 16:16:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 16:16:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:16:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 16:16:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 16:16:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:34:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: Model is starting a new training session...
[2025-07-16 18:34:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:34:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:34:56] INFO train_model: Preparing target variable...
[2025-07-16 18:34:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:34:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:34:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:34:56] INFO train_model: Dropping NaN targets...
[2025-07-16 18:34:56] INFO train_model: Class distribution: [975 439]
[2025-07-16 18:34:56] INFO train_model: Upsampling successful.
[2025-07-16 18:34:56] INFO train_model: Splitting train/test...
[2025-07-16 18:34:56] INFO train_model: Scaling features...
[2025-07-16 18:34:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:34:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:34:57] INFO train_model: Model fit complete.
[2025-07-16 18:34:57] INFO train_model: Model Accuracy: 0.5590
[2025-07-16 18:34:57] INFO train_model: 
Classification Report:
[2025-07-16 18:34:57] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.73      0.62       195
           1       0.59      0.39      0.47       195

    accuracy                           0.56       390
   macro avg       0.57      0.56      0.55       390
weighted avg       0.57      0.56      0.55       390

[2025-07-16 18:34:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:34:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:34:57] INFO train_model: Feature distributions before training:
[2025-07-16 18:34:57] INFO train_model: supply_zone: mean=0.4427, std=0.4969, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: demand_zone: mean=0.3833, std=0.4864, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:34:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:34:57] INFO train_model: rising_wedge: mean=0.2525, std=0.4346, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: falling_wedge: mean=0.1959, std=0.3970, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:34:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:34:57] INFO train_model: Auditing data quality before training...
[2025-07-16 18:34:57] INFO train_model: Entering audit_data_quality
[2025-07-16 18:34:58] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:34:58] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:34:58] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:34:58] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 18:34:58] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:34:58] INFO train_model: Entering audit_data_quality
[2025-07-16 18:34:58] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:34:58] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:34:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:34:59] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:34:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:34:59] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:35:00] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: Model is starting a new training session...
[2025-07-16 18:35:00] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:35:00] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:00] INFO train_model: Preparing target variable...
[2025-07-16 18:35:00] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:00] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:00] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:35:00] INFO train_model: Dropping NaN targets...
[2025-07-16 18:35:00] INFO train_model: Class distribution: [817 617]
[2025-07-16 18:35:00] INFO train_model: Upsampling successful.
[2025-07-16 18:35:00] INFO train_model: Splitting train/test...
[2025-07-16 18:35:00] INFO train_model: Scaling features...
[2025-07-16 18:35:00] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:35:00] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:35:01] INFO train_model: Model fit complete.
[2025-07-16 18:35:01] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 18:35:01] INFO train_model: 
Classification Report:
[2025-07-16 18:35:01] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 18:35:01] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:35:01] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:35:01] INFO train_model: Feature distributions before training:
[2025-07-16 18:35:01] INFO train_model: supply_zone: mean=0.2720, std=0.4451, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: demand_zone: mean=0.2001, std=0.4002, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: head_shoulders: mean=0.0342, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:01] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:01] INFO train_model: rising_wedge: mean=0.2741, std=0.4462, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: falling_wedge: mean=0.2503, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:01] INFO train_model: Auditing data quality before training...
[2025-07-16 18:35:01] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:01] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:01] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:35:01] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:35:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:35:01] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:02] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:02] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:35:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:02] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:35:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:02] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:35:03] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: Model is starting a new training session...
[2025-07-16 18:35:03] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:35:03] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:03] INFO train_model: Preparing target variable...
[2025-07-16 18:35:03] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:03] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:03] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:35:03] INFO train_model: Dropping NaN targets...
[2025-07-16 18:35:03] INFO train_model: Class distribution: [1032  383]
[2025-07-16 18:35:03] INFO train_model: Upsampling successful.
[2025-07-16 18:35:03] INFO train_model: Splitting train/test...
[2025-07-16 18:35:03] INFO train_model: Scaling features...
[2025-07-16 18:35:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:35:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:35:04] INFO train_model: Model fit complete.
[2025-07-16 18:35:04] INFO train_model: Model Accuracy: 0.4964
[2025-07-16 18:35:04] INFO train_model: 
Classification Report:
[2025-07-16 18:35:04] INFO train_model:               precision    recall  f1-score   support

           0       0.50      0.55      0.52       207
           1       0.49      0.44      0.47       206

    accuracy                           0.50       413
   macro avg       0.50      0.50      0.49       413
weighted avg       0.50      0.50      0.49       413

[2025-07-16 18:35:04] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:35:04] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:35:04] INFO train_model: Feature distributions before training:
[2025-07-16 18:35:04] INFO train_model: supply_zone: mean=0.4184, std=0.4935, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: demand_zone: mean=0.4813, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: head_shoulders: mean=0.0339, std=0.1811, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:04] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: rising_wedge: mean=0.2035, std=0.4028, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: falling_wedge: mean=0.2247, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:04] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:04] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:35:04] INFO train_model: Auditing data quality before training...
[2025-07-16 18:35:04] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:05] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:05] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:35:05] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 18:35:05] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 18:35:05] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:35:05] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:05] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:05] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:35:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:05] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:35:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:05] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:35:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: Model is starting a new training session...
[2025-07-16 18:35:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:35:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:07] INFO train_model: Preparing target variable...
[2025-07-16 18:35:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:35:07] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:35:07] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:35:07] INFO train_model: Dropping NaN targets...
[2025-07-16 18:35:07] INFO train_model: Class distribution: [959 464]
[2025-07-16 18:35:07] INFO train_model: Upsampling successful.
[2025-07-16 18:35:07] INFO train_model: Splitting train/test...
[2025-07-16 18:35:07] INFO train_model: Scaling features...
[2025-07-16 18:35:07] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:35:07] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:35:07] INFO train_model: Model fit complete.
[2025-07-16 18:35:07] INFO train_model: Model Accuracy: 0.5443
[2025-07-16 18:35:07] INFO train_model: 
Classification Report:
[2025-07-16 18:35:07] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.64      0.58       192
           1       0.55      0.45      0.50       192

    accuracy                           0.54       384
   macro avg       0.55      0.54      0.54       384
weighted avg       0.55      0.54      0.54       384

[2025-07-16 18:35:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:35:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:35:07] INFO train_model: Feature distributions before training:
[2025-07-16 18:35:07] INFO train_model: supply_zone: mean=0.4729, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: demand_zone: mean=0.3640, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: head_shoulders: mean=0.0344, std=0.1824, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: rising_wedge: mean=0.2916, std=0.4547, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: falling_wedge: mean=0.2375, std=0.4257, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:35:07] INFO train_model: Auditing data quality before training...
[2025-07-16 18:35:07] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:08] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:08] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:35:08] INFO train_model: Entering audit_data_quality
[2025-07-16 18:35:09] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:35:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:35:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:35:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:35:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:37:55] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: Model is starting a new training session...
[2025-07-16 18:37:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:37:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:37:55] INFO train_model: Preparing target variable...
[2025-07-16 18:37:55] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:37:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:37:55] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:37:55] INFO train_model: Dropping NaN targets...
[2025-07-16 18:37:55] INFO train_model: Class distribution: [975 439]
[2025-07-16 18:37:55] INFO train_model: Upsampling successful.
[2025-07-16 18:37:55] INFO train_model: Splitting train/test...
[2025-07-16 18:37:55] INFO train_model: Scaling features...
[2025-07-16 18:37:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:37:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:37:55] INFO train_model: Model fit complete.
[2025-07-16 18:37:55] INFO train_model: Model Accuracy: 0.5590
[2025-07-16 18:37:55] INFO train_model: 
Classification Report:
[2025-07-16 18:37:55] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.73      0.62       195
           1       0.59      0.39      0.47       195

    accuracy                           0.56       390
   macro avg       0.57      0.56      0.55       390
weighted avg       0.57      0.56      0.55       390

[2025-07-16 18:37:55] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:37:55] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:37:55] INFO train_model: Feature distributions before training:
[2025-07-16 18:37:55] INFO train_model: supply_zone: mean=0.4427, std=0.4969, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: demand_zone: mean=0.3833, std=0.4864, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1756, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:37:55] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:37:55] INFO train_model: rising_wedge: mean=0.2525, std=0.4346, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: falling_wedge: mean=0.1959, std=0.3970, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:37:55] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:37:55] INFO train_model: Auditing data quality before training...
[2025-07-16 18:37:56] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:00] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:00] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:38:00] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:38:00] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 18:38:00] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:38:00] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:05] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:05] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:38:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:05] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:38:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:05] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:38:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: Model is starting a new training session...
[2025-07-16 18:38:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:38:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:07] INFO train_model: Preparing target variable...
[2025-07-16 18:38:07] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:07] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:07] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:38:07] INFO train_model: Dropping NaN targets...
[2025-07-16 18:38:07] INFO train_model: Class distribution: [817 617]
[2025-07-16 18:38:07] INFO train_model: Upsampling successful.
[2025-07-16 18:38:07] INFO train_model: Splitting train/test...
[2025-07-16 18:38:07] INFO train_model: Scaling features...
[2025-07-16 18:38:07] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:38:07] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:38:07] INFO train_model: Model fit complete.
[2025-07-16 18:38:07] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 18:38:07] INFO train_model: 
Classification Report:
[2025-07-16 18:38:07] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 18:38:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:38:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:38:07] INFO train_model: Feature distributions before training:
[2025-07-16 18:38:07] INFO train_model: supply_zone: mean=0.2720, std=0.4451, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: demand_zone: mean=0.2001, std=0.4002, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: head_shoulders: mean=0.0342, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:07] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:07] INFO train_model: rising_wedge: mean=0.2741, std=0.4462, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: falling_wedge: mean=0.2503, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:07] INFO train_model: Auditing data quality before training...
[2025-07-16 18:38:07] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:16] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:16] WARNING train_model: Removing constant feature: double_top
[2025-07-16 18:38:16] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 18:38:16] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 18:38:16] INFO train_model: Entering audit_data_quality
[2025-07-16 18:38:20] INFO train_model: Exiting audit_data_quality
[2025-07-16 18:38:20] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 18:38:20] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:20] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 18:38:20] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 18:38:20] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 18:38:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: Model is starting a new training session...
[2025-07-16 18:38:21] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 18:38:21] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:21] INFO train_model: Preparing target variable...
[2025-07-16 18:38:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 18:38:21] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_phase', 'head_shoulders', 'inv_head_shoulders', 'double_top',
       'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up',
       'fakeout_down', 'future_return', 'target'],
      dtype='object')
[2025-07-16 18:38:21] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 18:38:21] INFO train_model: Dropping NaN targets...
[2025-07-16 18:38:21] INFO train_model: Class distribution: [1032  383]
[2025-07-16 18:38:21] INFO train_model: Upsampling successful.
[2025-07-16 18:38:21] INFO train_model: Splitting train/test...
[2025-07-16 18:38:21] INFO train_model: Scaling features...
[2025-07-16 18:38:21] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 18:38:21] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 18:38:22] INFO train_model: Model fit complete.
[2025-07-16 18:38:22] INFO train_model: Model Accuracy: 0.4964
[2025-07-16 18:38:22] INFO train_model: 
Classification Report:
[2025-07-16 18:38:22] INFO train_model:               precision    recall  f1-score   support

           0       0.50      0.55      0.52       207
           1       0.49      0.44      0.47       206

    accuracy                           0.50       413
   macro avg       0.50      0.50      0.49       413
weighted avg       0.50      0.50      0.49       413

[2025-07-16 18:38:22] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 18:38:22] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 18:38:22] INFO train_model: Feature distributions before training:
[2025-07-16 18:38:22] INFO train_model: supply_zone: mean=0.4184, std=0.4935, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: demand_zone: mean=0.4813, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: head_shoulders: mean=0.0339, std=0.1811, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:22] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: rising_wedge: mean=0.2035, std=0.4028, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: falling_wedge: mean=0.2247, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-16 18:38:22] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:22] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 18:38:22] INFO train_model: Auditing data quality before training...
[2025-07-16 18:38:22] INFO train_model: Entering audit_data_quality
[2025-07-16 18:49:19] INFO train_model: Training signal prediction model...
[2025-07-16 19:13:12] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:12] INFO train_model: Preparing target variable...
[2025-07-16 19:13:12] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:12] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:12] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:12] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:12] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:13:15] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:15] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:15] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:13:15] INFO train_model: Preparing target variable...
[2025-07-16 19:13:15] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:15] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:13:15] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:15] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:15] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:13:17] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:17] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:17] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:17] INFO train_model: Preparing target variable...
[2025-07-16 19:13:17] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:17] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:17] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:17] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:17] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:13:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: Model is starting a new training session...
[2025-07-16 19:13:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:13:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:18] INFO train_model: Preparing target variable...
[2025-07-16 19:13:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:13:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:13:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:13:18] INFO train_model: Dropping NaN targets...
[2025-07-16 19:13:18] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:15:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:28] INFO train_model: Preparing target variable...
[2025-07-16 19:15:28] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:28] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:28] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:15:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:15:29] INFO train_model: Preparing target variable...
[2025-07-16 19:15:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:15:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:29] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:29] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:15:31] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:31] INFO train_model: Preparing target variable...
[2025-07-16 19:15:31] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:31] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:31] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:31] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:31] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:15:33] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: Model is starting a new training session...
[2025-07-16 19:15:33] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:15:33] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:33] INFO train_model: Preparing target variable...
[2025-07-16 19:15:33] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:15:33] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'future_return', 'target'],
      dtype='object')
[2025-07-16 19:15:33] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:15:33] INFO train_model: Dropping NaN targets...
[2025-07-16 19:15:33] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:15:40] INFO train_model: Training signal prediction model...
[2025-07-16 19:16:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:25] INFO train_model: Preparing target variable...
[2025-07-16 19:16:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:25] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:25] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:25] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:16:26] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:26] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:26] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:26] INFO train_model: Preparing target variable...
[2025-07-16 19:16:26] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:26] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:26] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:26] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:26] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:16:27] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:27] INFO train_model: Preparing target variable...
[2025-07-16 19:16:27] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:27] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:27] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:27] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:16:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: Model is starting a new training session...
[2025-07-16 19:16:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:16:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:29] INFO train_model: Preparing target variable...
[2025-07-16 19:16:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:16:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:16:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:16:29] INFO train_model: Dropping NaN targets...
[2025-07-16 19:16:29] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:20:37] INFO train_model: Training signal prediction model...
[2025-07-16 19:21:37] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:37] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:37] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:37] INFO train_model: Preparing target variable...
[2025-07-16 19:21:37] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:37] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:37] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:37] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:37] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:21:37] INFO train_model: Upsampling successful.
[2025-07-16 19:21:37] INFO train_model: Splitting train/test...
[2025-07-16 19:21:37] INFO train_model: Scaling features...
[2025-07-16 19:21:37] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:37] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:38] INFO train_model: Model fit complete.
[2025-07-16 19:21:38] INFO train_model: Model Accuracy: 0.5831
[2025-07-16 19:21:38] INFO train_model: 
Classification Report:
[2025-07-16 19:21:38] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.74      0.64       196
           1       0.62      0.43      0.50       195

    accuracy                           0.58       391
   macro avg       0.59      0.58      0.57       391
weighted avg       0.59      0.58      0.57       391

[2025-07-16 19:21:38] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:38] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:38] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:38] INFO train_model: supply_zone: mean=0.4424, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: demand_zone: mean=0.3830, std=0.4863, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_markdown: mean=0.4686, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_markup: mean=0.5032, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_unknown: mean=0.0283, std=0.1658, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: rising_wedge: mean=0.2523, std=0.4345, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: falling_wedge: mean=0.1965, std=0.3975, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:38] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:38] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:38] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:38] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:21:38] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:21:38] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:38] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:39] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:39] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:39] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:39] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:21:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:40] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:40] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:40] INFO train_model: Preparing target variable...
[2025-07-16 19:21:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:40] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:40] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:40] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:40] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:21:40] INFO train_model: Upsampling successful.
[2025-07-16 19:21:40] INFO train_model: Splitting train/test...
[2025-07-16 19:21:40] INFO train_model: Scaling features...
[2025-07-16 19:21:40] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:40] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:41] INFO train_model: Model fit complete.
[2025-07-16 19:21:41] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 19:21:41] INFO train_model: 
Classification Report:
[2025-07-16 19:21:41] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 19:21:41] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:41] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:41] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:41] INFO train_model: supply_zone: mean=0.2718, std=0.4450, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: demand_zone: mean=0.2000, std=0.4001, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_distribution: mean=0.1331, std=0.3398, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_markdown: mean=0.3805, std=0.4857, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_markup: mean=0.4578, std=0.4984, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: wyckoff_unknown: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: head_shoulders: mean=0.0341, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:41] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:41] INFO train_model: rising_wedge: mean=0.2739, std=0.4461, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: falling_wedge: mean=0.2502, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:41] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:41] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:41] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:41] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:21:41] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:21:41] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:41] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:42] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:42] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:42] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:42] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:21:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:43] INFO train_model: Preparing target variable...
[2025-07-16 19:21:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:43] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:43] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:21:43] INFO train_model: Upsampling successful.
[2025-07-16 19:21:43] INFO train_model: Splitting train/test...
[2025-07-16 19:21:43] INFO train_model: Scaling features...
[2025-07-16 19:21:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:44] INFO train_model: Model fit complete.
[2025-07-16 19:21:44] INFO train_model: Model Accuracy: 0.5266
[2025-07-16 19:21:44] INFO train_model: 
Classification Report:
[2025-07-16 19:21:44] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.57      0.55       207
           1       0.53      0.48      0.50       207

    accuracy                           0.53       414
   macro avg       0.53      0.53      0.53       414
weighted avg       0.53      0.53      0.53       414

[2025-07-16 19:21:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:44] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:44] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: demand_zone: mean=0.4809, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_markdown: mean=0.5304, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_markup: mean=0.4414, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: head_shoulders: mean=0.0339, std=0.1810, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: rising_wedge: mean=0.2034, std=0.4027, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: falling_wedge: mean=0.2246, std=0.4175, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:44] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:44] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:44] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 19:21:44] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:21:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:45] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:45] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:45] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:21:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: Model is starting a new training session...
[2025-07-16 19:21:46] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:21:46] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:46] INFO train_model: Preparing target variable...
[2025-07-16 19:21:46] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:21:46] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:21:46] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:21:46] INFO train_model: Dropping NaN targets...
[2025-07-16 19:21:46] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:21:46] INFO train_model: Upsampling successful.
[2025-07-16 19:21:46] INFO train_model: Splitting train/test...
[2025-07-16 19:21:46] INFO train_model: Scaling features...
[2025-07-16 19:21:46] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:21:46] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:21:47] INFO train_model: Model fit complete.
[2025-07-16 19:21:47] INFO train_model: Model Accuracy: 0.5599
[2025-07-16 19:21:47] INFO train_model: 
Classification Report:
[2025-07-16 19:21:47] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.52      0.54       192
           1       0.56      0.60      0.58       192

    accuracy                           0.56       384
   macro avg       0.56      0.56      0.56       384
weighted avg       0.56      0.56      0.56       384

[2025-07-16 19:21:47] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:21:47] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:21:47] INFO train_model: Feature distributions before training:
[2025-07-16 19:21:47] INFO train_model: supply_zone: mean=0.4726, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: demand_zone: mean=0.3638, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_markdown: mean=0.4087, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_markup: mean=0.5632, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_unknown: mean=0.0281, std=0.1653, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:47] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:21:47] INFO train_model: head_shoulders: mean=0.0344, std=0.1823, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: rising_wedge: mean=0.2914, std=0.4546, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: falling_wedge: mean=0.2381, std=0.4260, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:21:47] INFO train_model: Auditing data quality before training...
[2025-07-16 19:21:47] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:47] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:47] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:21:47] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:21:47] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:21:47] INFO train_model: Entering audit_data_quality
[2025-07-16 19:21:47] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:21:47] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:21:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:47] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:21:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:21:47] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:29:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: Model is starting a new training session...
[2025-07-16 19:29:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:29:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:29:43] INFO train_model: Preparing target variable...
[2025-07-16 19:29:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:29:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:29:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:29:43] INFO train_model: Dropping NaN targets...
[2025-07-16 19:29:43] INFO train_model: Class distribution: [976 439]
[2025-07-16 19:29:43] INFO train_model: Upsampling successful.
[2025-07-16 19:29:43] INFO train_model: Splitting train/test...
[2025-07-16 19:29:43] INFO train_model: Scaling features...
[2025-07-16 19:29:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:29:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:29:44] INFO train_model: Model fit complete.
[2025-07-16 19:29:44] INFO train_model: Model Accuracy: 0.5831
[2025-07-16 19:29:44] INFO train_model: 
Classification Report:
[2025-07-16 19:29:44] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.74      0.64       196
           1       0.62      0.43      0.50       195

    accuracy                           0.58       391
   macro avg       0.59      0.58      0.57       391
weighted avg       0.59      0.58      0.57       391

[2025-07-16 19:29:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:29:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:29:44] INFO train_model: Feature distributions before training:
[2025-07-16 19:29:44] INFO train_model: supply_zone: mean=0.4424, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: demand_zone: mean=0.3830, std=0.4863, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_markdown: mean=0.4686, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_markup: mean=0.5032, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_unknown: mean=0.0283, std=0.1658, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: rising_wedge: mean=0.2523, std=0.4345, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: falling_wedge: mean=0.1965, std=0.3975, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:29:44] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:29:44] INFO train_model: Auditing data quality before training...
[2025-07-16 19:29:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:29:44] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:29:44] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:29:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:29:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:29:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:29:45] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:29:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:29:45] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:29:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:29:45] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:30:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: Model is starting a new training session...
[2025-07-16 19:30:16] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:30:16] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:16] INFO train_model: Preparing target variable...
[2025-07-16 19:30:16] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:16] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:16] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:30:16] INFO train_model: Dropping NaN targets...
[2025-07-16 19:30:16] INFO train_model: Class distribution: [817 618]
[2025-07-16 19:30:16] INFO train_model: Upsampling successful.
[2025-07-16 19:30:16] INFO train_model: Splitting train/test...
[2025-07-16 19:30:16] INFO train_model: Scaling features...
[2025-07-16 19:30:16] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:30:16] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:30:17] INFO train_model: Model fit complete.
[2025-07-16 19:30:17] INFO train_model: Model Accuracy: 0.5321
[2025-07-16 19:30:17] INFO train_model: 
Classification Report:
[2025-07-16 19:30:17] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.62      0.57       164
           1       0.54      0.44      0.48       163

    accuracy                           0.53       327
   macro avg       0.53      0.53      0.53       327
weighted avg       0.53      0.53      0.53       327

[2025-07-16 19:30:17] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:30:17] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:30:17] INFO train_model: Feature distributions before training:
[2025-07-16 19:30:17] INFO train_model: supply_zone: mean=0.2718, std=0.4450, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: demand_zone: mean=0.2000, std=0.4001, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_distribution: mean=0.1338, std=0.3406, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_markdown: mean=0.3805, std=0.4857, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_markup: mean=0.4571, std=0.4983, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: wyckoff_unknown: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: head_shoulders: mean=0.0341, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:17] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:17] INFO train_model: rising_wedge: mean=0.2739, std=0.4461, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: falling_wedge: mean=0.2502, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: fakeout_up: mean=0.0049, std=0.0697, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: fakeout_down: mean=0.0063, std=0.0790, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:17] INFO train_model: Auditing data quality before training...
[2025-07-16 19:30:17] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:17] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:17] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:30:17] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 19:30:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:30:17] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:18] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:30:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:18] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:30:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:18] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:30:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: Model is starting a new training session...
[2025-07-16 19:30:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:30:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:43] INFO train_model: Preparing target variable...
[2025-07-16 19:30:43] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:30:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:30:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:30:43] INFO train_model: Dropping NaN targets...
[2025-07-16 19:30:43] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:30:43] INFO train_model: Upsampling successful.
[2025-07-16 19:30:43] INFO train_model: Splitting train/test...
[2025-07-16 19:30:43] INFO train_model: Scaling features...
[2025-07-16 19:30:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:30:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:30:44] INFO train_model: Model fit complete.
[2025-07-16 19:30:44] INFO train_model: Model Accuracy: 0.5266
[2025-07-16 19:30:44] INFO train_model: 
Classification Report:
[2025-07-16 19:30:44] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.57      0.55       207
           1       0.53      0.48      0.50       207

    accuracy                           0.53       414
   macro avg       0.53      0.53      0.53       414
weighted avg       0.53      0.53      0.53       414

[2025-07-16 19:30:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:30:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:30:44] INFO train_model: Feature distributions before training:
[2025-07-16 19:30:44] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: demand_zone: mean=0.4809, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_markdown: mean=0.5304, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_markup: mean=0.4414, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: head_shoulders: mean=0.0339, std=0.1810, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: rising_wedge: mean=0.2034, std=0.4027, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: falling_wedge: mean=0.2246, std=0.4175, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:30:44] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:30:44] INFO train_model: Auditing data quality before training...
[2025-07-16 19:30:44] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 19:30:45] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:30:45] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:30:45] INFO train_model: Entering audit_data_quality
[2025-07-16 19:30:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:30:45] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:30:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:45] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:30:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:30:45] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:31:08] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: Model is starting a new training session...
[2025-07-16 19:31:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:31:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:31:08] INFO train_model: Preparing target variable...
[2025-07-16 19:31:08] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:31:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:31:08] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:31:08] INFO train_model: Dropping NaN targets...
[2025-07-16 19:31:08] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:31:08] INFO train_model: Upsampling successful.
[2025-07-16 19:31:08] INFO train_model: Splitting train/test...
[2025-07-16 19:31:08] INFO train_model: Scaling features...
[2025-07-16 19:31:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:31:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:31:08] INFO train_model: Model fit complete.
[2025-07-16 19:31:08] INFO train_model: Model Accuracy: 0.5599
[2025-07-16 19:31:08] INFO train_model: 
Classification Report:
[2025-07-16 19:31:08] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.52      0.54       192
           1       0.56      0.60      0.58       192

    accuracy                           0.56       384
   macro avg       0.56      0.56      0.56       384
weighted avg       0.56      0.56      0.56       384

[2025-07-16 19:31:08] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:31:08] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:31:08] INFO train_model: Feature distributions before training:
[2025-07-16 19:31:08] INFO train_model: supply_zone: mean=0.4726, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: demand_zone: mean=0.3638, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_markdown: mean=0.4087, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_markup: mean=0.5632, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_unknown: mean=0.0281, std=0.1653, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:31:08] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:31:08] INFO train_model: head_shoulders: mean=0.0344, std=0.1823, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: rising_wedge: mean=0.2914, std=0.4546, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: falling_wedge: mean=0.2381, std=0.4260, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:31:08] INFO train_model: Auditing data quality before training...
[2025-07-16 19:31:08] INFO train_model: Entering audit_data_quality
[2025-07-16 19:31:09] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:31:09] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:31:09] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:31:09] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:31:09] INFO train_model: Entering audit_data_quality
[2025-07-16 19:31:09] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:31:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:31:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:31:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:31:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:31:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:34:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: Model is starting a new training session...
[2025-07-16 19:34:21] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:34:21] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:21] INFO train_model: Preparing target variable...
[2025-07-16 19:34:21] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:21] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:21] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:34:21] INFO train_model: Dropping NaN targets...
[2025-07-16 19:34:21] INFO train_model: Class distribution: [1033  383]
[2025-07-16 19:34:21] INFO train_model: Upsampling successful.
[2025-07-16 19:34:21] INFO train_model: Splitting train/test...
[2025-07-16 19:34:21] INFO train_model: Scaling features...
[2025-07-16 19:34:21] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:34:21] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:34:22] INFO train_model: Model fit complete.
[2025-07-16 19:34:22] INFO train_model: Model Accuracy: 0.5266
[2025-07-16 19:34:22] INFO train_model: 
Classification Report:
[2025-07-16 19:34:22] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.57      0.55       207
           1       0.53      0.48      0.50       207

    accuracy                           0.53       414
   macro avg       0.53      0.53      0.53       414
weighted avg       0.53      0.53      0.53       414

[2025-07-16 19:34:22] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:34:22] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:34:22] INFO train_model: Feature distributions before training:
[2025-07-16 19:34:22] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: demand_zone: mean=0.4809, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_markdown: mean=0.5304, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_markup: mean=0.4414, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: head_shoulders: mean=0.0339, std=0.1810, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: double_bottom: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: rising_wedge: mean=0.2034, std=0.4027, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: falling_wedge: mean=0.2246, std=0.4175, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:22] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:22] INFO train_model: Auditing data quality before training...
[2025-07-16 19:34:22] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:23] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: double_top
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 19:34:23] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 19:34:23] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:34:23] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:23] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:23] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:34:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:24] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:34:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:24] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 19:34:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: Model is starting a new training session...
[2025-07-16 19:34:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 19:34:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:25] INFO train_model: Preparing target variable...
[2025-07-16 19:34:25] INFO train_model: Entering prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: Exiting prepare_target_variable
[2025-07-16 19:34:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 19:34:25] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 19:34:25] INFO train_model: Dropping NaN targets...
[2025-07-16 19:34:25] INFO train_model: Class distribution: [960 464]
[2025-07-16 19:34:25] INFO train_model: Upsampling successful.
[2025-07-16 19:34:25] INFO train_model: Splitting train/test...
[2025-07-16 19:34:25] INFO train_model: Scaling features...
[2025-07-16 19:34:25] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 19:34:25] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 19:34:26] INFO train_model: Model fit complete.
[2025-07-16 19:34:26] INFO train_model: Model Accuracy: 0.5599
[2025-07-16 19:34:26] INFO train_model: 
Classification Report:
[2025-07-16 19:34:26] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.52      0.54       192
           1       0.56      0.60      0.58       192

    accuracy                           0.56       384
   macro avg       0.56      0.56      0.56       384
weighted avg       0.56      0.56      0.56       384

[2025-07-16 19:34:26] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 19:34:26] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 19:34:26] INFO train_model: Feature distributions before training:
[2025-07-16 19:34:26] INFO train_model: supply_zone: mean=0.4726, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: demand_zone: mean=0.3638, std=0.4813, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_markdown: mean=0.4087, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_markup: mean=0.5632, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_unknown: mean=0.0281, std=0.1653, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:26] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 19:34:26] INFO train_model: head_shoulders: mean=0.0344, std=0.1823, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: inv_head_shoulders: mean=0.0274, std=0.1633, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: double_top: mean=0.0042, std=0.0648, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: double_bottom: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: rising_wedge: mean=0.2914, std=0.4546, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: falling_wedge: mean=0.2381, std=0.4260, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: fakeout_up: mean=0.0014, std=0.0375, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: fakeout_down: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 19:34:26] INFO train_model: Auditing data quality before training...
[2025-07-16 19:34:26] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:26] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:26] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 19:34:26] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 19:34:26] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 19:34:26] INFO train_model: Entering audit_data_quality
[2025-07-16 19:34:26] INFO train_model: Exiting audit_data_quality
[2025-07-16 19:34:26] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 19:34:26] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:26] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 19:34:26] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 19:34:26] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 20:05:23] INFO train_model: Training signal prediction model...
[2025-07-16 20:39:24] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: Model is starting a new training session...
[2025-07-16 20:39:24] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 20:39:24] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:39:24] INFO train_model: Preparing target variable...
[2025-07-16 20:39:24] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:39:24] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:39:24] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 20:39:24] INFO train_model: Dropping NaN targets...
[2025-07-16 20:39:24] INFO train_model: Class distribution: [977 439]
[2025-07-16 20:39:24] INFO train_model: Upsampling successful.
[2025-07-16 20:39:24] INFO train_model: Splitting train/test...
[2025-07-16 20:39:24] INFO train_model: Scaling features...
[2025-07-16 20:39:24] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 20:39:24] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 20:39:25] INFO train_model: Model fit complete.
[2025-07-16 20:39:25] INFO train_model: Model Accuracy: 0.5754
[2025-07-16 20:39:25] INFO train_model: 
Classification Report:
[2025-07-16 20:39:25] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.73      0.63       196
           1       0.61      0.42      0.49       195

    accuracy                           0.58       391
   macro avg       0.58      0.58      0.56       391
weighted avg       0.58      0.58      0.56       391

[2025-07-16 20:39:25] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 20:39:25] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 20:39:25] INFO train_model: Feature distributions before training:
[2025-07-16 20:39:25] INFO train_model: supply_zone: mean=0.4421, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: demand_zone: mean=0.3828, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_markdown: mean=0.4682, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_markup: mean=0.5035, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: rising_wedge: mean=0.2521, std=0.4344, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: falling_wedge: mean=0.1970, std=0.3979, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:39:25] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:39:25] INFO train_model: Auditing data quality before training...
[2025-07-16 20:39:25] INFO train_model: Entering audit_data_quality
[2025-07-16 20:57:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: Model is starting a new training session...
[2025-07-16 20:57:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 20:57:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:57:29] INFO train_model: Preparing target variable...
[2025-07-16 20:57:29] INFO train_model: Entering prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: Exiting prepare_target_variable
[2025-07-16 20:57:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 20:57:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 20:57:29] INFO train_model: Dropping NaN targets...
[2025-07-16 20:57:29] INFO train_model: Class distribution: [977 439]
[2025-07-16 20:57:29] INFO train_model: Upsampling successful.
[2025-07-16 20:57:29] INFO train_model: Splitting train/test...
[2025-07-16 20:57:29] INFO train_model: Scaling features...
[2025-07-16 20:57:29] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 20:57:29] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 20:57:30] INFO train_model: Model fit complete.
[2025-07-16 20:57:30] INFO train_model: Model Accuracy: 0.5754
[2025-07-16 20:57:30] INFO train_model: 
Classification Report:
[2025-07-16 20:57:30] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.73      0.63       196
           1       0.61      0.42      0.49       195

    accuracy                           0.58       391
   macro avg       0.58      0.58      0.56       391
weighted avg       0.58      0.58      0.56       391

[2025-07-16 20:57:30] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 20:57:30] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 20:57:30] INFO train_model: Feature distributions before training:
[2025-07-16 20:57:30] INFO train_model: supply_zone: mean=0.4421, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: demand_zone: mean=0.3828, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_markdown: mean=0.4682, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_markup: mean=0.5035, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1755, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: rising_wedge: mean=0.2521, std=0.4344, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: falling_wedge: mean=0.1970, std=0.3979, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 20:57:30] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 20:57:30] INFO train_model: Auditing data quality before training...
[2025-07-16 20:57:31] INFO train_model: Entering audit_data_quality
[2025-07-16 21:17:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: Model is starting a new training session...
[2025-07-16 21:17:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 21:17:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:17:47] INFO train_model: Preparing target variable...
[2025-07-16 21:17:47] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:17:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:17:47] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 21:17:47] INFO train_model: Dropping NaN targets...
[2025-07-16 21:17:48] INFO train_model: Class distribution: [978 439]
[2025-07-16 21:17:48] INFO train_model: Upsampling successful.
[2025-07-16 21:17:48] INFO train_model: Splitting train/test...
[2025-07-16 21:17:48] INFO train_model: Scaling features...
[2025-07-16 21:17:48] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 21:17:48] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 21:17:48] INFO train_model: Model fit complete.
[2025-07-16 21:17:48] INFO train_model: Model Accuracy: 0.5689
[2025-07-16 21:17:48] INFO train_model: 
Classification Report:
[2025-07-16 21:17:48] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.56      0.56       196
           1       0.57      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 21:17:48] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 21:17:48] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 21:17:48] INFO train_model: Feature distributions before training:
[2025-07-16 21:17:48] INFO train_model: supply_zone: mean=0.4418, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: demand_zone: mean=0.3825, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_markdown: mean=0.4679, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_markup: mean=0.5039, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: rising_wedge: mean=0.2519, std=0.4343, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: falling_wedge: mean=0.1976, std=0.3983, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:17:48] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:17:48] INFO train_model: Auditing data quality before training...
[2025-07-16 21:17:48] INFO train_model: Entering audit_data_quality
[2025-07-16 21:50:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: Model is starting a new training session...
[2025-07-16 21:50:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 21:50:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:50:56] INFO train_model: Preparing target variable...
[2025-07-16 21:50:56] INFO train_model: Entering prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: Exiting prepare_target_variable
[2025-07-16 21:50:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 21:50:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 21:50:56] INFO train_model: Dropping NaN targets...
[2025-07-16 21:50:56] INFO train_model: Class distribution: [978 439]
[2025-07-16 21:50:56] INFO train_model: Upsampling successful.
[2025-07-16 21:50:56] INFO train_model: Splitting train/test...
[2025-07-16 21:50:56] INFO train_model: Scaling features...
[2025-07-16 21:50:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 21:50:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 21:50:57] INFO train_model: Model fit complete.
[2025-07-16 21:50:57] INFO train_model: Model Accuracy: 0.5689
[2025-07-16 21:50:57] INFO train_model: 
Classification Report:
[2025-07-16 21:50:57] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.56      0.56       196
           1       0.57      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 21:50:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 21:50:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 21:50:57] INFO train_model: Feature distributions before training:
[2025-07-16 21:50:57] INFO train_model: supply_zone: mean=0.4418, std=0.4968, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: demand_zone: mean=0.3825, std=0.4862, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_markdown: mean=0.4679, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_markup: mean=0.5039, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1657, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: rising_wedge: mean=0.2519, std=0.4343, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: falling_wedge: mean=0.1976, std=0.3983, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 21:50:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 21:50:57] INFO train_model: Auditing data quality before training...
[2025-07-16 21:50:57] INFO train_model: Entering audit_data_quality
[2025-07-16 22:01:53] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: Model is starting a new training session...
[2025-07-16 22:01:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:01:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:01:53] INFO train_model: Preparing target variable...
[2025-07-16 22:01:53] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:01:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:01:53] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:01:53] INFO train_model: Dropping NaN targets...
[2025-07-16 22:01:53] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:01:53] INFO train_model: Upsampling successful.
[2025-07-16 22:01:53] INFO train_model: Splitting train/test...
[2025-07-16 22:01:53] INFO train_model: Scaling features...
[2025-07-16 22:01:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:01:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:01:54] INFO train_model: Model fit complete.
[2025-07-16 22:01:54] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:01:54] INFO train_model: 
Classification Report:
[2025-07-16 22:01:54] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:01:54] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:01:54] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:01:54] INFO train_model: Feature distributions before training:
[2025-07-16 22:01:54] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:01:54] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:01:54] INFO train_model: Auditing data quality before training...
[2025-07-16 22:01:54] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:10] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:09:10] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:09:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:09:10] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:13] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:09:13] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:09:13] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:09:13] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:16] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:16] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:09:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:16] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:09:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:16] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:09:17] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:09:17] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:09:17] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:17] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:09:17] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:09:17] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:09:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: Model is starting a new training session...
[2025-07-16 22:09:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:09:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:18] INFO train_model: Preparing target variable...
[2025-07-16 22:09:18] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:09:18] INFO train_model: Dropping NaN targets...
[2025-07-16 22:09:18] INFO train_model: Class distribution: [817 621]
[2025-07-16 22:09:18] INFO train_model: Upsampling successful.
[2025-07-16 22:09:18] INFO train_model: Splitting train/test...
[2025-07-16 22:09:18] INFO train_model: Scaling features...
[2025-07-16 22:09:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:09:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:09:18] INFO train_model: Model fit complete.
[2025-07-16 22:09:18] INFO train_model: Model Accuracy: 0.5443
[2025-07-16 22:09:18] INFO train_model: 
Classification Report:
[2025-07-16 22:09:18] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.63      0.58       164
           1       0.55      0.46      0.50       163

    accuracy                           0.54       327
   macro avg       0.55      0.54      0.54       327
weighted avg       0.55      0.54      0.54       327

[2025-07-16 22:09:18] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:09:18] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:09:18] INFO train_model: Feature distributions before training:
[2025-07-16 22:09:18] INFO train_model: supply_zone: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: demand_zone: mean=0.1996, std=0.3998, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_distribution: mean=0.1328, std=0.3395, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_markdown: mean=0.3811, std=0.4858, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_markup: mean=0.4576, std=0.4984, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1645, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: head_shoulders: mean=0.0341, std=0.1815, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: inv_head_shoulders: mean=0.0327, std=0.1779, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:18] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:18] INFO train_model: rising_wedge: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: falling_wedge: mean=0.2497, std=0.4330, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: fakeout_up: mean=0.0049, std=0.0696, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: fakeout_down: mean=0.0063, std=0.0789, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:18] INFO train_model: Auditing data quality before training...
[2025-07-16 22:09:18] INFO train_model: Entering audit_data_quality
[2025-07-16 22:09:32] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: Model is starting a new training session...
[2025-07-16 22:09:32] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:09:32] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:32] INFO train_model: Preparing target variable...
[2025-07-16 22:09:32] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:09:32] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:09:32] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:09:32] INFO train_model: Dropping NaN targets...
[2025-07-16 22:09:32] INFO train_model: Class distribution: [817 621]
[2025-07-16 22:09:32] INFO train_model: Upsampling successful.
[2025-07-16 22:09:32] INFO train_model: Splitting train/test...
[2025-07-16 22:09:32] INFO train_model: Scaling features...
[2025-07-16 22:09:32] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:09:32] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:09:33] INFO train_model: Model fit complete.
[2025-07-16 22:09:33] INFO train_model: Model Accuracy: 0.5443
[2025-07-16 22:09:33] INFO train_model: 
Classification Report:
[2025-07-16 22:09:33] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.63      0.58       164
           1       0.55      0.46      0.50       163

    accuracy                           0.54       327
   macro avg       0.55      0.54      0.54       327
weighted avg       0.55      0.54      0.54       327

[2025-07-16 22:09:33] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:09:33] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:09:33] INFO train_model: Feature distributions before training:
[2025-07-16 22:09:33] INFO train_model: supply_zone: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: demand_zone: mean=0.1996, std=0.3998, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_distribution: mean=0.1328, std=0.3395, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_markdown: mean=0.3811, std=0.4858, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_markup: mean=0.4576, std=0.4984, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1645, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: head_shoulders: mean=0.0341, std=0.1815, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: inv_head_shoulders: mean=0.0327, std=0.1779, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:33] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:09:33] INFO train_model: rising_wedge: mean=0.2733, std=0.4458, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: falling_wedge: mean=0.2497, std=0.4330, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: fakeout_up: mean=0.0049, std=0.0696, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: fakeout_down: mean=0.0063, std=0.0789, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:09:33] INFO train_model: Auditing data quality before training...
[2025-07-16 22:09:33] INFO train_model: Entering audit_data_quality
[2025-07-16 22:10:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: Model is starting a new training session...
[2025-07-16 22:10:40] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:10:40] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:10:40] INFO train_model: Preparing target variable...
[2025-07-16 22:10:40] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:10:40] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:10:40] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:10:40] INFO train_model: Dropping NaN targets...
[2025-07-16 22:10:40] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:10:40] INFO train_model: Upsampling successful.
[2025-07-16 22:10:40] INFO train_model: Splitting train/test...
[2025-07-16 22:10:40] INFO train_model: Scaling features...
[2025-07-16 22:10:40] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:10:40] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:10:40] INFO train_model: Model fit complete.
[2025-07-16 22:10:40] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:10:40] INFO train_model: 
Classification Report:
[2025-07-16 22:10:40] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:10:40] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:10:40] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:10:40] INFO train_model: Feature distributions before training:
[2025-07-16 22:10:40] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:10:40] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:10:40] INFO train_model: Auditing data quality before training...
[2025-07-16 22:10:41] INFO train_model: Entering audit_data_quality
[2025-07-16 22:16:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: Model is starting a new training session...
[2025-07-16 22:16:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:16:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:16:13] INFO train_model: Preparing target variable...
[2025-07-16 22:16:13] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:16:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:16:13] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:16:13] INFO train_model: Dropping NaN targets...
[2025-07-16 22:16:13] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:16:13] INFO train_model: Upsampling successful.
[2025-07-16 22:16:13] INFO train_model: Splitting train/test...
[2025-07-16 22:16:13] INFO train_model: Scaling features...
[2025-07-16 22:16:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:16:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:16:14] INFO train_model: Model fit complete.
[2025-07-16 22:16:14] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:16:14] INFO train_model: 
Classification Report:
[2025-07-16 22:16:14] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:16:14] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:16:14] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:16:14] INFO train_model: Feature distributions before training:
[2025-07-16 22:16:14] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:16:14] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:16:14] INFO train_model: Auditing data quality before training...
[2025-07-16 22:16:14] INFO train_model: Entering audit_data_quality
[2025-07-16 22:38:22] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: Model is starting a new training session...
[2025-07-16 22:38:22] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:38:22] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:38:22] INFO train_model: Preparing target variable...
[2025-07-16 22:38:22] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:38:22] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:38:22] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:38:22] INFO train_model: Dropping NaN targets...
[2025-07-16 22:38:22] INFO train_model: Class distribution: [979 439]
[2025-07-16 22:38:22] INFO train_model: Upsampling successful.
[2025-07-16 22:38:22] INFO train_model: Splitting train/test...
[2025-07-16 22:38:22] INFO train_model: Scaling features...
[2025-07-16 22:38:22] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:38:22] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:38:22] INFO train_model: Model fit complete.
[2025-07-16 22:38:22] INFO train_model: Model Accuracy: 0.5663
[2025-07-16 22:38:22] INFO train_model: 
Classification Report:
[2025-07-16 22:38:22] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.55      0.56       196
           1       0.56      0.58      0.57       196

    accuracy                           0.57       392
   macro avg       0.57      0.57      0.57       392
weighted avg       0.57      0.57      0.57       392

[2025-07-16 22:38:23] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:38:23] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:38:23] INFO train_model: Feature distributions before training:
[2025-07-16 22:38:23] INFO train_model: supply_zone: mean=0.4415, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: demand_zone: mean=0.3822, std=0.4861, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_markdown: mean=0.4676, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_markup: mean=0.5042, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: rising_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: falling_wedge: mean=0.1982, std=0.3988, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: fakeout_up: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:38:23] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:38:23] INFO train_model: Auditing data quality before training...
[2025-07-16 22:38:23] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:35] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:35] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:58:35] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:58:35] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:58:35] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:37] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:37] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:58:37] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:37] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:58:37] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:37] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:58:38] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: double_bottom
[2025-07-16 22:58:38] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:58:38] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:58:38] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:41] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: Model is starting a new training session...
[2025-07-16 22:58:41] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 22:58:41] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:58:41] INFO train_model: Preparing target variable...
[2025-07-16 22:58:41] INFO train_model: Entering prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: Exiting prepare_target_variable
[2025-07-16 22:58:41] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 22:58:41] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 22:58:41] INFO train_model: Dropping NaN targets...
[2025-07-16 22:58:41] INFO train_model: Class distribution: [1036  383]
[2025-07-16 22:58:41] INFO train_model: Upsampling successful.
[2025-07-16 22:58:41] INFO train_model: Splitting train/test...
[2025-07-16 22:58:41] INFO train_model: Scaling features...
[2025-07-16 22:58:41] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 22:58:41] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 22:58:41] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:41] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-16 22:58:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:42] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-16 22:58:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-16 22:58:42] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-16 22:58:42] INFO train_model: Model fit complete.
[2025-07-16 22:58:42] INFO train_model: Model Accuracy: 0.5735
[2025-07-16 22:58:42] INFO train_model: 
Classification Report:
[2025-07-16 22:58:42] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.64      0.60       208
           1       0.58      0.51      0.54       207

    accuracy                           0.57       415
   macro avg       0.57      0.57      0.57       415
weighted avg       0.57      0.57      0.57       415

[2025-07-16 22:58:42] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 22:58:42] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 22:58:42] INFO train_model: Feature distributions before training:
[2025-07-16 22:58:42] INFO train_model: supply_zone: mean=0.4172, std=0.4933, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: demand_zone: mean=0.4799, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_markdown: mean=0.5292, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_markup: mean=0.4426, std=0.4969, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: head_shoulders: mean=0.0338, std=0.1808, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: inv_head_shoulders: mean=0.0310, std=0.1734, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: double_bottom: mean=0.0127, std=0.1120, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: rising_wedge: mean=0.2030, std=0.4023, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: falling_wedge: mean=0.2241, std=0.4171, min=0.0000, max=1.0000, unique=2
[2025-07-16 22:58:42] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 22:58:42] INFO train_model: Auditing data quality before training...
[2025-07-16 22:58:42] INFO train_model: Entering audit_data_quality
[2025-07-16 22:58:45] INFO train_model: Exiting audit_data_quality
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: double_top
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-16 22:58:45] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-16 22:58:45] INFO train_model: Auditing data quality after removing constant features...
[2025-07-16 22:58:45] INFO train_model: Entering audit_data_quality
[2025-07-16 23:03:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: Model is starting a new training session...
[2025-07-16 23:03:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 23:03:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:03:52] INFO train_model: Preparing target variable...
[2025-07-16 23:03:52] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:03:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:03:52] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 23:03:52] INFO train_model: Dropping NaN targets...
[2025-07-16 23:03:52] INFO train_model: Class distribution: [980 439]
[2025-07-16 23:03:52] INFO train_model: Upsampling successful.
[2025-07-16 23:03:52] INFO train_model: Splitting train/test...
[2025-07-16 23:03:52] INFO train_model: Scaling features...
[2025-07-16 23:03:52] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 23:03:52] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 23:03:53] INFO train_model: Model fit complete.
[2025-07-16 23:03:53] INFO train_model: Model Accuracy: 0.5944
[2025-07-16 23:03:53] INFO train_model: 
Classification Report:
[2025-07-16 23:03:53] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.76      0.65       196
           1       0.64      0.43      0.52       196

    accuracy                           0.59       392
   macro avg       0.61      0.59      0.58       392
weighted avg       0.61      0.59      0.58       392

[2025-07-16 23:03:53] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 23:03:53] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 23:03:53] INFO train_model: Feature distributions before training:
[2025-07-16 23:03:53] INFO train_model: supply_zone: mean=0.4412, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: demand_zone: mean=0.3820, std=0.4860, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_markdown: mean=0.4672, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_markup: mean=0.5046, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: rising_wedge: mean=0.2516, std=0.4341, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: falling_wedge: mean=0.1987, std=0.3992, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: fakeout_up: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:03:53] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:03:53] INFO train_model: Auditing data quality before training...
[2025-07-16 23:03:53] INFO train_model: Entering audit_data_quality
[2025-07-16 23:53:30] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: Model is starting a new training session...
[2025-07-16 23:53:30] INFO train_model: Model is cleaning and preparing data...
[2025-07-16 23:53:30] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:53:30] INFO train_model: Preparing target variable...
[2025-07-16 23:53:30] INFO train_model: Entering prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: Exiting prepare_target_variable
[2025-07-16 23:53:30] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-16 23:53:30] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-16 23:53:30] INFO train_model: Dropping NaN targets...
[2025-07-16 23:53:30] INFO train_model: Class distribution: [980 439]
[2025-07-16 23:53:30] INFO train_model: Upsampling successful.
[2025-07-16 23:53:30] INFO train_model: Splitting train/test...
[2025-07-16 23:53:30] INFO train_model: Scaling features...
[2025-07-16 23:53:30] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-16 23:53:30] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-16 23:53:31] INFO train_model: Model fit complete.
[2025-07-16 23:53:31] INFO train_model: Model Accuracy: 0.5944
[2025-07-16 23:53:31] INFO train_model: 
Classification Report:
[2025-07-16 23:53:31] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.76      0.65       196
           1       0.64      0.43      0.52       196

    accuracy                           0.59       392
   macro avg       0.61      0.59      0.58       392
weighted avg       0.61      0.59      0.58       392

[2025-07-16 23:53:31] INFO train_model: Model is saving trained model and scaler...
[2025-07-16 23:53:31] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-16 23:53:31] INFO train_model: Feature distributions before training:
[2025-07-16 23:53:31] INFO train_model: supply_zone: mean=0.4412, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: demand_zone: mean=0.3820, std=0.4860, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_markdown: mean=0.4672, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_markup: mean=0.5046, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: rising_wedge: mean=0.2516, std=0.4341, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: falling_wedge: mean=0.1987, std=0.3992, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: fakeout_up: mean=0.0007, std=0.0265, min=0.0000, max=1.0000, unique=2
[2025-07-16 23:53:31] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-16 23:53:31] INFO train_model: Auditing data quality before training...
[2025-07-16 23:53:31] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:26] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: Model is starting a new training session...
[2025-07-17 00:00:26] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:00:26] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:26] INFO train_model: Preparing target variable...
[2025-07-17 00:00:26] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:26] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:26] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:00:26] INFO train_model: Dropping NaN targets...
[2025-07-17 00:00:26] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:00:26] INFO train_model: Upsampling successful.
[2025-07-17 00:00:26] INFO train_model: Splitting train/test...
[2025-07-17 00:00:26] INFO train_model: Scaling features...
[2025-07-17 00:00:26] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:00:26] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:00:27] INFO train_model: Model fit complete.
[2025-07-17 00:00:27] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:00:27] INFO train_model: 
Classification Report:
[2025-07-17 00:00:27] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:00:27] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:00:27] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:00:27] INFO train_model: Feature distributions before training:
[2025-07-17 00:00:27] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:27] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:27] INFO train_model: Auditing data quality before training...
[2025-07-17 00:00:27] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:28] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:00:28] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 00:00:28] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:00:28] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:28] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:28] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:00:28] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:28] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:00:28] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:28] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:00:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: Model is starting a new training session...
[2025-07-17 00:00:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:00:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:56] INFO train_model: Preparing target variable...
[2025-07-17 00:00:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:00:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:00:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:00:56] INFO train_model: Dropping NaN targets...
[2025-07-17 00:00:56] INFO train_model: Class distribution: [817 622]
[2025-07-17 00:00:56] INFO train_model: Upsampling successful.
[2025-07-17 00:00:56] INFO train_model: Splitting train/test...
[2025-07-17 00:00:56] INFO train_model: Scaling features...
[2025-07-17 00:00:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:00:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:00:57] INFO train_model: Model fit complete.
[2025-07-17 00:00:57] INFO train_model: Model Accuracy: 0.5443
[2025-07-17 00:00:57] INFO train_model: 
Classification Report:
[2025-07-17 00:00:57] INFO train_model:               precision    recall  f1-score   support

           0       0.54      0.63      0.58       164
           1       0.55      0.46      0.50       163

    accuracy                           0.54       327
   macro avg       0.55      0.54      0.54       327
weighted avg       0.55      0.54      0.54       327

[2025-07-17 00:00:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:00:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:00:57] INFO train_model: Feature distributions before training:
[2025-07-17 00:00:57] INFO train_model: supply_zone: mean=0.2731, std=0.4457, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: demand_zone: mean=0.1994, std=0.3997, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_distribution: mean=0.1334, std=0.3402, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_markdown: mean=0.3808, std=0.4858, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_markup: mean=0.4573, std=0.4983, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1644, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: head_shoulders: mean=0.0341, std=0.1814, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: inv_head_shoulders: mean=0.0327, std=0.1778, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:00:57] INFO train_model: rising_wedge: mean=0.2731, std=0.4457, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: falling_wedge: mean=0.2495, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: fakeout_up: mean=0.0049, std=0.0696, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: fakeout_down: mean=0.0063, std=0.0789, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:00:57] INFO train_model: Auditing data quality before training...
[2025-07-17 00:00:57] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:57] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:00:57] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:00:57] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:00:57] INFO train_model: Entering audit_data_quality
[2025-07-17 00:00:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:00:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:00:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:00:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:00:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:01:19] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: Model is starting a new training session...
[2025-07-17 00:01:19] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:01:19] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:19] INFO train_model: Preparing target variable...
[2025-07-17 00:01:19] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:19] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:19] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:01:19] INFO train_model: Dropping NaN targets...
[2025-07-17 00:01:19] INFO train_model: Class distribution: [1021  374]
[2025-07-17 00:01:19] INFO train_model: Upsampling successful.
[2025-07-17 00:01:19] INFO train_model: Splitting train/test...
[2025-07-17 00:01:19] INFO train_model: Scaling features...
[2025-07-17 00:01:19] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:01:19] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:01:20] INFO train_model: Model fit complete.
[2025-07-17 00:01:20] INFO train_model: Model Accuracy: 0.5697
[2025-07-17 00:01:20] INFO train_model: 
Classification Report:
[2025-07-17 00:01:20] INFO train_model:               precision    recall  f1-score   support

           0       0.56      0.65      0.60       205
           1       0.58      0.49      0.53       204

    accuracy                           0.57       409
   macro avg       0.57      0.57      0.57       409
weighted avg       0.57      0.57      0.57       409

[2025-07-17 00:01:20] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:01:20] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:01:20] INFO train_model: Feature distributions before training:
[2025-07-17 00:01:20] INFO train_model: supply_zone: mean=0.4172, std=0.4933, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: demand_zone: mean=0.4810, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_markdown: mean=0.5333, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_markup: mean=0.4380, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1669, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: head_shoulders: mean=0.0337, std=0.1805, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: inv_head_shoulders: mean=0.0308, std=0.1729, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: double_bottom: mean=0.0108, std=0.1032, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: rising_wedge: mean=0.2029, std=0.4023, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: falling_wedge: mean=0.2237, std=0.4168, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:20] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:20] INFO train_model: Auditing data quality before training...
[2025-07-17 00:01:20] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-17 00:01:21] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 00:01:21] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:01:21] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:01:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:01:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:01:43] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: Model is starting a new training session...
[2025-07-17 00:01:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:01:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:43] INFO train_model: Preparing target variable...
[2025-07-17 00:01:43] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:01:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:01:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:01:43] INFO train_model: Dropping NaN targets...
[2025-07-17 00:01:43] INFO train_model: Class distribution: [950 453]
[2025-07-17 00:01:43] INFO train_model: Upsampling successful.
[2025-07-17 00:01:43] INFO train_model: Splitting train/test...
[2025-07-17 00:01:43] INFO train_model: Scaling features...
[2025-07-17 00:01:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:01:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:01:44] INFO train_model: Model fit complete.
[2025-07-17 00:01:44] INFO train_model: Model Accuracy: 0.5895
[2025-07-17 00:01:44] INFO train_model: 
Classification Report:
[2025-07-17 00:01:44] INFO train_model:               precision    recall  f1-score   support

           0       0.58      0.62      0.60       190
           1       0.60      0.56      0.58       190

    accuracy                           0.59       380
   macro avg       0.59      0.59      0.59       380
weighted avg       0.59      0.59      0.59       380

[2025-07-17 00:01:44] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:01:44] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:01:44] INFO train_model: Feature distributions before training:
[2025-07-17 00:01:44] INFO train_model: supply_zone: mean=0.4669, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: demand_zone: mean=0.3699, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_markdown: mean=0.4120, std=0.4924, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_markup: mean=0.5595, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_unknown: mean=0.0285, std=0.1665, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:01:44] INFO train_model: head_shoulders: mean=0.0342, std=0.1818, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: inv_head_shoulders: mean=0.0278, std=0.1645, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: double_top: mean=0.0043, std=0.0653, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: double_bottom: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: rising_wedge: mean=0.2894, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: falling_wedge: mean=0.2438, std=0.4295, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: fakeout_up: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: fakeout_down: mean=0.0007, std=0.0267, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:01:44] INFO train_model: Auditing data quality before training...
[2025-07-17 00:01:44] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:01:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:01:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:01:44] INFO train_model: Entering audit_data_quality
[2025-07-17 00:01:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:01:44] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:01:44] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:44] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:01:44] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:01:44] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:02:10] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: Model is starting a new training session...
[2025-07-17 00:02:10] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:02:10] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:02:10] INFO train_model: Preparing target variable...
[2025-07-17 00:02:10] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:02:10] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:02:10] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:02:10] INFO train_model: Dropping NaN targets...
[2025-07-17 00:02:10] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:02:10] INFO train_model: Upsampling successful.
[2025-07-17 00:02:10] INFO train_model: Splitting train/test...
[2025-07-17 00:02:10] INFO train_model: Scaling features...
[2025-07-17 00:02:10] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:02:10] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:02:11] INFO train_model: Model fit complete.
[2025-07-17 00:02:11] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:02:11] INFO train_model: 
Classification Report:
[2025-07-17 00:02:11] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:02:11] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:02:11] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:02:11] INFO train_model: Feature distributions before training:
[2025-07-17 00:02:11] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:02:11] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:02:11] INFO train_model: Auditing data quality before training...
[2025-07-17 00:02:12] INFO train_model: Entering audit_data_quality
[2025-07-17 00:12:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: Model is starting a new training session...
[2025-07-17 00:12:51] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:12:51] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:12:51] INFO train_model: Preparing target variable...
[2025-07-17 00:12:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:12:51] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:12:51] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:12:51] INFO train_model: Dropping NaN targets...
[2025-07-17 00:12:51] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:12:51] INFO train_model: Upsampling successful.
[2025-07-17 00:12:51] INFO train_model: Splitting train/test...
[2025-07-17 00:12:51] INFO train_model: Scaling features...
[2025-07-17 00:12:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:12:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:12:51] INFO train_model: Model fit complete.
[2025-07-17 00:12:51] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:12:51] INFO train_model: 
Classification Report:
[2025-07-17 00:12:51] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:12:51] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:12:51] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:12:51] INFO train_model: Feature distributions before training:
[2025-07-17 00:12:51] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:12:51] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:12:51] INFO train_model: Auditing data quality before training...
[2025-07-17 00:12:52] INFO train_model: Entering audit_data_quality
[2025-07-17 00:19:43] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:19:43] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 00:19:43] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:19:43] INFO train_model: Entering audit_data_quality
[2025-07-17 00:19:47] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:19:47] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 00:19:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:19:47] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 00:19:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 00:19:47] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 00:19:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: Model is starting a new training session...
[2025-07-17 00:19:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:19:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:19:55] INFO train_model: Preparing target variable...
[2025-07-17 00:19:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:19:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:19:55] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:19:55] INFO train_model: Dropping NaN targets...
[2025-07-17 00:19:55] INFO train_model: Class distribution: [818 622]
[2025-07-17 00:19:55] INFO train_model: Upsampling successful.
[2025-07-17 00:19:55] INFO train_model: Splitting train/test...
[2025-07-17 00:19:55] INFO train_model: Scaling features...
[2025-07-17 00:19:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:19:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:19:55] INFO train_model: Model fit complete.
[2025-07-17 00:19:55] INFO train_model: Model Accuracy: 0.5549
[2025-07-17 00:19:55] INFO train_model: 
Classification Report:
[2025-07-17 00:19:55] INFO train_model:               precision    recall  f1-score   support

           0       0.60      0.34      0.43       164
           1       0.54      0.77      0.64       164

    accuracy                           0.55       328
   macro avg       0.57      0.55      0.53       328
weighted avg       0.57      0.55      0.53       328

[2025-07-17 00:19:55] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:19:55] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:19:55] INFO train_model: Feature distributions before training:
[2025-07-17 00:19:55] INFO train_model: supply_zone: mean=0.2729, std=0.4456, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: demand_zone: mean=0.1993, std=0.3996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0264, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_distribution: mean=0.1340, std=0.3408, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_markdown: mean=0.3806, std=0.4857, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_markup: mean=0.4569, std=0.4983, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: wyckoff_unknown: mean=0.0278, std=0.1644, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: head_shoulders: mean=0.0340, std=0.1814, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1778, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:19:55] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:19:55] INFO train_model: rising_wedge: mean=0.2729, std=0.4456, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: falling_wedge: mean=0.2493, std=0.4328, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: fakeout_up: mean=0.0056, std=0.0744, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: fakeout_down: mean=0.0063, std=0.0788, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:19:55] INFO train_model: Auditing data quality before training...
[2025-07-17 00:19:55] INFO train_model: Entering audit_data_quality
[2025-07-17 00:20:01] INFO train_model: Exiting audit_data_quality
[2025-07-17 00:20:01] WARNING train_model: Removing constant feature: double_top
[2025-07-17 00:20:01] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 00:20:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 00:20:01] INFO train_model: Entering audit_data_quality
[2025-07-17 00:37:25] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: Model is starting a new training session...
[2025-07-17 00:37:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:37:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:37:25] INFO train_model: Preparing target variable...
[2025-07-17 00:37:25] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:37:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:37:25] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:37:25] INFO train_model: Dropping NaN targets...
[2025-07-17 00:37:25] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:37:25] INFO train_model: Upsampling successful.
[2025-07-17 00:37:25] INFO train_model: Splitting train/test...
[2025-07-17 00:37:25] INFO train_model: Scaling features...
[2025-07-17 00:37:25] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:37:25] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:37:26] INFO train_model: Model fit complete.
[2025-07-17 00:37:26] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:37:26] INFO train_model: 
Classification Report:
[2025-07-17 00:37:26] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:37:26] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:37:26] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:37:26] INFO train_model: Feature distributions before training:
[2025-07-17 00:37:26] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:37:26] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:37:26] INFO train_model: Auditing data quality before training...
[2025-07-17 00:37:26] INFO train_model: Entering audit_data_quality
[2025-07-17 00:42:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: Model is starting a new training session...
[2025-07-17 00:42:36] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 00:42:36] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:42:36] INFO train_model: Preparing target variable...
[2025-07-17 00:42:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 00:42:36] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 00:42:36] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 00:42:36] INFO train_model: Dropping NaN targets...
[2025-07-17 00:42:36] INFO train_model: Class distribution: [961 433]
[2025-07-17 00:42:36] INFO train_model: Upsampling successful.
[2025-07-17 00:42:36] INFO train_model: Splitting train/test...
[2025-07-17 00:42:36] INFO train_model: Scaling features...
[2025-07-17 00:42:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 00:42:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 00:42:37] INFO train_model: Model fit complete.
[2025-07-17 00:42:37] INFO train_model: Model Accuracy: 0.5506
[2025-07-17 00:42:37] INFO train_model: 
Classification Report:
[2025-07-17 00:42:37] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.44      0.50       193
           1       0.54      0.66      0.59       192

    accuracy                           0.55       385
   macro avg       0.55      0.55      0.55       385
weighted avg       0.55      0.55      0.55       385

[2025-07-17 00:42:37] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 00:42:37] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 00:42:37] INFO train_model: Feature distributions before training:
[2025-07-17 00:42:37] INFO train_model: supply_zone: mean=0.4455, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: demand_zone: mean=0.3780, std=0.4851, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_markdown: mean=0.4756, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_markup: mean=0.4957, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1670, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: inv_head_shoulders: mean=0.0316, std=0.1749, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: rising_wedge: mean=0.2539, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: falling_wedge: mean=0.2009, std=0.4008, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 00:42:37] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 00:42:37] INFO train_model: Auditing data quality before training...
[2025-07-17 00:42:37] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:05] INFO train_model: Preparing target variable...
[2025-07-17 01:30:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:05] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:05] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:05] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:05] INFO train_model: Class distribution: [961 434]
[2025-07-17 01:30:05] INFO train_model: Upsampling successful.
[2025-07-17 01:30:05] INFO train_model: Splitting train/test...
[2025-07-17 01:30:05] INFO train_model: Scaling features...
[2025-07-17 01:30:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:06] INFO train_model: Model fit complete.
[2025-07-17 01:30:06] INFO train_model: Model Accuracy: 0.5455
[2025-07-17 01:30:06] INFO train_model: 
Classification Report:
[2025-07-17 01:30:06] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.74      0.62       193
           1       0.57      0.35      0.43       192

    accuracy                           0.55       385
   macro avg       0.55      0.54      0.53       385
weighted avg       0.55      0.55      0.53       385

[2025-07-17 01:30:06] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:06] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:06] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:06] INFO train_model: supply_zone: mean=0.4452, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: demand_zone: mean=0.3778, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_markdown: mean=0.4753, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_markup: mean=0.4961, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1669, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: head_shoulders: mean=0.0315, std=0.1748, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: inv_head_shoulders: mean=0.0315, std=0.1748, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: rising_wedge: mean=0.2538, std=0.4353, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: falling_wedge: mean=0.2014, std=0.4012, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: fakeout_up: mean=0.0007, std=0.0268, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:06] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:06] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:06] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:30:06] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 01:30:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:06] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:07] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:30:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:08] INFO train_model: Preparing target variable...
[2025-07-17 01:30:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:08] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:08] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:08] INFO train_model: Class distribution: [809 605]
[2025-07-17 01:30:08] INFO train_model: Upsampling successful.
[2025-07-17 01:30:08] INFO train_model: Splitting train/test...
[2025-07-17 01:30:08] INFO train_model: Scaling features...
[2025-07-17 01:30:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:09] INFO train_model: Model fit complete.
[2025-07-17 01:30:09] INFO train_model: Model Accuracy: 0.4938
[2025-07-17 01:30:09] INFO train_model: 
Classification Report:
[2025-07-17 01:30:09] INFO train_model:               precision    recall  f1-score   support

           0       0.49      0.51      0.50       162
           1       0.49      0.48      0.48       162

    accuracy                           0.49       324
   macro avg       0.49      0.49      0.49       324
weighted avg       0.49      0.49      0.49       324

[2025-07-17 01:30:09] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:09] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:09] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:09] INFO train_model: supply_zone: mean=0.2624, std=0.4401, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: demand_zone: mean=0.2016, std=0.4013, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_distribution: mean=0.1337, std=0.3404, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_markdown: mean=0.3854, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_markup: mean=0.4519, std=0.4979, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: wyckoff_unknown: mean=0.0283, std=0.1659, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: head_shoulders: mean=0.0339, std=0.1812, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1775, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:09] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:09] INFO train_model: rising_wedge: mean=0.2779, std=0.4481, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: falling_wedge: mean=0.2525, std=0.4346, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: fakeout_up: mean=0.0042, std=0.0650, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: fakeout_down: mean=0.0064, std=0.0796, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:09] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:09] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:09] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:09] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:30:09] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:30:09] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:09] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:09] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:30:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:11] INFO train_model: Preparing target variable...
[2025-07-17 01:30:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:11] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:11] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:11] INFO train_model: Class distribution: [1022  374]
[2025-07-17 01:30:11] INFO train_model: Upsampling successful.
[2025-07-17 01:30:11] INFO train_model: Splitting train/test...
[2025-07-17 01:30:11] INFO train_model: Scaling features...
[2025-07-17 01:30:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:11] INFO train_model: Model fit complete.
[2025-07-17 01:30:11] INFO train_model: Model Accuracy: 0.5770
[2025-07-17 01:30:11] INFO train_model: 
Classification Report:
[2025-07-17 01:30:11] INFO train_model:               precision    recall  f1-score   support

           0       0.57      0.63      0.60       205
           1       0.59      0.52      0.55       204

    accuracy                           0.58       409
   macro avg       0.58      0.58      0.58       409
weighted avg       0.58      0.58      0.58       409

[2025-07-17 01:30:11] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:11] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:11] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:11] INFO train_model: supply_zone: mean=0.4169, std=0.4932, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: demand_zone: mean=0.4807, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_markdown: mean=0.5330, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_markup: mean=0.4384, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_unknown: mean=0.0287, std=0.1669, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: head_shoulders: mean=0.0337, std=0.1804, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: inv_head_shoulders: mean=0.0308, std=0.1728, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: double_bottom: mean=0.0107, std=0.1031, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: rising_wedge: mean=0.2027, std=0.4022, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: falling_wedge: mean=0.2235, std=0.4167, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:11] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:11] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:11] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:12] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-17 01:30:12] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 01:30:12] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:12] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:12] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:12] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:12] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:12] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:12] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:12] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:30:13] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: Model is starting a new training session...
[2025-07-17 01:30:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:30:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:13] INFO train_model: Preparing target variable...
[2025-07-17 01:30:13] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:30:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 01:30:13] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 01:30:13] INFO train_model: Dropping NaN targets...
[2025-07-17 01:30:13] INFO train_model: Class distribution: [950 454]
[2025-07-17 01:30:13] INFO train_model: Upsampling successful.
[2025-07-17 01:30:13] INFO train_model: Splitting train/test...
[2025-07-17 01:30:13] INFO train_model: Scaling features...
[2025-07-17 01:30:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:30:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:30:14] INFO train_model: Model fit complete.
[2025-07-17 01:30:14] INFO train_model: Model Accuracy: 0.5895
[2025-07-17 01:30:14] INFO train_model: 
Classification Report:
[2025-07-17 01:30:14] INFO train_model:               precision    recall  f1-score   support

           0       0.58      0.62      0.60       190
           1       0.60      0.56      0.58       190

    accuracy                           0.59       380
   macro avg       0.59      0.59      0.59       380
weighted avg       0.59      0.59      0.59       380

[2025-07-17 01:30:14] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:30:14] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:30:14] INFO train_model: Feature distributions before training:
[2025-07-17 01:30:14] INFO train_model: supply_zone: mean=0.4665, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: demand_zone: mean=0.3697, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_markdown: mean=0.4124, std=0.4924, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_markup: mean=0.5591, std=0.4967, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_unknown: mean=0.0285, std=0.1664, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:30:14] INFO train_model: head_shoulders: mean=0.0342, std=0.1818, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: inv_head_shoulders: mean=0.0278, std=0.1644, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: double_top: mean=0.0043, std=0.0653, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: double_bottom: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: rising_wedge: mean=0.2892, std=0.4535, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: falling_wedge: mean=0.2443, std=0.4298, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: fakeout_up: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: fakeout_down: mean=0.0007, std=0.0267, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:30:14] INFO train_model: Auditing data quality before training...
[2025-07-17 01:30:14] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:14] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:30:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:30:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:30:14] INFO train_model: Entering audit_data_quality
[2025-07-17 01:30:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:30:15] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:30:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:15] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:30:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:30:15] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:41:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: Model is starting a new training session...
[2025-07-17 01:41:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:41:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:41:56] INFO train_model: Preparing target variable...
[2025-07-17 01:41:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:41:56] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:41:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:41:56] INFO train_model: Dropping NaN targets...
[2025-07-17 01:41:56] INFO train_model: Class distribution: [1390  713]
[2025-07-17 01:41:56] INFO train_model: Upsampling successful.
[2025-07-17 01:41:56] INFO train_model: Splitting train/test...
[2025-07-17 01:41:56] INFO train_model: Scaling features...
[2025-07-17 01:41:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:41:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:41:57] INFO train_model: Model fit complete.
[2025-07-17 01:41:57] INFO train_model: Model Accuracy: 0.8849
[2025-07-17 01:41:57] INFO train_model: 
Classification Report:
[2025-07-17 01:41:57] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.86      0.88       278
           1       0.87      0.91      0.89       278

    accuracy                           0.88       556
   macro avg       0.89      0.88      0.88       556
weighted avg       0.89      0.88      0.88       556

[2025-07-17 01:41:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:41:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:41:57] INFO train_model: Feature distributions before training:
[2025-07-17 01:41:57] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:41:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:41:57] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 01:41:57] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 01:41:57] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 01:41:57] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 01:41:57] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 01:41:57] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 01:41:57] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 01:41:57] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 01:41:57] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 01:41:57] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 01:41:57] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 01:41:57] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 01:41:57] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 01:41:57] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 01:41:57] INFO train_model: Auditing data quality before training...
[2025-07-17 01:41:57] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: Model is starting a new training session...
[2025-07-17 01:51:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:51:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:35] INFO train_model: Preparing target variable...
[2025-07-17 01:51:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:35] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:35] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:51:35] INFO train_model: Dropping NaN targets...
[2025-07-17 01:51:35] INFO train_model: Class distribution: [1390  713]
[2025-07-17 01:51:35] INFO train_model: Upsampling successful.
[2025-07-17 01:51:35] INFO train_model: Splitting train/test...
[2025-07-17 01:51:35] INFO train_model: Scaling features...
[2025-07-17 01:51:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:51:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:51:36] INFO train_model: Model fit complete.
[2025-07-17 01:51:36] INFO train_model: Model Accuracy: 0.8849
[2025-07-17 01:51:36] INFO train_model: 
Classification Report:
[2025-07-17 01:51:36] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.87      0.88       278
           1       0.87      0.90      0.89       278

    accuracy                           0.88       556
   macro avg       0.89      0.88      0.88       556
weighted avg       0.89      0.88      0.88       556

[2025-07-17 01:51:36] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:51:36] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:51:36] INFO train_model: Feature distributions before training:
[2025-07-17 01:51:36] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:36] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:36] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 01:51:36] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 01:51:36] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 01:51:36] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 01:51:36] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 01:51:36] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 01:51:36] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 01:51:36] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 01:51:36] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 01:51:36] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 01:51:36] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 01:51:36] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 01:51:36] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 01:51:36] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 01:51:36] INFO train_model: Auditing data quality before training...
[2025-07-17 01:51:36] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:37] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:51:37] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 01:51:37] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:51:37] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:38] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:38] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:51:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:39] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:51:39] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:39] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:51:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: Model is starting a new training session...
[2025-07-17 01:51:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:51:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:53] INFO train_model: Preparing target variable...
[2025-07-17 01:51:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:51:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:51:53] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:51:53] INFO train_model: Dropping NaN targets...
[2025-07-17 01:51:53] INFO train_model: Class distribution: [764 725]
[2025-07-17 01:51:53] INFO train_model: Upsampling successful.
[2025-07-17 01:51:53] INFO train_model: Splitting train/test...
[2025-07-17 01:51:53] INFO train_model: Scaling features...
[2025-07-17 01:51:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:51:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:51:54] INFO train_model: Model fit complete.
[2025-07-17 01:51:54] INFO train_model: Model Accuracy: 0.7974
[2025-07-17 01:51:54] INFO train_model: 
Classification Report:
[2025-07-17 01:51:54] INFO train_model:               precision    recall  f1-score   support

           0       0.76      0.88      0.81       153
           1       0.85      0.72      0.78       153

    accuracy                           0.80       306
   macro avg       0.80      0.80      0.80       306
weighted avg       0.80      0.80      0.80       306

[2025-07-17 01:51:54] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:51:54] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:51:54] INFO train_model: Feature distributions before training:
[2025-07-17 01:51:54] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:51:54] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:51:54] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 01:51:54] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 01:51:54] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 01:51:54] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 01:51:54] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 01:51:54] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 01:51:54] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 01:51:54] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 01:51:54] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 01:51:54] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 01:51:54] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 01:51:54] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 01:51:54] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 01:51:54] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 01:51:54] INFO train_model: Auditing data quality before training...
[2025-07-17 01:51:54] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:55] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: double_top
[2025-07-17 01:51:55] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 01:51:55] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:51:55] INFO train_model: Entering audit_data_quality
[2025-07-17 01:51:56] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:51:56] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:51:56] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:56] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:51:56] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:51:56] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 01:52:02] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: Model is starting a new training session...
[2025-07-17 01:52:02] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 01:52:02] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:52:02] INFO train_model: Preparing target variable...
[2025-07-17 01:52:02] INFO train_model: Entering prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: Exiting prepare_target_variable
[2025-07-17 01:52:02] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 01:52:02] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 01:52:02] INFO train_model: Dropping NaN targets...
[2025-07-17 01:52:03] INFO train_model: Class distribution: [1331  772]
[2025-07-17 01:52:03] INFO train_model: Upsampling successful.
[2025-07-17 01:52:03] INFO train_model: Splitting train/test...
[2025-07-17 01:52:03] INFO train_model: Scaling features...
[2025-07-17 01:52:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 01:52:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 01:52:04] INFO train_model: Model fit complete.
[2025-07-17 01:52:04] INFO train_model: Model Accuracy: 0.8687
[2025-07-17 01:52:04] INFO train_model: 
Classification Report:
[2025-07-17 01:52:04] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.87      0.87       267
           1       0.87      0.86      0.87       266

    accuracy                           0.87       533
   macro avg       0.87      0.87      0.87       533
weighted avg       0.87      0.87      0.87       533

[2025-07-17 01:52:04] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 01:52:04] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 01:52:04] INFO train_model: Feature distributions before training:
[2025-07-17 01:52:04] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:52:04] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 01:52:04] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 01:52:04] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 01:52:04] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 01:52:04] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 01:52:04] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 01:52:04] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 01:52:04] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 01:52:04] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 01:52:04] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 01:52:04] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 01:52:04] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 01:52:04] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 01:52:04] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 01:52:04] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 01:52:04] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 01:52:04] INFO train_model: Auditing data quality before training...
[2025-07-17 01:52:04] INFO train_model: Entering audit_data_quality
[2025-07-17 01:52:05] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:52:05] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 01:52:05] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 01:52:05] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 01:52:05] INFO train_model: Entering audit_data_quality
[2025-07-17 01:52:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 01:52:06] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 01:52:06] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:52:06] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 01:52:06] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 01:52:06] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:08:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: Model is starting a new training session...
[2025-07-17 02:08:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:08:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:08:35] INFO train_model: Preparing target variable...
[2025-07-17 02:08:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:08:35] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:08:35] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:08:35] INFO train_model: Dropping NaN targets...
[2025-07-17 02:08:35] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:08:35] INFO train_model: Upsampling successful.
[2025-07-17 02:08:35] INFO train_model: Splitting train/test...
[2025-07-17 02:08:35] INFO train_model: Scaling features...
[2025-07-17 02:08:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:08:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:08:36] INFO train_model: Model fit complete.
[2025-07-17 02:08:36] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:08:36] INFO train_model: 
Classification Report:
[2025-07-17 02:08:36] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:08:36] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:08:36] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:08:36] INFO train_model: Feature distributions before training:
[2025-07-17 02:08:36] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:08:36] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:08:36] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:08:36] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:08:36] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:08:36] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:08:36] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:08:36] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:08:36] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:08:36] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:08:36] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:08:36] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:08:36] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:08:36] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:08:36] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:08:36] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:08:36] INFO train_model: Auditing data quality before training...
[2025-07-17 02:08:36] INFO train_model: Entering audit_data_quality
[2025-07-17 02:10:47] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: Model is starting a new training session...
[2025-07-17 02:10:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:10:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:10:47] INFO train_model: Preparing target variable...
[2025-07-17 02:10:47] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:10:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:10:47] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:10:47] INFO train_model: Dropping NaN targets...
[2025-07-17 02:10:47] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:10:47] INFO train_model: Upsampling successful.
[2025-07-17 02:10:47] INFO train_model: Splitting train/test...
[2025-07-17 02:10:47] INFO train_model: Scaling features...
[2025-07-17 02:10:47] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:10:47] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:10:49] INFO train_model: Model fit complete.
[2025-07-17 02:10:49] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:10:49] INFO train_model: 
Classification Report:
[2025-07-17 02:10:49] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:10:49] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:10:49] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:10:49] INFO train_model: Feature distributions before training:
[2025-07-17 02:10:49] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:10:49] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:10:49] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:10:49] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:10:49] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:10:49] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:10:49] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:10:49] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:10:49] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:10:49] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:10:49] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:10:49] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:10:49] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:10:49] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:10:49] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:10:49] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:10:49] INFO train_model: Auditing data quality before training...
[2025-07-17 02:10:49] INFO train_model: Entering audit_data_quality
[2025-07-17 02:10:50] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:10:50] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:10:50] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:10:50] INFO train_model: Entering audit_data_quality
[2025-07-17 02:10:51] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:10:51] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:10:52] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:10:52] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:10:52] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:10:52] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:11:04] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: Model is starting a new training session...
[2025-07-17 02:11:04] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:11:04] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:04] INFO train_model: Preparing target variable...
[2025-07-17 02:11:04] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:04] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:04] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:11:04] INFO train_model: Dropping NaN targets...
[2025-07-17 02:11:04] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:11:04] INFO train_model: Upsampling successful.
[2025-07-17 02:11:04] INFO train_model: Splitting train/test...
[2025-07-17 02:11:04] INFO train_model: Scaling features...
[2025-07-17 02:11:04] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:11:04] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:11:05] INFO train_model: Model fit complete.
[2025-07-17 02:11:05] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:11:05] INFO train_model: 
Classification Report:
[2025-07-17 02:11:05] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:11:05] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:11:05] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:11:05] INFO train_model: Feature distributions before training:
[2025-07-17 02:11:05] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:05] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:05] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:11:05] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:11:05] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:11:05] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:11:05] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:11:05] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:11:05] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:11:05] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:11:05] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:11:05] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:11:05] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:11:05] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:11:05] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:11:05] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:11:05] INFO train_model: Auditing data quality before training...
[2025-07-17 02:11:05] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:11:06] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:11:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:11:06] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:07] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:11:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:11:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:11:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: Model is starting a new training session...
[2025-07-17 02:11:14] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:11:14] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:14] INFO train_model: Preparing target variable...
[2025-07-17 02:11:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:11:14] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:11:14] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:11:14] INFO train_model: Dropping NaN targets...
[2025-07-17 02:11:14] INFO train_model: Class distribution: [1331  772]
[2025-07-17 02:11:14] INFO train_model: Upsampling successful.
[2025-07-17 02:11:14] INFO train_model: Splitting train/test...
[2025-07-17 02:11:14] INFO train_model: Scaling features...
[2025-07-17 02:11:14] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:11:14] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:11:15] INFO train_model: Model fit complete.
[2025-07-17 02:11:15] INFO train_model: Model Accuracy: 0.8593
[2025-07-17 02:11:15] INFO train_model: 
Classification Report:
[2025-07-17 02:11:15] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       267
           1       0.86      0.86      0.86       266

    accuracy                           0.86       533
   macro avg       0.86      0.86      0.86       533
weighted avg       0.86      0.86      0.86       533

[2025-07-17 02:11:15] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:11:15] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:11:15] INFO train_model: Feature distributions before training:
[2025-07-17 02:11:15] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:15] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:11:15] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:11:15] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:11:15] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:11:15] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:11:15] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:11:15] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:11:15] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:11:15] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:11:15] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:11:15] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:11:15] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:11:15] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:11:15] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:11:15] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:11:15] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:11:15] INFO train_model: Auditing data quality before training...
[2025-07-17 02:11:15] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:16] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:16] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:11:16] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:11:16] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:11:16] INFO train_model: Entering audit_data_quality
[2025-07-17 02:11:18] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:11:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:11:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:18] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:11:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:11:18] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:19:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:19:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:19:51] INFO train_model: Model is starting a new training session...
[2025-07-17 02:19:51] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:19:51] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:19:51] INFO train_model: Preparing target variable...
[2025-07-17 02:19:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:19:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:19:51] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:19:51] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:19:51] INFO train_model: Dropping NaN targets...
[2025-07-17 02:19:51] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:19:51] INFO train_model: Upsampling successful.
[2025-07-17 02:19:51] INFO train_model: Splitting train/test...
[2025-07-17 02:19:51] INFO train_model: Scaling features...
[2025-07-17 02:19:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:19:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:19:53] INFO train_model: Model fit complete.
[2025-07-17 02:19:53] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:19:53] INFO train_model: 
Classification Report:
[2025-07-17 02:19:53] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:19:53] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:19:53] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:19:53] INFO train_model: Feature distributions before training:
[2025-07-17 02:19:53] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:19:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:19:53] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:19:53] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:19:53] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:19:53] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:19:53] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:19:53] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:19:53] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:19:53] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:19:53] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:19:53] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:19:53] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:19:53] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:19:53] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:19:53] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:19:53] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:19:53] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:19:53] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:19:53] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:19:53] INFO train_model: Auditing data quality before training...
[2025-07-17 02:19:53] INFO train_model: Entering audit_data_quality
[2025-07-17 02:19:54] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:19:54] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:19:54] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:19:54] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:19:54] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:19:54] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:19:54] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:19:54] INFO train_model: Entering audit_data_quality
[2025-07-17 02:19:55] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:19:55] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:19:55] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:19:55] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:19:55] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:19:55] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:20:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:20:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:20:08] INFO train_model: Model is starting a new training session...
[2025-07-17 02:20:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:20:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:20:08] INFO train_model: Preparing target variable...
[2025-07-17 02:20:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:20:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:20:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:20:08] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:20:08] INFO train_model: Dropping NaN targets...
[2025-07-17 02:20:08] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:20:08] INFO train_model: Upsampling successful.
[2025-07-17 02:20:08] INFO train_model: Splitting train/test...
[2025-07-17 02:20:08] INFO train_model: Scaling features...
[2025-07-17 02:20:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:20:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:20:09] INFO train_model: Model fit complete.
[2025-07-17 02:20:09] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:20:09] INFO train_model: 
Classification Report:
[2025-07-17 02:20:09] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:20:09] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:20:09] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:20:09] INFO train_model: Feature distributions before training:
[2025-07-17 02:20:09] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:20:09] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:20:09] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:20:09] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:20:09] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:09] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:20:09] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:20:09] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:20:09] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:20:09] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:20:09] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:20:09] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:20:09] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:20:09] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:20:09] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:20:09] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:20:09] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:20:09] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:20:09] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:20:09] INFO train_model: Auditing data quality before training...
[2025-07-17 02:20:09] INFO train_model: Entering audit_data_quality
[2025-07-17 02:20:10] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:20:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:20:10] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:20:10] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:20:10] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:20:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:20:10] INFO train_model: Entering audit_data_quality
[2025-07-17 02:20:11] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:20:11] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:20:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:20:11] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:20:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:20:11] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:20:17] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:20:17] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:20:17] INFO train_model: Model is starting a new training session...
[2025-07-17 02:20:17] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:20:17] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:20:17] INFO train_model: Preparing target variable...
[2025-07-17 02:20:17] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:20:17] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:20:17] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:20:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:20:18] INFO train_model: Dropping NaN targets...
[2025-07-17 02:20:18] INFO train_model: Class distribution: [1331  772]
[2025-07-17 02:20:18] INFO train_model: Upsampling successful.
[2025-07-17 02:20:18] INFO train_model: Splitting train/test...
[2025-07-17 02:20:18] INFO train_model: Scaling features...
[2025-07-17 02:20:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:20:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:20:19] INFO train_model: Model fit complete.
[2025-07-17 02:20:19] INFO train_model: Model Accuracy: 0.8593
[2025-07-17 02:20:19] INFO train_model: 
Classification Report:
[2025-07-17 02:20:19] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       267
           1       0.86      0.86      0.86       266

    accuracy                           0.86       533
   macro avg       0.86      0.86      0.86       533
weighted avg       0.86      0.86      0.86       533

[2025-07-17 02:20:19] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:20:19] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:20:19] INFO train_model: Feature distributions before training:
[2025-07-17 02:20:19] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:20:19] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:20:19] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:20:19] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:20:19] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:20:19] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:20:19] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:20:19] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:20:19] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:20:19] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:20:19] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:20:19] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:20:19] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:20:19] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:20:19] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:20:19] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:20:19] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:20:19] INFO train_model: Auditing data quality before training...
[2025-07-17 02:20:19] INFO train_model: Entering audit_data_quality
[2025-07-17 02:20:20] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:20:20] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:20:20] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:20:20] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:20:20] INFO train_model: Entering audit_data_quality
[2025-07-17 02:20:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:20:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:20:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:20:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:20:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:20:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:23:58] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:23:58] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:23:58] INFO train_model: Model is starting a new training session...
[2025-07-17 02:23:58] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:23:58] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:23:58] INFO train_model: Preparing target variable...
[2025-07-17 02:23:58] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:23:58] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:23:58] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:23:58] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:23:58] INFO train_model: Dropping NaN targets...
[2025-07-17 02:23:58] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:23:58] INFO train_model: Upsampling successful.
[2025-07-17 02:23:58] INFO train_model: Splitting train/test...
[2025-07-17 02:23:58] INFO train_model: Scaling features...
[2025-07-17 02:23:58] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:23:58] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:23:59] INFO train_model: Model fit complete.
[2025-07-17 02:23:59] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:23:59] INFO train_model: 
Classification Report:
[2025-07-17 02:23:59] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:23:59] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:23:59] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:23:59] INFO train_model: Feature distributions before training:
[2025-07-17 02:23:59] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:23:59] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:23:59] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:23:59] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:23:59] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:23:59] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:23:59] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:23:59] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:23:59] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:23:59] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:23:59] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:23:59] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:23:59] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:23:59] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:23:59] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:23:59] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:23:59] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:23:59] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:23:59] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:23:59] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:23:59] INFO train_model: Auditing data quality before training...
[2025-07-17 02:24:00] INFO train_model: Entering audit_data_quality
[2025-07-17 02:24:01] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:24:01] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:24:01] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:24:01] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:24:01] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:24:01] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:24:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:24:01] INFO train_model: Entering audit_data_quality
[2025-07-17 02:24:02] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:24:02] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:24:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:24:02] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:24:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:24:02] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:24:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:24:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:24:12] INFO train_model: Model is starting a new training session...
[2025-07-17 02:24:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:24:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:24:12] INFO train_model: Preparing target variable...
[2025-07-17 02:24:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:24:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:24:12] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:24:12] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:24:12] INFO train_model: Dropping NaN targets...
[2025-07-17 02:24:12] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:24:12] INFO train_model: Upsampling successful.
[2025-07-17 02:24:12] INFO train_model: Splitting train/test...
[2025-07-17 02:24:12] INFO train_model: Scaling features...
[2025-07-17 02:24:12] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:24:12] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:24:13] INFO train_model: Model fit complete.
[2025-07-17 02:24:13] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:24:13] INFO train_model: 
Classification Report:
[2025-07-17 02:24:13] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:24:13] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:24:13] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:24:13] INFO train_model: Feature distributions before training:
[2025-07-17 02:24:13] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:13] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:24:14] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:24:14] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:24:14] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:24:14] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:14] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:24:14] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:24:14] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:24:14] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:24:14] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:24:14] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:24:14] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:24:14] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:24:14] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:24:14] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:24:14] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:24:14] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:24:14] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:24:14] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:24:14] INFO train_model: Auditing data quality before training...
[2025-07-17 02:24:14] INFO train_model: Entering audit_data_quality
[2025-07-17 02:24:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:24:15] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:24:15] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:24:15] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:24:15] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:24:15] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:24:15] INFO train_model: Entering audit_data_quality
[2025-07-17 02:24:16] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:24:16] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:24:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:24:16] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:24:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:24:16] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:24:22] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:24:22] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:24:22] INFO train_model: Model is starting a new training session...
[2025-07-17 02:24:22] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:24:22] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:24:22] INFO train_model: Preparing target variable...
[2025-07-17 02:24:22] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:24:22] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:24:22] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:24:22] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:24:22] INFO train_model: Dropping NaN targets...
[2025-07-17 02:24:22] INFO train_model: Class distribution: [1331  772]
[2025-07-17 02:24:22] INFO train_model: Upsampling successful.
[2025-07-17 02:24:22] INFO train_model: Splitting train/test...
[2025-07-17 02:24:22] INFO train_model: Scaling features...
[2025-07-17 02:24:22] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:24:22] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:24:24] INFO train_model: Model fit complete.
[2025-07-17 02:24:24] INFO train_model: Model Accuracy: 0.8593
[2025-07-17 02:24:24] INFO train_model: 
Classification Report:
[2025-07-17 02:24:24] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       267
           1       0.86      0.86      0.86       266

    accuracy                           0.86       533
   macro avg       0.86      0.86      0.86       533
weighted avg       0.86      0.86      0.86       533

[2025-07-17 02:24:24] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:24:24] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:24:24] INFO train_model: Feature distributions before training:
[2025-07-17 02:24:24] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:24:24] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:24:24] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:24:24] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:24:24] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:24:24] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:24:24] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:24:24] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:24:24] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:24:24] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:24:24] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:24:24] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:24:24] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:24:24] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:24:24] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:24:24] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:24:24] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:24:24] INFO train_model: Auditing data quality before training...
[2025-07-17 02:24:24] INFO train_model: Entering audit_data_quality
[2025-07-17 02:24:25] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:24:25] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:24:25] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:24:25] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:24:25] INFO train_model: Entering audit_data_quality
[2025-07-17 02:24:26] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:24:26] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:24:26] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:24:26] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:24:26] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:24:26] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:27:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:27:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:27:54] INFO train_model: Model is starting a new training session...
[2025-07-17 02:27:54] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:27:54] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:27:54] INFO train_model: Preparing target variable...
[2025-07-17 02:27:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:27:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:27:54] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:27:54] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:27:54] INFO train_model: Dropping NaN targets...
[2025-07-17 02:27:54] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:27:54] INFO train_model: Upsampling successful.
[2025-07-17 02:27:54] INFO train_model: Splitting train/test...
[2025-07-17 02:27:54] INFO train_model: Scaling features...
[2025-07-17 02:27:54] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:27:54] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:27:56] INFO train_model: Model fit complete.
[2025-07-17 02:27:56] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:27:56] INFO train_model: 
Classification Report:
[2025-07-17 02:27:56] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:27:56] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:27:56] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:27:56] INFO train_model: Feature distributions before training:
[2025-07-17 02:27:56] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:27:56] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:27:56] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:27:56] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:27:56] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:27:56] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:27:56] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:27:56] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:27:56] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:27:56] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:27:56] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:27:56] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:27:56] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:27:56] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:27:56] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:27:56] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:27:56] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:27:56] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:27:56] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:27:56] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:27:56] INFO train_model: Auditing data quality before training...
[2025-07-17 02:27:56] INFO train_model: Entering audit_data_quality
[2025-07-17 02:29:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:29:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:29:49] INFO train_model: Model is starting a new training session...
[2025-07-17 02:29:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:29:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:29:49] INFO train_model: Preparing target variable...
[2025-07-17 02:29:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:29:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:29:49] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:29:49] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:29:49] INFO train_model: Dropping NaN targets...
[2025-07-17 02:29:49] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:29:49] INFO train_model: Upsampling successful.
[2025-07-17 02:29:49] INFO train_model: Splitting train/test...
[2025-07-17 02:29:49] INFO train_model: Scaling features...
[2025-07-17 02:29:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:29:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:29:51] INFO train_model: Model fit complete.
[2025-07-17 02:29:51] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:29:51] INFO train_model: 
Classification Report:
[2025-07-17 02:29:51] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:29:51] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:29:51] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:29:51] INFO train_model: Feature distributions before training:
[2025-07-17 02:29:51] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:29:51] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:29:51] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:29:51] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:29:51] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:29:51] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:29:51] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:29:51] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:29:51] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:29:51] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:29:51] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:29:51] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:29:51] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:29:51] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:29:51] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:29:51] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:29:51] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:29:51] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:29:51] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:29:51] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:29:51] INFO train_model: Auditing data quality before training...
[2025-07-17 02:29:51] INFO train_model: Entering audit_data_quality
[2025-07-17 02:29:52] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:29:52] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:29:52] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:29:52] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:29:52] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:29:52] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:29:52] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:29:52] INFO train_model: Entering audit_data_quality
[2025-07-17 02:29:53] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:29:53] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:29:54] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:29:54] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:29:54] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:29:54] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:30:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:30:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:30:09] INFO train_model: Model is starting a new training session...
[2025-07-17 02:30:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:30:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:30:09] INFO train_model: Preparing target variable...
[2025-07-17 02:30:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:30:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:30:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:30:09] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:30:09] INFO train_model: Dropping NaN targets...
[2025-07-17 02:30:09] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:30:09] INFO train_model: Upsampling successful.
[2025-07-17 02:30:09] INFO train_model: Splitting train/test...
[2025-07-17 02:30:09] INFO train_model: Scaling features...
[2025-07-17 02:30:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:30:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:30:10] INFO train_model: Model fit complete.
[2025-07-17 02:30:10] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:30:10] INFO train_model: 
Classification Report:
[2025-07-17 02:30:10] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:30:10] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:30:10] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:30:10] INFO train_model: Feature distributions before training:
[2025-07-17 02:30:10] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:30:10] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:30:10] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:30:10] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:30:10] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:10] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:30:10] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:30:10] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:30:10] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:30:10] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:30:10] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:30:10] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:30:10] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:30:10] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:30:10] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:30:10] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:30:10] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:30:10] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:30:10] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:30:10] INFO train_model: Auditing data quality before training...
[2025-07-17 02:30:10] INFO train_model: Entering audit_data_quality
[2025-07-17 02:30:11] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:30:11] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:30:11] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:30:11] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:30:11] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:30:11] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:30:11] INFO train_model: Entering audit_data_quality
[2025-07-17 02:30:12] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:30:12] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:30:12] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:30:12] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:30:12] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:30:12] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:30:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:30:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:30:18] INFO train_model: Model is starting a new training session...
[2025-07-17 02:30:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:30:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:30:18] INFO train_model: Preparing target variable...
[2025-07-17 02:30:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:30:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:30:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:30:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:30:18] INFO train_model: Dropping NaN targets...
[2025-07-17 02:30:18] INFO train_model: Class distribution: [1331  772]
[2025-07-17 02:30:18] INFO train_model: Upsampling successful.
[2025-07-17 02:30:18] INFO train_model: Splitting train/test...
[2025-07-17 02:30:18] INFO train_model: Scaling features...
[2025-07-17 02:30:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:30:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:30:20] INFO train_model: Model fit complete.
[2025-07-17 02:30:20] INFO train_model: Model Accuracy: 0.8593
[2025-07-17 02:30:20] INFO train_model: 
Classification Report:
[2025-07-17 02:30:20] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       267
           1       0.86      0.86      0.86       266

    accuracy                           0.86       533
   macro avg       0.86      0.86      0.86       533
weighted avg       0.86      0.86      0.86       533

[2025-07-17 02:30:20] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:30:20] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:30:20] INFO train_model: Feature distributions before training:
[2025-07-17 02:30:20] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:30:20] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:30:20] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:30:20] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:30:20] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:30:20] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:30:20] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:30:20] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:30:20] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:30:20] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:30:20] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:30:20] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:30:20] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:30:20] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:30:20] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:30:20] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:30:20] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:30:20] INFO train_model: Auditing data quality before training...
[2025-07-17 02:30:20] INFO train_model: Entering audit_data_quality
[2025-07-17 02:30:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:30:21] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:30:21] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:30:21] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:30:21] INFO train_model: Entering audit_data_quality
[2025-07-17 02:30:22] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:30:22] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:30:22] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:30:22] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:30:22] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:30:22] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:33:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:33:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:33:36] INFO train_model: Model is starting a new training session...
[2025-07-17 02:33:36] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:33:36] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:33:36] INFO train_model: Preparing target variable...
[2025-07-17 02:33:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:33:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:33:36] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:33:36] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:33:36] INFO train_model: Dropping NaN targets...
[2025-07-17 02:33:36] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:33:36] INFO train_model: Upsampling successful.
[2025-07-17 02:33:36] INFO train_model: Splitting train/test...
[2025-07-17 02:33:36] INFO train_model: Scaling features...
[2025-07-17 02:33:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:33:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:33:37] INFO train_model: Model fit complete.
[2025-07-17 02:33:37] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:33:37] INFO train_model: 
Classification Report:
[2025-07-17 02:33:37] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:33:37] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:33:37] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:33:37] INFO train_model: Feature distributions before training:
[2025-07-17 02:33:37] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:37] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:37] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:37] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:37] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:37] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:37] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:33:37] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:33:37] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:33:37] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:33:37] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:33:37] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:33:37] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:33:37] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:33:37] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:33:37] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:33:37] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:33:37] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:33:37] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:33:37] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:33:37] INFO train_model: Auditing data quality before training...
[2025-07-17 02:33:38] INFO train_model: Entering audit_data_quality
[2025-07-17 02:33:39] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:33:39] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:33:39] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:33:39] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:33:39] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:33:39] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:33:39] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:33:39] INFO train_model: Entering audit_data_quality
[2025-07-17 02:33:40] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:33:40] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:33:40] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:33:40] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:33:40] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:33:40] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:33:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:33:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:33:53] INFO train_model: Model is starting a new training session...
[2025-07-17 02:33:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:33:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:33:53] INFO train_model: Preparing target variable...
[2025-07-17 02:33:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:33:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:33:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:33:53] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:33:53] INFO train_model: Dropping NaN targets...
[2025-07-17 02:33:53] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:33:53] INFO train_model: Upsampling successful.
[2025-07-17 02:33:53] INFO train_model: Splitting train/test...
[2025-07-17 02:33:53] INFO train_model: Scaling features...
[2025-07-17 02:33:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:33:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:33:54] INFO train_model: Model fit complete.
[2025-07-17 02:33:54] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:33:54] INFO train_model: 
Classification Report:
[2025-07-17 02:33:54] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:33:54] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:33:54] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:33:54] INFO train_model: Feature distributions before training:
[2025-07-17 02:33:54] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:54] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:54] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:54] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:33:54] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:33:54] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:33:54] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:33:54] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:33:54] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:33:54] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:33:54] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:33:54] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:33:54] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:33:54] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:33:54] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:33:54] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:33:54] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:33:54] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:33:54] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:33:54] INFO train_model: Auditing data quality before training...
[2025-07-17 02:33:54] INFO train_model: Entering audit_data_quality
[2025-07-17 02:33:55] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:33:55] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:33:55] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:33:55] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:33:55] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:33:55] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:33:55] INFO train_model: Entering audit_data_quality
[2025-07-17 02:33:56] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:33:56] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:33:56] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:33:56] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:33:56] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:33:56] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:34:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:34:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:34:03] INFO train_model: Model is starting a new training session...
[2025-07-17 02:34:03] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:34:03] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:34:03] INFO train_model: Preparing target variable...
[2025-07-17 02:34:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:34:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:34:03] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:34:03] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:34:03] INFO train_model: Dropping NaN targets...
[2025-07-17 02:34:03] INFO train_model: Class distribution: [1331  772]
[2025-07-17 02:34:03] INFO train_model: Upsampling successful.
[2025-07-17 02:34:03] INFO train_model: Splitting train/test...
[2025-07-17 02:34:03] INFO train_model: Scaling features...
[2025-07-17 02:34:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:34:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:34:04] INFO train_model: Model fit complete.
[2025-07-17 02:34:04] INFO train_model: Model Accuracy: 0.8593
[2025-07-17 02:34:04] INFO train_model: 
Classification Report:
[2025-07-17 02:34:04] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       267
           1       0.86      0.86      0.86       266

    accuracy                           0.86       533
   macro avg       0.86      0.86      0.86       533
weighted avg       0.86      0.86      0.86       533

[2025-07-17 02:34:04] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:34:04] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:34:04] INFO train_model: Feature distributions before training:
[2025-07-17 02:34:04] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:34:04] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:34:04] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:34:04] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:34:04] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:34:04] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:34:04] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:34:04] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:34:04] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:34:04] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:34:04] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:34:04] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:34:04] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:34:04] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:34:04] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:34:04] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:34:04] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:34:04] INFO train_model: Auditing data quality before training...
[2025-07-17 02:34:04] INFO train_model: Entering audit_data_quality
[2025-07-17 02:34:05] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:34:05] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:34:05] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:34:05] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:34:05] INFO train_model: Entering audit_data_quality
[2025-07-17 02:34:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:34:06] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:34:06] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:34:06] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:34:06] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:34:06] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:34:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:34:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:34:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:34:44] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:34:44] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:34:44] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:34:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:34:44] INFO train_model: Entering audit_data_quality
[2025-07-17 02:34:48] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:34:48] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:34:48] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:34:48] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:34:48] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:34:48] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:35:06] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:35:06] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:35:06] INFO train_model: Model is starting a new training session...
[2025-07-17 02:35:06] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:35:06] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:35:06] INFO train_model: Preparing target variable...
[2025-07-17 02:35:06] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:35:06] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:35:06] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:35:06] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:35:06] INFO train_model: Dropping NaN targets...
[2025-07-17 02:35:06] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:35:06] INFO train_model: Upsampling successful.
[2025-07-17 02:35:06] INFO train_model: Splitting train/test...
[2025-07-17 02:35:06] INFO train_model: Scaling features...
[2025-07-17 02:35:06] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:35:06] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:35:08] INFO train_model: Model fit complete.
[2025-07-17 02:35:08] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:35:08] INFO train_model: 
Classification Report:
[2025-07-17 02:35:08] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:35:08] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:35:08] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:35:08] INFO train_model: Feature distributions before training:
[2025-07-17 02:35:08] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:08] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:08] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:08] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:08] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:08] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:35:08] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:35:08] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:35:08] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:35:08] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:35:08] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:35:08] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:35:08] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:35:08] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:35:08] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:35:08] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:35:08] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:35:08] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:35:08] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:35:08] INFO train_model: Auditing data quality before training...
[2025-07-17 02:35:08] INFO train_model: Entering audit_data_quality
[2025-07-17 02:35:39] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:35:39] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:35:39] INFO train_model: Model is starting a new training session...
[2025-07-17 02:35:39] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:35:39] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:35:39] INFO train_model: Preparing target variable...
[2025-07-17 02:35:39] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:35:39] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:35:39] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:35:39] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:35:39] INFO train_model: Dropping NaN targets...
[2025-07-17 02:35:39] INFO train_model: Class distribution: [1390  713]
[2025-07-17 02:35:39] INFO train_model: Upsampling successful.
[2025-07-17 02:35:39] INFO train_model: Splitting train/test...
[2025-07-17 02:35:39] INFO train_model: Scaling features...
[2025-07-17 02:35:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:35:39] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:35:40] INFO train_model: Model fit complete.
[2025-07-17 02:35:40] INFO train_model: Model Accuracy: 0.8795
[2025-07-17 02:35:40] INFO train_model: 
Classification Report:
[2025-07-17 02:35:40] INFO train_model:               precision    recall  f1-score   support

           0       0.90      0.86      0.88       278
           1       0.87      0.90      0.88       278

    accuracy                           0.88       556
   macro avg       0.88      0.88      0.88       556
weighted avg       0.88      0.88      0.88       556

[2025-07-17 02:35:40] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:35:40] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:35:40] INFO train_model: Feature distributions before training:
[2025-07-17 02:35:41] INFO train_model: supply_zone: mean=0.4184, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: demand_zone: mean=0.3704, std=0.4830, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: wyckoff_markdown: mean=0.4964, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: wyckoff_markup: mean=0.4845, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:41] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:41] INFO train_model: head_shoulders: mean=0.0323, std=0.1769, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1794, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:41] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:41] INFO train_model: rising_wedge: mean=0.2606, std=0.4391, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:35:41] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:35:41] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:35:41] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:35:41] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:35:41] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:35:41] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:35:41] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:35:41] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:35:41] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:35:41] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:35:41] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:35:41] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:35:41] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:35:41] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:35:41] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:35:41] INFO train_model: Auditing data quality before training...
[2025-07-17 02:35:41] INFO train_model: Entering audit_data_quality
[2025-07-17 02:35:42] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:35:42] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:35:42] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:35:42] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:35:42] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:35:42] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:35:42] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:35:42] INFO train_model: Entering audit_data_quality
[2025-07-17 02:35:43] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:35:43] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:35:43] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:35:43] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:35:43] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:35:43] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:35:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:35:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:35:59] INFO train_model: Model is starting a new training session...
[2025-07-17 02:35:59] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:35:59] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:35:59] INFO train_model: Preparing target variable...
[2025-07-17 02:35:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:35:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:35:59] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:35:59] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:35:59] INFO train_model: Dropping NaN targets...
[2025-07-17 02:35:59] INFO train_model: Class distribution: [764 725]
[2025-07-17 02:35:59] INFO train_model: Upsampling successful.
[2025-07-17 02:35:59] INFO train_model: Splitting train/test...
[2025-07-17 02:35:59] INFO train_model: Scaling features...
[2025-07-17 02:35:59] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:35:59] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:36:00] INFO train_model: Model fit complete.
[2025-07-17 02:36:00] INFO train_model: Model Accuracy: 0.7941
[2025-07-17 02:36:00] INFO train_model: 
Classification Report:
[2025-07-17 02:36:00] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.88      0.81       153
           1       0.85      0.71      0.78       153

    accuracy                           0.79       306
   macro avg       0.80      0.79      0.79       306
weighted avg       0.80      0.79      0.79       306

[2025-07-17 02:36:00] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:36:00] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:36:00] INFO train_model: Feature distributions before training:
[2025-07-17 02:36:00] INFO train_model: supply_zone: mean=0.2498, std=0.4331, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: demand_zone: mean=0.1625, std=0.3691, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:36:00] INFO train_model: wyckoff_distribution: mean=0.1793, std=0.3837, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: wyckoff_markdown: mean=0.3076, std=0.4617, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: wyckoff_markup: mean=0.5131, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:36:00] INFO train_model: head_shoulders: mean=0.0356, std=0.1853, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1802, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:36:00] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:36:00] INFO train_model: rising_wedge: mean=0.2653, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: falling_wedge: mean=0.2344, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: fakeout_up: mean=0.0047, std=0.0684, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:00] INFO train_model: sma_20_4h: mean=144.5407, std=1.5809, min=140.5166, max=148.8194, unique=1488
[2025-07-17 02:36:00] INFO train_model: sma_50_4h: mean=144.4784, std=1.4740, min=140.9014, max=148.3147, unique=1488
[2025-07-17 02:36:00] INFO train_model: ema_12_4h: mean=144.5572, std=1.5938, min=140.4309, max=148.8021, unique=1489
[2025-07-17 02:36:00] INFO train_model: ema_26_4h: mean=144.5284, std=1.5323, min=140.6371, max=148.5877, unique=1489
[2025-07-17 02:36:00] INFO train_model: rsi_14_4h: mean=50.4925, std=34.3187, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:36:00] INFO train_model: macd_4h: mean=0.0288, std=0.2276, min=-0.4377, max=0.7986, unique=1489
[2025-07-17 02:36:00] INFO train_model: macd_signal_4h: mean=0.0287, std=0.2135, min=-0.3715, max=0.7178, unique=1489
[2025-07-17 02:36:00] INFO train_model: bb_high_4h: mean=145.2015, std=1.6285, min=140.8112, max=149.7951, unique=1489
[2025-07-17 02:36:00] INFO train_model: bb_low_4h: mean=143.8799, std=1.6230, min=139.1342, max=148.6325, unique=1489
[2025-07-17 02:36:00] INFO train_model: atr_14_4h: mean=0.5718, std=0.1873, min=0.1883, max=1.4068, unique=1473
[2025-07-17 02:36:00] INFO train_model: volatility_20_4h: mean=0.3304, std=0.1896, min=0.0575, max=1.2618, unique=1489
[2025-07-17 02:36:00] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1489
[2025-07-17 02:36:00] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1489
[2025-07-17 02:36:00] INFO train_model: trend_strength_4h: mean=0.0029, std=0.0019, min=0.0000, max=0.0112, unique=1489
[2025-07-17 02:36:00] INFO train_model: Auditing data quality before training...
[2025-07-17 02:36:00] INFO train_model: Entering audit_data_quality
[2025-07-17 02:36:02] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:36:02] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:36:02] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:36:02] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:36:02] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:36:02] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:36:02] INFO train_model: Entering audit_data_quality
[2025-07-17 02:36:04] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:36:04] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:36:04] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:36:04] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:36:04] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:36:04] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:36:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:36:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:36:11] INFO train_model: Model is starting a new training session...
[2025-07-17 02:36:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:36:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:36:11] INFO train_model: Preparing target variable...
[2025-07-17 02:36:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:36:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:36:11] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:36:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:36:11] INFO train_model: Dropping NaN targets...
[2025-07-17 02:36:11] INFO train_model: Class distribution: [1331  772]
[2025-07-17 02:36:11] INFO train_model: Upsampling successful.
[2025-07-17 02:36:11] INFO train_model: Splitting train/test...
[2025-07-17 02:36:11] INFO train_model: Scaling features...
[2025-07-17 02:36:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:36:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:36:12] INFO train_model: Model fit complete.
[2025-07-17 02:36:12] INFO train_model: Model Accuracy: 0.8593
[2025-07-17 02:36:12] INFO train_model: 
Classification Report:
[2025-07-17 02:36:12] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       267
           1       0.86      0.86      0.86       266

    accuracy                           0.86       533
   macro avg       0.86      0.86      0.86       533
weighted avg       0.86      0.86      0.86       533

[2025-07-17 02:36:12] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:36:12] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:36:12] INFO train_model: Feature distributions before training:
[2025-07-17 02:36:12] INFO train_model: supply_zone: mean=0.4389, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: demand_zone: mean=0.3405, std=0.4740, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: wyckoff_markdown: mean=0.4151, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: wyckoff_markup: mean=0.5663, std=0.4957, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:36:12] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:36:12] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1582, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: double_top: mean=0.0029, std=0.0534, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: rising_wedge: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: falling_wedge: mean=0.2496, std=0.4329, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:36:12] INFO train_model: sma_20_4h: mean=145.3426, std=2.3828, min=140.5166, max=150.9374, unique=2082
[2025-07-17 02:36:12] INFO train_model: sma_50_4h: mean=145.2947, std=2.3173, min=140.9014, max=150.6738, unique=2050
[2025-07-17 02:36:12] INFO train_model: ema_12_4h: mean=145.3703, std=2.3935, min=140.4309, max=150.9399, unique=2103
[2025-07-17 02:36:12] INFO train_model: ema_26_4h: mean=145.3707, std=2.3611, min=140.6371, max=150.7944, unique=2103
[2025-07-17 02:36:12] INFO train_model: rsi_14_4h: mean=49.2808, std=32.9282, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:36:12] INFO train_model: macd_4h: mean=-0.0004, std=0.2403, min=-0.9388, max=0.7986, unique=2103
[2025-07-17 02:36:12] INFO train_model: macd_signal_4h: mean=-0.0002, std=0.2247, min=-0.8130, max=0.7178, unique=2103
[2025-07-17 02:36:12] INFO train_model: bb_high_4h: mean=146.0482, std=2.4460, min=140.8112, max=151.4645, unique=2084
[2025-07-17 02:36:12] INFO train_model: bb_low_4h: mean=144.6370, std=2.3993, min=139.1342, max=150.7418, unique=2084
[2025-07-17 02:36:12] INFO train_model: atr_14_4h: mean=0.6268, std=0.2773, min=0.1483, max=2.0255, unique=2065
[2025-07-17 02:36:12] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2190, min=0.0338, max=1.2700, unique=2084
[2025-07-17 02:36:12] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2084
[2025-07-17 02:36:12] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2052
[2025-07-17 02:36:12] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2054
[2025-07-17 02:36:12] INFO train_model: Auditing data quality before training...
[2025-07-17 02:36:12] INFO train_model: Entering audit_data_quality
[2025-07-17 02:36:14] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:36:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:36:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:36:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:36:14] INFO train_model: Entering audit_data_quality
[2025-07-17 02:36:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:36:15] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:36:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:36:15] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:36:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:36:15] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:45:52] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:45:52] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:45:52] INFO train_model: Model is starting a new training session...
[2025-07-17 02:45:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:45:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:45:52] INFO train_model: Preparing target variable...
[2025-07-17 02:45:52] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:45:52] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:45:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:45:52] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:45:52] INFO train_model: Dropping NaN targets...
[2025-07-17 02:45:52] INFO train_model: Class distribution: [1391  714]
[2025-07-17 02:45:52] INFO train_model: Upsampling successful.
[2025-07-17 02:45:52] INFO train_model: Splitting train/test...
[2025-07-17 02:45:52] INFO train_model: Scaling features...
[2025-07-17 02:45:52] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:45:52] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:45:53] INFO train_model: Model fit complete.
[2025-07-17 02:45:53] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 02:45:53] INFO train_model: 
Classification Report:
[2025-07-17 02:45:53] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 02:45:53] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:45:53] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:45:53] INFO train_model: Feature distributions before training:
[2025-07-17 02:45:53] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:45:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:45:53] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:45:53] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:45:53] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:45:53] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:45:53] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 02:45:53] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 02:45:53] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 02:45:53] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 02:45:53] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:45:53] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 02:45:53] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 02:45:53] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 02:45:53] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 02:45:53] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 02:45:53] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 02:45:53] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 02:45:53] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 02:45:53] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 02:45:53] INFO train_model: Auditing data quality before training...
[2025-07-17 02:45:53] INFO train_model: Entering audit_data_quality
[2025-07-17 02:50:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:50:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:50:23] INFO train_model: Model is starting a new training session...
[2025-07-17 02:50:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:50:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:50:23] INFO train_model: Preparing target variable...
[2025-07-17 02:50:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:50:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:50:23] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:50:23] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:50:23] INFO train_model: Dropping NaN targets...
[2025-07-17 02:50:23] INFO train_model: Class distribution: [1391  714]
[2025-07-17 02:50:23] INFO train_model: Upsampling successful.
[2025-07-17 02:50:23] INFO train_model: Splitting train/test...
[2025-07-17 02:50:23] INFO train_model: Scaling features...
[2025-07-17 02:50:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:50:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:50:24] INFO train_model: Model fit complete.
[2025-07-17 02:50:24] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 02:50:24] INFO train_model: 
Classification Report:
[2025-07-17 02:50:24] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 02:50:24] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:50:24] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:50:24] INFO train_model: Feature distributions before training:
[2025-07-17 02:50:24] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:50:24] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:50:24] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:50:24] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:50:24] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:50:24] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:50:24] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 02:50:24] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 02:50:24] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 02:50:24] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 02:50:24] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:50:24] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 02:50:24] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 02:50:24] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 02:50:24] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 02:50:24] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 02:50:24] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 02:50:24] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 02:50:24] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 02:50:24] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 02:50:24] INFO train_model: Auditing data quality before training...
[2025-07-17 02:50:24] INFO train_model: Entering audit_data_quality
[2025-07-17 02:52:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:52:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:52:28] INFO train_model: Model is starting a new training session...
[2025-07-17 02:52:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:52:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:52:28] INFO train_model: Preparing target variable...
[2025-07-17 02:52:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:52:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:52:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:52:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:52:28] INFO train_model: Dropping NaN targets...
[2025-07-17 02:52:28] INFO train_model: Class distribution: [1391  714]
[2025-07-17 02:52:28] INFO train_model: Upsampling successful.
[2025-07-17 02:52:28] INFO train_model: Splitting train/test...
[2025-07-17 02:52:28] INFO train_model: Scaling features...
[2025-07-17 02:52:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:52:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:52:30] INFO train_model: Model fit complete.
[2025-07-17 02:52:30] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 02:52:30] INFO train_model: 
Classification Report:
[2025-07-17 02:52:30] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 02:52:30] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:52:30] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:52:30] INFO train_model: Feature distributions before training:
[2025-07-17 02:52:30] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:52:30] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:52:30] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:52:30] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:52:30] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:52:30] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:52:30] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 02:52:30] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 02:52:30] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 02:52:30] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 02:52:30] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:52:30] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 02:52:30] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 02:52:30] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 02:52:30] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 02:52:30] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 02:52:30] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 02:52:30] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 02:52:30] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 02:52:30] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 02:52:30] INFO train_model: Auditing data quality before training...
[2025-07-17 02:52:30] INFO train_model: Entering audit_data_quality
[2025-07-17 02:54:06] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:54:06] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:54:06] INFO train_model: Model is starting a new training session...
[2025-07-17 02:54:06] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:54:06] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:54:06] INFO train_model: Preparing target variable...
[2025-07-17 02:54:06] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:54:06] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:54:06] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:54:06] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:54:06] INFO train_model: Dropping NaN targets...
[2025-07-17 02:54:06] INFO train_model: Class distribution: [1391  714]
[2025-07-17 02:54:06] INFO train_model: Upsampling successful.
[2025-07-17 02:54:06] INFO train_model: Splitting train/test...
[2025-07-17 02:54:06] INFO train_model: Scaling features...
[2025-07-17 02:54:06] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:54:06] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:54:07] INFO train_model: Model fit complete.
[2025-07-17 02:54:07] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 02:54:07] INFO train_model: 
Classification Report:
[2025-07-17 02:54:07] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 02:54:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:54:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:54:07] INFO train_model: Feature distributions before training:
[2025-07-17 02:54:07] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:07] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:07] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:07] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:07] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:07] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:07] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 02:54:07] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 02:54:07] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 02:54:07] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 02:54:07] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:54:07] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 02:54:07] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 02:54:07] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 02:54:07] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 02:54:07] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 02:54:07] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 02:54:07] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 02:54:07] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 02:54:07] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 02:54:07] INFO train_model: Auditing data quality before training...
[2025-07-17 02:54:07] INFO train_model: Entering audit_data_quality
[2025-07-17 02:54:24] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:54:24] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:54:24] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 02:54:24] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:54:24] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:54:24] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 02:54:24] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:54:24] INFO train_model: Entering audit_data_quality
[2025-07-17 02:54:27] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:54:27] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:54:27] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 02:54:27] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:54:27] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:54:27] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:54:27] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:54:27] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:54:28] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:54:28] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:54:28] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:54:28] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:54:28] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:54:28] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:54:28] INFO train_model: Entering audit_data_quality
[2025-07-17 02:54:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:54:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:54:49] INFO train_model: Model is starting a new training session...
[2025-07-17 02:54:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:54:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:54:49] INFO train_model: Preparing target variable...
[2025-07-17 02:54:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:54:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:54:49] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:54:49] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:54:49] INFO train_model: Dropping NaN targets...
[2025-07-17 02:54:49] INFO train_model: Class distribution: [765 727]
[2025-07-17 02:54:49] INFO train_model: Upsampling successful.
[2025-07-17 02:54:49] INFO train_model: Splitting train/test...
[2025-07-17 02:54:49] INFO train_model: Scaling features...
[2025-07-17 02:54:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:54:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:54:50] INFO train_model: Model fit complete.
[2025-07-17 02:54:50] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 02:54:50] INFO train_model: 
Classification Report:
[2025-07-17 02:54:50] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 02:54:50] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:54:50] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:54:50] INFO train_model: Feature distributions before training:
[2025-07-17 02:54:50] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:50] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:50] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:50] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:54:50] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:54:50] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 02:54:50] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 02:54:50] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 02:54:50] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 02:54:50] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 02:54:50] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 02:54:50] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 02:54:50] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 02:54:50] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 02:54:50] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 02:54:50] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 02:54:50] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 02:54:50] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 02:54:50] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 02:54:50] INFO train_model: Auditing data quality before training...
[2025-07-17 02:54:50] INFO train_model: Entering audit_data_quality
[2025-07-17 02:54:54] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:54:54] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 02:54:54] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 02:54:54] WARNING train_model: Removing constant feature: double_top
[2025-07-17 02:54:54] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 02:54:54] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 02:54:54] INFO train_model: Entering audit_data_quality
[2025-07-17 02:54:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 02:54:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 02:54:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:54:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 02:54:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 02:54:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 02:55:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:55:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:55:08] INFO train_model: Model is starting a new training session...
[2025-07-17 02:55:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:55:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:55:08] INFO train_model: Preparing target variable...
[2025-07-17 02:55:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:55:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:55:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:55:08] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:55:08] INFO train_model: Dropping NaN targets...
[2025-07-17 02:55:08] INFO train_model: Class distribution: [1332  773]
[2025-07-17 02:55:08] INFO train_model: Upsampling successful.
[2025-07-17 02:55:08] INFO train_model: Splitting train/test...
[2025-07-17 02:55:08] INFO train_model: Scaling features...
[2025-07-17 02:55:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:55:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:55:11] INFO train_model: Model fit complete.
[2025-07-17 02:55:11] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 02:55:11] INFO train_model: 
Classification Report:
[2025-07-17 02:55:11] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 02:55:11] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:55:11] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:55:11] INFO train_model: Feature distributions before training:
[2025-07-17 02:55:11] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:55:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:55:11] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:11] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 02:55:11] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 02:55:11] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 02:55:11] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 02:55:11] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:55:11] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 02:55:11] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 02:55:11] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 02:55:11] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 02:55:11] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 02:55:11] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 02:55:11] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 02:55:11] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 02:55:11] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 02:55:11] INFO train_model: Auditing data quality before training...
[2025-07-17 02:55:11] INFO train_model: Entering audit_data_quality
[2025-07-17 02:55:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:55:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:55:55] INFO train_model: Model is starting a new training session...
[2025-07-17 02:55:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 02:55:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:55:55] INFO train_model: Preparing target variable...
[2025-07-17 02:55:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 02:55:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 02:55:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 02:55:55] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 02:55:55] INFO train_model: Dropping NaN targets...
[2025-07-17 02:55:55] INFO train_model: Class distribution: [1391  714]
[2025-07-17 02:55:55] INFO train_model: Upsampling successful.
[2025-07-17 02:55:55] INFO train_model: Splitting train/test...
[2025-07-17 02:55:55] INFO train_model: Scaling features...
[2025-07-17 02:55:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 02:55:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 02:55:57] INFO train_model: Model fit complete.
[2025-07-17 02:55:57] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 02:55:57] INFO train_model: 
Classification Report:
[2025-07-17 02:55:57] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 02:55:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 02:55:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 02:55:57] INFO train_model: Feature distributions before training:
[2025-07-17 02:55:57] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:55:57] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:55:57] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:55:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:55:57] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 02:55:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 02:55:57] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 02:55:57] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 02:55:57] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 02:55:57] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 02:55:57] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 02:55:57] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 02:55:57] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 02:55:57] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 02:55:57] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 02:55:57] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 02:55:57] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 02:55:57] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 02:55:57] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 02:55:57] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 02:55:57] INFO train_model: Auditing data quality before training...
[2025-07-17 02:55:57] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:03] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:03] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:03] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:03] INFO train_model: Preparing target variable...
[2025-07-17 03:00:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:03] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:03] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 03:00:03] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:03] INFO train_model: Class distribution: [964 435]
[2025-07-17 03:00:03] INFO train_model: Upsampling successful.
[2025-07-17 03:00:03] INFO train_model: Splitting train/test...
[2025-07-17 03:00:03] INFO train_model: Scaling features...
[2025-07-17 03:00:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:00:04] INFO train_model: Model fit complete.
[2025-07-17 03:00:04] INFO train_model: Model Accuracy: 0.5648
[2025-07-17 03:00:04] INFO train_model: 
Classification Report:
[2025-07-17 03:00:04] INFO train_model:               precision    recall  f1-score   support

           0       0.55      0.76      0.63       193
           1       0.61      0.37      0.46       193

    accuracy                           0.56       386
   macro avg       0.58      0.56      0.55       386
weighted avg       0.58      0.56      0.55       386

[2025-07-17 03:00:04] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:00:04] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:00:04] INFO train_model: Feature distributions before training:
[2025-07-17 03:00:04] INFO train_model: supply_zone: mean=0.4439, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: demand_zone: mean=0.3767, std=0.4847, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: wyckoff_markdown: mean=0.4739, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: wyckoff_markup: mean=0.4975, std=0.5002, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: wyckoff_unknown: mean=0.0286, std=0.1667, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:04] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:04] INFO train_model: head_shoulders: mean=0.0315, std=0.1746, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: inv_head_shoulders: mean=0.0315, std=0.1746, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:04] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:04] INFO train_model: rising_wedge: mean=0.2530, std=0.4349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: falling_wedge: mean=0.2037, std=0.4029, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: fakeout_up: mean=0.0007, std=0.0267, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:04] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:04] INFO train_model: Auditing data quality before training...
[2025-07-17 03:00:04] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:04] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:04] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:00:04] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:00:04] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:00:04] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:00:04] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:00:04] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:00:04] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:05] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:05] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:00:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:05] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:00:05] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:05] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:00:07] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:07] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:07] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:07] INFO train_model: Preparing target variable...
[2025-07-17 03:00:07] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:07] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:07] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:07] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 03:00:07] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:07] INFO train_model: Class distribution: [811 607]
[2025-07-17 03:00:07] INFO train_model: Upsampling successful.
[2025-07-17 03:00:07] INFO train_model: Splitting train/test...
[2025-07-17 03:00:07] INFO train_model: Scaling features...
[2025-07-17 03:00:07] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:07] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:00:07] INFO train_model: Model fit complete.
[2025-07-17 03:00:07] INFO train_model: Model Accuracy: 0.5200
[2025-07-17 03:00:07] INFO train_model: 
Classification Report:
[2025-07-17 03:00:07] INFO train_model:               precision    recall  f1-score   support

           0       0.52      0.51      0.52       163
           1       0.52      0.53      0.52       162

    accuracy                           0.52       325
   macro avg       0.52      0.52      0.52       325
weighted avg       0.52      0.52      0.52       325

[2025-07-17 03:00:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:00:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:00:07] INFO train_model: Feature distributions before training:
[2025-07-17 03:00:07] INFO train_model: supply_zone: mean=0.2630, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: demand_zone: mean=0.2017, std=0.4014, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: wyckoff_accumulation: mean=0.0007, std=0.0266, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: wyckoff_distribution: mean=0.1347, std=0.3415, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: wyckoff_markdown: mean=0.3843, std=0.4866, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: wyckoff_markup: mean=0.4520, std=0.4979, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: wyckoff_unknown: mean=0.0282, std=0.1656, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: head_shoulders: mean=0.0339, std=0.1809, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: inv_head_shoulders: mean=0.0324, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:07] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:07] INFO train_model: rising_wedge: mean=0.2772, std=0.4477, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: falling_wedge: mean=0.2518, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: fakeout_up: mean=0.0049, std=0.0701, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: fakeout_down: mean=0.0063, std=0.0794, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:07] INFO train_model: Auditing data quality before training...
[2025-07-17 03:00:07] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:08] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:08] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:00:08] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:00:08] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:00:08] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:08] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:08] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:00:08] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:08] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:00:08] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:08] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:00:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:09] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:09] INFO train_model: Preparing target variable...
[2025-07-17 03:00:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:09] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 03:00:09] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:09] INFO train_model: Class distribution: [1024  376]
[2025-07-17 03:00:09] INFO train_model: Upsampling successful.
[2025-07-17 03:00:09] INFO train_model: Splitting train/test...
[2025-07-17 03:00:09] INFO train_model: Scaling features...
[2025-07-17 03:00:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:00:10] INFO train_model: Model fit complete.
[2025-07-17 03:00:10] INFO train_model: Model Accuracy: 0.5390
[2025-07-17 03:00:10] INFO train_model: 
Classification Report:
[2025-07-17 03:00:10] INFO train_model:               precision    recall  f1-score   support

           0       0.53      0.78      0.63       205
           1       0.57      0.30      0.40       205

    accuracy                           0.54       410
   macro avg       0.55      0.54      0.51       410
weighted avg       0.55      0.54      0.51       410

[2025-07-17 03:00:10] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:00:10] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:00:10] INFO train_model: Feature distributions before training:
[2025-07-17 03:00:10] INFO train_model: supply_zone: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: demand_zone: mean=0.4793, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: wyckoff_markdown: mean=0.5314, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: wyckoff_markup: mean=0.4400, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: wyckoff_unknown: mean=0.0286, std=0.1667, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:10] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:10] INFO train_model: head_shoulders: mean=0.0343, std=0.1820, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: inv_head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:10] INFO train_model: double_bottom: mean=0.0107, std=0.1030, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: rising_wedge: mean=0.2021, std=0.4017, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: falling_wedge: mean=0.2250, std=0.4177, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:10] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:10] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:10] INFO train_model: Auditing data quality before training...
[2025-07-17 03:00:10] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:10] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:00:10] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:00:10] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:00:10] WARNING train_model: Removing constant feature: fakeout_up
[2025-07-17 03:00:10] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:00:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:00:10] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:11] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:11] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:00:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:11] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:00:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:11] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:00:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:12] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:12] INFO train_model: Preparing target variable...
[2025-07-17 03:00:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:12] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 03:00:12] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down']
[2025-07-17 03:00:12] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:12] INFO train_model: Class distribution: [953 455]
[2025-07-17 03:00:12] INFO train_model: Upsampling successful.
[2025-07-17 03:00:12] INFO train_model: Splitting train/test...
[2025-07-17 03:00:12] INFO train_model: Scaling features...
[2025-07-17 03:00:12] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:12] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:00:13] INFO train_model: Model fit complete.
[2025-07-17 03:00:13] INFO train_model: Model Accuracy: 0.5576
[2025-07-17 03:00:13] INFO train_model: 
Classification Report:
[2025-07-17 03:00:13] INFO train_model:               precision    recall  f1-score   support

           0       0.55      0.62      0.58       191
           1       0.57      0.50      0.53       191

    accuracy                           0.56       382
   macro avg       0.56      0.56      0.56       382
weighted avg       0.56      0.56      0.56       382

[2025-07-17 03:00:13] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:00:13] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:00:13] INFO train_model: Feature distributions before training:
[2025-07-17 03:00:13] INFO train_model: supply_zone: mean=0.4652, std=0.4990, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: demand_zone: mean=0.3686, std=0.4826, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: wyckoff_markdown: mean=0.4141, std=0.4927, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: wyckoff_markup: mean=0.5575, std=0.4969, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: wyckoff_unknown: mean=0.0284, std=0.1662, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:13] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:13] INFO train_model: head_shoulders: mean=0.0341, std=0.1815, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: inv_head_shoulders: mean=0.0277, std=0.1642, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: double_top: mean=0.0043, std=0.0652, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: double_bottom: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: rising_wedge: mean=0.2884, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: falling_wedge: mean=0.2464, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: fakeout_up: mean=0.0014, std=0.0377, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: fakeout_down: mean=0.0007, std=0.0267, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:13] INFO train_model: Auditing data quality before training...
[2025-07-17 03:00:13] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:14] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:00:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:00:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:00:14] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:14] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:14] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:00:14] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:14] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:00:14] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:14] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:00:15] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:15] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:15] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:15] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:15] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:15] INFO train_model: Preparing target variable...
[2025-07-17 03:00:15] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:15] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:15] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:15] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:00:15] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:15] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:00:15] INFO train_model: Upsampling successful.
[2025-07-17 03:00:15] INFO train_model: Splitting train/test...
[2025-07-17 03:00:15] INFO train_model: Scaling features...
[2025-07-17 03:00:15] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:15] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:00:16] INFO train_model: Model fit complete.
[2025-07-17 03:00:16] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:00:16] INFO train_model: 
Classification Report:
[2025-07-17 03:00:16] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:00:16] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:00:16] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:00:16] INFO train_model: Feature distributions before training:
[2025-07-17 03:00:16] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:16] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:16] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:16] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:16] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:16] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:16] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:00:16] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:00:16] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:00:16] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:00:16] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:00:16] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:00:16] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:00:16] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:00:16] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:00:16] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:00:16] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:00:16] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:00:16] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:00:16] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:00:16] INFO train_model: Auditing data quality before training...
[2025-07-17 03:00:16] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:18] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:18] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:00:18] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:00:18] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:00:18] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:00:18] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:00:18] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:00:18] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:20] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:20] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:00:20] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:20] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:00:20] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:20] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:00:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:36] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:36] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:36] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:36] INFO train_model: Preparing target variable...
[2025-07-17 03:00:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:36] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:36] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:00:36] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:36] INFO train_model: Class distribution: [765 727]
[2025-07-17 03:00:36] INFO train_model: Upsampling successful.
[2025-07-17 03:00:36] INFO train_model: Splitting train/test...
[2025-07-17 03:00:36] INFO train_model: Scaling features...
[2025-07-17 03:00:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:00:38] INFO train_model: Model fit complete.
[2025-07-17 03:00:38] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 03:00:38] INFO train_model: 
Classification Report:
[2025-07-17 03:00:38] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 03:00:38] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:00:38] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:00:38] INFO train_model: Feature distributions before training:
[2025-07-17 03:00:38] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:38] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:38] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:38] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:38] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:38] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 03:00:38] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 03:00:38] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 03:00:38] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 03:00:38] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 03:00:38] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 03:00:38] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 03:00:38] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 03:00:38] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 03:00:38] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 03:00:38] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 03:00:38] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 03:00:38] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 03:00:38] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 03:00:38] INFO train_model: Auditing data quality before training...
[2025-07-17 03:00:38] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:40] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:40] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:00:40] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 03:00:40] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:00:40] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:00:40] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:00:40] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:41] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:41] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:00:41] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:41] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:00:41] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:41] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:00:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:49] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:49] INFO train_model: Preparing target variable...
[2025-07-17 03:00:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:49] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:49] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:00:49] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:49] INFO train_model: Class distribution: [1332  773]
[2025-07-17 03:00:49] INFO train_model: Upsampling successful.
[2025-07-17 03:00:49] INFO train_model: Splitting train/test...
[2025-07-17 03:00:49] INFO train_model: Scaling features...
[2025-07-17 03:00:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:00:51] INFO train_model: Model fit complete.
[2025-07-17 03:00:51] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 03:00:51] INFO train_model: 
Classification Report:
[2025-07-17 03:00:51] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 03:00:51] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:00:51] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:00:51] INFO train_model: Feature distributions before training:
[2025-07-17 03:00:51] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:51] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:00:51] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:00:51] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:00:51] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:00:51] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:00:51] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:00:51] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:00:51] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:00:51] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:00:51] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:00:51] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:00:51] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:00:51] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:00:51] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:00:51] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:00:51] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:00:51] INFO train_model: Auditing data quality before training...
[2025-07-17 03:00:51] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:52] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:52] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:00:52] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:00:52] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:00:52] INFO train_model: Entering audit_data_quality
[2025-07-17 03:00:53] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:00:53] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:00:53] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:53] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:00:53] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:00:53] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:00:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:59] INFO train_model: Model is starting a new training session...
[2025-07-17 03:00:59] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:00:59] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:59] INFO train_model: Preparing target variable...
[2025-07-17 03:00:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:00:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:00:59] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:00:59] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:00:59] INFO train_model: Dropping NaN targets...
[2025-07-17 03:00:59] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:00:59] INFO train_model: Upsampling successful.
[2025-07-17 03:00:59] INFO train_model: Splitting train/test...
[2025-07-17 03:00:59] INFO train_model: Scaling features...
[2025-07-17 03:00:59] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:00:59] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:01:01] INFO train_model: Model fit complete.
[2025-07-17 03:01:01] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:01:01] INFO train_model: 
Classification Report:
[2025-07-17 03:01:01] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:01:01] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:01:01] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:01:01] INFO train_model: Feature distributions before training:
[2025-07-17 03:01:01] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:01] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:01] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:01] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:01] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:01] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:01] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:01:01] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:01:01] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:01:01] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:01:01] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:01:01] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:01:01] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:01:01] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:01:01] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:01:01] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:01:01] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:01:01] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:01:01] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:01:01] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:01:01] INFO train_model: Auditing data quality before training...
[2025-07-17 03:01:01] INFO train_model: Entering audit_data_quality
[2025-07-17 03:01:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:01:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:01:55] INFO train_model: Model is starting a new training session...
[2025-07-17 03:01:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:01:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:01:55] INFO train_model: Preparing target variable...
[2025-07-17 03:01:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:01:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:01:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:01:55] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:01:55] INFO train_model: Dropping NaN targets...
[2025-07-17 03:01:55] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:01:55] INFO train_model: Upsampling successful.
[2025-07-17 03:01:55] INFO train_model: Splitting train/test...
[2025-07-17 03:01:55] INFO train_model: Scaling features...
[2025-07-17 03:01:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:01:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:01:57] INFO train_model: Model fit complete.
[2025-07-17 03:01:57] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:01:57] INFO train_model: 
Classification Report:
[2025-07-17 03:01:57] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:01:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:01:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:01:57] INFO train_model: Feature distributions before training:
[2025-07-17 03:01:57] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:57] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:57] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:57] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:01:57] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:01:57] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:01:57] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:01:57] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:01:57] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:01:57] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:01:57] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:01:57] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:01:57] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:01:57] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:01:57] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:01:57] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:01:57] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:01:57] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:01:57] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:01:57] INFO train_model: Auditing data quality before training...
[2025-07-17 03:01:57] INFO train_model: Entering audit_data_quality
[2025-07-17 03:02:04] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:02:04] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:02:04] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:02:04] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:02:04] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:02:04] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:02:04] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:02:04] INFO train_model: Entering audit_data_quality
[2025-07-17 03:07:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:07:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:07:51] INFO train_model: Model is starting a new training session...
[2025-07-17 03:07:51] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:07:51] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:07:51] INFO train_model: Preparing target variable...
[2025-07-17 03:07:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:07:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:07:51] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:07:51] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:07:51] INFO train_model: Dropping NaN targets...
[2025-07-17 03:07:51] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:07:51] INFO train_model: Upsampling successful.
[2025-07-17 03:07:51] INFO train_model: Splitting train/test...
[2025-07-17 03:07:51] INFO train_model: Scaling features...
[2025-07-17 03:07:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:07:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:07:53] INFO train_model: Model fit complete.
[2025-07-17 03:07:53] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:07:53] INFO train_model: 
Classification Report:
[2025-07-17 03:07:53] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:07:53] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:07:53] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:07:53] INFO train_model: Feature distributions before training:
[2025-07-17 03:07:53] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:07:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:07:53] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:07:53] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:07:53] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:07:53] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:07:53] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:07:53] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:07:53] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:07:53] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:07:53] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:07:53] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:07:53] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:07:53] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:07:53] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:07:53] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:07:53] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:07:53] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:07:53] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:07:53] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:07:53] INFO train_model: Auditing data quality before training...
[2025-07-17 03:07:53] INFO train_model: Entering audit_data_quality
[2025-07-17 03:10:57] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:10:57] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:10:57] INFO train_model: Model is starting a new training session...
[2025-07-17 03:10:57] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:10:57] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:10:57] INFO train_model: Preparing target variable...
[2025-07-17 03:10:57] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:10:57] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:10:57] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:10:57] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:10:57] INFO train_model: Dropping NaN targets...
[2025-07-17 03:10:57] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:10:57] INFO train_model: Upsampling successful.
[2025-07-17 03:10:57] INFO train_model: Splitting train/test...
[2025-07-17 03:10:57] INFO train_model: Scaling features...
[2025-07-17 03:10:57] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:10:57] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:10:58] INFO train_model: Model fit complete.
[2025-07-17 03:10:58] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:10:58] INFO train_model: 
Classification Report:
[2025-07-17 03:10:58] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:10:58] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:10:58] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:10:58] INFO train_model: Feature distributions before training:
[2025-07-17 03:10:58] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:10:58] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:10:58] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:10:58] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:10:58] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:10:58] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:10:58] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:10:58] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:10:58] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:10:58] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:10:58] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:10:58] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:10:58] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:10:58] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:10:58] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:10:58] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:10:58] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:10:58] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:10:58] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:10:58] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:10:58] INFO train_model: Auditing data quality before training...
[2025-07-17 03:10:58] INFO train_model: Entering audit_data_quality
[2025-07-17 03:11:00] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:11:00] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:11:00] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:11:00] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:11:00] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:11:00] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:11:00] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:11:00] INFO train_model: Entering audit_data_quality
[2025-07-17 03:11:01] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:11:01] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:11:01] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:11:01] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:11:01] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:11:01] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:11:01] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:11:01] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:11:17] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:11:17] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:11:17] INFO train_model: Model is starting a new training session...
[2025-07-17 03:11:17] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:11:17] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:11:17] INFO train_model: Preparing target variable...
[2025-07-17 03:11:17] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:11:17] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:11:17] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:11:17] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:11:17] INFO train_model: Dropping NaN targets...
[2025-07-17 03:11:17] INFO train_model: Class distribution: [765 727]
[2025-07-17 03:11:17] INFO train_model: Upsampling successful.
[2025-07-17 03:11:17] INFO train_model: Splitting train/test...
[2025-07-17 03:11:17] INFO train_model: Scaling features...
[2025-07-17 03:11:17] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:11:17] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:11:18] INFO train_model: Model fit complete.
[2025-07-17 03:11:18] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 03:11:18] INFO train_model: 
Classification Report:
[2025-07-17 03:11:18] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 03:11:18] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:11:18] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:11:18] INFO train_model: Feature distributions before training:
[2025-07-17 03:11:18] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:11:18] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:11:18] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:11:18] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:11:18] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:18] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 03:11:18] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 03:11:18] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 03:11:18] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 03:11:18] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 03:11:18] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 03:11:18] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 03:11:18] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 03:11:18] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 03:11:18] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 03:11:18] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 03:11:18] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 03:11:18] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 03:11:18] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 03:11:18] INFO train_model: Auditing data quality before training...
[2025-07-17 03:11:18] INFO train_model: Entering audit_data_quality
[2025-07-17 03:11:19] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:11:19] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:11:19] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 03:11:19] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:11:19] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:11:19] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:11:19] INFO train_model: Entering audit_data_quality
[2025-07-17 03:11:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:11:21] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:11:21] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:11:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:11:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:11:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:11:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:11:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:11:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:11:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:11:28] INFO train_model: Model is starting a new training session...
[2025-07-17 03:11:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:11:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:11:28] INFO train_model: Preparing target variable...
[2025-07-17 03:11:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:11:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:11:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:11:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:11:28] INFO train_model: Dropping NaN targets...
[2025-07-17 03:11:28] INFO train_model: Class distribution: [1332  773]
[2025-07-17 03:11:28] INFO train_model: Upsampling successful.
[2025-07-17 03:11:28] INFO train_model: Splitting train/test...
[2025-07-17 03:11:28] INFO train_model: Scaling features...
[2025-07-17 03:11:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:11:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:11:29] INFO train_model: Model fit complete.
[2025-07-17 03:11:29] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 03:11:29] INFO train_model: 
Classification Report:
[2025-07-17 03:11:29] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 03:11:29] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:11:29] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:11:29] INFO train_model: Feature distributions before training:
[2025-07-17 03:11:29] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:11:29] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:11:29] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:11:29] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:11:29] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:11:29] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:11:29] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:11:29] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:11:29] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:11:29] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:11:29] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:11:29] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:11:29] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:11:29] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:11:29] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:11:29] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:11:29] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:11:29] INFO train_model: Auditing data quality before training...
[2025-07-17 03:11:29] INFO train_model: Entering audit_data_quality
[2025-07-17 03:11:30] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:11:30] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:11:30] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:11:30] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:11:30] INFO train_model: Entering audit_data_quality
[2025-07-17 03:11:32] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:11:32] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:11:32] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:11:32] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:11:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:11:32] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:11:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:11:32] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:16:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:16:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:16:28] INFO train_model: Model is starting a new training session...
[2025-07-17 03:16:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:16:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:16:28] INFO train_model: Preparing target variable...
[2025-07-17 03:16:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:16:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:16:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:16:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:16:28] INFO train_model: Dropping NaN targets...
[2025-07-17 03:16:28] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:16:28] INFO train_model: Upsampling successful.
[2025-07-17 03:16:28] INFO train_model: Splitting train/test...
[2025-07-17 03:16:28] INFO train_model: Scaling features...
[2025-07-17 03:16:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:16:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:16:29] INFO train_model: Model fit complete.
[2025-07-17 03:16:29] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:16:29] INFO train_model: 
Classification Report:
[2025-07-17 03:16:29] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:16:29] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:16:29] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:16:29] INFO train_model: Feature distributions before training:
[2025-07-17 03:16:29] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:29] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:29] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:29] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:29] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:29] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:29] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:16:29] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:16:29] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:16:29] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:16:29] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:16:29] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:16:29] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:16:29] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:16:29] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:16:29] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:16:29] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:16:29] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:16:29] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:16:29] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:16:29] INFO train_model: Auditing data quality before training...
[2025-07-17 03:16:29] INFO train_model: Entering audit_data_quality
[2025-07-17 03:16:31] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:16:31] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:16:31] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:16:31] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:16:31] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:16:31] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:16:31] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:16:31] INFO train_model: Entering audit_data_quality
[2025-07-17 03:16:32] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:16:32] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:16:32] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:16:32] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:16:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:16:32] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:16:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:16:32] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:16:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:16:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:16:49] INFO train_model: Model is starting a new training session...
[2025-07-17 03:16:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:16:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:16:49] INFO train_model: Preparing target variable...
[2025-07-17 03:16:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:16:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:16:49] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:16:49] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:16:49] INFO train_model: Dropping NaN targets...
[2025-07-17 03:16:49] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:16:49] INFO train_model: Upsampling successful.
[2025-07-17 03:16:49] INFO train_model: Splitting train/test...
[2025-07-17 03:16:49] INFO train_model: Scaling features...
[2025-07-17 03:16:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:16:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:16:50] INFO train_model: Model fit complete.
[2025-07-17 03:16:50] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:16:50] INFO train_model: 
Classification Report:
[2025-07-17 03:16:50] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:16:50] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:16:50] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:16:50] INFO train_model: Feature distributions before training:
[2025-07-17 03:16:50] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:50] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:50] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:50] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:50] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:50] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:50] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:16:50] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:16:50] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:16:50] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:16:50] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:16:50] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:16:50] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:16:50] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:16:50] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:16:50] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:16:50] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:16:50] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:16:50] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:16:50] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:16:50] INFO train_model: Auditing data quality before training...
[2025-07-17 03:16:51] INFO train_model: Entering audit_data_quality
[2025-07-17 03:16:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:16:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:16:54] INFO train_model: Model is starting a new training session...
[2025-07-17 03:16:54] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:16:54] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:16:54] INFO train_model: Preparing target variable...
[2025-07-17 03:16:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:16:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:16:54] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:16:54] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:16:54] INFO train_model: Dropping NaN targets...
[2025-07-17 03:16:54] INFO train_model: Class distribution: [765 727]
[2025-07-17 03:16:54] INFO train_model: Upsampling successful.
[2025-07-17 03:16:54] INFO train_model: Splitting train/test...
[2025-07-17 03:16:54] INFO train_model: Scaling features...
[2025-07-17 03:16:54] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:16:54] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:16:55] INFO train_model: Model fit complete.
[2025-07-17 03:16:55] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 03:16:55] INFO train_model: 
Classification Report:
[2025-07-17 03:16:55] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 03:16:55] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:16:55] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:16:55] INFO train_model: Feature distributions before training:
[2025-07-17 03:16:55] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:55] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:55] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:55] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:16:55] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:16:55] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 03:16:55] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 03:16:55] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 03:16:55] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 03:16:55] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 03:16:55] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 03:16:55] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 03:16:55] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 03:16:55] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 03:16:55] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 03:16:55] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 03:16:55] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 03:16:55] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 03:16:55] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 03:16:55] INFO train_model: Auditing data quality before training...
[2025-07-17 03:16:55] INFO train_model: Entering audit_data_quality
[2025-07-17 03:16:56] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:16:56] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:16:56] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 03:16:56] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:16:56] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:16:56] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:16:56] INFO train_model: Entering audit_data_quality
[2025-07-17 03:16:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:16:57] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:16:57] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:16:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:16:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:16:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:16:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:16:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:17:06] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:17:06] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:17:06] INFO train_model: Model is starting a new training session...
[2025-07-17 03:17:06] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:17:06] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:17:06] INFO train_model: Preparing target variable...
[2025-07-17 03:17:06] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:17:06] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:17:06] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:17:06] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:17:06] INFO train_model: Dropping NaN targets...
[2025-07-17 03:17:06] INFO train_model: Class distribution: [1332  773]
[2025-07-17 03:17:06] INFO train_model: Upsampling successful.
[2025-07-17 03:17:06] INFO train_model: Splitting train/test...
[2025-07-17 03:17:06] INFO train_model: Scaling features...
[2025-07-17 03:17:06] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:17:06] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:17:07] INFO train_model: Model fit complete.
[2025-07-17 03:17:07] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 03:17:07] INFO train_model: 
Classification Report:
[2025-07-17 03:17:07] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 03:17:07] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:17:07] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:17:07] INFO train_model: Feature distributions before training:
[2025-07-17 03:17:07] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:17:07] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:17:07] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:17:07] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:17:07] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:17:07] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:17:07] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:17:07] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:17:07] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:17:07] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:17:07] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:17:07] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:17:07] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:17:07] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:17:07] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:17:07] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:17:07] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:17:07] INFO train_model: Auditing data quality before training...
[2025-07-17 03:17:07] INFO train_model: Entering audit_data_quality
[2025-07-17 03:17:09] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:17:09] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:17:09] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:17:09] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:17:09] INFO train_model: Entering audit_data_quality
[2025-07-17 03:17:10] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:17:10] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:17:10] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:17:10] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:17:10] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:17:10] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:17:10] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:17:10] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:24:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:24:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:24:36] INFO train_model: Model is starting a new training session...
[2025-07-17 03:24:36] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:24:36] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:24:36] INFO train_model: Preparing target variable...
[2025-07-17 03:24:36] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:24:36] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:24:36] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:24:36] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:24:36] INFO train_model: Dropping NaN targets...
[2025-07-17 03:24:36] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:24:36] INFO train_model: Upsampling successful.
[2025-07-17 03:24:36] INFO train_model: Splitting train/test...
[2025-07-17 03:24:36] INFO train_model: Scaling features...
[2025-07-17 03:24:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:24:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:24:38] INFO train_model: Model fit complete.
[2025-07-17 03:24:38] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:24:38] INFO train_model: 
Classification Report:
[2025-07-17 03:24:38] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:24:38] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:24:38] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:24:38] INFO train_model: Feature distributions before training:
[2025-07-17 03:24:38] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:24:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:24:38] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:24:38] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:24:38] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:24:38] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:24:38] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:24:38] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:24:38] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:24:38] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:24:38] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:24:38] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:24:38] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:24:38] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:24:38] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:24:38] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:24:38] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:24:38] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:24:38] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:24:38] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:24:38] INFO train_model: Auditing data quality before training...
[2025-07-17 03:24:38] INFO train_model: Entering audit_data_quality
[2025-07-17 03:26:33] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:26:33] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:26:33] INFO train_model: Model is starting a new training session...
[2025-07-17 03:26:33] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:26:33] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:26:33] INFO train_model: Preparing target variable...
[2025-07-17 03:26:33] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:26:33] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:26:33] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:26:33] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:26:33] INFO train_model: Dropping NaN targets...
[2025-07-17 03:26:33] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:26:33] INFO train_model: Upsampling successful.
[2025-07-17 03:26:33] INFO train_model: Splitting train/test...
[2025-07-17 03:26:33] INFO train_model: Scaling features...
[2025-07-17 03:26:33] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:26:33] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:26:34] INFO train_model: Model fit complete.
[2025-07-17 03:26:34] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:26:34] INFO train_model: 
Classification Report:
[2025-07-17 03:26:34] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:26:34] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:26:34] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:26:34] INFO train_model: Feature distributions before training:
[2025-07-17 03:26:34] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:26:34] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:26:34] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:26:34] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:26:34] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:26:34] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:26:34] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:26:34] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:26:34] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:26:34] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:26:34] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:26:34] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:26:34] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:26:34] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:26:34] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:26:34] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:26:34] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:26:34] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:26:34] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:26:34] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:26:34] INFO train_model: Auditing data quality before training...
[2025-07-17 03:26:34] INFO train_model: Entering audit_data_quality
[2025-07-17 03:32:25] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:32:25] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:32:25] INFO train_model: Model is starting a new training session...
[2025-07-17 03:32:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:32:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:32:25] INFO train_model: Preparing target variable...
[2025-07-17 03:32:25] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:32:25] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:32:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:32:25] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:32:25] INFO train_model: Dropping NaN targets...
[2025-07-17 03:32:25] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:32:25] INFO train_model: Upsampling successful.
[2025-07-17 03:32:25] INFO train_model: Splitting train/test...
[2025-07-17 03:32:25] INFO train_model: Scaling features...
[2025-07-17 03:32:25] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:32:25] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:32:26] INFO train_model: Model fit complete.
[2025-07-17 03:32:26] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:32:26] INFO train_model: 
Classification Report:
[2025-07-17 03:32:26] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:32:26] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:32:26] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:32:26] INFO train_model: Feature distributions before training:
[2025-07-17 03:32:26] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:26] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:26] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:26] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:26] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:26] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:26] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:32:26] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:32:26] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:32:26] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:32:26] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:32:26] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:32:26] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:32:26] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:32:26] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:32:26] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:32:26] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:32:26] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:32:26] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:32:26] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:32:26] INFO train_model: Auditing data quality before training...
[2025-07-17 03:32:26] INFO train_model: Entering audit_data_quality
[2025-07-17 03:32:27] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:32:27] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:32:27] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:32:27] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:32:27] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:32:27] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:32:27] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:32:27] INFO train_model: Entering audit_data_quality
[2025-07-17 03:32:28] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:32:28] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:32:28] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:32:28] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:32:29] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:32:29] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:32:29] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:32:29] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:32:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:32:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:32:55] INFO train_model: Model is starting a new training session...
[2025-07-17 03:32:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:32:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:32:55] INFO train_model: Preparing target variable...
[2025-07-17 03:32:55] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:32:55] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:32:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:32:55] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:32:55] INFO train_model: Dropping NaN targets...
[2025-07-17 03:32:55] INFO train_model: Class distribution: [765 727]
[2025-07-17 03:32:55] INFO train_model: Upsampling successful.
[2025-07-17 03:32:55] INFO train_model: Splitting train/test...
[2025-07-17 03:32:55] INFO train_model: Scaling features...
[2025-07-17 03:32:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:32:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:32:57] INFO train_model: Model fit complete.
[2025-07-17 03:32:57] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 03:32:57] INFO train_model: 
Classification Report:
[2025-07-17 03:32:57] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 03:32:57] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:32:57] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:32:57] INFO train_model: Feature distributions before training:
[2025-07-17 03:32:57] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:57] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:57] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:32:57] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:32:57] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 03:32:57] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 03:32:57] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 03:32:57] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 03:32:57] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 03:32:57] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 03:32:57] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 03:32:57] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 03:32:57] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 03:32:57] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 03:32:57] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 03:32:57] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 03:32:57] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 03:32:57] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 03:32:57] INFO train_model: Auditing data quality before training...
[2025-07-17 03:32:57] INFO train_model: Entering audit_data_quality
[2025-07-17 03:32:59] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:32:59] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:32:59] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 03:32:59] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:32:59] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:32:59] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:32:59] INFO train_model: Entering audit_data_quality
[2025-07-17 03:33:00] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:33:00] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:33:00] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:33:00] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:33:00] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:33:00] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:33:00] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:33:00] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:33:07] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:33:07] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:33:07] INFO train_model: Model is starting a new training session...
[2025-07-17 03:33:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:33:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:33:07] INFO train_model: Preparing target variable...
[2025-07-17 03:33:07] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:33:07] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:33:07] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:33:07] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:33:07] INFO train_model: Dropping NaN targets...
[2025-07-17 03:33:07] INFO train_model: Class distribution: [1332  773]
[2025-07-17 03:33:07] INFO train_model: Upsampling successful.
[2025-07-17 03:33:07] INFO train_model: Splitting train/test...
[2025-07-17 03:33:07] INFO train_model: Scaling features...
[2025-07-17 03:33:07] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:33:07] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:33:09] INFO train_model: Model fit complete.
[2025-07-17 03:33:09] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 03:33:09] INFO train_model: 
Classification Report:
[2025-07-17 03:33:09] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 03:33:09] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:33:09] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:33:09] INFO train_model: Feature distributions before training:
[2025-07-17 03:33:09] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:33:09] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:33:09] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:33:09] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:33:09] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:33:09] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:33:09] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:33:09] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:33:09] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:33:09] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:33:09] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:33:09] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:33:09] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:33:09] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:33:09] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:33:09] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:33:09] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:33:09] INFO train_model: Auditing data quality before training...
[2025-07-17 03:33:09] INFO train_model: Entering audit_data_quality
[2025-07-17 03:33:10] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:33:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:33:10] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:33:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:33:10] INFO train_model: Entering audit_data_quality
[2025-07-17 03:33:11] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:33:11] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:33:11] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:33:11] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:33:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:33:11] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:33:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:33:11] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:40:44] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:40:44] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:40:44] INFO train_model: Model is starting a new training session...
[2025-07-17 03:40:44] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:40:44] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:40:44] INFO train_model: Preparing target variable...
[2025-07-17 03:40:44] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:40:44] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:40:44] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:40:44] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:40:44] INFO train_model: Dropping NaN targets...
[2025-07-17 03:40:44] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:40:44] INFO train_model: Upsampling successful.
[2025-07-17 03:40:44] INFO train_model: Splitting train/test...
[2025-07-17 03:40:44] INFO train_model: Scaling features...
[2025-07-17 03:40:44] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:40:44] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:40:46] INFO train_model: Model fit complete.
[2025-07-17 03:40:46] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:40:46] INFO train_model: 
Classification Report:
[2025-07-17 03:40:46] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:40:46] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:40:46] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:40:46] INFO train_model: Feature distributions before training:
[2025-07-17 03:40:46] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:40:46] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:40:46] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:40:46] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:40:46] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:40:46] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:40:46] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:40:46] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:40:46] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:40:46] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:40:46] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:40:46] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:40:46] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:40:46] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:40:46] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:40:46] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:40:46] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:40:46] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:40:46] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:40:46] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:40:46] INFO train_model: Auditing data quality before training...
[2025-07-17 03:40:46] INFO train_model: Entering audit_data_quality
[2025-07-17 03:40:47] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:40:47] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:40:47] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:40:47] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:40:47] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:40:47] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:40:47] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:40:47] INFO train_model: Entering audit_data_quality
[2025-07-17 03:40:48] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:40:48] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:40:48] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:40:48] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:40:48] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:40:48] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:40:48] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:40:48] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:41:13] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:13] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:13] INFO train_model: Model is starting a new training session...
[2025-07-17 03:41:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:41:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:13] INFO train_model: Preparing target variable...
[2025-07-17 03:41:13] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:13] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:13] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:41:13] INFO train_model: Dropping NaN targets...
[2025-07-17 03:41:13] INFO train_model: Class distribution: [765 727]
[2025-07-17 03:41:13] INFO train_model: Upsampling successful.
[2025-07-17 03:41:13] INFO train_model: Splitting train/test...
[2025-07-17 03:41:13] INFO train_model: Scaling features...
[2025-07-17 03:41:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:41:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:41:14] INFO train_model: Model fit complete.
[2025-07-17 03:41:14] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 03:41:14] INFO train_model: 
Classification Report:
[2025-07-17 03:41:14] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 03:41:14] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:41:14] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:41:14] INFO train_model: Feature distributions before training:
[2025-07-17 03:41:14] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:14] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:14] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:14] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:14] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:14] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 03:41:14] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 03:41:14] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 03:41:14] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 03:41:14] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 03:41:14] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 03:41:14] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 03:41:14] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 03:41:14] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 03:41:14] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 03:41:14] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 03:41:14] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 03:41:14] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 03:41:14] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 03:41:14] INFO train_model: Auditing data quality before training...
[2025-07-17 03:41:14] INFO train_model: Entering audit_data_quality
[2025-07-17 03:41:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:41:15] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:41:15] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 03:41:15] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:41:15] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:41:15] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:41:15] INFO train_model: Entering audit_data_quality
[2025-07-17 03:41:16] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:41:16] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:41:16] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:41:16] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:41:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:41:16] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:41:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:41:16] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:41:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:23] INFO train_model: Model is starting a new training session...
[2025-07-17 03:41:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:41:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:23] INFO train_model: Preparing target variable...
[2025-07-17 03:41:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:23] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:23] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:41:23] INFO train_model: Dropping NaN targets...
[2025-07-17 03:41:23] INFO train_model: Class distribution: [1332  773]
[2025-07-17 03:41:23] INFO train_model: Upsampling successful.
[2025-07-17 03:41:23] INFO train_model: Splitting train/test...
[2025-07-17 03:41:23] INFO train_model: Scaling features...
[2025-07-17 03:41:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:41:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:41:25] INFO train_model: Model fit complete.
[2025-07-17 03:41:25] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 03:41:25] INFO train_model: 
Classification Report:
[2025-07-17 03:41:25] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 03:41:25] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:41:25] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:41:25] INFO train_model: Feature distributions before training:
[2025-07-17 03:41:25] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:25] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:25] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:25] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:41:25] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:41:25] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:41:25] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:41:25] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:41:25] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:41:25] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:41:25] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:41:25] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:41:25] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:41:25] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:41:25] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:41:25] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:41:25] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:41:25] INFO train_model: Auditing data quality before training...
[2025-07-17 03:41:25] INFO train_model: Entering audit_data_quality
[2025-07-17 03:41:39] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:39] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:39] INFO train_model: Model is starting a new training session...
[2025-07-17 03:41:39] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:41:39] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:39] INFO train_model: Preparing target variable...
[2025-07-17 03:41:39] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:39] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:39] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:39] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:41:39] INFO train_model: Dropping NaN targets...
[2025-07-17 03:41:39] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:41:39] INFO train_model: Upsampling successful.
[2025-07-17 03:41:39] INFO train_model: Splitting train/test...
[2025-07-17 03:41:39] INFO train_model: Scaling features...
[2025-07-17 03:41:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:41:39] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:41:40] INFO train_model: Model fit complete.
[2025-07-17 03:41:40] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:41:40] INFO train_model: 
Classification Report:
[2025-07-17 03:41:40] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:41:40] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:41:40] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:41:40] INFO train_model: Feature distributions before training:
[2025-07-17 03:41:40] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:40] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:40] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:40] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:41:40] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:41:40] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:41:40] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:41:40] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:41:40] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:41:40] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:41:40] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:41:40] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:41:40] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:41:40] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:41:40] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:41:40] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:41:40] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:41:40] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:41:40] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:41:40] INFO train_model: Auditing data quality before training...
[2025-07-17 03:41:40] INFO train_model: Entering audit_data_quality
[2025-07-17 03:41:42] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:41:42] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:41:42] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:41:42] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:41:42] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:41:42] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:41:42] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:41:42] INFO train_model: Entering audit_data_quality
[2025-07-17 03:41:43] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:41:43] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:41:43] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:41:43] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:41:43] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:41:43] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:41:43] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:41:43] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:41:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:59] INFO train_model: Model is starting a new training session...
[2025-07-17 03:41:59] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:41:59] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:59] INFO train_model: Preparing target variable...
[2025-07-17 03:41:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:41:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:41:59] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:41:59] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:41:59] INFO train_model: Dropping NaN targets...
[2025-07-17 03:41:59] INFO train_model: Class distribution: [765 727]
[2025-07-17 03:41:59] INFO train_model: Upsampling successful.
[2025-07-17 03:41:59] INFO train_model: Splitting train/test...
[2025-07-17 03:41:59] INFO train_model: Scaling features...
[2025-07-17 03:41:59] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:41:59] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:42:00] INFO train_model: Model fit complete.
[2025-07-17 03:42:00] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 03:42:00] INFO train_model: 
Classification Report:
[2025-07-17 03:42:00] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 03:42:00] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:42:00] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:42:00] INFO train_model: Feature distributions before training:
[2025-07-17 03:42:00] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:42:00] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:42:00] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:42:00] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:42:00] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:00] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 03:42:00] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 03:42:00] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 03:42:00] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 03:42:00] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 03:42:00] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 03:42:00] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 03:42:00] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 03:42:00] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 03:42:00] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 03:42:00] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 03:42:00] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 03:42:00] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 03:42:00] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 03:42:00] INFO train_model: Auditing data quality before training...
[2025-07-17 03:42:00] INFO train_model: Entering audit_data_quality
[2025-07-17 03:42:01] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:42:01] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:42:01] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 03:42:01] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:42:01] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:42:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:42:01] INFO train_model: Entering audit_data_quality
[2025-07-17 03:42:02] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:42:02] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:42:02] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:42:02] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:42:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:42:02] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:42:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:42:02] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:42:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:42:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:42:09] INFO train_model: Model is starting a new training session...
[2025-07-17 03:42:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:42:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:42:09] INFO train_model: Preparing target variable...
[2025-07-17 03:42:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:42:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:42:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:42:09] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:42:09] INFO train_model: Dropping NaN targets...
[2025-07-17 03:42:09] INFO train_model: Class distribution: [1332  773]
[2025-07-17 03:42:09] INFO train_model: Upsampling successful.
[2025-07-17 03:42:09] INFO train_model: Splitting train/test...
[2025-07-17 03:42:09] INFO train_model: Scaling features...
[2025-07-17 03:42:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:42:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:42:10] INFO train_model: Model fit complete.
[2025-07-17 03:42:10] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 03:42:10] INFO train_model: 
Classification Report:
[2025-07-17 03:42:10] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 03:42:10] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:42:10] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:42:10] INFO train_model: Feature distributions before training:
[2025-07-17 03:42:10] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:42:10] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:42:10] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:42:10] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:42:10] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:42:10] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:42:10] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:42:10] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:42:10] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:42:10] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:42:10] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:42:10] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:42:10] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:42:10] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:42:10] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:42:10] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:42:10] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:42:10] INFO train_model: Auditing data quality before training...
[2025-07-17 03:42:10] INFO train_model: Entering audit_data_quality
[2025-07-17 03:42:12] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:42:12] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:42:12] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:42:12] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:42:12] INFO train_model: Entering audit_data_quality
[2025-07-17 03:42:13] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:42:13] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:42:13] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:42:13] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:42:13] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:42:13] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:42:13] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:42:13] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:48:42] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:48:42] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:48:42] INFO train_model: Model is starting a new training session...
[2025-07-17 03:48:42] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:48:42] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:48:42] INFO train_model: Preparing target variable...
[2025-07-17 03:48:42] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:48:42] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:48:42] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:48:42] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:48:42] INFO train_model: Dropping NaN targets...
[2025-07-17 03:48:42] INFO train_model: Class distribution: [1391  714]
[2025-07-17 03:48:42] INFO train_model: Upsampling successful.
[2025-07-17 03:48:42] INFO train_model: Splitting train/test...
[2025-07-17 03:48:42] INFO train_model: Scaling features...
[2025-07-17 03:48:42] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:48:42] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:48:43] INFO train_model: Model fit complete.
[2025-07-17 03:48:43] INFO train_model: Model Accuracy: 0.8815
[2025-07-17 03:48:43] INFO train_model: 
Classification Report:
[2025-07-17 03:48:43] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.90      0.88       279
           1       0.89      0.87      0.88       278

    accuracy                           0.88       557
   macro avg       0.88      0.88      0.88       557
weighted avg       0.88      0.88      0.88       557

[2025-07-17 03:48:43] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:48:43] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:48:43] INFO train_model: Feature distributions before training:
[2025-07-17 03:48:43] INFO train_model: supply_zone: mean=0.4181, std=0.4934, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: demand_zone: mean=0.3701, std=0.4829, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: wyckoff_markdown: mean=0.4960, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: wyckoff_markup: mean=0.4850, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1366, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:48:43] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:48:43] INFO train_model: head_shoulders: mean=0.0323, std=0.1768, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: inv_head_shoulders: mean=0.0333, std=0.1793, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:48:43] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:48:43] INFO train_model: rising_wedge: mean=0.2603, std=0.4389, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: falling_wedge: mean=0.2304, std=0.4212, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:48:43] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:48:43] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:48:43] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:48:43] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:48:43] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:48:43] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:48:43] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:48:43] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:48:43] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:48:43] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:48:43] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:48:43] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:48:43] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:48:43] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:48:43] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:48:43] INFO train_model: Auditing data quality before training...
[2025-07-17 03:48:43] INFO train_model: Entering audit_data_quality
[2025-07-17 03:48:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:48:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:48:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:48:44] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:48:44] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:48:44] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 03:48:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:48:44] INFO train_model: Entering audit_data_quality
[2025-07-17 03:48:46] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:48:46] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:48:46] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:48:46] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:48:46] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:48:46] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:48:46] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:48:46] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:49:04] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:49:04] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:49:04] INFO train_model: Model is starting a new training session...
[2025-07-17 03:49:04] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:49:04] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:49:04] INFO train_model: Preparing target variable...
[2025-07-17 03:49:04] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:49:04] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:49:04] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:49:04] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:49:04] INFO train_model: Dropping NaN targets...
[2025-07-17 03:49:04] INFO train_model: Class distribution: [765 727]
[2025-07-17 03:49:04] INFO train_model: Upsampling successful.
[2025-07-17 03:49:04] INFO train_model: Splitting train/test...
[2025-07-17 03:49:04] INFO train_model: Scaling features...
[2025-07-17 03:49:04] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:49:04] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:49:05] INFO train_model: Model fit complete.
[2025-07-17 03:49:05] INFO train_model: Model Accuracy: 0.7810
[2025-07-17 03:49:05] INFO train_model: 
Classification Report:
[2025-07-17 03:49:05] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.78       153
           1       0.79      0.76      0.78       153

    accuracy                           0.78       306
   macro avg       0.78      0.78      0.78       306
weighted avg       0.78      0.78      0.78       306

[2025-07-17 03:49:05] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:49:05] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:49:05] INFO train_model: Feature distributions before training:
[2025-07-17 03:49:05] INFO train_model: supply_zone: mean=0.2507, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: demand_zone: mean=0.1622, std=0.3688, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:49:05] INFO train_model: wyckoff_distribution: mean=0.1803, std=0.3846, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: wyckoff_markdown: mean=0.3070, std=0.4614, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: wyckoff_markup: mean=0.5127, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:49:05] INFO train_model: head_shoulders: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:49:05] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:49:05] INFO train_model: rising_wedge: mean=0.2647, std=0.4413, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: falling_wedge: mean=0.2339, std=0.4235, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: fakeout_up: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: fakeout_down: mean=0.0054, std=0.0731, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:05] INFO train_model: sma_20_4h: mean=144.5484, std=1.5887, min=140.5166, max=148.8194, unique=1491
[2025-07-17 03:49:05] INFO train_model: sma_50_4h: mean=144.4861, std=1.4825, min=140.9014, max=148.3217, unique=1491
[2025-07-17 03:49:05] INFO train_model: ema_12_4h: mean=144.5643, std=1.6002, min=140.4309, max=148.8021, unique=1492
[2025-07-17 03:49:05] INFO train_model: ema_26_4h: mean=144.5359, std=1.5400, min=140.6371, max=148.5877, unique=1492
[2025-07-17 03:49:05] INFO train_model: rsi_14_4h: mean=50.3959, std=34.3520, min=0.0000, max=100.0000, unique=550
[2025-07-17 03:49:05] INFO train_model: macd_4h: mean=0.0284, std=0.2276, min=-0.4377, max=0.7986, unique=1492
[2025-07-17 03:49:05] INFO train_model: macd_signal_4h: mean=0.0285, std=0.2133, min=-0.3715, max=0.7178, unique=1492
[2025-07-17 03:49:05] INFO train_model: bb_high_4h: mean=145.2094, std=1.6363, min=140.8112, max=149.7951, unique=1492
[2025-07-17 03:49:05] INFO train_model: bb_low_4h: mean=143.8875, std=1.6302, min=139.1342, max=148.6325, unique=1492
[2025-07-17 03:49:05] INFO train_model: atr_14_4h: mean=0.5725, std=0.1877, min=0.1883, max=1.4068, unique=1476
[2025-07-17 03:49:05] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1894, min=0.0575, max=1.2618, unique=1492
[2025-07-17 03:49:05] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1492
[2025-07-17 03:49:05] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1492
[2025-07-17 03:49:05] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1492
[2025-07-17 03:49:05] INFO train_model: Auditing data quality before training...
[2025-07-17 03:49:05] INFO train_model: Entering audit_data_quality
[2025-07-17 03:49:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:49:06] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:49:06] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 03:49:06] WARNING train_model: Removing constant feature: double_top
[2025-07-17 03:49:06] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 03:49:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:49:06] INFO train_model: Entering audit_data_quality
[2025-07-17 03:49:07] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:49:07] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:49:07] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:49:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:49:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:49:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:49:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:49:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 03:49:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:49:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:49:14] INFO train_model: Model is starting a new training session...
[2025-07-17 03:49:14] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 03:49:14] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:49:14] INFO train_model: Preparing target variable...
[2025-07-17 03:49:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 03:49:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 03:49:14] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 03:49:14] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:49:14] INFO train_model: Dropping NaN targets...
[2025-07-17 03:49:14] INFO train_model: Class distribution: [1332  773]
[2025-07-17 03:49:14] INFO train_model: Upsampling successful.
[2025-07-17 03:49:14] INFO train_model: Splitting train/test...
[2025-07-17 03:49:14] INFO train_model: Scaling features...
[2025-07-17 03:49:14] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 03:49:14] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 03:49:16] INFO train_model: Model fit complete.
[2025-07-17 03:49:16] INFO train_model: Model Accuracy: 0.8780
[2025-07-17 03:49:16] INFO train_model: 
Classification Report:
[2025-07-17 03:49:16] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.87      0.88       267
           1       0.87      0.89      0.88       266

    accuracy                           0.88       533
   macro avg       0.88      0.88      0.88       533
weighted avg       0.88      0.88      0.88       533

[2025-07-17 03:49:16] INFO train_model: Model is saving trained model and scaler...
[2025-07-17 03:49:16] INFO train_model: Model saved to models/saved_models/signal_model.pkl
[2025-07-17 03:49:16] INFO train_model: Feature distributions before training:
[2025-07-17 03:49:16] INFO train_model: supply_zone: mean=0.4385, std=0.4963, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: demand_zone: mean=0.3401, std=0.4739, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: wyckoff_markdown: mean=0.4157, std=0.4930, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: wyckoff_markup: mean=0.5658, std=0.4958, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: wyckoff_unknown: mean=0.0185, std=0.1349, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:49:16] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 03:49:16] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: inv_head_shoulders: mean=0.0257, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: double_top: mean=0.0029, std=0.0533, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: double_bottom: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: rising_wedge: mean=0.2879, std=0.4529, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: falling_wedge: mean=0.2504, std=0.4333, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: fakeout_up: mean=0.0010, std=0.0308, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: fakeout_down: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 03:49:16] INFO train_model: sma_20_4h: mean=145.3455, std=2.3835, min=140.5166, max=150.9374, unique=2084
[2025-07-17 03:49:16] INFO train_model: sma_50_4h: mean=145.2976, std=2.3181, min=140.9014, max=150.6738, unique=2052
[2025-07-17 03:49:16] INFO train_model: ema_12_4h: mean=145.3729, std=2.3939, min=140.4309, max=150.9399, unique=2105
[2025-07-17 03:49:16] INFO train_model: ema_26_4h: mean=145.3735, std=2.3616, min=140.6371, max=150.7944, unique=2105
[2025-07-17 03:49:16] INFO train_model: rsi_14_4h: mean=49.2337, std=32.9477, min=0.0000, max=100.0000, unique=799
[2025-07-17 03:49:16] INFO train_model: macd_4h: mean=-0.0005, std=0.2402, min=-0.9388, max=0.7986, unique=2105
[2025-07-17 03:49:16] INFO train_model: macd_signal_4h: mean=-0.0003, std=0.2246, min=-0.8130, max=0.7178, unique=2105
[2025-07-17 03:49:16] INFO train_model: bb_high_4h: mean=146.0512, std=2.4466, min=140.8112, max=151.4645, unique=2086
[2025-07-17 03:49:16] INFO train_model: bb_low_4h: mean=144.6399, std=2.3999, min=139.1342, max=150.7418, unique=2086
[2025-07-17 03:49:16] INFO train_model: atr_14_4h: mean=0.6271, std=0.2774, min=0.1483, max=2.0255, unique=2067
[2025-07-17 03:49:16] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2189, min=0.0338, max=1.2700, unique=2086
[2025-07-17 03:49:16] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2086
[2025-07-17 03:49:16] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2054
[2025-07-17 03:49:16] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2056
[2025-07-17 03:49:16] INFO train_model: Auditing data quality before training...
[2025-07-17 03:49:16] INFO train_model: Entering audit_data_quality
[2025-07-17 03:49:17] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:49:17] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 03:49:17] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 03:49:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 03:49:17] INFO train_model: Entering audit_data_quality
[2025-07-17 03:49:19] INFO train_model: Exiting audit_data_quality
[2025-07-17 03:49:19] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 03:49:19] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_features.json
[2025-07-17 03:49:19] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 03:49:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:49:19] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 03:49:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 03:49:19] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 04:13:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:13:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:13:23] INFO train_model: Model is starting a new training session...
[2025-07-17 04:13:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:13:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:13:23] INFO train_model: Preparing target variable...
[2025-07-17 04:13:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:13:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:13:23] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:13:23] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:13:23] INFO train_model: Dropping NaN targets...
[2025-07-17 04:13:23] INFO train_model: Class distribution: [1392  717]
[2025-07-17 04:13:23] INFO train_model: Upsampling successful.
[2025-07-17 04:13:23] INFO train_model: Splitting train/test...
[2025-07-17 04:13:23] INFO train_model: Scaling features...
[2025-07-17 04:13:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:13:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:13:25] INFO train_model: Model fit complete.
[2025-07-17 04:13:25] INFO train_model: Model Accuracy: 0.8743
[2025-07-17 04:13:25] INFO train_model: 
Classification Report:
[2025-07-17 04:13:25] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.89      0.88       279
           1       0.89      0.86      0.87       278

    accuracy                           0.87       557
   macro avg       0.87      0.87      0.87       557
weighted avg       0.87      0.87      0.87       557

[2025-07-17 04:13:43] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:13:43] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:13:43] INFO train_model: Model is starting a new training session...
[2025-07-17 04:13:43] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:13:43] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:13:43] INFO train_model: Preparing target variable...
[2025-07-17 04:13:43] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:13:43] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:13:43] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:13:43] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:13:43] INFO train_model: Dropping NaN targets...
[2025-07-17 04:13:43] INFO train_model: Class distribution: [769 727]
[2025-07-17 04:13:43] INFO train_model: Upsampling successful.
[2025-07-17 04:13:43] INFO train_model: Splitting train/test...
[2025-07-17 04:13:43] INFO train_model: Scaling features...
[2025-07-17 04:13:43] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:13:43] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:13:44] INFO train_model: Model fit complete.
[2025-07-17 04:13:44] INFO train_model: Model Accuracy: 0.8149
[2025-07-17 04:13:44] INFO train_model: 
Classification Report:
[2025-07-17 04:13:44] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.87      0.82       154
           1       0.85      0.76      0.80       154

    accuracy                           0.81       308
   macro avg       0.82      0.81      0.81       308
weighted avg       0.82      0.81      0.81       308

[2025-07-17 04:18:32] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:18:32] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:18:32] INFO train_model: Model is starting a new training session...
[2025-07-17 04:18:32] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:18:32] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:18:32] INFO train_model: Preparing target variable...
[2025-07-17 04:18:32] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:18:32] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:18:32] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:18:32] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:18:32] INFO train_model: Dropping NaN targets...
[2025-07-17 04:18:32] INFO train_model: Class distribution: [1392  717]
[2025-07-17 04:18:32] INFO train_model: Upsampling successful.
[2025-07-17 04:18:32] INFO train_model: Splitting train/test...
[2025-07-17 04:18:32] INFO train_model: Scaling features...
[2025-07-17 04:18:32] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:18:32] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:18:34] INFO train_model: Model fit complete.
[2025-07-17 04:18:34] INFO train_model: Model Accuracy: 0.8743
[2025-07-17 04:18:34] INFO train_model: 
Classification Report:
[2025-07-17 04:18:34] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.89      0.88       279
           1       0.89      0.86      0.87       278

    accuracy                           0.87       557
   macro avg       0.87      0.87      0.87       557
weighted avg       0.87      0.87      0.87       557

[2025-07-17 04:18:34] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 04:18:34] INFO train_model: Feature distributions before training:
[2025-07-17 04:18:34] INFO train_model: supply_zone: mean=0.4173, std=0.4932, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: demand_zone: mean=0.3694, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: wyckoff_markdown: mean=0.4950, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: wyckoff_markup: mean=0.4860, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1364, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:34] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:34] INFO train_model: head_shoulders: mean=0.0322, std=0.1767, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: inv_head_shoulders: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:34] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:34] INFO train_model: rising_wedge: mean=0.2598, std=0.4387, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: falling_wedge: mean=0.2314, std=0.4218, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:34] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:34] INFO train_model: sma_20_4h: mean=145.3512, std=2.3847, min=140.5166, max=150.9374, unique=2088
[2025-07-17 04:18:34] INFO train_model: sma_50_4h: mean=145.3035, std=2.3197, min=140.9014, max=150.6738, unique=2056
[2025-07-17 04:18:34] INFO train_model: ema_12_4h: mean=145.3783, std=2.3948, min=140.4309, max=150.9399, unique=2109
[2025-07-17 04:18:34] INFO train_model: ema_26_4h: mean=145.3790, std=2.3628, min=140.6371, max=150.7944, unique=2109
[2025-07-17 04:18:34] INFO train_model: rsi_14_4h: mean=49.2255, std=32.9173, min=0.0000, max=100.0000, unique=801
[2025-07-17 04:18:34] INFO train_model: macd_4h: mean=-0.0007, std=0.2400, min=-0.9388, max=0.7986, unique=2109
[2025-07-17 04:18:34] INFO train_model: macd_signal_4h: mean=-0.0005, std=0.2244, min=-0.8130, max=0.7178, unique=2109
[2025-07-17 04:18:34] INFO train_model: bb_high_4h: mean=146.0568, std=2.4477, min=140.8112, max=151.4645, unique=2090
[2025-07-17 04:18:34] INFO train_model: bb_low_4h: mean=144.6456, std=2.4011, min=139.1342, max=150.7418, unique=2090
[2025-07-17 04:18:34] INFO train_model: atr_14_4h: mean=0.6274, std=0.2772, min=0.1483, max=2.0255, unique=2071
[2025-07-17 04:18:34] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2187, min=0.0338, max=1.2700, unique=2090
[2025-07-17 04:18:34] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2090
[2025-07-17 04:18:34] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2058
[2025-07-17 04:18:34] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2060
[2025-07-17 04:18:34] INFO train_model: Auditing data quality before training...
[2025-07-17 04:18:34] INFO train_model: Entering audit_data_quality
[2025-07-17 04:18:35] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:18:35] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 04:18:35] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 04:18:35] WARNING train_model: Removing constant feature: double_top
[2025-07-17 04:18:35] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 04:18:35] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 04:18:35] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 04:18:35] INFO train_model: Entering audit_data_quality
[2025-07-17 04:18:36] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:18:36] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:18:36] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 04:18:36] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 04:18:37] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:18:37] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 04:18:37] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:18:37] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 04:18:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:18:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:18:51] INFO train_model: Model is starting a new training session...
[2025-07-17 04:18:51] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:18:51] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:18:51] INFO train_model: Preparing target variable...
[2025-07-17 04:18:51] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:18:51] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:18:51] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:18:51] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:18:51] INFO train_model: Dropping NaN targets...
[2025-07-17 04:18:51] INFO train_model: Class distribution: [769 727]
[2025-07-17 04:18:51] INFO train_model: Upsampling successful.
[2025-07-17 04:18:51] INFO train_model: Splitting train/test...
[2025-07-17 04:18:51] INFO train_model: Scaling features...
[2025-07-17 04:18:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:18:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:18:52] INFO train_model: Model fit complete.
[2025-07-17 04:18:52] INFO train_model: Model Accuracy: 0.8149
[2025-07-17 04:18:52] INFO train_model: 
Classification Report:
[2025-07-17 04:18:52] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.87      0.82       154
           1       0.85      0.76      0.80       154

    accuracy                           0.81       308
   macro avg       0.82      0.81      0.81       308
weighted avg       0.82      0.81      0.81       308

[2025-07-17 04:18:52] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 04:18:52] INFO train_model: Feature distributions before training:
[2025-07-17 04:18:52] INFO train_model: supply_zone: mean=0.2500, std=0.4332, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: demand_zone: mean=0.1631, std=0.3696, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:52] INFO train_model: wyckoff_distribution: mean=0.1818, std=0.3858, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: wyckoff_markdown: mean=0.3061, std=0.4610, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: wyckoff_markup: mean=0.5120, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:52] INFO train_model: head_shoulders: mean=0.0354, std=0.1849, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: inv_head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:52] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:18:52] INFO train_model: rising_wedge: mean=0.2640, std=0.4410, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: falling_wedge: mean=0.2333, std=0.4231, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: fakeout_up: mean=0.0053, std=0.0730, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: fakeout_down: mean=0.0053, std=0.0730, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:18:52] INFO train_model: sma_20_4h: mean=144.5585, std=1.5984, min=140.5166, max=148.8194, unique=1495
[2025-07-17 04:18:52] INFO train_model: sma_50_4h: mean=144.4965, std=1.4940, min=140.9014, max=148.3830, unique=1495
[2025-07-17 04:18:52] INFO train_model: ema_12_4h: mean=144.5741, std=1.6091, min=140.4309, max=148.8021, unique=1496
[2025-07-17 04:18:52] INFO train_model: ema_26_4h: mean=144.5460, std=1.5501, min=140.6371, max=148.5877, unique=1496
[2025-07-17 04:18:52] INFO train_model: rsi_14_4h: mean=50.3814, std=34.3078, min=0.0000, max=100.0000, unique=552
[2025-07-17 04:18:52] INFO train_model: macd_4h: mean=0.0281, std=0.2274, min=-0.4377, max=0.7986, unique=1496
[2025-07-17 04:18:52] INFO train_model: macd_signal_4h: mean=0.0282, std=0.2131, min=-0.3715, max=0.7178, unique=1496
[2025-07-17 04:18:52] INFO train_model: bb_high_4h: mean=145.2195, std=1.6457, min=140.8112, max=149.7951, unique=1496
[2025-07-17 04:18:52] INFO train_model: bb_low_4h: mean=143.8974, std=1.6394, min=139.1342, max=148.6325, unique=1496
[2025-07-17 04:18:52] INFO train_model: atr_14_4h: mean=0.5730, std=0.1878, min=0.1883, max=1.4068, unique=1480
[2025-07-17 04:18:52] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1891, min=0.0575, max=1.2618, unique=1496
[2025-07-17 04:18:52] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1496
[2025-07-17 04:18:52] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1496
[2025-07-17 04:18:52] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1496
[2025-07-17 04:18:52] INFO train_model: Auditing data quality before training...
[2025-07-17 04:18:52] INFO train_model: Entering audit_data_quality
[2025-07-17 04:18:53] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:18:53] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 04:18:53] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 04:18:53] WARNING train_model: Removing constant feature: double_top
[2025-07-17 04:18:53] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 04:18:53] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 04:18:53] INFO train_model: Entering audit_data_quality
[2025-07-17 04:18:55] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:18:55] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:18:55] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 04:18:55] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 04:18:55] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:18:55] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 04:18:55] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:18:55] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 04:26:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:26:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:26:31] INFO train_model: Model is starting a new training session...
[2025-07-17 04:26:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:26:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:26:31] INFO train_model: Preparing target variable...
[2025-07-17 04:26:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:26:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:26:31] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:26:31] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:26:31] INFO train_model: Dropping NaN targets...
[2025-07-17 04:26:31] INFO train_model: Class distribution: [1392  717]
[2025-07-17 04:26:31] INFO train_model: Upsampling successful.
[2025-07-17 04:26:31] INFO train_model: Splitting train/test...
[2025-07-17 04:26:31] INFO train_model: Scaling features...
[2025-07-17 04:26:31] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:26:31] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:26:32] INFO train_model: Model fit complete.
[2025-07-17 04:26:32] INFO train_model: Model Accuracy: 0.8869
[2025-07-17 04:26:32] INFO train_model: 
Classification Report:
[2025-07-17 04:26:32] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.91      0.89       279
           1       0.90      0.87      0.88       278

    accuracy                           0.89       557
   macro avg       0.89      0.89      0.89       557
weighted avg       0.89      0.89      0.89       557

[2025-07-17 04:26:32] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 04:26:32] INFO train_model: Feature distributions before training:
[2025-07-17 04:26:32] INFO train_model: supply_zone: mean=0.4173, std=0.4932, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: demand_zone: mean=0.3694, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: wyckoff_markdown: mean=0.4950, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: wyckoff_markup: mean=0.4860, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: wyckoff_unknown: mean=0.0190, std=0.1364, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:32] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:32] INFO train_model: head_shoulders: mean=0.0322, std=0.1767, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: inv_head_shoulders: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:32] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:32] INFO train_model: rising_wedge: mean=0.2598, std=0.4387, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: falling_wedge: mean=0.2314, std=0.4218, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: fakeout_up: mean=0.0005, std=0.0218, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:32] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:32] INFO train_model: sma_20_4h: mean=145.3512, std=2.3847, min=140.5166, max=150.9374, unique=2088
[2025-07-17 04:26:32] INFO train_model: sma_50_4h: mean=145.3035, std=2.3197, min=140.9014, max=150.6738, unique=2056
[2025-07-17 04:26:32] INFO train_model: ema_12_4h: mean=145.3783, std=2.3948, min=140.4309, max=150.9399, unique=2109
[2025-07-17 04:26:32] INFO train_model: ema_26_4h: mean=145.3790, std=2.3628, min=140.6371, max=150.7944, unique=2109
[2025-07-17 04:26:32] INFO train_model: rsi_14_4h: mean=49.2255, std=32.9173, min=0.0000, max=100.0000, unique=801
[2025-07-17 04:26:32] INFO train_model: macd_4h: mean=-0.0007, std=0.2400, min=-0.9388, max=0.7986, unique=2109
[2025-07-17 04:26:32] INFO train_model: macd_signal_4h: mean=-0.0005, std=0.2244, min=-0.8130, max=0.7178, unique=2109
[2025-07-17 04:26:32] INFO train_model: bb_high_4h: mean=146.0568, std=2.4477, min=140.8112, max=151.4645, unique=2090
[2025-07-17 04:26:32] INFO train_model: bb_low_4h: mean=144.6456, std=2.4011, min=139.1342, max=150.7418, unique=2090
[2025-07-17 04:26:32] INFO train_model: atr_14_4h: mean=0.6274, std=0.2772, min=0.1483, max=2.0255, unique=2071
[2025-07-17 04:26:32] INFO train_model: volatility_20_4h: mean=0.3528, std=0.2187, min=0.0338, max=1.2700, unique=2090
[2025-07-17 04:26:32] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0038, min=-0.0154, max=0.0185, unique=2090
[2025-07-17 04:26:32] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0059, min=-0.0229, max=0.0202, unique=2058
[2025-07-17 04:26:32] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0022, min=0.0000, max=0.0125, unique=2060
[2025-07-17 04:26:32] INFO train_model: Auditing data quality before training...
[2025-07-17 04:26:33] INFO train_model: Entering audit_data_quality
[2025-07-17 04:26:34] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:26:34] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 04:26:34] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 04:26:34] WARNING train_model: Removing constant feature: double_top
[2025-07-17 04:26:34] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 04:26:34] WARNING train_model: Removing constant feature: fakeout_down
[2025-07-17 04:26:34] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 04:26:34] INFO train_model: Entering audit_data_quality
[2025-07-17 04:26:35] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:26:35] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:26:35] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 04:26:35] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 04:26:35] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:26:35] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 04:26:35] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:26:35] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 04:26:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:26:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:26:54] INFO train_model: Model is starting a new training session...
[2025-07-17 04:26:54] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:26:54] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:26:54] INFO train_model: Preparing target variable...
[2025-07-17 04:26:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:26:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:26:54] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'future_return', 'target'],
      dtype='object')
[2025-07-17 04:26:54] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:26:54] INFO train_model: Dropping NaN targets...
[2025-07-17 04:26:54] INFO train_model: Class distribution: [769 727]
[2025-07-17 04:26:54] INFO train_model: Upsampling successful.
[2025-07-17 04:26:54] INFO train_model: Splitting train/test...
[2025-07-17 04:26:54] INFO train_model: Scaling features...
[2025-07-17 04:26:54] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:26:54] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:26:55] INFO train_model: Model fit complete.
[2025-07-17 04:26:55] INFO train_model: Model Accuracy: 0.8149
[2025-07-17 04:26:55] INFO train_model: 
Classification Report:
[2025-07-17 04:26:55] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.87      0.82       154
           1       0.85      0.76      0.80       154

    accuracy                           0.81       308
   macro avg       0.82      0.81      0.81       308
weighted avg       0.82      0.81      0.81       308

[2025-07-17 04:26:55] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 04:26:55] INFO train_model: Feature distributions before training:
[2025-07-17 04:26:55] INFO train_model: supply_zone: mean=0.2500, std=0.4332, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: demand_zone: mean=0.1631, std=0.3696, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:55] INFO train_model: wyckoff_distribution: mean=0.1818, std=0.3858, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: wyckoff_markdown: mean=0.3061, std=0.4610, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: wyckoff_markup: mean=0.5120, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:55] INFO train_model: head_shoulders: mean=0.0354, std=0.1849, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: inv_head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:55] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:26:55] INFO train_model: rising_wedge: mean=0.2640, std=0.4410, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: falling_wedge: mean=0.2333, std=0.4231, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: fakeout_up: mean=0.0053, std=0.0730, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: fakeout_down: mean=0.0053, std=0.0730, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:26:55] INFO train_model: sma_20_4h: mean=144.5585, std=1.5984, min=140.5166, max=148.8194, unique=1495
[2025-07-17 04:26:55] INFO train_model: sma_50_4h: mean=144.4965, std=1.4940, min=140.9014, max=148.3830, unique=1495
[2025-07-17 04:26:55] INFO train_model: ema_12_4h: mean=144.5741, std=1.6091, min=140.4309, max=148.8021, unique=1496
[2025-07-17 04:26:55] INFO train_model: ema_26_4h: mean=144.5460, std=1.5501, min=140.6371, max=148.5877, unique=1496
[2025-07-17 04:26:55] INFO train_model: rsi_14_4h: mean=50.3814, std=34.3078, min=0.0000, max=100.0000, unique=552
[2025-07-17 04:26:55] INFO train_model: macd_4h: mean=0.0281, std=0.2274, min=-0.4377, max=0.7986, unique=1496
[2025-07-17 04:26:55] INFO train_model: macd_signal_4h: mean=0.0282, std=0.2131, min=-0.3715, max=0.7178, unique=1496
[2025-07-17 04:26:55] INFO train_model: bb_high_4h: mean=145.2195, std=1.6457, min=140.8112, max=149.7951, unique=1496
[2025-07-17 04:26:55] INFO train_model: bb_low_4h: mean=143.8974, std=1.6394, min=139.1342, max=148.6325, unique=1496
[2025-07-17 04:26:55] INFO train_model: atr_14_4h: mean=0.5730, std=0.1878, min=0.1883, max=1.4068, unique=1480
[2025-07-17 04:26:55] INFO train_model: volatility_20_4h: mean=0.3305, std=0.1891, min=0.0575, max=1.2618, unique=1496
[2025-07-17 04:26:55] INFO train_model: price_vs_sma20_4h: mean=0.0003, std=0.0035, min=-0.0097, max=0.0185, unique=1496
[2025-07-17 04:26:55] INFO train_model: price_vs_sma50_4h: mean=0.0007, std=0.0055, min=-0.0126, max=0.0202, unique=1496
[2025-07-17 04:26:55] INFO train_model: trend_strength_4h: mean=0.0028, std=0.0019, min=0.0000, max=0.0112, unique=1496
[2025-07-17 04:26:55] INFO train_model: Auditing data quality before training...
[2025-07-17 04:26:55] INFO train_model: Entering audit_data_quality
[2025-07-17 04:26:56] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:26:56] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 04:26:56] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 04:26:56] WARNING train_model: Removing constant feature: double_top
[2025-07-17 04:26:56] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 04:26:56] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 04:26:56] INFO train_model: Entering audit_data_quality
[2025-07-17 04:26:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:26:57] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:26:57] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 04:26:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 04:26:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:26:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 04:26:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:26:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 04:45:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:45:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:45:54] INFO train_model: Model is starting a new training session...
[2025-07-17 04:45:54] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:45:54] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:45:54] INFO train_model: Preparing target variable...
[2025-07-17 04:45:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:45:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:45:54] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:45:54] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:45:54] INFO train_model: Dropping NaN targets...
[2025-07-17 04:48:16] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:48:16] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:48:16] INFO train_model: Model is starting a new training session...
[2025-07-17 04:48:16] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:48:16] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:48:16] INFO train_model: Preparing target variable...
[2025-07-17 04:48:16] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:48:16] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:48:16] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:48:16] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:48:16] INFO train_model: Dropping NaN targets...
[2025-07-17 04:48:16] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 04:48:37] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:48:37] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:48:37] INFO train_model: Model is starting a new training session...
[2025-07-17 04:48:37] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:48:37] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:48:37] INFO train_model: Preparing target variable...
[2025-07-17 04:48:37] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:48:37] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:48:37] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:48:37] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:48:37] INFO train_model: Dropping NaN targets...
[2025-07-17 04:48:37] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 04:49:27] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:49:27] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:49:27] INFO train_model: Model is starting a new training session...
[2025-07-17 04:49:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:49:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:49:27] INFO train_model: Preparing target variable...
[2025-07-17 04:49:27] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:49:27] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:49:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:49:27] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:49:27] INFO train_model: Dropping NaN targets...
[2025-07-17 04:49:27] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 04:49:45] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:49:45] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:49:45] INFO train_model: Model is starting a new training session...
[2025-07-17 04:49:45] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:49:45] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:49:45] INFO train_model: Preparing target variable...
[2025-07-17 04:49:45] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:49:45] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:49:45] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:49:45] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:49:45] INFO train_model: Dropping NaN targets...
[2025-07-17 04:49:45] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 04:52:38] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:52:38] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:52:38] INFO train_model: Model is starting a new training session...
[2025-07-17 04:52:38] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:52:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:52:38] INFO train_model: Preparing target variable...
[2025-07-17 04:52:38] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:52:38] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:52:38] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:52:38] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:52:38] INFO train_model: Dropping NaN targets...
[2025-07-17 04:52:38] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 04:52:38] INFO train_model: Upsampling successful.
[2025-07-17 04:52:38] INFO train_model: Splitting train/test...
[2025-07-17 04:52:38] INFO train_model: Scaling features...
[2025-07-17 04:52:38] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:52:38] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:52:39] INFO train_model: Model fit complete.
[2025-07-17 04:52:39] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 04:52:39] INFO train_model: 
Classification Report:
[2025-07-17 04:52:39] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 04:52:39] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 04:52:39] INFO train_model: Feature distributions before training:
[2025-07-17 04:52:39] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:52:39] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:52:39] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:52:39] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:52:39] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 04:52:39] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 04:52:39] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 04:52:39] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 04:52:39] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 04:52:39] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 04:52:39] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 04:52:39] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 04:52:39] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 04:52:39] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 04:52:39] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 04:52:39] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 04:52:39] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 04:52:39] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 04:52:39] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:52:39] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:52:39] INFO train_model: Auditing data quality before training...
[2025-07-17 04:52:39] INFO train_model: Entering audit_data_quality
[2025-07-17 04:57:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:57:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:57:49] INFO train_model: Model is starting a new training session...
[2025-07-17 04:57:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:57:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:57:49] INFO train_model: Preparing target variable...
[2025-07-17 04:57:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:57:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:57:49] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:57:49] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:57:49] INFO train_model: Dropping NaN targets...
[2025-07-17 04:57:49] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 04:57:49] INFO train_model: Upsampling successful.
[2025-07-17 04:57:49] INFO train_model: Splitting train/test...
[2025-07-17 04:57:49] INFO train_model: Scaling features...
[2025-07-17 04:57:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:57:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:57:50] INFO train_model: Model fit complete.
[2025-07-17 04:57:50] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 04:57:50] INFO train_model: 
Classification Report:
[2025-07-17 04:57:50] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 04:57:50] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 04:57:50] INFO train_model: Feature distributions before training:
[2025-07-17 04:57:50] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:57:50] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:57:50] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:57:50] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:57:50] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 04:57:50] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 04:57:50] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 04:57:50] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 04:57:50] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 04:57:50] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 04:57:50] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 04:57:50] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 04:57:50] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 04:57:50] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 04:57:50] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 04:57:50] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 04:57:50] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 04:57:50] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 04:57:50] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:57:50] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:57:50] INFO train_model: Auditing data quality before training...
[2025-07-17 04:57:50] INFO train_model: Entering audit_data_quality
[2025-07-17 04:57:51] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:57:51] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 04:57:51] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 04:57:51] WARNING train_model: Removing constant feature: double_top
[2025-07-17 04:57:51] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 04:57:51] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 04:57:51] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 04:57:51] INFO train_model: Entering audit_data_quality
[2025-07-17 04:57:52] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:57:52] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:57:52] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 04:57:52] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 04:57:53] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:57:53] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 04:57:53] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:57:53] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 04:58:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:58:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:58:18] INFO train_model: Model is starting a new training session...
[2025-07-17 04:58:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 04:58:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:58:18] INFO train_model: Preparing target variable...
[2025-07-17 04:58:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 04:58:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 04:58:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 04:58:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 04:58:18] INFO train_model: Dropping NaN targets...
[2025-07-17 04:58:18] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 04:58:18] INFO train_model: Upsampling successful.
[2025-07-17 04:58:18] INFO train_model: Splitting train/test...
[2025-07-17 04:58:18] INFO train_model: Scaling features...
[2025-07-17 04:58:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 04:58:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 04:58:19] INFO train_model: Model fit complete.
[2025-07-17 04:58:19] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 04:58:19] INFO train_model: 
Classification Report:
[2025-07-17 04:58:19] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 04:58:19] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 04:58:19] INFO train_model: Feature distributions before training:
[2025-07-17 04:58:19] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:58:19] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:58:19] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:58:19] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 04:58:19] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 04:58:19] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 04:58:19] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 04:58:19] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 04:58:19] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 04:58:19] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 04:58:19] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 04:58:19] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 04:58:19] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 04:58:19] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 04:58:19] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 04:58:19] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 04:58:19] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 04:58:19] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 04:58:19] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:58:19] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 04:58:19] INFO train_model: Auditing data quality before training...
[2025-07-17 04:58:19] INFO train_model: Entering audit_data_quality
[2025-07-17 04:58:20] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:58:20] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 04:58:20] WARNING train_model: Removing constant feature: double_top
[2025-07-17 04:58:20] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 04:58:20] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 04:58:20] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 04:58:20] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 04:58:20] INFO train_model: Entering audit_data_quality
[2025-07-17 04:58:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 04:58:21] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 04:58:21] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 04:58:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 04:58:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:58:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 04:58:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 04:58:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:00:40] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:00:40] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:00:40] INFO train_model: Model is starting a new training session...
[2025-07-17 05:00:40] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:00:40] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:00:40] INFO train_model: Preparing target variable...
[2025-07-17 05:00:40] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:00:40] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:00:40] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:00:40] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:00:40] INFO train_model: Dropping NaN targets...
[2025-07-17 05:00:40] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:00:40] INFO train_model: Upsampling successful.
[2025-07-17 05:00:40] INFO train_model: Splitting train/test...
[2025-07-17 05:00:40] INFO train_model: Scaling features...
[2025-07-17 05:00:40] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:00:40] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:00:41] INFO train_model: Model fit complete.
[2025-07-17 05:00:41] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:00:41] INFO train_model: 
Classification Report:
[2025-07-17 05:00:41] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:00:41] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:00:41] INFO train_model: Feature distributions before training:
[2025-07-17 05:00:41] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:00:41] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:00:41] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:00:41] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:00:41] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:00:41] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:00:41] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:00:41] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:00:41] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:00:41] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:00:41] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:00:41] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:00:41] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:00:41] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:00:41] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:00:41] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:00:41] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:00:41] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:00:41] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:00:41] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:00:41] INFO train_model: Auditing data quality before training...
[2025-07-17 05:00:41] INFO train_model: Entering audit_data_quality
[2025-07-17 05:00:43] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:00:43] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:00:43] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 05:00:43] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:00:43] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:00:43] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:00:43] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:00:43] INFO train_model: Entering audit_data_quality
[2025-07-17 05:00:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:00:44] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:00:44] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 05:00:44] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:00:44] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:00:44] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:00:44] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:00:44] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:01:07] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:01:07] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:01:07] INFO train_model: Model is starting a new training session...
[2025-07-17 05:01:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:01:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:01:08] INFO train_model: Preparing target variable...
[2025-07-17 05:01:08] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:01:08] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:01:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:01:08] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:01:08] INFO train_model: Dropping NaN targets...
[2025-07-17 05:01:08] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:01:08] INFO train_model: Upsampling successful.
[2025-07-17 05:01:08] INFO train_model: Splitting train/test...
[2025-07-17 05:01:08] INFO train_model: Scaling features...
[2025-07-17 05:01:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:01:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:01:09] INFO train_model: Model fit complete.
[2025-07-17 05:01:09] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:01:09] INFO train_model: 
Classification Report:
[2025-07-17 05:01:09] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:01:09] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:01:09] INFO train_model: Feature distributions before training:
[2025-07-17 05:01:09] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:01:09] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:01:09] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:01:09] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:01:09] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:01:09] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:01:09] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:01:09] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:01:09] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:01:09] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:01:09] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:01:09] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:01:09] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:01:09] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:01:09] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:01:09] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:01:09] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:01:09] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:01:09] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:01:09] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:01:09] INFO train_model: Auditing data quality before training...
[2025-07-17 05:01:09] INFO train_model: Entering audit_data_quality
[2025-07-17 05:01:10] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:01:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:01:10] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:01:10] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 05:01:10] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:01:10] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:01:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:01:10] INFO train_model: Entering audit_data_quality
[2025-07-17 05:01:11] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:01:11] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:01:11] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 05:01:11] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:01:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:01:11] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:01:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:01:11] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:04:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:04:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:04:03] INFO train_model: Model is starting a new training session...
[2025-07-17 05:04:03] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:04:03] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:04:03] INFO train_model: Preparing target variable...
[2025-07-17 05:04:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:04:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:04:03] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:04:03] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:04:03] INFO train_model: Dropping NaN targets...
[2025-07-17 05:04:03] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:04:03] INFO train_model: Upsampling successful.
[2025-07-17 05:04:03] INFO train_model: Splitting train/test...
[2025-07-17 05:04:03] INFO train_model: Scaling features...
[2025-07-17 05:04:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:04:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:04:05] INFO train_model: Model fit complete.
[2025-07-17 05:04:05] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:04:05] INFO train_model: 
Classification Report:
[2025-07-17 05:04:05] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:04:05] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:04:05] INFO train_model: Feature distributions before training:
[2025-07-17 05:04:05] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:05] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:05] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:05] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:05] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:04:05] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:04:05] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:04:05] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:04:05] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:04:05] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:04:05] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:04:05] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:04:05] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:04:05] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:04:05] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:04:05] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:04:05] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:04:05] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:04:05] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:05] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:05] INFO train_model: Auditing data quality before training...
[2025-07-17 05:04:05] INFO train_model: Entering audit_data_quality
[2025-07-17 05:04:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:04:06] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:04:06] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 05:04:06] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:04:06] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:04:06] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:04:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:04:06] INFO train_model: Entering audit_data_quality
[2025-07-17 05:04:07] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:04:07] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:04:07] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 05:04:07] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:04:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:04:07] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:04:07] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:04:07] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:04:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:04:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:04:31] INFO train_model: Model is starting a new training session...
[2025-07-17 05:04:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:04:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:04:31] INFO train_model: Preparing target variable...
[2025-07-17 05:04:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:04:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:04:31] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:04:32] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:04:32] INFO train_model: Dropping NaN targets...
[2025-07-17 05:04:32] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:04:32] INFO train_model: Upsampling successful.
[2025-07-17 05:04:32] INFO train_model: Splitting train/test...
[2025-07-17 05:04:32] INFO train_model: Scaling features...
[2025-07-17 05:04:32] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:04:32] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:04:33] INFO train_model: Model fit complete.
[2025-07-17 05:04:33] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:04:33] INFO train_model: 
Classification Report:
[2025-07-17 05:04:33] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:04:33] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:04:33] INFO train_model: Feature distributions before training:
[2025-07-17 05:04:33] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:33] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:33] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:33] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:04:33] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:04:33] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:04:33] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:04:33] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:04:33] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:04:33] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:04:33] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:04:33] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:04:33] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:04:33] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:04:33] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:04:33] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:04:33] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:04:33] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:04:33] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:33] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:04:33] INFO train_model: Auditing data quality before training...
[2025-07-17 05:04:33] INFO train_model: Entering audit_data_quality
[2025-07-17 05:04:34] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:04:34] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:04:34] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:04:34] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 05:04:34] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:04:34] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:04:34] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:04:34] INFO train_model: Entering audit_data_quality
[2025-07-17 05:04:35] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:04:35] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:04:35] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 05:04:35] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:04:35] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:04:35] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:04:35] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:04:35] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:06:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:06:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:06:09] INFO train_model: Model is starting a new training session...
[2025-07-17 05:06:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:06:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:06:09] INFO train_model: Preparing target variable...
[2025-07-17 05:06:09] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:06:09] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:06:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:06:09] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:06:09] INFO train_model: Dropping NaN targets...
[2025-07-17 05:06:09] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:06:09] INFO train_model: Upsampling successful.
[2025-07-17 05:06:09] INFO train_model: Splitting train/test...
[2025-07-17 05:06:09] INFO train_model: Scaling features...
[2025-07-17 05:06:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:06:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:06:11] INFO train_model: Model fit complete.
[2025-07-17 05:06:11] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:06:11] INFO train_model: 
Classification Report:
[2025-07-17 05:06:11] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:06:11] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:06:11] INFO train_model: Feature distributions before training:
[2025-07-17 05:06:11] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:11] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:11] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:11] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:06:11] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:06:11] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:06:11] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:06:11] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:06:11] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:06:11] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:06:11] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:06:11] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:06:11] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:06:11] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:06:11] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:06:11] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:06:11] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:06:11] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:11] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:11] INFO train_model: Auditing data quality before training...
[2025-07-17 05:06:11] INFO train_model: Entering audit_data_quality
[2025-07-17 05:06:12] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:06:12] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:06:12] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 05:06:12] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:06:12] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:06:12] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:06:12] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:06:12] INFO train_model: Entering audit_data_quality
[2025-07-17 05:06:13] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:06:13] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:06:13] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 05:06:13] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:06:14] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:06:14] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:06:14] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:06:14] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:06:34] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:06:34] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:06:34] INFO train_model: Model is starting a new training session...
[2025-07-17 05:06:34] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:06:34] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:06:34] INFO train_model: Preparing target variable...
[2025-07-17 05:06:34] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:06:34] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:06:34] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown',
       'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:06:34] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:06:34] INFO train_model: Dropping NaN targets...
[2025-07-17 05:06:34] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:06:34] INFO train_model: Upsampling successful.
[2025-07-17 05:06:34] INFO train_model: Splitting train/test...
[2025-07-17 05:06:34] INFO train_model: Scaling features...
[2025-07-17 05:06:34] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:06:34] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:06:35] INFO train_model: Model fit complete.
[2025-07-17 05:06:35] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:06:35] INFO train_model: 
Classification Report:
[2025-07-17 05:06:35] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:06:35] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:06:35] INFO train_model: Feature distributions before training:
[2025-07-17 05:06:35] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:35] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:35] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:35] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:06:35] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:06:35] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:06:35] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:06:35] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:06:35] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:06:36] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:06:36] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:06:36] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:06:36] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:06:36] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:06:36] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:06:36] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:06:36] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:06:36] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:06:36] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:36] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:06:36] INFO train_model: Auditing data quality before training...
[2025-07-17 05:06:36] INFO train_model: Entering audit_data_quality
[2025-07-17 05:06:37] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:06:37] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:06:37] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:06:37] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 05:06:37] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:06:37] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:06:37] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:06:37] INFO train_model: Entering audit_data_quality
[2025-07-17 05:06:38] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:06:38] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_distribution', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:06:38] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 05:06:38] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:06:38] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:06:38] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:06:38] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:06:38] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:10:11] INFO train_model: Model is starting a new training session...
[2025-07-17 05:10:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:10:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20'],
      dtype='object')
[2025-07-17 05:10:11] INFO train_model: Preparing target variable...
[2025-07-17 05:10:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:10:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:10:11] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:10:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:10:11] INFO train_model: Dropping NaN targets...
[2025-07-17 05:10:11] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:10:11] INFO train_model: Upsampling successful.
[2025-07-17 05:10:11] INFO train_model: Splitting train/test...
[2025-07-17 05:10:11] INFO train_model: Scaling features...
[2025-07-17 05:10:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:10:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:10:13] INFO train_model: Model fit complete.
[2025-07-17 05:10:13] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:10:13] INFO train_model: 
Classification Report:
[2025-07-17 05:10:13] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:10:13] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:10:13] INFO train_model: Feature distributions before training:
[2025-07-17 05:10:13] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:10:13] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:10:13] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:10:13] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:10:13] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:10:13] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:10:13] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:10:13] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:10:13] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:10:13] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:10:13] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:10:13] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:10:13] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:10:13] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:10:13] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:10:13] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:10:13] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:10:13] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:10:13] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:10:13] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:10:13] INFO train_model: Auditing data quality before training...
[2025-07-17 05:10:13] INFO train_model: Entering audit_data_quality
[2025-07-17 05:20:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:20:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:20:53] INFO train_model: Model is starting a new training session...
[2025-07-17 05:20:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:20:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:20:53] INFO train_model: Preparing target variable...
[2025-07-17 05:20:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:20:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:20:53] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:20:53] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:20:53] INFO train_model: Dropping NaN targets...
[2025-07-17 05:20:53] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:20:53] INFO train_model: Upsampling successful.
[2025-07-17 05:20:53] INFO train_model: Splitting train/test...
[2025-07-17 05:20:53] INFO train_model: Scaling features...
[2025-07-17 05:20:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:20:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:20:55] INFO train_model: Model fit complete.
[2025-07-17 05:20:55] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:20:55] INFO train_model: 
Classification Report:
[2025-07-17 05:20:55] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:20:55] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:20:55] INFO train_model: Feature distributions before training:
[2025-07-17 05:20:55] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:20:55] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:20:55] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:20:55] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:20:55] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:20:55] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:20:55] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:20:55] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:20:55] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:20:55] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:20:55] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:20:55] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:20:55] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:20:55] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:20:55] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:20:55] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:20:55] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:20:55] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:20:55] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:20:55] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:20:55] INFO train_model: Auditing data quality before training...
[2025-07-17 05:20:55] INFO train_model: Entering audit_data_quality
[2025-07-17 05:20:56] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:20:56] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:20:56] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 05:20:56] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:20:56] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:20:56] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:20:56] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:20:56] INFO train_model: Entering audit_data_quality
[2025-07-17 05:20:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:20:57] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:20:57] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 05:20:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:20:58] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:20:58] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:20:58] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:21:15] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:21:15] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:21:15] INFO train_model: Model is starting a new training session...
[2025-07-17 05:21:15] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:21:15] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:21:15] INFO train_model: Preparing target variable...
[2025-07-17 05:21:15] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:21:15] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:21:15] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:21:15] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:21:15] INFO train_model: Dropping NaN targets...
[2025-07-17 05:21:15] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:21:15] INFO train_model: Upsampling successful.
[2025-07-17 05:21:15] INFO train_model: Splitting train/test...
[2025-07-17 05:21:15] INFO train_model: Scaling features...
[2025-07-17 05:21:15] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:21:15] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:21:17] INFO train_model: Model fit complete.
[2025-07-17 05:21:17] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:21:17] INFO train_model: 
Classification Report:
[2025-07-17 05:21:17] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:21:17] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:21:17] INFO train_model: Feature distributions before training:
[2025-07-17 05:21:17] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:21:17] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:21:17] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:21:17] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:21:17] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:21:17] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:21:17] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:21:17] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:21:17] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:21:17] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:21:17] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:21:17] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:21:17] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:21:17] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:21:17] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:21:17] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:21:17] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:21:17] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:21:17] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:21:17] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:21:17] INFO train_model: Auditing data quality before training...
[2025-07-17 05:21:17] INFO train_model: Entering audit_data_quality
[2025-07-17 05:21:18] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:21:18] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:21:18] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:21:18] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 05:21:18] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:21:18] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:21:18] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:21:18] INFO train_model: Entering audit_data_quality
[2025-07-17 05:21:19] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:21:19] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:21:19] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 05:21:19] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:21:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:21:19] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:21:19] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:22:54] INFO train_model: Batch retraining all models for all pairs in Config.TRADING_PAIRS...
[2025-07-17 05:22:54] INFO train_model: Retraining model for USDJPY...
[2025-07-17 05:23:05] INFO train_model: Model is starting a new training session...
[2025-07-17 05:23:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:23:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20'],
      dtype='object')
[2025-07-17 05:23:05] INFO train_model: Preparing target variable...
[2025-07-17 05:23:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:23:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:23:05] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:23:05] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:23:05] INFO train_model: Dropping NaN targets...
[2025-07-17 05:23:05] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:23:05] INFO train_model: Upsampling successful.
[2025-07-17 05:23:05] INFO train_model: Splitting train/test...
[2025-07-17 05:23:05] INFO train_model: Scaling features...
[2025-07-17 05:23:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:23:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:23:07] INFO train_model: Model fit complete.
[2025-07-17 05:23:07] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:23:07] INFO train_model: 
Classification Report:
[2025-07-17 05:23:07] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:23:07] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:23:07] INFO train_model: Feature distributions before training:
[2025-07-17 05:23:07] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:23:07] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:23:07] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:23:07] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:23:07] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:23:07] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:23:07] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:23:07] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:23:07] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:23:07] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:23:07] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:23:07] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:23:07] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:23:07] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:23:07] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:23:07] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:23:07] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:23:07] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:23:07] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:23:07] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:23:07] INFO train_model: Auditing data quality before training...
[2025-07-17 05:23:07] INFO train_model: Entering audit_data_quality
[2025-07-17 05:25:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:25:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:25:18] INFO train_model: Model is starting a new training session...
[2025-07-17 05:25:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:25:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:25:18] INFO train_model: Preparing target variable...
[2025-07-17 05:25:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:25:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:25:18] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:25:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:25:18] INFO train_model: Dropping NaN targets...
[2025-07-17 05:25:18] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:25:18] INFO train_model: Upsampling successful.
[2025-07-17 05:25:18] INFO train_model: Splitting train/test...
[2025-07-17 05:25:18] INFO train_model: Scaling features...
[2025-07-17 05:25:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:25:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:25:20] INFO train_model: Model fit complete.
[2025-07-17 05:25:20] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:25:20] INFO train_model: 
Classification Report:
[2025-07-17 05:25:20] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:25:20] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:25:20] INFO train_model: Feature distributions before training:
[2025-07-17 05:25:20] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:20] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:20] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:20] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:20] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:25:20] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:25:20] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:25:20] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:25:20] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:25:20] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:25:20] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:25:20] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:25:20] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:25:20] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:25:20] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:25:20] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:25:20] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:25:20] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:25:20] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:20] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:20] INFO train_model: Auditing data quality before training...
[2025-07-17 05:25:20] INFO train_model: Entering audit_data_quality
[2025-07-17 05:25:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:25:21] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:25:21] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 05:25:21] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:25:21] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:25:21] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:25:21] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:25:21] INFO train_model: Entering audit_data_quality
[2025-07-17 05:25:22] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:25:22] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:25:22] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 05:25:22] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:25:22] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:25:22] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:25:22] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:25:41] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:25:41] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:25:41] INFO train_model: Model is starting a new training session...
[2025-07-17 05:25:41] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:25:41] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:25:41] INFO train_model: Preparing target variable...
[2025-07-17 05:25:41] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:25:41] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:25:41] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:25:41] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:25:41] INFO train_model: Dropping NaN targets...
[2025-07-17 05:25:41] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:25:41] INFO train_model: Upsampling successful.
[2025-07-17 05:25:41] INFO train_model: Splitting train/test...
[2025-07-17 05:25:41] INFO train_model: Scaling features...
[2025-07-17 05:25:41] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:25:41] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:25:42] INFO train_model: Model fit complete.
[2025-07-17 05:25:42] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:25:42] INFO train_model: 
Classification Report:
[2025-07-17 05:25:43] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:25:43] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:25:43] INFO train_model: Feature distributions before training:
[2025-07-17 05:25:43] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:43] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:43] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:43] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:25:43] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:25:43] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:25:43] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:25:43] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:25:43] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:25:43] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:25:43] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:25:43] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:25:43] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:25:43] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:25:43] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:25:43] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:25:43] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:25:43] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:25:43] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:43] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:25:43] INFO train_model: Auditing data quality before training...
[2025-07-17 05:25:43] INFO train_model: Entering audit_data_quality
[2025-07-17 05:25:44] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:25:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:25:44] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:25:44] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 05:25:44] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:25:44] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:25:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:25:44] INFO train_model: Entering audit_data_quality
[2025-07-17 05:25:45] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:25:45] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:25:45] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 05:25:45] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:25:45] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:25:45] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:25:45] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:26:56] INFO train_model: Batch retraining all models for all pairs in Config.TRADING_PAIRS...
[2025-07-17 05:26:56] INFO train_model: Retraining model for USDJPY...
[2025-07-17 05:27:06] INFO train_model: Model is starting a new training session...
[2025-07-17 05:27:06] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:27:06] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20'],
      dtype='object')
[2025-07-17 05:27:06] INFO train_model: Preparing target variable...
[2025-07-17 05:27:06] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:27:06] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:27:06] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:27:06] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:27:06] INFO train_model: Dropping NaN targets...
[2025-07-17 05:27:06] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:27:06] INFO train_model: Upsampling successful.
[2025-07-17 05:27:06] INFO train_model: Splitting train/test...
[2025-07-17 05:27:06] INFO train_model: Scaling features...
[2025-07-17 05:27:06] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:27:06] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:27:08] INFO train_model: Model fit complete.
[2025-07-17 05:27:08] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:27:08] INFO train_model: 
Classification Report:
[2025-07-17 05:27:08] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:27:08] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:27:08] INFO train_model: Feature distributions before training:
[2025-07-17 05:27:08] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:27:08] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:27:08] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:27:08] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:27:08] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:27:08] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:27:08] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:27:08] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:27:08] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:27:08] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:27:08] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:27:08] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:27:08] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:27:08] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:27:08] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:27:08] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:27:08] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:27:08] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:27:08] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:27:08] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:27:08] INFO train_model: Auditing data quality before training...
[2025-07-17 05:27:08] INFO train_model: Entering audit_data_quality
[2025-07-17 05:37:58] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:37:58] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:37:58] INFO train_model: Model is starting a new training session...
[2025-07-17 05:37:58] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:37:58] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:37:58] INFO train_model: Preparing target variable...
[2025-07-17 05:37:58] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:37:58] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:37:58] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:37:58] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:37:58] INFO train_model: Dropping NaN targets...
[2025-07-17 05:37:58] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 05:37:58] INFO train_model: Upsampling successful.
[2025-07-17 05:37:58] INFO train_model: Splitting train/test...
[2025-07-17 05:37:58] INFO train_model: Scaling features...
[2025-07-17 05:37:58] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:37:58] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:38:00] INFO train_model: Model fit complete.
[2025-07-17 05:38:00] INFO train_model: Model Accuracy: 0.8265
[2025-07-17 05:38:00] INFO train_model: 
Classification Report:
[2025-07-17 05:38:00] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.81      0.82       620
           1       0.82      0.84      0.83       619

    accuracy                           0.83      1239
   macro avg       0.83      0.83      0.83      1239
weighted avg       0.83      0.83      0.83      1239

[2025-07-17 05:38:00] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 05:38:00] INFO train_model: Feature distributions before training:
[2025-07-17 05:38:00] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:00] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:00] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:00] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:00] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 05:38:00] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 05:38:00] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 05:38:00] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 05:38:00] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 05:38:00] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 05:38:00] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 05:38:00] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 05:38:00] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 05:38:00] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 05:38:00] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 05:38:00] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 05:38:00] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 05:38:00] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 05:38:00] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:00] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:00] INFO train_model: Auditing data quality before training...
[2025-07-17 05:38:00] INFO train_model: Entering audit_data_quality
[2025-07-17 05:38:01] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:38:01] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:38:01] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 05:38:01] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:38:01] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:38:01] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:38:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:38:01] INFO train_model: Entering audit_data_quality
[2025-07-17 05:38:02] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:38:02] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:38:02] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 05:38:02] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:38:03] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:38:03] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:38:03] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:38:26] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:38:26] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:38:26] INFO train_model: Model is starting a new training session...
[2025-07-17 05:38:26] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:38:26] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:38:26] INFO train_model: Preparing target variable...
[2025-07-17 05:38:26] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:38:26] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:38:26] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:38:26] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:38:26] INFO train_model: Dropping NaN targets...
[2025-07-17 05:38:26] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:38:26] INFO train_model: Upsampling successful.
[2025-07-17 05:38:26] INFO train_model: Splitting train/test...
[2025-07-17 05:38:26] INFO train_model: Scaling features...
[2025-07-17 05:38:26] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:38:26] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:38:27] INFO train_model: Model fit complete.
[2025-07-17 05:38:27] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:38:27] INFO train_model: 
Classification Report:
[2025-07-17 05:38:27] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:38:27] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:38:27] INFO train_model: Feature distributions before training:
[2025-07-17 05:38:27] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:27] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:27] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:27] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:38:27] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:38:27] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:38:27] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:38:27] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:38:27] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:38:27] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:38:27] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:38:27] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:38:27] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:38:27] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:38:27] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:38:27] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:38:27] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:38:27] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:38:27] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:27] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:38:27] INFO train_model: Auditing data quality before training...
[2025-07-17 05:38:27] INFO train_model: Entering audit_data_quality
[2025-07-17 05:38:28] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:38:28] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:38:28] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:38:28] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 05:38:28] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:38:28] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:38:28] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:38:28] INFO train_model: Entering audit_data_quality
[2025-07-17 05:38:29] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:38:29] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:38:29] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 05:38:29] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:38:29] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:38:29] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:38:29] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 05:39:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:39:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:39:35] INFO train_model: Model is starting a new training session...
[2025-07-17 05:39:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:39:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:39:35] INFO train_model: Preparing target variable...
[2025-07-17 05:39:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:39:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:39:35] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:39:35] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:39:35] INFO train_model: Dropping NaN targets...
[2025-07-17 05:39:35] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:39:35] INFO train_model: Upsampling successful.
[2025-07-17 05:39:35] INFO train_model: Splitting train/test...
[2025-07-17 05:39:35] INFO train_model: Scaling features...
[2025-07-17 05:39:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:39:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:39:36] INFO train_model: Model fit complete.
[2025-07-17 05:39:36] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:39:36] INFO train_model: 
Classification Report:
[2025-07-17 05:39:36] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:39:36] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:39:36] INFO train_model: Feature distributions before training:
[2025-07-17 05:39:36] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:39:36] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:39:36] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:39:36] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:39:36] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:39:36] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:39:36] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:39:36] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:39:36] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:39:36] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:39:36] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:39:36] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:39:36] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:39:36] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:39:36] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:39:36] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:39:36] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:39:36] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:39:36] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:39:36] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:39:36] INFO train_model: Auditing data quality before training...
[2025-07-17 05:39:36] INFO train_model: Entering audit_data_quality
[2025-07-17 05:41:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:41:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:41:12] INFO train_model: Model is starting a new training session...
[2025-07-17 05:41:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:41:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:41:12] INFO train_model: Preparing target variable...
[2025-07-17 05:41:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:41:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:41:12] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:41:12] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:41:12] INFO train_model: Dropping NaN targets...
[2025-07-17 05:41:12] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:41:12] INFO train_model: Upsampling successful.
[2025-07-17 05:41:12] INFO train_model: Splitting train/test...
[2025-07-17 05:41:12] INFO train_model: Scaling features...
[2025-07-17 05:41:12] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:41:12] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:41:13] INFO train_model: Model fit complete.
[2025-07-17 05:41:13] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:41:13] INFO train_model: 
Classification Report:
[2025-07-17 05:41:13] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:41:13] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:41:13] INFO train_model: Feature distributions before training:
[2025-07-17 05:41:13] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:41:13] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:41:13] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:41:13] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:41:13] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:41:13] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:41:13] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:41:13] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:41:13] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:41:13] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:41:13] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:41:13] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:41:13] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:41:13] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:41:13] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:41:13] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:41:13] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:41:13] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:41:13] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:41:13] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:41:13] INFO train_model: Auditing data quality before training...
[2025-07-17 05:41:14] INFO train_model: Entering audit_data_quality
[2025-07-17 05:43:50] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:43:50] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:43:50] INFO train_model: Model is starting a new training session...
[2025-07-17 05:43:50] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:43:50] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:43:50] INFO train_model: Preparing target variable...
[2025-07-17 05:43:50] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:43:50] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:43:50] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:43:50] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:43:50] INFO train_model: Dropping NaN targets...
[2025-07-17 05:43:50] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:43:50] INFO train_model: Upsampling successful.
[2025-07-17 05:43:50] INFO train_model: Splitting train/test...
[2025-07-17 05:43:50] INFO train_model: Scaling features...
[2025-07-17 05:43:50] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:43:50] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:43:51] INFO train_model: Model fit complete.
[2025-07-17 05:43:51] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:43:51] INFO train_model: 
Classification Report:
[2025-07-17 05:43:51] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:43:51] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:43:51] INFO train_model: Feature distributions before training:
[2025-07-17 05:43:51] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:43:51] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:43:51] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:43:51] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:43:51] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:43:51] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:43:51] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:43:51] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:43:51] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:43:51] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:43:51] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:43:51] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:43:51] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:43:51] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:43:51] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:43:51] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:43:51] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:43:51] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:43:51] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:43:51] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:43:51] INFO train_model: Auditing data quality before training...
[2025-07-17 05:43:51] INFO train_model: Entering audit_data_quality
[2025-07-17 05:47:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:47:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:47:31] INFO train_model: Model is starting a new training session...
[2025-07-17 05:47:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:47:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:47:31] INFO train_model: Preparing target variable...
[2025-07-17 05:47:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:47:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:47:31] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:47:31] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:47:31] INFO train_model: Dropping NaN targets...
[2025-07-17 05:47:31] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:47:31] INFO train_model: Upsampling successful.
[2025-07-17 05:47:31] INFO train_model: Splitting train/test...
[2025-07-17 05:47:31] INFO train_model: Scaling features...
[2025-07-17 05:47:31] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:47:31] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:47:33] INFO train_model: Model fit complete.
[2025-07-17 05:47:33] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:47:33] INFO train_model: 
Classification Report:
[2025-07-17 05:47:33] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:47:33] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:47:33] INFO train_model: Feature distributions before training:
[2025-07-17 05:47:33] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:47:33] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:47:33] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:47:33] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:47:33] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:47:33] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:47:33] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:47:33] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:47:33] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:47:33] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:47:33] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:47:33] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:47:33] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:47:33] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:47:33] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:47:33] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:47:33] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:47:33] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:47:33] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:47:33] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:47:33] INFO train_model: Auditing data quality before training...
[2025-07-17 05:47:33] INFO train_model: Entering audit_data_quality
[2025-07-17 05:48:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:48:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:48:56] INFO train_model: Model is starting a new training session...
[2025-07-17 05:48:56] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 05:48:56] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:48:56] INFO train_model: Preparing target variable...
[2025-07-17 05:48:56] INFO train_model: Entering prepare_target_variable
[2025-07-17 05:48:56] INFO train_model: Exiting prepare_target_variable
[2025-07-17 05:48:56] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 05:48:56] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 05:48:56] INFO train_model: Dropping NaN targets...
[2025-07-17 05:48:56] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 05:48:56] INFO train_model: Upsampling successful.
[2025-07-17 05:48:56] INFO train_model: Splitting train/test...
[2025-07-17 05:48:56] INFO train_model: Scaling features...
[2025-07-17 05:48:56] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 05:48:56] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 05:48:57] INFO train_model: Model fit complete.
[2025-07-17 05:48:57] INFO train_model: Model Accuracy: 0.7842
[2025-07-17 05:48:57] INFO train_model: 
Classification Report:
[2025-07-17 05:48:57] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.79      0.79       348
           1       0.79      0.78      0.78       347

    accuracy                           0.78       695
   macro avg       0.78      0.78      0.78       695
weighted avg       0.78      0.78      0.78       695

[2025-07-17 05:48:57] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 05:48:57] INFO train_model: Feature distributions before training:
[2025-07-17 05:48:57] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:48:57] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:48:57] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:48:57] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 05:48:57] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 05:48:57] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 05:48:57] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 05:48:57] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 05:48:57] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 05:48:57] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 05:48:57] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 05:48:57] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 05:48:57] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 05:48:57] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 05:48:57] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 05:48:57] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 05:48:57] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 05:48:57] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 05:48:57] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:48:57] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 05:48:57] INFO train_model: Auditing data quality before training...
[2025-07-17 05:48:57] INFO train_model: Entering audit_data_quality
[2025-07-17 05:48:59] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:48:59] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 05:48:59] WARNING train_model: Removing constant feature: double_top
[2025-07-17 05:48:59] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 05:48:59] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 05:48:59] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 05:48:59] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 05:48:59] INFO train_model: Entering audit_data_quality
[2025-07-17 05:49:00] INFO train_model: Exiting audit_data_quality
[2025-07-17 05:49:00] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 05:49:00] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 05:49:00] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 05:49:00] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 05:49:00] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 05:49:00] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 06:32:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:32:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:32:54] INFO train_model: Model is starting a new training session...
[2025-07-17 06:32:54] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 06:32:54] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:32:54] INFO train_model: Preparing target variable...
[2025-07-17 06:32:54] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:32:54] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:32:54] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:32:54] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 06:32:54] INFO train_model: Dropping NaN targets...
[2025-07-17 06:32:54] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 06:32:54] INFO train_model: Upsampling successful.
[2025-07-17 06:32:54] INFO train_model: Splitting train/test...
[2025-07-17 06:32:54] INFO train_model: Scaling features...
[2025-07-17 06:32:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 06:32:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 06:32:56] INFO train_model: Model fit complete.
[2025-07-17 06:32:56] INFO train_model: Model Accuracy: 0.8200
[2025-07-17 06:32:56] INFO train_model: 
Classification Report:
[2025-07-17 06:32:56] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.82      0.82       620
           1       0.82      0.82      0.82       619

    accuracy                           0.82      1239
   macro avg       0.82      0.82      0.82      1239
weighted avg       0.82      0.82      0.82      1239

[2025-07-17 06:32:56] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 06:32:56] INFO train_model: Feature distributions before training:
[2025-07-17 06:32:56] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:32:56] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:32:56] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:32:56] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:32:56] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 06:32:56] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 06:32:56] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 06:32:56] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 06:32:56] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 06:32:56] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 06:32:56] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 06:32:56] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 06:32:56] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 06:32:56] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4551
[2025-07-17 06:32:56] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 06:32:56] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 06:32:56] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 06:32:56] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 06:32:56] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:32:56] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:32:56] INFO train_model: Auditing data quality before training...
[2025-07-17 06:32:56] INFO train_model: Entering audit_data_quality
[2025-07-17 06:32:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:32:57] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 06:32:57] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 06:32:57] WARNING train_model: Removing constant feature: double_top
[2025-07-17 06:32:57] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 06:32:57] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 06:32:57] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 06:32:57] INFO train_model: Entering audit_data_quality
[2025-07-17 06:32:59] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:32:59] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 06:32:59] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 06:32:59] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 06:32:59] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 06:32:59] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 06:32:59] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 06:33:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:33:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:33:18] INFO train_model: Model is starting a new training session...
[2025-07-17 06:33:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 06:33:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:33:18] INFO train_model: Preparing target variable...
[2025-07-17 06:33:18] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:33:18] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:33:18] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:33:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 06:33:18] INFO train_model: Dropping NaN targets...
[2025-07-17 06:33:18] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 06:33:18] INFO train_model: Upsampling successful.
[2025-07-17 06:33:18] INFO train_model: Splitting train/test...
[2025-07-17 06:33:18] INFO train_model: Scaling features...
[2025-07-17 06:33:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 06:33:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 06:33:19] INFO train_model: Model fit complete.
[2025-07-17 06:33:19] INFO train_model: Model Accuracy: 0.7914
[2025-07-17 06:33:19] INFO train_model: 
Classification Report:
[2025-07-17 06:33:19] INFO train_model:               precision    recall  f1-score   support

           0       0.80      0.78      0.79       348
           1       0.79      0.80      0.79       347

    accuracy                           0.79       695
   macro avg       0.79      0.79      0.79       695
weighted avg       0.79      0.79      0.79       695

[2025-07-17 06:33:19] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 06:33:19] INFO train_model: Feature distributions before training:
[2025-07-17 06:33:19] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:33:19] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:33:19] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:33:19] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:33:19] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 06:33:19] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 06:33:19] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 06:33:19] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 06:33:19] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 06:33:19] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 06:33:19] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 06:33:19] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 06:33:19] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 06:33:19] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 06:33:19] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 06:33:19] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 06:33:19] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 06:33:19] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 06:33:19] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:33:19] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:33:19] INFO train_model: Auditing data quality before training...
[2025-07-17 06:33:19] INFO train_model: Entering audit_data_quality
[2025-07-17 06:33:20] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:33:20] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 06:33:20] WARNING train_model: Removing constant feature: double_top
[2025-07-17 06:33:20] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 06:33:20] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 06:33:20] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 06:33:20] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 06:33:20] INFO train_model: Entering audit_data_quality
[2025-07-17 06:33:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:33:21] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 06:33:21] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 06:33:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 06:33:21] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 06:33:21] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 06:33:21] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 06:34:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:34:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:34:35] INFO train_model: Model is starting a new training session...
[2025-07-17 06:34:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 06:34:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:34:35] INFO train_model: Preparing target variable...
[2025-07-17 06:34:35] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:34:35] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:34:35] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:34:35] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 06:34:35] INFO train_model: Dropping NaN targets...
[2025-07-17 06:34:35] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 06:34:35] INFO train_model: Upsampling successful.
[2025-07-17 06:34:35] INFO train_model: Splitting train/test...
[2025-07-17 06:34:35] INFO train_model: Scaling features...
[2025-07-17 06:34:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 06:34:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 06:34:36] INFO train_model: Model fit complete.
[2025-07-17 06:34:36] INFO train_model: Model Accuracy: 0.8224
[2025-07-17 06:34:36] INFO train_model: 
Classification Report:
[2025-07-17 06:34:36] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.81      0.82       620
           1       0.82      0.83      0.82       619

    accuracy                           0.82      1239
   macro avg       0.82      0.82      0.82      1239
weighted avg       0.82      0.82      0.82      1239

[2025-07-17 06:34:36] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 06:34:36] INFO train_model: Feature distributions before training:
[2025-07-17 06:34:36] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:34:36] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:34:36] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:34:36] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:34:36] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 06:34:36] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 06:34:36] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 06:34:36] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 06:34:36] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 06:34:36] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 06:34:36] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 06:34:36] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 06:34:36] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 06:34:36] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 06:34:36] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 06:34:36] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 06:34:36] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 06:34:36] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 06:34:36] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:34:36] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:34:36] INFO train_model: Auditing data quality before training...
[2025-07-17 06:34:37] INFO train_model: Entering audit_data_quality
[2025-07-17 06:45:38] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:45:38] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:45:38] INFO train_model: Model is starting a new training session...
[2025-07-17 06:45:38] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 06:45:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:45:38] INFO train_model: Preparing target variable...
[2025-07-17 06:45:38] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:45:38] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:45:38] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:45:38] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 06:45:38] INFO train_model: Dropping NaN targets...
[2025-07-17 06:45:38] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 06:45:38] INFO train_model: Upsampling successful.
[2025-07-17 06:45:38] INFO train_model: Splitting train/test...
[2025-07-17 06:45:38] INFO train_model: Scaling features...
[2025-07-17 06:45:38] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 06:45:38] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 06:45:40] INFO train_model: Model fit complete.
[2025-07-17 06:45:40] INFO train_model: Model Accuracy: 0.8224
[2025-07-17 06:45:40] INFO train_model: 
Classification Report:
[2025-07-17 06:45:40] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.81      0.82       620
           1       0.82      0.83      0.82       619

    accuracy                           0.82      1239
   macro avg       0.82      0.82      0.82      1239
weighted avg       0.82      0.82      0.82      1239

[2025-07-17 06:45:40] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 06:45:40] INFO train_model: Feature distributions before training:
[2025-07-17 06:45:40] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:45:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:45:40] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:45:40] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:45:40] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 06:45:40] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 06:45:40] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 06:45:40] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 06:45:40] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 06:45:40] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 06:45:40] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 06:45:40] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 06:45:40] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 06:45:40] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 06:45:40] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 06:45:40] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 06:45:40] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 06:45:40] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 06:45:40] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:45:40] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:45:40] INFO train_model: Auditing data quality before training...
[2025-07-17 06:45:40] INFO train_model: Entering audit_data_quality
[2025-07-17 06:45:42] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:45:42] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 06:45:42] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 06:45:42] WARNING train_model: Removing constant feature: double_top
[2025-07-17 06:45:42] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 06:45:42] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 06:45:42] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 06:45:42] INFO train_model: Entering audit_data_quality
[2025-07-17 06:45:43] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:45:43] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 06:45:43] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 06:45:43] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 06:45:43] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 06:45:43] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 06:45:43] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 06:46:02] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:46:02] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:46:02] INFO train_model: Model is starting a new training session...
[2025-07-17 06:46:02] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 06:46:02] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:46:02] INFO train_model: Preparing target variable...
[2025-07-17 06:46:02] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:46:02] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:46:02] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:46:02] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 06:46:02] INFO train_model: Dropping NaN targets...
[2025-07-17 06:46:02] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 06:46:02] INFO train_model: Upsampling successful.
[2025-07-17 06:46:02] INFO train_model: Splitting train/test...
[2025-07-17 06:46:02] INFO train_model: Scaling features...
[2025-07-17 06:46:02] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 06:46:02] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 06:46:04] INFO train_model: Model fit complete.
[2025-07-17 06:46:04] INFO train_model: Model Accuracy: 0.7914
[2025-07-17 06:46:04] INFO train_model: 
Classification Report:
[2025-07-17 06:46:04] INFO train_model:               precision    recall  f1-score   support

           0       0.80      0.78      0.79       348
           1       0.79      0.80      0.79       347

    accuracy                           0.79       695
   macro avg       0.79      0.79      0.79       695
weighted avg       0.79      0.79      0.79       695

[2025-07-17 06:46:04] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 06:46:04] INFO train_model: Feature distributions before training:
[2025-07-17 06:46:04] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:46:04] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:46:04] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:46:04] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:46:04] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 06:46:04] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 06:46:04] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 06:46:04] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 06:46:04] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 06:46:04] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 06:46:04] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 06:46:04] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 06:46:04] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 06:46:04] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 06:46:04] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 06:46:04] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 06:46:04] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 06:46:04] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 06:46:04] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:46:04] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:46:04] INFO train_model: Auditing data quality before training...
[2025-07-17 06:46:04] INFO train_model: Entering audit_data_quality
[2025-07-17 06:46:05] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:46:05] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 06:46:05] WARNING train_model: Removing constant feature: double_top
[2025-07-17 06:46:05] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 06:46:05] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 06:46:05] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 06:46:05] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 06:46:05] INFO train_model: Entering audit_data_quality
[2025-07-17 06:46:06] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:46:06] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 06:46:06] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 06:46:06] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 06:46:06] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 06:46:06] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 06:46:06] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 06:49:48] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:49:48] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:49:48] INFO train_model: Model is starting a new training session...
[2025-07-17 06:49:48] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 06:49:48] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:49:48] INFO train_model: Preparing target variable...
[2025-07-17 06:49:48] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:49:48] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:49:48] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:49:48] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 06:49:48] INFO train_model: Dropping NaN targets...
[2025-07-17 06:49:48] INFO train_model: Class balance before upsampling: {0: 3097, 1: 1587}
[2025-07-17 06:49:48] INFO train_model: Upsampling successful.
[2025-07-17 06:49:48] INFO train_model: Splitting train/test...
[2025-07-17 06:49:48] INFO train_model: Scaling features...
[2025-07-17 06:49:48] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 06:49:48] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 06:49:49] INFO train_model: Model fit complete.
[2025-07-17 06:49:49] INFO train_model: Model Accuracy: 0.8224
[2025-07-17 06:49:49] INFO train_model: 
Classification Report:
[2025-07-17 06:49:49] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.81      0.82       620
           1       0.82      0.83      0.82       619

    accuracy                           0.82      1239
   macro avg       0.82      0.82      0.82      1239
weighted avg       0.82      0.82      0.82      1239

[2025-07-17 06:49:49] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 06:49:49] INFO train_model: Feature distributions before training:
[2025-07-17 06:49:49] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: demand_zone: mean=0.3670, std=0.4820, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:49:49] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:49:49] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: inv_head_shoulders: mean=0.0325, std=0.1772, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:49:49] INFO train_model: double_bottom: mean=0.0011, std=0.0327, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: rising_wedge: mean=0.2696, std=0.4438, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: falling_wedge: mean=0.2408, std=0.4276, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:49:49] INFO train_model: sma_20_4h: mean=149.0303, std=10.6126, min=0.0000, max=158.3032, unique=4656
[2025-07-17 06:49:49] INFO train_model: sma_50_4h: mean=148.0765, std=15.9312, min=0.0000, max=158.1807, unique=4631
[2025-07-17 06:49:49] INFO train_model: ema_12_4h: mean=149.6332, std=4.7083, min=140.4309, max=158.3803, unique=4684
[2025-07-17 06:49:49] INFO train_model: ema_26_4h: mean=149.6341, std=4.6938, min=140.6371, max=158.2477, unique=4684
[2025-07-17 06:49:49] INFO train_model: rsi_14_4h: mean=50.1076, std=32.8788, min=0.0000, max=100.0000, unique=1829
[2025-07-17 06:49:49] INFO train_model: macd_4h: mean=-0.0009, std=0.2227, min=-0.9388, max=0.8699, unique=4684
[2025-07-17 06:49:49] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2087, min=-0.8130, max=0.7790, unique=4684
[2025-07-17 06:49:49] INFO train_model: bb_high_4h: mean=149.6797, std=10.6385, min=0.0000, max=158.6366, unique=4666
[2025-07-17 06:49:49] INFO train_model: bb_low_4h: mean=148.3808, std=10.6008, min=0.0000, max=158.0493, unique=4666
[2025-07-17 06:49:49] INFO train_model: atr_14_4h: mean=0.6028, std=0.2359, min=0.0000, max=2.0255, unique=4552
[2025-07-17 06:49:49] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1931, min=0.0000, max=1.3017, unique=4666
[2025-07-17 06:49:49] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4666
[2025-07-17 06:49:49] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4634
[2025-07-17 06:49:49] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4636
[2025-07-17 06:49:49] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:49:49] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:49:49] INFO train_model: Auditing data quality before training...
[2025-07-17 06:49:50] INFO train_model: Entering audit_data_quality
[2025-07-17 06:49:52] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:49:52] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 06:49:52] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 06:49:52] WARNING train_model: Removing constant feature: double_top
[2025-07-17 06:49:52] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 06:49:52] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 06:49:52] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 06:49:52] INFO train_model: Entering audit_data_quality
[2025-07-17 06:49:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:49:57] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 06:49:57] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 06:49:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 06:49:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 06:49:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 06:49:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 06:50:16] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:50:16] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:50:16] INFO train_model: Model is starting a new training session...
[2025-07-17 06:50:16] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 06:50:16] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:50:16] INFO train_model: Preparing target variable...
[2025-07-17 06:50:16] INFO train_model: Entering prepare_target_variable
[2025-07-17 06:50:16] INFO train_model: Exiting prepare_target_variable
[2025-07-17 06:50:16] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 06:50:16] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 06:50:16] INFO train_model: Dropping NaN targets...
[2025-07-17 06:50:16] INFO train_model: Class balance before upsampling: {0: 1736, 1: 1631}
[2025-07-17 06:50:16] INFO train_model: Upsampling successful.
[2025-07-17 06:50:16] INFO train_model: Splitting train/test...
[2025-07-17 06:50:16] INFO train_model: Scaling features...
[2025-07-17 06:50:16] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 06:50:16] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 06:50:18] INFO train_model: Model fit complete.
[2025-07-17 06:50:18] INFO train_model: Model Accuracy: 0.7914
[2025-07-17 06:50:18] INFO train_model: 
Classification Report:
[2025-07-17 06:50:18] INFO train_model:               precision    recall  f1-score   support

           0       0.80      0.78      0.79       348
           1       0.79      0.80      0.79       347

    accuracy                           0.79       695
   macro avg       0.79      0.79      0.79       695
weighted avg       0.79      0.79      0.79       695

[2025-07-17 06:50:18] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 06:50:18] INFO train_model: Feature distributions before training:
[2025-07-17 06:50:18] INFO train_model: supply_zone: mean=0.2228, std=0.4162, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: demand_zone: mean=0.1651, std=0.3714, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: wyckoff_markdown: mean=0.3368, std=0.4727, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: wyckoff_markup: mean=0.4372, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1084, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:50:18] INFO train_model: wyckoff_distribution: mean=0.2141, std=0.4103, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: inv_head_shoulders: mean=0.0336, std=0.1801, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:50:18] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:50:18] INFO train_model: rising_wedge: mean=0.2560, std=0.4365, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: fakeout_up: mean=0.0042, std=0.0644, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: fakeout_down: mean=0.0065, std=0.0806, min=0.0000, max=1.0000, unique=2
[2025-07-17 06:50:18] INFO train_model: sma_20_4h: mean=148.3776, std=4.7970, min=140.5166, max=158.3032, unique=3363
[2025-07-17 06:50:18] INFO train_model: sma_50_4h: mean=148.4185, std=4.8172, min=140.9014, max=158.1807, unique=3363
[2025-07-17 06:50:18] INFO train_model: ema_12_4h: mean=148.3662, std=4.7878, min=140.4309, max=158.3803, unique=3367
[2025-07-17 06:50:18] INFO train_model: ema_26_4h: mean=148.3857, std=4.7925, min=140.6371, max=158.2477, unique=3367
[2025-07-17 06:50:18] INFO train_model: rsi_14_4h: mean=48.7060, std=32.4489, min=0.0000, max=100.0000, unique=1341
[2025-07-17 06:50:18] INFO train_model: macd_4h: mean=-0.0195, std=0.2232, min=-0.9388, max=0.7986, unique=3367
[2025-07-17 06:50:18] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2087, min=-0.8130, max=0.7178, unique=3367
[2025-07-17 06:50:18] INFO train_model: bb_high_4h: mean=149.0476, std=4.7702, min=140.8112, max=158.6366, unique=3367
[2025-07-17 06:50:18] INFO train_model: bb_low_4h: mean=147.7076, std=4.8550, min=139.1342, max=158.0493, unique=3367
[2025-07-17 06:50:18] INFO train_model: atr_14_4h: mean=0.6246, std=0.2426, min=0.1483, max=2.0255, unique=3299
[2025-07-17 06:50:18] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1944, min=0.0338, max=1.2700, unique=3367
[2025-07-17 06:50:18] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3367
[2025-07-17 06:50:18] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3365
[2025-07-17 06:50:18] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3367
[2025-07-17 06:50:18] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:50:18] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 06:50:18] INFO train_model: Auditing data quality before training...
[2025-07-17 06:50:18] INFO train_model: Entering audit_data_quality
[2025-07-17 06:51:25] INFO train_model: Exiting audit_data_quality
[2025-07-17 06:51:25] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 06:51:25] WARNING train_model: Removing constant feature: double_top
[2025-07-17 06:51:25] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 06:51:25] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 06:51:25] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 06:51:25] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 06:51:25] INFO train_model: Entering audit_data_quality
[2025-07-17 10:42:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:42:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:42:23] INFO train_model: Model is starting a new training session...
[2025-07-17 10:42:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 10:42:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:42:23] INFO train_model: Preparing target variable...
[2025-07-17 10:42:23] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:42:23] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:42:23] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:42:23] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 10:42:23] INFO train_model: Dropping NaN targets...
[2025-07-17 10:42:23] INFO train_model: Class balance before upsampling: {0: 3098, 1: 1590}
[2025-07-17 10:42:23] INFO train_model: Upsampling successful.
[2025-07-17 10:42:23] INFO train_model: Splitting train/test...
[2025-07-17 10:42:23] INFO train_model: Scaling features...
[2025-07-17 10:42:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 10:42:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 10:42:25] INFO train_model: Model fit complete.
[2025-07-17 10:42:25] INFO train_model: Model Accuracy: 0.8419
[2025-07-17 10:42:25] INFO train_model: 
Classification Report:
[2025-07-17 10:42:25] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.82      0.84       620
           1       0.83      0.86      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 10:42:25] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 10:42:25] INFO train_model: Feature distributions before training:
[2025-07-17 10:42:25] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: demand_zone: mean=0.3667, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:25] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:25] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1777, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:25] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: rising_wedge: mean=0.2694, std=0.4437, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: falling_wedge: mean=0.2406, std=0.4275, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:25] INFO train_model: sma_20_4h: mean=149.0296, std=10.6081, min=0.0000, max=158.3032, unique=4660
[2025-07-17 10:42:25] INFO train_model: sma_50_4h: mean=148.0768, std=15.9244, min=0.0000, max=158.1807, unique=4635
[2025-07-17 10:42:25] INFO train_model: ema_12_4h: mean=149.6321, std=4.7065, min=140.4309, max=158.3803, unique=4688
[2025-07-17 10:42:25] INFO train_model: ema_26_4h: mean=149.6330, std=4.6920, min=140.6371, max=158.2477, unique=4688
[2025-07-17 10:42:25] INFO train_model: rsi_14_4h: mean=50.1277, std=32.8762, min=0.0000, max=100.0000, unique=1831
[2025-07-17 10:42:25] INFO train_model: macd_4h: mean=-0.0009, std=0.2226, min=-0.9388, max=0.8699, unique=4688
[2025-07-17 10:42:25] INFO train_model: macd_signal_4h: mean=-0.0009, std=0.2086, min=-0.8130, max=0.7790, unique=4688
[2025-07-17 10:42:25] INFO train_model: bb_high_4h: mean=149.6791, std=10.6339, min=0.0000, max=158.6366, unique=4670
[2025-07-17 10:42:25] INFO train_model: bb_low_4h: mean=148.3802, std=10.5963, min=0.0000, max=158.0493, unique=4670
[2025-07-17 10:42:25] INFO train_model: atr_14_4h: mean=0.6028, std=0.2358, min=0.0000, max=2.0255, unique=4556
[2025-07-17 10:42:25] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4670
[2025-07-17 10:42:25] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4670
[2025-07-17 10:42:25] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4638
[2025-07-17 10:42:25] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4640
[2025-07-17 10:42:25] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:25] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:25] INFO train_model: Auditing data quality before training...
[2025-07-17 10:42:25] INFO train_model: Entering audit_data_quality
[2025-07-17 10:42:26] INFO train_model: Exiting audit_data_quality
[2025-07-17 10:42:26] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 10:42:26] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 10:42:26] WARNING train_model: Removing constant feature: double_top
[2025-07-17 10:42:26] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 10:42:26] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 10:42:26] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 10:42:26] INFO train_model: Entering audit_data_quality
[2025-07-17 10:42:27] INFO train_model: Exiting audit_data_quality
[2025-07-17 10:42:27] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 10:42:27] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 10:42:27] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 10:42:28] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 10:42:28] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 10:42:28] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 10:42:40] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:42:40] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:42:40] INFO train_model: Model is starting a new training session...
[2025-07-17 10:42:40] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 10:42:40] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:42:40] INFO train_model: Preparing target variable...
[2025-07-17 10:42:40] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:42:40] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:42:40] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:42:40] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 10:42:40] INFO train_model: Dropping NaN targets...
[2025-07-17 10:42:40] INFO train_model: Class balance before upsampling: {0: 1739, 1: 1632}
[2025-07-17 10:42:40] INFO train_model: Upsampling successful.
[2025-07-17 10:42:40] INFO train_model: Splitting train/test...
[2025-07-17 10:42:40] INFO train_model: Scaling features...
[2025-07-17 10:42:40] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 10:42:40] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 10:42:41] INFO train_model: Model fit complete.
[2025-07-17 10:42:41] INFO train_model: Model Accuracy: 0.8147
[2025-07-17 10:42:41] INFO train_model: 
Classification Report:
[2025-07-17 10:42:41] INFO train_model:               precision    recall  f1-score   support

           0       0.80      0.84      0.82       348
           1       0.83      0.78      0.81       348

    accuracy                           0.81       696
   macro avg       0.82      0.81      0.81       696
weighted avg       0.82      0.81      0.81       696

[2025-07-17 10:42:41] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 10:42:41] INFO train_model: Feature distributions before training:
[2025-07-17 10:42:41] INFO train_model: supply_zone: mean=0.2225, std=0.4160, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: demand_zone: mean=0.1655, std=0.3717, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: wyckoff_markdown: mean=0.3364, std=0.4725, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: wyckoff_markup: mean=0.4379, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1083, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:41] INFO train_model: wyckoff_distribution: mean=0.2139, std=0.4101, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: head_shoulders: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:41] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:41] INFO train_model: rising_wedge: mean=0.2557, std=0.4363, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: falling_wedge: mean=0.2661, std=0.4420, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: fakeout_up: mean=0.0042, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:42:41] INFO train_model: sma_20_4h: mean=148.3775, std=4.7942, min=140.5166, max=158.3032, unique=3367
[2025-07-17 10:42:41] INFO train_model: sma_50_4h: mean=148.4185, std=4.8143, min=140.9014, max=158.1807, unique=3367
[2025-07-17 10:42:41] INFO train_model: ema_12_4h: mean=148.3662, std=4.7850, min=140.4309, max=158.3803, unique=3371
[2025-07-17 10:42:41] INFO train_model: ema_26_4h: mean=148.3856, std=4.7896, min=140.6371, max=158.2477, unique=3371
[2025-07-17 10:42:41] INFO train_model: rsi_14_4h: mean=48.7356, std=32.4469, min=0.0000, max=100.0000, unique=1343
[2025-07-17 10:42:41] INFO train_model: macd_4h: mean=-0.0194, std=0.2231, min=-0.9388, max=0.7986, unique=3371
[2025-07-17 10:42:41] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2086, min=-0.8130, max=0.7178, unique=3371
[2025-07-17 10:42:41] INFO train_model: bb_high_4h: mean=149.0475, std=4.7673, min=140.8112, max=158.6366, unique=3371
[2025-07-17 10:42:41] INFO train_model: bb_low_4h: mean=147.7075, std=4.8521, min=139.1342, max=158.0493, unique=3371
[2025-07-17 10:42:41] INFO train_model: atr_14_4h: mean=0.6245, std=0.2425, min=0.1483, max=2.0255, unique=3303
[2025-07-17 10:42:41] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1943, min=0.0338, max=1.2700, unique=3371
[2025-07-17 10:42:41] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3371
[2025-07-17 10:42:41] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3369
[2025-07-17 10:42:41] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3371
[2025-07-17 10:42:41] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:41] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:42:41] INFO train_model: Auditing data quality before training...
[2025-07-17 10:42:41] INFO train_model: Entering audit_data_quality
[2025-07-17 10:42:42] INFO train_model: Exiting audit_data_quality
[2025-07-17 10:42:42] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 10:42:42] WARNING train_model: Removing constant feature: double_top
[2025-07-17 10:42:42] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 10:42:42] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 10:42:42] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 10:42:42] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 10:42:42] INFO train_model: Entering audit_data_quality
[2025-07-17 10:42:43] INFO train_model: Exiting audit_data_quality
[2025-07-17 10:42:43] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 10:42:43] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 10:42:43] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 10:42:43] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 10:42:43] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 10:42:43] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 10:45:45] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:45:45] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:45:45] INFO train_model: Model is starting a new training session...
[2025-07-17 10:45:45] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 10:45:45] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:45:45] INFO train_model: Preparing target variable...
[2025-07-17 10:45:45] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:45:45] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:45:45] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:45:45] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 10:45:45] INFO train_model: Dropping NaN targets...
[2025-07-17 10:45:45] INFO train_model: Class balance before upsampling: {0: 3098, 1: 1590}
[2025-07-17 10:45:45] INFO train_model: Upsampling successful.
[2025-07-17 10:45:45] INFO train_model: Splitting train/test...
[2025-07-17 10:45:45] INFO train_model: Scaling features...
[2025-07-17 10:45:45] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 10:45:45] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 10:45:47] INFO train_model: Model fit complete.
[2025-07-17 10:45:47] INFO train_model: Model Accuracy: 0.8419
[2025-07-17 10:45:47] INFO train_model: 
Classification Report:
[2025-07-17 10:45:47] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.82      0.84       620
           1       0.83      0.86      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 10:45:47] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 10:45:47] INFO train_model: Feature distributions before training:
[2025-07-17 10:45:47] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: demand_zone: mean=0.3667, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:45:47] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:45:47] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1777, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:45:47] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: rising_wedge: mean=0.2694, std=0.4437, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: falling_wedge: mean=0.2406, std=0.4275, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:45:47] INFO train_model: sma_20_4h: mean=149.0296, std=10.6081, min=0.0000, max=158.3032, unique=4660
[2025-07-17 10:45:47] INFO train_model: sma_50_4h: mean=148.0768, std=15.9244, min=0.0000, max=158.1807, unique=4635
[2025-07-17 10:45:47] INFO train_model: ema_12_4h: mean=149.6321, std=4.7065, min=140.4309, max=158.3803, unique=4688
[2025-07-17 10:45:47] INFO train_model: ema_26_4h: mean=149.6330, std=4.6920, min=140.6371, max=158.2477, unique=4688
[2025-07-17 10:45:47] INFO train_model: rsi_14_4h: mean=50.1277, std=32.8762, min=0.0000, max=100.0000, unique=1831
[2025-07-17 10:45:47] INFO train_model: macd_4h: mean=-0.0009, std=0.2226, min=-0.9388, max=0.8699, unique=4688
[2025-07-17 10:45:47] INFO train_model: macd_signal_4h: mean=-0.0009, std=0.2086, min=-0.8130, max=0.7790, unique=4688
[2025-07-17 10:45:47] INFO train_model: bb_high_4h: mean=149.6791, std=10.6339, min=0.0000, max=158.6366, unique=4670
[2025-07-17 10:45:47] INFO train_model: bb_low_4h: mean=148.3802, std=10.5963, min=0.0000, max=158.0493, unique=4670
[2025-07-17 10:45:47] INFO train_model: atr_14_4h: mean=0.6028, std=0.2358, min=0.0000, max=2.0255, unique=4556
[2025-07-17 10:45:47] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4670
[2025-07-17 10:45:47] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4670
[2025-07-17 10:45:47] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4638
[2025-07-17 10:45:47] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4640
[2025-07-17 10:45:47] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:45:47] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:45:47] INFO train_model: Auditing data quality before training...
[2025-07-17 10:45:47] INFO train_model: Entering audit_data_quality
[2025-07-17 10:50:44] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:50:44] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:50:44] INFO train_model: Model is starting a new training session...
[2025-07-17 10:50:44] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 10:50:44] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:50:44] INFO train_model: Preparing target variable...
[2025-07-17 10:50:44] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:50:44] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:50:44] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:50:44] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 10:50:44] INFO train_model: Dropping NaN targets...
[2025-07-17 10:50:44] INFO train_model: Class balance before upsampling: {0: 3098, 1: 1590}
[2025-07-17 10:50:44] INFO train_model: Upsampling successful.
[2025-07-17 10:50:44] INFO train_model: Splitting train/test...
[2025-07-17 10:50:44] INFO train_model: Scaling features...
[2025-07-17 10:50:44] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 10:50:44] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 10:50:46] INFO train_model: Model fit complete.
[2025-07-17 10:50:46] INFO train_model: Model Accuracy: 0.8419
[2025-07-17 10:50:46] INFO train_model: 
Classification Report:
[2025-07-17 10:50:46] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.82      0.84       620
           1       0.83      0.86      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 10:50:46] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 10:50:46] INFO train_model: Feature distributions before training:
[2025-07-17 10:50:46] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: demand_zone: mean=0.3667, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:50:46] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:50:46] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1777, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:50:46] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: rising_wedge: mean=0.2694, std=0.4437, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: falling_wedge: mean=0.2406, std=0.4275, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:50:46] INFO train_model: sma_20_4h: mean=149.0296, std=10.6081, min=0.0000, max=158.3032, unique=4660
[2025-07-17 10:50:46] INFO train_model: sma_50_4h: mean=148.0768, std=15.9244, min=0.0000, max=158.1807, unique=4635
[2025-07-17 10:50:46] INFO train_model: ema_12_4h: mean=149.6321, std=4.7065, min=140.4309, max=158.3803, unique=4688
[2025-07-17 10:50:46] INFO train_model: ema_26_4h: mean=149.6330, std=4.6920, min=140.6371, max=158.2477, unique=4688
[2025-07-17 10:50:46] INFO train_model: rsi_14_4h: mean=50.1277, std=32.8762, min=0.0000, max=100.0000, unique=1831
[2025-07-17 10:50:46] INFO train_model: macd_4h: mean=-0.0009, std=0.2226, min=-0.9388, max=0.8699, unique=4688
[2025-07-17 10:50:46] INFO train_model: macd_signal_4h: mean=-0.0009, std=0.2086, min=-0.8130, max=0.7790, unique=4688
[2025-07-17 10:50:46] INFO train_model: bb_high_4h: mean=149.6791, std=10.6339, min=0.0000, max=158.6366, unique=4670
[2025-07-17 10:50:46] INFO train_model: bb_low_4h: mean=148.3802, std=10.5963, min=0.0000, max=158.0493, unique=4670
[2025-07-17 10:50:46] INFO train_model: atr_14_4h: mean=0.6028, std=0.2358, min=0.0000, max=2.0255, unique=4556
[2025-07-17 10:50:46] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4670
[2025-07-17 10:50:46] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4670
[2025-07-17 10:50:46] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4638
[2025-07-17 10:50:46] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4640
[2025-07-17 10:50:46] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:50:46] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:50:46] INFO train_model: Auditing data quality before training...
[2025-07-17 10:50:46] INFO train_model: Entering audit_data_quality
[2025-07-17 10:52:34] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:52:34] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:52:34] INFO train_model: Model is starting a new training session...
[2025-07-17 10:52:34] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 10:52:34] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:52:34] INFO train_model: Preparing target variable...
[2025-07-17 10:52:34] INFO train_model: Entering prepare_target_variable
[2025-07-17 10:52:34] INFO train_model: Exiting prepare_target_variable
[2025-07-17 10:52:34] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 10:52:34] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 10:52:34] INFO train_model: Dropping NaN targets...
[2025-07-17 10:52:34] INFO train_model: Class balance before upsampling: {0: 3098, 1: 1590}
[2025-07-17 10:52:34] INFO train_model: Upsampling successful.
[2025-07-17 10:52:34] INFO train_model: Splitting train/test...
[2025-07-17 10:52:34] INFO train_model: Scaling features...
[2025-07-17 10:52:34] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 10:52:34] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 10:52:35] INFO train_model: Model fit complete.
[2025-07-17 10:52:35] INFO train_model: Model Accuracy: 0.8419
[2025-07-17 10:52:35] INFO train_model: 
Classification Report:
[2025-07-17 10:52:35] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.82      0.84       620
           1       0.83      0.86      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 10:52:35] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 10:52:35] INFO train_model: Feature distributions before training:
[2025-07-17 10:52:35] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: demand_zone: mean=0.3667, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:52:35] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:52:35] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1777, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:52:35] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: rising_wedge: mean=0.2694, std=0.4437, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: falling_wedge: mean=0.2406, std=0.4275, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 10:52:35] INFO train_model: sma_20_4h: mean=149.0296, std=10.6081, min=0.0000, max=158.3032, unique=4660
[2025-07-17 10:52:35] INFO train_model: sma_50_4h: mean=148.0768, std=15.9244, min=0.0000, max=158.1807, unique=4635
[2025-07-17 10:52:35] INFO train_model: ema_12_4h: mean=149.6321, std=4.7065, min=140.4309, max=158.3803, unique=4688
[2025-07-17 10:52:35] INFO train_model: ema_26_4h: mean=149.6330, std=4.6920, min=140.6371, max=158.2477, unique=4688
[2025-07-17 10:52:35] INFO train_model: rsi_14_4h: mean=50.1277, std=32.8762, min=0.0000, max=100.0000, unique=1831
[2025-07-17 10:52:35] INFO train_model: macd_4h: mean=-0.0009, std=0.2226, min=-0.9388, max=0.8699, unique=4688
[2025-07-17 10:52:35] INFO train_model: macd_signal_4h: mean=-0.0009, std=0.2086, min=-0.8130, max=0.7790, unique=4688
[2025-07-17 10:52:35] INFO train_model: bb_high_4h: mean=149.6791, std=10.6339, min=0.0000, max=158.6366, unique=4670
[2025-07-17 10:52:35] INFO train_model: bb_low_4h: mean=148.3802, std=10.5963, min=0.0000, max=158.0493, unique=4670
[2025-07-17 10:52:35] INFO train_model: atr_14_4h: mean=0.6028, std=0.2358, min=0.0000, max=2.0255, unique=4556
[2025-07-17 10:52:35] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4670
[2025-07-17 10:52:35] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4670
[2025-07-17 10:52:35] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4638
[2025-07-17 10:52:35] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4640
[2025-07-17 10:52:35] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:52:35] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 10:52:35] INFO train_model: Auditing data quality before training...
[2025-07-17 10:52:35] INFO train_model: Entering audit_data_quality
[2025-07-17 10:53:03] INFO train_model: Exiting audit_data_quality
[2025-07-17 10:53:03] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 10:53:03] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 10:53:03] WARNING train_model: Removing constant feature: double_top
[2025-07-17 10:53:03] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 10:53:03] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 10:53:03] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 10:53:03] INFO train_model: Entering audit_data_quality
[2025-07-17 11:08:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:08:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:08:14] INFO train_model: Model is starting a new training session...
[2025-07-17 11:08:14] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 11:08:14] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:08:14] INFO train_model: Preparing target variable...
[2025-07-17 11:08:14] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:08:14] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:08:14] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:08:14] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:08:14] INFO train_model: Dropping NaN targets...
[2025-07-17 11:08:14] INFO train_model: Class balance before upsampling: {0: 3098, 1: 1590}
[2025-07-17 11:08:14] INFO train_model: Upsampling successful.
[2025-07-17 11:08:14] INFO train_model: Splitting train/test...
[2025-07-17 11:08:14] INFO train_model: Scaling features...
[2025-07-17 11:08:14] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 11:08:14] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 11:08:15] INFO train_model: Model fit complete.
[2025-07-17 11:08:15] INFO train_model: Model Accuracy: 0.8419
[2025-07-17 11:08:15] INFO train_model: 
Classification Report:
[2025-07-17 11:08:15] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.82      0.84       620
           1       0.83      0.86      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 11:08:15] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 11:08:15] INFO train_model: Feature distributions before training:
[2025-07-17 11:08:15] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: demand_zone: mean=0.3667, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:15] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:15] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1777, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:15] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: rising_wedge: mean=0.2694, std=0.4437, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: falling_wedge: mean=0.2406, std=0.4275, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:15] INFO train_model: sma_20_4h: mean=149.0296, std=10.6081, min=0.0000, max=158.3032, unique=4660
[2025-07-17 11:08:15] INFO train_model: sma_50_4h: mean=148.0768, std=15.9244, min=0.0000, max=158.1807, unique=4635
[2025-07-17 11:08:15] INFO train_model: ema_12_4h: mean=149.6321, std=4.7065, min=140.4309, max=158.3803, unique=4688
[2025-07-17 11:08:15] INFO train_model: ema_26_4h: mean=149.6330, std=4.6920, min=140.6371, max=158.2477, unique=4688
[2025-07-17 11:08:15] INFO train_model: rsi_14_4h: mean=50.1277, std=32.8762, min=0.0000, max=100.0000, unique=1831
[2025-07-17 11:08:15] INFO train_model: macd_4h: mean=-0.0009, std=0.2226, min=-0.9388, max=0.8699, unique=4688
[2025-07-17 11:08:15] INFO train_model: macd_signal_4h: mean=-0.0009, std=0.2086, min=-0.8130, max=0.7790, unique=4688
[2025-07-17 11:08:15] INFO train_model: bb_high_4h: mean=149.6791, std=10.6339, min=0.0000, max=158.6366, unique=4670
[2025-07-17 11:08:15] INFO train_model: bb_low_4h: mean=148.3802, std=10.5963, min=0.0000, max=158.0493, unique=4670
[2025-07-17 11:08:15] INFO train_model: atr_14_4h: mean=0.6028, std=0.2358, min=0.0000, max=2.0255, unique=4556
[2025-07-17 11:08:15] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4670
[2025-07-17 11:08:15] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4670
[2025-07-17 11:08:15] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4638
[2025-07-17 11:08:15] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4640
[2025-07-17 11:08:15] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:15] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:15] INFO train_model: Auditing data quality before training...
[2025-07-17 11:08:15] INFO train_model: Entering audit_data_quality
[2025-07-17 11:08:17] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:08:17] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 11:08:17] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 11:08:17] WARNING train_model: Removing constant feature: double_top
[2025-07-17 11:08:17] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 11:08:17] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 11:08:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 11:08:17] INFO train_model: Entering audit_data_quality
[2025-07-17 11:08:18] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:08:18] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'atr_14', 'volatility_20']
[2025-07-17 11:08:18] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:08:18] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 11:08:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:08:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:08:18] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:08:18] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 11:08:29] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:08:29] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:08:29] INFO train_model: Model is starting a new training session...
[2025-07-17 11:08:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 11:08:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:08:29] INFO train_model: Preparing target variable...
[2025-07-17 11:08:29] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:08:29] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:08:29] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:08:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:08:29] INFO train_model: Dropping NaN targets...
[2025-07-17 11:08:29] INFO train_model: Class balance before upsampling: {0: 1739, 1: 1632}
[2025-07-17 11:08:29] INFO train_model: Upsampling successful.
[2025-07-17 11:08:29] INFO train_model: Splitting train/test...
[2025-07-17 11:08:29] INFO train_model: Scaling features...
[2025-07-17 11:08:29] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 11:08:29] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 11:08:30] INFO train_model: Model fit complete.
[2025-07-17 11:08:30] INFO train_model: Model Accuracy: 0.8147
[2025-07-17 11:08:30] INFO train_model: 
Classification Report:
[2025-07-17 11:08:30] INFO train_model:               precision    recall  f1-score   support

           0       0.80      0.84      0.82       348
           1       0.83      0.78      0.81       348

    accuracy                           0.81       696
   macro avg       0.82      0.81      0.81       696
weighted avg       0.82      0.81      0.81       696

[2025-07-17 11:08:30] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 11:08:30] INFO train_model: Feature distributions before training:
[2025-07-17 11:08:30] INFO train_model: supply_zone: mean=0.2225, std=0.4160, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: demand_zone: mean=0.1655, std=0.3717, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: wyckoff_markdown: mean=0.3364, std=0.4725, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: wyckoff_markup: mean=0.4379, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1083, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:30] INFO train_model: wyckoff_distribution: mean=0.2139, std=0.4101, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: head_shoulders: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:30] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:30] INFO train_model: rising_wedge: mean=0.2557, std=0.4363, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: falling_wedge: mean=0.2661, std=0.4420, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: fakeout_up: mean=0.0042, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:08:30] INFO train_model: sma_20_4h: mean=148.3775, std=4.7942, min=140.5166, max=158.3032, unique=3367
[2025-07-17 11:08:30] INFO train_model: sma_50_4h: mean=148.4185, std=4.8143, min=140.9014, max=158.1807, unique=3367
[2025-07-17 11:08:30] INFO train_model: ema_12_4h: mean=148.3662, std=4.7850, min=140.4309, max=158.3803, unique=3371
[2025-07-17 11:08:30] INFO train_model: ema_26_4h: mean=148.3856, std=4.7896, min=140.6371, max=158.2477, unique=3371
[2025-07-17 11:08:30] INFO train_model: rsi_14_4h: mean=48.7356, std=32.4469, min=0.0000, max=100.0000, unique=1343
[2025-07-17 11:08:30] INFO train_model: macd_4h: mean=-0.0194, std=0.2231, min=-0.9388, max=0.7986, unique=3371
[2025-07-17 11:08:30] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2086, min=-0.8130, max=0.7178, unique=3371
[2025-07-17 11:08:30] INFO train_model: bb_high_4h: mean=149.0475, std=4.7673, min=140.8112, max=158.6366, unique=3371
[2025-07-17 11:08:30] INFO train_model: bb_low_4h: mean=147.7075, std=4.8521, min=139.1342, max=158.0493, unique=3371
[2025-07-17 11:08:30] INFO train_model: atr_14_4h: mean=0.6245, std=0.2425, min=0.1483, max=2.0255, unique=3303
[2025-07-17 11:08:30] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1943, min=0.0338, max=1.2700, unique=3371
[2025-07-17 11:08:30] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3371
[2025-07-17 11:08:30] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3369
[2025-07-17 11:08:30] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3371
[2025-07-17 11:08:30] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:30] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:08:30] INFO train_model: Auditing data quality before training...
[2025-07-17 11:08:30] INFO train_model: Entering audit_data_quality
[2025-07-17 11:08:31] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:08:31] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 11:08:31] WARNING train_model: Removing constant feature: double_top
[2025-07-17 11:08:31] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 11:08:31] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 11:08:31] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 11:08:31] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 11:08:31] INFO train_model: Entering audit_data_quality
[2025-07-17 11:08:32] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:08:32] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'double_top', 'double_bottom', 'atr_14', 'volatility_20']
[2025-07-17 11:08:32] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:08:32] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 11:08:32] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:08:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:08:32] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:08:32] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 11:25:35] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:25:35] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 11:25:35] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 11:25:35] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:25:35] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:25:35] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:25:35] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 11:25:36] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:25:36] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 11:25:36] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 11:25:36] WARNING train_model: Removing constant feature: double_top
[2025-07-17 11:25:36] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 11:25:36] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 11:25:36] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 11:25:36] INFO train_model: Entering audit_data_quality
[2025-07-17 11:25:41] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:25:41] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 11:25:41] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 11:25:41] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:25:41] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:25:41] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:25:41] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 11:25:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:25:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:25:49] INFO train_model: Model is starting a new training session...
[2025-07-17 11:25:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 11:25:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:25:49] INFO train_model: Preparing target variable...
[2025-07-17 11:25:49] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:25:49] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:25:49] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:25:49] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:25:49] INFO train_model: Dropping NaN targets...
[2025-07-17 11:25:49] INFO train_model: Class balance before upsampling: {0: 1739, 1: 1632}
[2025-07-17 11:25:49] INFO train_model: Upsampling successful.
[2025-07-17 11:25:49] INFO train_model: Splitting train/test...
[2025-07-17 11:25:49] INFO train_model: Scaling features...
[2025-07-17 11:25:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 11:25:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 11:25:50] INFO train_model: Model fit complete.
[2025-07-17 11:25:50] INFO train_model: Model Accuracy: 0.8276
[2025-07-17 11:25:50] INFO train_model: 
Classification Report:
[2025-07-17 11:25:50] INFO train_model:               precision    recall  f1-score   support

           0       0.81      0.85      0.83       348
           1       0.84      0.81      0.82       348

    accuracy                           0.83       696
   macro avg       0.83      0.83      0.83       696
weighted avg       0.83      0.83      0.83       696

[2025-07-17 11:25:50] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 11:25:50] INFO train_model: Feature distributions before training:
[2025-07-17 11:25:50] INFO train_model: supply_zone: mean=0.2225, std=0.4160, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: demand_zone: mean=0.1655, std=0.3717, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: wyckoff_markdown: mean=0.3364, std=0.4725, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: wyckoff_markup: mean=0.4379, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1083, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:50] INFO train_model: wyckoff_distribution: mean=0.2139, std=0.4101, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: head_shoulders: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:50] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:50] INFO train_model: rising_wedge: mean=0.2557, std=0.4363, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: falling_wedge: mean=0.2661, std=0.4420, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: fakeout_up: mean=0.0042, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:50] INFO train_model: sma_20_4h: mean=148.3775, std=4.7942, min=140.5166, max=158.3032, unique=3367
[2025-07-17 11:25:50] INFO train_model: sma_50_4h: mean=148.4185, std=4.8143, min=140.9014, max=158.1807, unique=3367
[2025-07-17 11:25:50] INFO train_model: ema_12_4h: mean=148.3662, std=4.7850, min=140.4309, max=158.3803, unique=3371
[2025-07-17 11:25:50] INFO train_model: ema_26_4h: mean=148.3856, std=4.7896, min=140.6371, max=158.2477, unique=3371
[2025-07-17 11:25:50] INFO train_model: rsi_14_4h: mean=48.7356, std=32.4469, min=0.0000, max=100.0000, unique=1343
[2025-07-17 11:25:50] INFO train_model: macd_4h: mean=-0.0194, std=0.2231, min=-0.9388, max=0.7986, unique=3371
[2025-07-17 11:25:50] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2086, min=-0.8130, max=0.7178, unique=3371
[2025-07-17 11:25:50] INFO train_model: bb_high_4h: mean=149.0475, std=4.7673, min=140.8112, max=158.6366, unique=3371
[2025-07-17 11:25:50] INFO train_model: bb_low_4h: mean=147.7075, std=4.8521, min=139.1342, max=158.0493, unique=3371
[2025-07-17 11:25:50] INFO train_model: atr_14_4h: mean=0.6245, std=0.2425, min=0.1483, max=2.0255, unique=3303
[2025-07-17 11:25:50] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1943, min=0.0338, max=1.2700, unique=3371
[2025-07-17 11:25:50] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3371
[2025-07-17 11:25:50] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3369
[2025-07-17 11:25:50] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3371
[2025-07-17 11:25:50] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:50] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:50] INFO train_model: Auditing data quality before training...
[2025-07-17 11:25:50] INFO train_model: Entering audit_data_quality
[2025-07-17 11:25:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:25:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:25:53] INFO train_model: Model is starting a new training session...
[2025-07-17 11:25:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 11:25:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:25:53] INFO train_model: Preparing target variable...
[2025-07-17 11:25:53] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:25:53] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:25:53] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:25:53] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:25:53] INFO train_model: Dropping NaN targets...
[2025-07-17 11:25:53] INFO train_model: Class balance before upsampling: {0: 1739, 1: 1632}
[2025-07-17 11:25:53] INFO train_model: Upsampling successful.
[2025-07-17 11:25:53] INFO train_model: Splitting train/test...
[2025-07-17 11:25:53] INFO train_model: Scaling features...
[2025-07-17 11:25:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 11:25:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 11:25:54] INFO train_model: Model fit complete.
[2025-07-17 11:25:54] INFO train_model: Model Accuracy: 0.8276
[2025-07-17 11:25:54] INFO train_model: 
Classification Report:
[2025-07-17 11:25:54] INFO train_model:               precision    recall  f1-score   support

           0       0.81      0.85      0.83       348
           1       0.84      0.81      0.82       348

    accuracy                           0.83       696
   macro avg       0.83      0.83      0.83       696
weighted avg       0.83      0.83      0.83       696

[2025-07-17 11:25:54] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 11:25:54] INFO train_model: Feature distributions before training:
[2025-07-17 11:25:54] INFO train_model: supply_zone: mean=0.2225, std=0.4160, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: demand_zone: mean=0.1655, std=0.3717, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: wyckoff_markdown: mean=0.3364, std=0.4725, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: wyckoff_markup: mean=0.4379, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1083, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:54] INFO train_model: wyckoff_distribution: mean=0.2139, std=0.4101, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: head_shoulders: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:54] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:54] INFO train_model: rising_wedge: mean=0.2557, std=0.4363, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: falling_wedge: mean=0.2661, std=0.4420, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: fakeout_up: mean=0.0042, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:25:54] INFO train_model: sma_20_4h: mean=148.3775, std=4.7942, min=140.5166, max=158.3032, unique=3367
[2025-07-17 11:25:54] INFO train_model: sma_50_4h: mean=148.4185, std=4.8143, min=140.9014, max=158.1807, unique=3367
[2025-07-17 11:25:54] INFO train_model: ema_12_4h: mean=148.3662, std=4.7850, min=140.4309, max=158.3803, unique=3371
[2025-07-17 11:25:54] INFO train_model: ema_26_4h: mean=148.3856, std=4.7896, min=140.6371, max=158.2477, unique=3371
[2025-07-17 11:25:54] INFO train_model: rsi_14_4h: mean=48.7356, std=32.4469, min=0.0000, max=100.0000, unique=1343
[2025-07-17 11:25:54] INFO train_model: macd_4h: mean=-0.0194, std=0.2231, min=-0.9388, max=0.7986, unique=3371
[2025-07-17 11:25:54] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2086, min=-0.8130, max=0.7178, unique=3371
[2025-07-17 11:25:54] INFO train_model: bb_high_4h: mean=149.0475, std=4.7673, min=140.8112, max=158.6366, unique=3371
[2025-07-17 11:25:54] INFO train_model: bb_low_4h: mean=147.7075, std=4.8521, min=139.1342, max=158.0493, unique=3371
[2025-07-17 11:25:54] INFO train_model: atr_14_4h: mean=0.6245, std=0.2425, min=0.1483, max=2.0255, unique=3303
[2025-07-17 11:25:54] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1943, min=0.0338, max=1.2700, unique=3371
[2025-07-17 11:25:54] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3371
[2025-07-17 11:25:54] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3369
[2025-07-17 11:25:54] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3371
[2025-07-17 11:25:54] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:54] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:25:54] INFO train_model: Auditing data quality before training...
[2025-07-17 11:25:54] INFO train_model: Entering audit_data_quality
[2025-07-17 11:30:52] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:30:52] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:30:52] INFO train_model: Model is starting a new training session...
[2025-07-17 11:30:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 11:30:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:30:52] INFO train_model: Preparing target variable...
[2025-07-17 11:30:52] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:30:52] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:30:52] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:30:52] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:30:52] INFO train_model: Dropping NaN targets...
[2025-07-17 11:30:52] INFO train_model: Class balance before upsampling: {0: 3098, 1: 1590}
[2025-07-17 11:30:52] INFO train_model: Upsampling successful.
[2025-07-17 11:30:52] INFO train_model: Splitting train/test...
[2025-07-17 11:30:52] INFO train_model: Scaling features...
[2025-07-17 11:30:52] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 11:30:52] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 11:30:53] INFO train_model: Model fit complete.
[2025-07-17 11:30:53] INFO train_model: Model Accuracy: 0.8379
[2025-07-17 11:30:53] INFO train_model: 
Classification Report:
[2025-07-17 11:30:53] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.82      0.84       620
           1       0.83      0.85      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 11:30:53] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 11:30:53] INFO train_model: Feature distributions before training:
[2025-07-17 11:30:53] INFO train_model: supply_zone: mean=0.4398, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: demand_zone: mean=0.3667, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: wyckoff_markdown: mean=0.4998, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: wyckoff_markup: mean=0.4917, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0920, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:30:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:30:53] INFO train_model: head_shoulders: mean=0.0307, std=0.1726, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1777, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:30:53] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: rising_wedge: mean=0.2694, std=0.4437, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: falling_wedge: mean=0.2406, std=0.4275, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: fakeout_up: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: fakeout_down: mean=0.0004, std=0.0207, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:30:53] INFO train_model: sma_20_4h: mean=149.0296, std=10.6081, min=0.0000, max=158.3032, unique=4660
[2025-07-17 11:30:53] INFO train_model: sma_50_4h: mean=148.0768, std=15.9244, min=0.0000, max=158.1807, unique=4635
[2025-07-17 11:30:53] INFO train_model: ema_12_4h: mean=149.6321, std=4.7065, min=140.4309, max=158.3803, unique=4688
[2025-07-17 11:30:53] INFO train_model: ema_26_4h: mean=149.6330, std=4.6920, min=140.6371, max=158.2477, unique=4688
[2025-07-17 11:30:53] INFO train_model: rsi_14_4h: mean=50.1277, std=32.8762, min=0.0000, max=100.0000, unique=1831
[2025-07-17 11:30:53] INFO train_model: macd_4h: mean=-0.0009, std=0.2226, min=-0.9388, max=0.8699, unique=4688
[2025-07-17 11:30:53] INFO train_model: macd_signal_4h: mean=-0.0009, std=0.2086, min=-0.8130, max=0.7790, unique=4688
[2025-07-17 11:30:53] INFO train_model: bb_high_4h: mean=149.6791, std=10.6339, min=0.0000, max=158.6366, unique=4670
[2025-07-17 11:30:53] INFO train_model: bb_low_4h: mean=148.3802, std=10.5963, min=0.0000, max=158.0493, unique=4670
[2025-07-17 11:30:53] INFO train_model: atr_14_4h: mean=0.6028, std=0.2358, min=0.0000, max=2.0255, unique=4556
[2025-07-17 11:30:53] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4670
[2025-07-17 11:30:53] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4670
[2025-07-17 11:30:53] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4638
[2025-07-17 11:30:53] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4640
[2025-07-17 11:30:53] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:30:53] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:30:53] INFO train_model: Auditing data quality before training...
[2025-07-17 11:30:54] INFO train_model: Entering audit_data_quality
[2025-07-17 11:30:55] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:30:55] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 11:30:55] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 11:30:55] WARNING train_model: Removing constant feature: double_top
[2025-07-17 11:30:55] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 11:30:55] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 11:30:55] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 11:30:55] INFO train_model: Entering audit_data_quality
[2025-07-17 11:30:56] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:30:56] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'atr_14', 'volatility_20']
[2025-07-17 11:30:56] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:30:56] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 11:30:56] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:30:56] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:30:56] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:30:56] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 11:31:07] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:31:07] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:31:07] INFO train_model: Model is starting a new training session...
[2025-07-17 11:31:07] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 11:31:07] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:31:07] INFO train_model: Preparing target variable...
[2025-07-17 11:31:07] INFO train_model: Entering prepare_target_variable
[2025-07-17 11:31:07] INFO train_model: Exiting prepare_target_variable
[2025-07-17 11:31:07] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 11:31:07] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:31:07] INFO train_model: Dropping NaN targets...
[2025-07-17 11:31:07] INFO train_model: Class balance before upsampling: {0: 1739, 1: 1632}
[2025-07-17 11:31:07] INFO train_model: Upsampling successful.
[2025-07-17 11:31:07] INFO train_model: Splitting train/test...
[2025-07-17 11:31:07] INFO train_model: Scaling features...
[2025-07-17 11:31:07] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 11:31:07] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 11:31:08] INFO train_model: Model fit complete.
[2025-07-17 11:31:08] INFO train_model: Model Accuracy: 0.8276
[2025-07-17 11:31:08] INFO train_model: 
Classification Report:
[2025-07-17 11:31:08] INFO train_model:               precision    recall  f1-score   support

           0       0.81      0.85      0.83       348
           1       0.84      0.81      0.82       348

    accuracy                           0.83       696
   macro avg       0.83      0.83      0.83       696
weighted avg       0.83      0.83      0.83       696

[2025-07-17 11:31:08] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 11:31:08] INFO train_model: Feature distributions before training:
[2025-07-17 11:31:08] INFO train_model: supply_zone: mean=0.2225, std=0.4160, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: demand_zone: mean=0.1655, std=0.3717, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: wyckoff_markdown: mean=0.3364, std=0.4725, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: wyckoff_markup: mean=0.4379, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1083, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:31:08] INFO train_model: wyckoff_distribution: mean=0.2139, std=0.4101, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: head_shoulders: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1800, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:31:08] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:31:08] INFO train_model: rising_wedge: mean=0.2557, std=0.4363, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: falling_wedge: mean=0.2661, std=0.4420, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: fakeout_up: mean=0.0042, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 11:31:08] INFO train_model: sma_20_4h: mean=148.3775, std=4.7942, min=140.5166, max=158.3032, unique=3367
[2025-07-17 11:31:08] INFO train_model: sma_50_4h: mean=148.4185, std=4.8143, min=140.9014, max=158.1807, unique=3367
[2025-07-17 11:31:08] INFO train_model: ema_12_4h: mean=148.3662, std=4.7850, min=140.4309, max=158.3803, unique=3371
[2025-07-17 11:31:08] INFO train_model: ema_26_4h: mean=148.3856, std=4.7896, min=140.6371, max=158.2477, unique=3371
[2025-07-17 11:31:08] INFO train_model: rsi_14_4h: mean=48.7356, std=32.4469, min=0.0000, max=100.0000, unique=1343
[2025-07-17 11:31:08] INFO train_model: macd_4h: mean=-0.0194, std=0.2231, min=-0.9388, max=0.7986, unique=3371
[2025-07-17 11:31:08] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2086, min=-0.8130, max=0.7178, unique=3371
[2025-07-17 11:31:08] INFO train_model: bb_high_4h: mean=149.0475, std=4.7673, min=140.8112, max=158.6366, unique=3371
[2025-07-17 11:31:08] INFO train_model: bb_low_4h: mean=147.7075, std=4.8521, min=139.1342, max=158.0493, unique=3371
[2025-07-17 11:31:08] INFO train_model: atr_14_4h: mean=0.6245, std=0.2425, min=0.1483, max=2.0255, unique=3303
[2025-07-17 11:31:08] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1943, min=0.0338, max=1.2700, unique=3371
[2025-07-17 11:31:08] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3371
[2025-07-17 11:31:08] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3369
[2025-07-17 11:31:08] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3371
[2025-07-17 11:31:08] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:31:08] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 11:31:08] INFO train_model: Auditing data quality before training...
[2025-07-17 11:31:08] INFO train_model: Entering audit_data_quality
[2025-07-17 11:31:10] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:31:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 11:31:10] WARNING train_model: Removing constant feature: double_top
[2025-07-17 11:31:10] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 11:31:10] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 11:31:10] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 11:31:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 11:31:10] INFO train_model: Entering audit_data_quality
[2025-07-17 11:31:11] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:31:11] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'double_top', 'double_bottom', 'atr_14', 'volatility_20']
[2025-07-17 11:31:11] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 11:31:11] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 11:31:11] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:31:11] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:31:11] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:31:11] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 11:31:17] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:31:17] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 11:31:17] WARNING train_model: Removing constant feature: double_top
[2025-07-17 11:31:17] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 11:31:17] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 11:31:17] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 11:31:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 11:31:17] INFO train_model: Entering audit_data_quality
[2025-07-17 11:31:19] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:31:19] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 11:31:19] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 11:31:19] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:31:19] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:31:19] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:31:19] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 11:31:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:31:21] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 11:31:21] WARNING train_model: Removing constant feature: double_top
[2025-07-17 11:31:21] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 11:31:21] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 11:31:21] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 11:31:21] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 11:31:21] INFO train_model: Entering audit_data_quality
[2025-07-17 11:31:24] INFO train_model: Exiting audit_data_quality
[2025-07-17 11:31:24] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 11:31:24] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 11:31:24] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 11:31:24] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 11:31:24] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 11:31:24] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 12:06:33] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:06:33] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:06:33] INFO train_model: Model is starting a new training session...
[2025-07-17 12:06:33] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 12:06:33] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:06:33] INFO train_model: Preparing target variable...
[2025-07-17 12:06:33] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:06:33] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:06:33] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:06:33] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:06:33] INFO train_model: Dropping NaN targets...
[2025-07-17 12:06:33] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 12:06:33] INFO train_model: Upsampling successful.
[2025-07-17 12:06:33] INFO train_model: Splitting train/test...
[2025-07-17 12:06:33] INFO train_model: Scaling features...
[2025-07-17 12:06:33] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 12:06:33] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 12:06:34] INFO train_model: Model fit complete.
[2025-07-17 12:06:34] INFO train_model: Model Accuracy: 0.8363
[2025-07-17 12:06:34] INFO train_model: 
Classification Report:
[2025-07-17 12:06:34] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.83      0.83       620
           1       0.83      0.85      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 12:06:34] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 12:06:34] INFO train_model: Feature distributions before training:
[2025-07-17 12:06:34] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: wyckoff_markdown: mean=0.5002, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: wyckoff_markup: mean=0.4913, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0919, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:34] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:34] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:34] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:34] INFO train_model: sma_20_4h: mean=149.0290, std=10.6036, min=0.0000, max=158.3032, unique=4664
[2025-07-17 12:06:34] INFO train_model: sma_50_4h: mean=148.0772, std=15.9176, min=0.0000, max=158.1807, unique=4639
[2025-07-17 12:06:34] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 12:06:34] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 12:06:34] INFO train_model: rsi_14_4h: mean=50.1667, std=32.8895, min=0.0000, max=100.0000, unique=1832
[2025-07-17 12:06:34] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 12:06:34] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 12:06:34] INFO train_model: bb_high_4h: mean=149.6784, std=10.6294, min=0.0000, max=158.6366, unique=4674
[2025-07-17 12:06:34] INFO train_model: bb_low_4h: mean=148.3796, std=10.5918, min=0.0000, max=158.0493, unique=4674
[2025-07-17 12:06:34] INFO train_model: atr_14_4h: mean=0.6026, std=0.2358, min=0.0000, max=2.0255, unique=4560
[2025-07-17 12:06:34] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4674
[2025-07-17 12:06:34] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4674
[2025-07-17 12:06:34] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4642
[2025-07-17 12:06:34] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4644
[2025-07-17 12:06:34] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:34] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:34] INFO train_model: Auditing data quality before training...
[2025-07-17 12:06:35] INFO train_model: Entering audit_data_quality
[2025-07-17 12:06:36] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:06:36] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 12:06:36] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 12:06:36] WARNING train_model: Removing constant feature: double_top
[2025-07-17 12:06:36] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 12:06:36] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 12:06:36] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 12:06:36] INFO train_model: Entering audit_data_quality
[2025-07-17 12:06:37] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:06:37] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'atr_14', 'volatility_20']
[2025-07-17 12:06:37] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:06:37] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 12:06:37] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 12:06:38] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 12:06:38] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 12:06:38] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 12:06:47] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:06:47] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:06:47] INFO train_model: Model is starting a new training session...
[2025-07-17 12:06:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 12:06:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:06:47] INFO train_model: Preparing target variable...
[2025-07-17 12:06:47] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:06:47] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:06:47] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:06:47] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:06:47] INFO train_model: Dropping NaN targets...
[2025-07-17 12:06:47] INFO train_model: Class balance before upsampling: {0: 1741, 1: 1634}
[2025-07-17 12:06:47] INFO train_model: Upsampling successful.
[2025-07-17 12:06:47] INFO train_model: Splitting train/test...
[2025-07-17 12:06:47] INFO train_model: Scaling features...
[2025-07-17 12:06:47] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 12:06:47] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 12:06:48] INFO train_model: Model fit complete.
[2025-07-17 12:06:48] INFO train_model: Model Accuracy: 0.7834
[2025-07-17 12:06:48] INFO train_model: 
Classification Report:
[2025-07-17 12:06:48] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.81      0.79       349
           1       0.80      0.76      0.78       348

    accuracy                           0.78       697
   macro avg       0.78      0.78      0.78       697
weighted avg       0.78      0.78      0.78       697

[2025-07-17 12:06:48] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 12:06:48] INFO train_model: Feature distributions before training:
[2025-07-17 12:06:48] INFO train_model: supply_zone: mean=0.2222, std=0.4158, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: demand_zone: mean=0.1653, std=0.3715, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: wyckoff_markdown: mean=0.3360, std=0.4724, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: wyckoff_markup: mean=0.4376, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1082, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:48] INFO train_model: wyckoff_distribution: mean=0.2145, std=0.4105, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: head_shoulders: mean=0.0332, std=0.1791, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1799, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:48] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:48] INFO train_model: rising_wedge: mean=0.2554, std=0.4362, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: fakeout_up: mean=0.0041, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:06:48] INFO train_model: sma_20_4h: mean=148.3774, std=4.7913, min=140.5166, max=158.3032, unique=3371
[2025-07-17 12:06:48] INFO train_model: sma_50_4h: mean=148.4186, std=4.8114, min=140.9014, max=158.1807, unique=3371
[2025-07-17 12:06:48] INFO train_model: ema_12_4h: mean=148.3664, std=4.7822, min=140.4309, max=158.3803, unique=3375
[2025-07-17 12:06:48] INFO train_model: ema_26_4h: mean=148.3857, std=4.7868, min=140.6371, max=158.2477, unique=3375
[2025-07-17 12:06:48] INFO train_model: rsi_14_4h: mean=48.7915, std=32.4685, min=0.0000, max=100.0000, unique=1344
[2025-07-17 12:06:48] INFO train_model: macd_4h: mean=-0.0193, std=0.2230, min=-0.9388, max=0.7986, unique=3375
[2025-07-17 12:06:48] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2085, min=-0.8130, max=0.7178, unique=3375
[2025-07-17 12:06:48] INFO train_model: bb_high_4h: mean=149.0474, std=4.7645, min=140.8112, max=158.6366, unique=3375
[2025-07-17 12:06:48] INFO train_model: bb_low_4h: mean=147.7074, std=4.8492, min=139.1342, max=158.0493, unique=3375
[2025-07-17 12:06:48] INFO train_model: atr_14_4h: mean=0.6243, std=0.2424, min=0.1483, max=2.0255, unique=3307
[2025-07-17 12:06:48] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1941, min=0.0338, max=1.2700, unique=3375
[2025-07-17 12:06:48] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3375
[2025-07-17 12:06:48] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3373
[2025-07-17 12:06:48] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3375
[2025-07-17 12:06:48] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:48] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:06:48] INFO train_model: Auditing data quality before training...
[2025-07-17 12:06:48] INFO train_model: Entering audit_data_quality
[2025-07-17 12:06:49] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:06:49] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 12:06:49] WARNING train_model: Removing constant feature: double_top
[2025-07-17 12:06:49] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 12:06:49] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 12:06:49] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 12:06:49] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 12:06:49] INFO train_model: Entering audit_data_quality
[2025-07-17 12:06:50] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:06:50] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'double_top', 'double_bottom', 'atr_14', 'volatility_20']
[2025-07-17 12:06:50] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:06:50] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 12:06:50] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 12:06:50] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 12:06:50] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 12:06:50] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 12:22:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:22:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:22:05] INFO train_model: Model is starting a new training session...
[2025-07-17 12:22:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 12:22:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:22:05] INFO train_model: Preparing target variable...
[2025-07-17 12:22:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:22:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:22:05] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:22:05] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:22:05] INFO train_model: Dropping NaN targets...
[2025-07-17 12:22:05] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 12:22:05] INFO train_model: Upsampling successful.
[2025-07-17 12:22:05] INFO train_model: Splitting train/test...
[2025-07-17 12:22:05] INFO train_model: Scaling features...
[2025-07-17 12:22:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 12:22:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 12:22:07] INFO train_model: Model fit complete.
[2025-07-17 12:22:07] INFO train_model: Model Accuracy: 0.8435
[2025-07-17 12:22:07] INFO train_model: 
Classification Report:
[2025-07-17 12:22:07] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.82      0.84       620
           1       0.83      0.86      0.85       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 12:22:07] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 12:22:07] INFO train_model: Feature distributions before training:
[2025-07-17 12:22:07] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: wyckoff_markdown: mean=0.5002, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: wyckoff_markup: mean=0.4913, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0919, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:07] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:07] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:07] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:07] INFO train_model: sma_20_4h: mean=149.0290, std=10.6036, min=0.0000, max=158.3032, unique=4664
[2025-07-17 12:22:07] INFO train_model: sma_50_4h: mean=148.0772, std=15.9176, min=0.0000, max=158.1807, unique=4639
[2025-07-17 12:22:07] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 12:22:07] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 12:22:07] INFO train_model: rsi_14_4h: mean=50.1667, std=32.8895, min=0.0000, max=100.0000, unique=1832
[2025-07-17 12:22:07] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 12:22:07] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 12:22:07] INFO train_model: bb_high_4h: mean=149.6784, std=10.6294, min=0.0000, max=158.6366, unique=4674
[2025-07-17 12:22:07] INFO train_model: bb_low_4h: mean=148.3796, std=10.5918, min=0.0000, max=158.0493, unique=4674
[2025-07-17 12:22:07] INFO train_model: atr_14_4h: mean=0.6026, std=0.2358, min=0.0000, max=2.0255, unique=4560
[2025-07-17 12:22:07] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4674
[2025-07-17 12:22:07] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4674
[2025-07-17 12:22:07] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4642
[2025-07-17 12:22:07] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4644
[2025-07-17 12:22:07] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:07] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:07] INFO train_model: Auditing data quality before training...
[2025-07-17 12:22:07] INFO train_model: Entering audit_data_quality
[2025-07-17 12:22:08] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:22:08] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 12:22:08] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 12:22:08] WARNING train_model: Removing constant feature: double_top
[2025-07-17 12:22:08] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 12:22:08] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 12:22:08] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 12:22:08] INFO train_model: Entering audit_data_quality
[2025-07-17 12:22:09] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:22:09] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'atr_14', 'volatility_20']
[2025-07-17 12:22:09] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:22:09] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 12:22:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 12:22:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 12:22:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 12:22:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 12:22:19] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:22:19] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:22:19] INFO train_model: Model is starting a new training session...
[2025-07-17 12:22:19] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 12:22:19] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:22:19] INFO train_model: Preparing target variable...
[2025-07-17 12:22:19] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:22:19] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:22:19] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:22:19] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:22:19] INFO train_model: Dropping NaN targets...
[2025-07-17 12:22:19] INFO train_model: Class balance before upsampling: {0: 1741, 1: 1634}
[2025-07-17 12:22:19] INFO train_model: Upsampling successful.
[2025-07-17 12:22:19] INFO train_model: Splitting train/test...
[2025-07-17 12:22:19] INFO train_model: Scaling features...
[2025-07-17 12:22:19] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 12:22:19] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 12:22:20] INFO train_model: Model fit complete.
[2025-07-17 12:22:20] INFO train_model: Model Accuracy: 0.7848
[2025-07-17 12:22:20] INFO train_model: 
Classification Report:
[2025-07-17 12:22:20] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.80      0.79       349
           1       0.79      0.77      0.78       348

    accuracy                           0.78       697
   macro avg       0.78      0.78      0.78       697
weighted avg       0.78      0.78      0.78       697

[2025-07-17 12:22:20] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 12:22:20] INFO train_model: Feature distributions before training:
[2025-07-17 12:22:20] INFO train_model: supply_zone: mean=0.2222, std=0.4158, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: demand_zone: mean=0.1653, std=0.3715, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: wyckoff_markdown: mean=0.3360, std=0.4724, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: wyckoff_markup: mean=0.4373, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1082, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:20] INFO train_model: wyckoff_distribution: mean=0.2148, std=0.4108, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: head_shoulders: mean=0.0332, std=0.1791, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1799, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:20] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:20] INFO train_model: rising_wedge: mean=0.2554, std=0.4362, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: fakeout_up: mean=0.0041, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:22:20] INFO train_model: sma_20_4h: mean=148.3774, std=4.7913, min=140.5166, max=158.3032, unique=3371
[2025-07-17 12:22:20] INFO train_model: sma_50_4h: mean=148.4186, std=4.8114, min=140.9014, max=158.1807, unique=3371
[2025-07-17 12:22:20] INFO train_model: ema_12_4h: mean=148.3664, std=4.7822, min=140.4309, max=158.3803, unique=3375
[2025-07-17 12:22:20] INFO train_model: ema_26_4h: mean=148.3857, std=4.7868, min=140.6371, max=158.2477, unique=3375
[2025-07-17 12:22:20] INFO train_model: rsi_14_4h: mean=48.7915, std=32.4685, min=0.0000, max=100.0000, unique=1344
[2025-07-17 12:22:20] INFO train_model: macd_4h: mean=-0.0193, std=0.2230, min=-0.9388, max=0.7986, unique=3375
[2025-07-17 12:22:20] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2085, min=-0.8130, max=0.7178, unique=3375
[2025-07-17 12:22:20] INFO train_model: bb_high_4h: mean=149.0474, std=4.7645, min=140.8112, max=158.6366, unique=3375
[2025-07-17 12:22:20] INFO train_model: bb_low_4h: mean=147.7074, std=4.8492, min=139.1342, max=158.0493, unique=3375
[2025-07-17 12:22:20] INFO train_model: atr_14_4h: mean=0.6243, std=0.2424, min=0.1483, max=2.0255, unique=3307
[2025-07-17 12:22:20] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1941, min=0.0338, max=1.2700, unique=3375
[2025-07-17 12:22:20] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3375
[2025-07-17 12:22:20] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3373
[2025-07-17 12:22:20] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3375
[2025-07-17 12:22:20] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:20] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:22:20] INFO train_model: Auditing data quality before training...
[2025-07-17 12:22:20] INFO train_model: Entering audit_data_quality
[2025-07-17 12:22:22] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:22:22] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 12:22:22] WARNING train_model: Removing constant feature: double_top
[2025-07-17 12:22:22] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 12:22:22] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 12:22:22] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 12:22:22] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 12:22:22] INFO train_model: Entering audit_data_quality
[2025-07-17 12:22:23] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:22:23] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'double_top', 'double_bottom', 'atr_14', 'volatility_20']
[2025-07-17 12:22:23] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:22:23] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 12:22:23] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 12:22:23] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 12:22:23] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 12:22:23] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 12:37:58] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:37:58] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:37:58] INFO train_model: Model is starting a new training session...
[2025-07-17 12:37:58] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 12:37:58] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:37:58] INFO train_model: Preparing target variable...
[2025-07-17 12:37:58] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:37:58] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:37:58] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:37:58] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:37:58] INFO train_model: Dropping NaN targets...
[2025-07-17 12:37:58] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 12:37:58] INFO train_model: Upsampling successful.
[2025-07-17 12:37:58] INFO train_model: Splitting train/test...
[2025-07-17 12:37:58] INFO train_model: Scaling features...
[2025-07-17 12:37:58] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 12:37:58] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 12:38:00] INFO train_model: Model fit complete.
[2025-07-17 12:38:00] INFO train_model: Model Accuracy: 0.8411
[2025-07-17 12:38:00] INFO train_model: 
Classification Report:
[2025-07-17 12:38:00] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.82      0.84       620
           1       0.83      0.86      0.84       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 12:38:00] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 12:38:00] INFO train_model: Feature distributions before training:
[2025-07-17 12:38:00] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: wyckoff_markdown: mean=0.5002, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: wyckoff_markup: mean=0.4913, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0919, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:00] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:00] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:00] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:00] INFO train_model: sma_20_4h: mean=149.0290, std=10.6036, min=0.0000, max=158.3032, unique=4664
[2025-07-17 12:38:00] INFO train_model: sma_50_4h: mean=148.0772, std=15.9176, min=0.0000, max=158.1807, unique=4639
[2025-07-17 12:38:00] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 12:38:00] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 12:38:00] INFO train_model: rsi_14_4h: mean=50.1667, std=32.8895, min=0.0000, max=100.0000, unique=1832
[2025-07-17 12:38:00] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 12:38:00] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 12:38:00] INFO train_model: bb_high_4h: mean=149.6784, std=10.6294, min=0.0000, max=158.6366, unique=4674
[2025-07-17 12:38:00] INFO train_model: bb_low_4h: mean=148.3796, std=10.5918, min=0.0000, max=158.0493, unique=4674
[2025-07-17 12:38:00] INFO train_model: atr_14_4h: mean=0.6026, std=0.2358, min=0.0000, max=2.0255, unique=4559
[2025-07-17 12:38:00] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4674
[2025-07-17 12:38:00] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4674
[2025-07-17 12:38:00] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4642
[2025-07-17 12:38:00] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4644
[2025-07-17 12:38:00] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:00] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:00] INFO train_model: Auditing data quality before training...
[2025-07-17 12:38:00] INFO train_model: Entering audit_data_quality
[2025-07-17 12:38:01] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:38:01] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 12:38:01] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 12:38:01] WARNING train_model: Removing constant feature: double_top
[2025-07-17 12:38:01] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 12:38:01] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 12:38:01] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 12:38:01] INFO train_model: Entering audit_data_quality
[2025-07-17 12:38:02] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:38:02] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'atr_14', 'volatility_20']
[2025-07-17 12:38:02] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:38:02] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 12:38:02] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 12:38:02] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 12:38:02] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 12:38:02] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 12:38:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:38:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:38:12] INFO train_model: Model is starting a new training session...
[2025-07-17 12:38:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 12:38:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:38:12] INFO train_model: Preparing target variable...
[2025-07-17 12:38:12] INFO train_model: Entering prepare_target_variable
[2025-07-17 12:38:12] INFO train_model: Exiting prepare_target_variable
[2025-07-17 12:38:12] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 12:38:12] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:38:12] INFO train_model: Dropping NaN targets...
[2025-07-17 12:38:13] INFO train_model: Class balance before upsampling: {0: 1741, 1: 1634}
[2025-07-17 12:38:13] INFO train_model: Upsampling successful.
[2025-07-17 12:38:13] INFO train_model: Splitting train/test...
[2025-07-17 12:38:13] INFO train_model: Scaling features...
[2025-07-17 12:38:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 12:38:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 12:38:14] INFO train_model: Model fit complete.
[2025-07-17 12:38:14] INFO train_model: Model Accuracy: 0.7920
[2025-07-17 12:38:14] INFO train_model: 
Classification Report:
[2025-07-17 12:38:14] INFO train_model:               precision    recall  f1-score   support

           0       0.78      0.81      0.80       349
           1       0.80      0.77      0.79       348

    accuracy                           0.79       697
   macro avg       0.79      0.79      0.79       697
weighted avg       0.79      0.79      0.79       697

[2025-07-17 12:38:14] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 12:38:14] INFO train_model: Feature distributions before training:
[2025-07-17 12:38:14] INFO train_model: supply_zone: mean=0.2222, std=0.4158, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: demand_zone: mean=0.1653, std=0.3715, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: wyckoff_markdown: mean=0.3360, std=0.4724, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: wyckoff_markup: mean=0.4373, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1082, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:14] INFO train_model: wyckoff_distribution: mean=0.2148, std=0.4108, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: head_shoulders: mean=0.0332, std=0.1791, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1799, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:14] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:14] INFO train_model: rising_wedge: mean=0.2554, std=0.4362, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: fakeout_up: mean=0.0041, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 12:38:14] INFO train_model: sma_20_4h: mean=148.3774, std=4.7913, min=140.5166, max=158.3032, unique=3371
[2025-07-17 12:38:14] INFO train_model: sma_50_4h: mean=148.4186, std=4.8114, min=140.9014, max=158.1807, unique=3371
[2025-07-17 12:38:14] INFO train_model: ema_12_4h: mean=148.3664, std=4.7822, min=140.4309, max=158.3803, unique=3375
[2025-07-17 12:38:14] INFO train_model: ema_26_4h: mean=148.3857, std=4.7868, min=140.6371, max=158.2477, unique=3375
[2025-07-17 12:38:14] INFO train_model: rsi_14_4h: mean=48.7915, std=32.4685, min=0.0000, max=100.0000, unique=1344
[2025-07-17 12:38:14] INFO train_model: macd_4h: mean=-0.0193, std=0.2230, min=-0.9388, max=0.7986, unique=3375
[2025-07-17 12:38:14] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2085, min=-0.8130, max=0.7178, unique=3375
[2025-07-17 12:38:14] INFO train_model: bb_high_4h: mean=149.0474, std=4.7645, min=140.8112, max=158.6366, unique=3375
[2025-07-17 12:38:14] INFO train_model: bb_low_4h: mean=147.7074, std=4.8492, min=139.1342, max=158.0493, unique=3375
[2025-07-17 12:38:14] INFO train_model: atr_14_4h: mean=0.6243, std=0.2424, min=0.1483, max=2.0255, unique=3307
[2025-07-17 12:38:14] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1941, min=0.0338, max=1.2700, unique=3375
[2025-07-17 12:38:14] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3375
[2025-07-17 12:38:14] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3373
[2025-07-17 12:38:14] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3375
[2025-07-17 12:38:14] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:14] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 12:38:14] INFO train_model: Auditing data quality before training...
[2025-07-17 12:38:14] INFO train_model: Entering audit_data_quality
[2025-07-17 12:38:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:38:15] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 12:38:15] WARNING train_model: Removing constant feature: double_top
[2025-07-17 12:38:15] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 12:38:15] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 12:38:15] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 12:38:15] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 12:38:15] INFO train_model: Entering audit_data_quality
[2025-07-17 12:38:16] INFO train_model: Exiting audit_data_quality
[2025-07-17 12:38:16] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'double_top', 'double_bottom', 'atr_14', 'volatility_20']
[2025-07-17 12:38:16] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 12:38:16] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 12:38:16] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 12:38:16] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 12:38:16] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 12:38:16] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 13:00:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Model is starting a new training session...
[2025-07-17 13:00:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 13:00:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:11] INFO train_model: Preparing target variable...
[2025-07-17 13:00:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 13:00:11] INFO train_model: Dropping NaN targets...
[2025-07-17 13:00:11] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 13:00:11] INFO train_model: Upsampling successful.
[2025-07-17 13:00:11] INFO train_model: Splitting train/test...
[2025-07-17 13:00:11] INFO train_model: Scaling features...
[2025-07-17 13:00:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 13:00:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 13:00:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Model is starting a new training session...
[2025-07-17 13:00:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 13:00:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:11] INFO train_model: Preparing target variable...
[2025-07-17 13:00:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 13:00:11] INFO train_model: Dropping NaN targets...
[2025-07-17 13:00:11] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 13:00:11] INFO train_model: Upsampling successful.
[2025-07-17 13:00:11] INFO train_model: Splitting train/test...
[2025-07-17 13:00:11] INFO train_model: Scaling features...
[2025-07-17 13:00:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 13:00:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 13:00:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Model is starting a new training session...
[2025-07-17 13:00:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 13:00:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:11] INFO train_model: Preparing target variable...
[2025-07-17 13:00:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:11] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 13:00:11] INFO train_model: Dropping NaN targets...
[2025-07-17 13:00:11] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 13:00:11] INFO train_model: Upsampling successful.
[2025-07-17 13:00:11] INFO train_model: Splitting train/test...
[2025-07-17 13:00:11] INFO train_model: Scaling features...
[2025-07-17 13:00:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 13:00:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 13:00:14] INFO train_model: Model fit complete.
[2025-07-17 13:00:14] INFO train_model: Model Accuracy: 0.8452
[2025-07-17 13:00:14] INFO train_model: 
Classification Report:
[2025-07-17 13:00:14] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.83      0.84       620
           1       0.84      0.86      0.85       620

    accuracy                           0.85      1240
   macro avg       0.85      0.85      0.85      1240
weighted avg       0.85      0.85      0.85      1240

[2025-07-17 13:00:14] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 13:00:14] INFO train_model: Feature distributions before training:
[2025-07-17 13:00:14] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_markdown: mean=0.5002, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_markup: mean=0.4913, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0919, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: sma_20_4h: mean=149.0290, std=10.6036, min=0.0000, max=158.3032, unique=4664
[2025-07-17 13:00:14] INFO train_model: sma_50_4h: mean=148.0772, std=15.9176, min=0.0000, max=158.1807, unique=4639
[2025-07-17 13:00:14] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 13:00:14] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 13:00:14] INFO train_model: rsi_14_4h: mean=50.1667, std=32.8895, min=0.0000, max=100.0000, unique=1832
[2025-07-17 13:00:14] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 13:00:14] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 13:00:14] INFO train_model: bb_high_4h: mean=149.6784, std=10.6294, min=0.0000, max=158.6366, unique=4674
[2025-07-17 13:00:14] INFO train_model: bb_low_4h: mean=148.3796, std=10.5918, min=0.0000, max=158.0493, unique=4674
[2025-07-17 13:00:14] INFO train_model: atr_14_4h: mean=0.6026, std=0.2358, min=0.0000, max=2.0255, unique=4560
[2025-07-17 13:00:14] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4674
[2025-07-17 13:00:14] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4674
[2025-07-17 13:00:14] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4642
[2025-07-17 13:00:14] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4644
[2025-07-17 13:00:14] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: Auditing data quality before training...
[2025-07-17 13:00:14] INFO train_model: Entering audit_data_quality
[2025-07-17 13:00:14] INFO train_model: Model fit complete.
[2025-07-17 13:00:14] INFO train_model: Model Accuracy: 0.8452
[2025-07-17 13:00:14] INFO train_model: 
Classification Report:
[2025-07-17 13:00:14] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.83      0.84       620
           1       0.84      0.86      0.85       620

    accuracy                           0.85      1240
   macro avg       0.85      0.85      0.85      1240
weighted avg       0.85      0.85      0.85      1240

[2025-07-17 13:00:14] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 13:00:14] INFO train_model: Feature distributions before training:
[2025-07-17 13:00:14] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_markdown: mean=0.5002, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_markup: mean=0.4913, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0919, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: sma_20_4h: mean=149.0290, std=10.6036, min=0.0000, max=158.3032, unique=4664
[2025-07-17 13:00:14] INFO train_model: sma_50_4h: mean=148.0772, std=15.9176, min=0.0000, max=158.1807, unique=4639
[2025-07-17 13:00:14] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 13:00:14] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 13:00:14] INFO train_model: rsi_14_4h: mean=50.1667, std=32.8895, min=0.0000, max=100.0000, unique=1832
[2025-07-17 13:00:14] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 13:00:14] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 13:00:14] INFO train_model: bb_high_4h: mean=149.6784, std=10.6294, min=0.0000, max=158.6366, unique=4674
[2025-07-17 13:00:14] INFO train_model: bb_low_4h: mean=148.3796, std=10.5918, min=0.0000, max=158.0493, unique=4674
[2025-07-17 13:00:14] INFO train_model: atr_14_4h: mean=0.6026, std=0.2358, min=0.0000, max=2.0255, unique=4560
[2025-07-17 13:00:14] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4674
[2025-07-17 13:00:14] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4674
[2025-07-17 13:00:14] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4642
[2025-07-17 13:00:14] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4644
[2025-07-17 13:00:14] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: Auditing data quality before training...
[2025-07-17 13:00:14] INFO train_model: Entering audit_data_quality
[2025-07-17 13:00:14] INFO train_model: Model fit complete.
[2025-07-17 13:00:14] INFO train_model: Model Accuracy: 0.8452
[2025-07-17 13:00:14] INFO train_model: 
Classification Report:
[2025-07-17 13:00:14] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.83      0.84       620
           1       0.84      0.86      0.85       620

    accuracy                           0.85      1240
   macro avg       0.85      0.85      0.85      1240
weighted avg       0.85      0.85      0.85      1240

[2025-07-17 13:00:14] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 13:00:14] INFO train_model: Feature distributions before training:
[2025-07-17 13:00:14] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_markdown: mean=0.5002, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_markup: mean=0.4913, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0919, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:14] INFO train_model: sma_20_4h: mean=149.0290, std=10.6036, min=0.0000, max=158.3032, unique=4664
[2025-07-17 13:00:14] INFO train_model: sma_50_4h: mean=148.0772, std=15.9176, min=0.0000, max=158.1807, unique=4639
[2025-07-17 13:00:14] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 13:00:14] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 13:00:14] INFO train_model: rsi_14_4h: mean=50.1667, std=32.8895, min=0.0000, max=100.0000, unique=1832
[2025-07-17 13:00:14] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 13:00:14] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 13:00:14] INFO train_model: bb_high_4h: mean=149.6784, std=10.6294, min=0.0000, max=158.6366, unique=4674
[2025-07-17 13:00:14] INFO train_model: bb_low_4h: mean=148.3796, std=10.5918, min=0.0000, max=158.0493, unique=4674
[2025-07-17 13:00:14] INFO train_model: atr_14_4h: mean=0.6026, std=0.2358, min=0.0000, max=2.0255, unique=4560
[2025-07-17 13:00:14] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1930, min=0.0000, max=1.3017, unique=4674
[2025-07-17 13:00:14] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4674
[2025-07-17 13:00:14] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0053, min=-0.0229, max=0.0210, unique=4642
[2025-07-17 13:00:14] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4644
[2025-07-17 13:00:14] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:14] INFO train_model: Auditing data quality before training...
[2025-07-17 13:00:14] INFO train_model: Entering audit_data_quality
[2025-07-17 13:00:17] INFO train_model: Exiting audit_data_quality
[2025-07-17 13:00:17] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 13:00:17] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 13:00:17] WARNING train_model: Removing constant feature: double_top
[2025-07-17 13:00:17] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 13:00:17] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 13:00:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 13:00:17] INFO train_model: Entering audit_data_quality
[2025-07-17 13:00:18] INFO train_model: Exiting audit_data_quality
[2025-07-17 13:00:18] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'atr_14', 'volatility_20']
[2025-07-17 13:00:18] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 13:00:18] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 13:00:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 13:00:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 13:00:18] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 13:00:18] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 13:00:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:31] INFO train_model: Model is starting a new training session...
[2025-07-17 13:00:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 13:00:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:31] INFO train_model: Preparing target variable...
[2025-07-17 13:00:31] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:00:31] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:00:31] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'news_sentiment', 'future_return', 'target'],
      dtype='object')
[2025-07-17 13:00:31] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 13:00:32] INFO train_model: Dropping NaN targets...
[2025-07-17 13:00:32] INFO train_model: Class balance before upsampling: {0: 1741, 1: 1634}
[2025-07-17 13:00:32] INFO train_model: Upsampling successful.
[2025-07-17 13:00:32] INFO train_model: Splitting train/test...
[2025-07-17 13:00:32] INFO train_model: Scaling features...
[2025-07-17 13:00:32] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 13:00:32] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 13:00:33] INFO train_model: Model fit complete.
[2025-07-17 13:00:33] INFO train_model: Model Accuracy: 0.7862
[2025-07-17 13:00:33] INFO train_model: 
Classification Report:
[2025-07-17 13:00:33] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.82      0.79       349
           1       0.80      0.76      0.78       348

    accuracy                           0.79       697
   macro avg       0.79      0.79      0.79       697
weighted avg       0.79      0.79      0.79       697

[2025-07-17 13:00:33] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 13:00:33] INFO train_model: Feature distributions before training:
[2025-07-17 13:00:33] INFO train_model: supply_zone: mean=0.2222, std=0.4158, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: demand_zone: mean=0.1656, std=0.3718, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: wyckoff_markdown: mean=0.3360, std=0.4724, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: wyckoff_markup: mean=0.4382, std=0.4962, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: wyckoff_unknown: mean=0.0119, std=0.1082, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:33] INFO train_model: wyckoff_distribution: mean=0.2139, std=0.4101, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: head_shoulders: mean=0.0332, std=0.1791, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1799, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:33] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:33] INFO train_model: rising_wedge: mean=0.2554, std=0.4362, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: fakeout_up: mean=0.0041, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:00:33] INFO train_model: sma_20_4h: mean=148.3774, std=4.7913, min=140.5166, max=158.3032, unique=3371
[2025-07-17 13:00:33] INFO train_model: sma_50_4h: mean=148.4186, std=4.8114, min=140.9014, max=158.1807, unique=3371
[2025-07-17 13:00:33] INFO train_model: ema_12_4h: mean=148.3664, std=4.7822, min=140.4309, max=158.3803, unique=3375
[2025-07-17 13:00:33] INFO train_model: ema_26_4h: mean=148.3857, std=4.7868, min=140.6371, max=158.2477, unique=3375
[2025-07-17 13:00:33] INFO train_model: rsi_14_4h: mean=48.7915, std=32.4685, min=0.0000, max=100.0000, unique=1344
[2025-07-17 13:00:33] INFO train_model: macd_4h: mean=-0.0193, std=0.2230, min=-0.9388, max=0.7986, unique=3375
[2025-07-17 13:00:33] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2085, min=-0.8130, max=0.7178, unique=3375
[2025-07-17 13:00:33] INFO train_model: bb_high_4h: mean=149.0474, std=4.7645, min=140.8112, max=158.6366, unique=3375
[2025-07-17 13:00:33] INFO train_model: bb_low_4h: mean=147.7074, std=4.8492, min=139.1342, max=158.0493, unique=3375
[2025-07-17 13:00:33] INFO train_model: atr_14_4h: mean=0.6243, std=0.2424, min=0.1483, max=2.0255, unique=3307
[2025-07-17 13:00:33] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1941, min=0.0338, max=1.2700, unique=3375
[2025-07-17 13:00:33] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3375
[2025-07-17 13:00:33] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3373
[2025-07-17 13:00:33] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3375
[2025-07-17 13:00:33] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:33] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:00:33] INFO train_model: Auditing data quality before training...
[2025-07-17 13:00:33] INFO train_model: Entering audit_data_quality
[2025-07-17 13:00:34] INFO train_model: Exiting audit_data_quality
[2025-07-17 13:00:34] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 13:00:34] WARNING train_model: Removing constant feature: double_top
[2025-07-17 13:00:34] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 13:00:34] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 13:00:34] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 13:00:34] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 13:00:34] INFO train_model: Entering audit_data_quality
[2025-07-17 13:00:36] INFO train_model: Exiting audit_data_quality
[2025-07-17 13:00:36] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_accumulation', 'double_top', 'double_bottom', 'atr_14', 'volatility_20']
[2025-07-17 13:00:36] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 13:00:36] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 13:00:36] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 13:00:36] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 13:00:36] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 13:00:36] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 13:50:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:50:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:50:03] INFO train_model: Model is starting a new training session...
[2025-07-17 13:50:03] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 13:50:03] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 13:50:03] INFO train_model: Preparing target variable...
[2025-07-17 13:50:03] INFO train_model: Entering prepare_target_variable
[2025-07-17 13:50:03] INFO train_model: Exiting prepare_target_variable
[2025-07-17 13:50:03] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 13:50:03] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 13:50:03] INFO train_model: Dropping NaN targets...
[2025-07-17 13:50:03] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 13:50:03] INFO train_model: Upsampling successful.
[2025-07-17 13:50:03] INFO train_model: Splitting train/test...
[2025-07-17 13:50:03] INFO train_model: Scaling features...
[2025-07-17 13:50:03] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 13:50:03] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 13:50:04] INFO train_model: Model fit complete.
[2025-07-17 13:50:04] INFO train_model: Model Accuracy: 0.8419
[2025-07-17 13:50:04] INFO train_model: 
Classification Report:
[2025-07-17 13:50:04] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.82      0.84       620
           1       0.83      0.87      0.85       620

    accuracy                           0.84      1240
   macro avg       0.84      0.84      0.84      1240
weighted avg       0.84      0.84      0.84      1240

[2025-07-17 13:50:04] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 13:50:04] INFO train_model: Feature distributions before training:
[2025-07-17 13:50:04] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 13:50:04] INFO train_model: sma_20_4h: mean=149.6321, std=4.7029, min=140.5166, max=158.3032, unique=4663
[2025-07-17 13:50:04] INFO train_model: sma_50_4h: mean=149.6364, std=4.6817, min=140.9014, max=158.1807, unique=4638
[2025-07-17 13:50:04] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 13:50:04] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 13:50:04] INFO train_model: rsi_14_4h: mean=50.4438, std=32.8869, min=0.0000, max=100.0000, unique=1832
[2025-07-17 13:50:04] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 13:50:04] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 13:50:04] INFO train_model: bb_high_4h: mean=150.2836, std=4.6773, min=140.8112, max=158.6366, unique=4673
[2025-07-17 13:50:04] INFO train_model: bb_low_4h: mean=148.9806, std=4.7594, min=139.1342, max=158.0493, unique=4673
[2025-07-17 13:50:04] INFO train_model: atr_14_4h: mean=0.6038, std=0.2338, min=0.1483, max=2.0255, unique=4559
[2025-07-17 13:50:04] INFO train_model: volatility_20_4h: mean=0.3257, std=0.1919, min=0.0338, max=1.3017, unique=4673
[2025-07-17 13:50:04] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 13:50:04] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4680
[2025-07-17 13:50:04] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4673
[2025-07-17 13:50:04] INFO train_model: Auditing data quality before training...
[2025-07-17 13:50:05] INFO train_model: Entering audit_data_quality
[2025-07-17 14:10:38] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:10:38] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:10:38] INFO train_model: Model is starting a new training session...
[2025-07-17 14:10:38] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 14:10:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:10:38] INFO train_model: Preparing target variable...
[2025-07-17 14:10:38] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:10:38] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:10:38] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:10:38] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:10:38] INFO train_model: Dropping NaN targets...
[2025-07-17 14:10:38] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 14:10:38] INFO train_model: Upsampling successful.
[2025-07-17 14:10:38] INFO train_model: Splitting train/test...
[2025-07-17 14:10:38] INFO train_model: Scaling features...
[2025-07-17 14:10:38] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 14:10:38] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 14:10:39] INFO train_model: Model fit complete.
[2025-07-17 14:10:39] INFO train_model: Model Accuracy: 0.8524
[2025-07-17 14:10:39] INFO train_model: 
Classification Report:
[2025-07-17 14:10:39] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.83      0.85       620
           1       0.84      0.87      0.86       620

    accuracy                           0.85      1240
   macro avg       0.85      0.85      0.85      1240
weighted avg       0.85      0.85      0.85      1240

[2025-07-17 14:10:39] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 14:10:39] INFO train_model: Feature distributions before training:
[2025-07-17 14:10:39] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:10:39] INFO train_model: sma_20_4h: mean=149.6321, std=4.7029, min=140.5166, max=158.3032, unique=4663
[2025-07-17 14:10:39] INFO train_model: sma_50_4h: mean=149.6364, std=4.6817, min=140.9014, max=158.1807, unique=4638
[2025-07-17 14:10:39] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 14:10:39] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 14:10:39] INFO train_model: rsi_14_4h: mean=50.4438, std=32.8869, min=0.0000, max=100.0000, unique=1832
[2025-07-17 14:10:39] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 14:10:39] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 14:10:39] INFO train_model: bb_high_4h: mean=150.2836, std=4.6773, min=140.8112, max=158.6366, unique=4673
[2025-07-17 14:10:39] INFO train_model: bb_low_4h: mean=148.9806, std=4.7594, min=139.1342, max=158.0493, unique=4673
[2025-07-17 14:10:39] INFO train_model: atr_14_4h: mean=0.6038, std=0.2338, min=0.1483, max=2.0255, unique=4559
[2025-07-17 14:10:39] INFO train_model: volatility_20_4h: mean=0.3257, std=0.1919, min=0.0338, max=1.3017, unique=4673
[2025-07-17 14:10:39] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:10:39] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4680
[2025-07-17 14:10:39] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4673
[2025-07-17 14:10:39] INFO train_model: Auditing data quality before training...
[2025-07-17 14:10:39] INFO train_model: Entering audit_data_quality
[2025-07-17 14:17:17] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:17:17] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:17:17] INFO train_model: Model is starting a new training session...
[2025-07-17 14:17:17] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 14:17:17] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:17:17] INFO train_model: Preparing target variable...
[2025-07-17 14:17:17] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:17:17] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:17:17] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:17:17] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:17:17] INFO train_model: Dropping NaN targets...
[2025-07-17 14:17:17] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 14:17:17] INFO train_model: Upsampling successful.
[2025-07-17 14:17:17] INFO train_model: Splitting train/test...
[2025-07-17 14:17:17] INFO train_model: Scaling features...
[2025-07-17 14:17:17] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 14:17:17] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 14:17:19] INFO train_model: Model fit complete.
[2025-07-17 14:17:19] INFO train_model: Model Accuracy: 0.8508
[2025-07-17 14:17:19] INFO train_model: 
Classification Report:
[2025-07-17 14:17:19] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.83      0.85       620
           1       0.84      0.87      0.85       620

    accuracy                           0.85      1240
   macro avg       0.85      0.85      0.85      1240
weighted avg       0.85      0.85      0.85      1240

[2025-07-17 14:17:19] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 14:17:19] INFO train_model: Feature distributions before training:
[2025-07-17 14:17:19] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:19] INFO train_model: sma_20_4h: mean=149.6321, std=4.7029, min=140.5166, max=158.3032, unique=4663
[2025-07-17 14:17:19] INFO train_model: sma_50_4h: mean=149.6364, std=4.6817, min=140.9014, max=158.1807, unique=4638
[2025-07-17 14:17:19] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 14:17:19] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 14:17:19] INFO train_model: rsi_14_4h: mean=50.4438, std=32.8869, min=0.0000, max=100.0000, unique=1832
[2025-07-17 14:17:19] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 14:17:19] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 14:17:19] INFO train_model: bb_high_4h: mean=150.2836, std=4.6773, min=140.8112, max=158.6366, unique=4673
[2025-07-17 14:17:19] INFO train_model: bb_low_4h: mean=148.9806, std=4.7594, min=139.1342, max=158.0493, unique=4673
[2025-07-17 14:17:19] INFO train_model: atr_14_4h: mean=0.6038, std=0.2338, min=0.1483, max=2.0255, unique=4559
[2025-07-17 14:17:19] INFO train_model: volatility_20_4h: mean=0.3257, std=0.1919, min=0.0338, max=1.3017, unique=4673
[2025-07-17 14:17:19] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:19] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4680
[2025-07-17 14:17:19] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4673
[2025-07-17 14:17:19] INFO train_model: Auditing data quality before training...
[2025-07-17 14:17:19] INFO train_model: Entering audit_data_quality
[2025-07-17 14:17:20] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: double_top
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-17 14:17:20] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-17 14:17:20] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 14:17:20] INFO train_model: Entering audit_data_quality
[2025-07-17 14:17:21] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:17:21] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 14:17:21] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:17:21] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 14:17:21] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 14:17:22] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 14:17:22] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 14:17:22] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 14:17:33] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:17:33] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:17:33] INFO train_model: Model is starting a new training session...
[2025-07-17 14:17:33] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 14:17:33] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:17:33] INFO train_model: Preparing target variable...
[2025-07-17 14:17:33] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:17:33] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:17:33] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:17:33] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:17:33] INFO train_model: Dropping NaN targets...
[2025-07-17 14:17:33] INFO train_model: Class balance before upsampling: {0: 1741, 1: 1634}
[2025-07-17 14:17:33] INFO train_model: Upsampling successful.
[2025-07-17 14:17:33] INFO train_model: Splitting train/test...
[2025-07-17 14:17:33] INFO train_model: Scaling features...
[2025-07-17 14:17:33] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 14:17:33] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 14:17:34] INFO train_model: Model fit complete.
[2025-07-17 14:17:34] INFO train_model: Model Accuracy: 0.7819
[2025-07-17 14:17:34] INFO train_model: 
Classification Report:
[2025-07-17 14:17:34] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.79       349
           1       0.79      0.76      0.78       348

    accuracy                           0.78       697
   macro avg       0.78      0.78      0.78       697
weighted avg       0.78      0.78      0.78       697

[2025-07-17 14:17:34] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 14:17:34] INFO train_model: Feature distributions before training:
[2025-07-17 14:17:34] INFO train_model: supply_zone: mean=0.2222, std=0.4158, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: demand_zone: mean=0.1656, std=0.3718, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: head_shoulders: mean=0.0332, std=0.1791, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1799, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: rising_wedge: mean=0.2554, std=0.4362, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: fakeout_up: mean=0.0041, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:17:34] INFO train_model: sma_20_4h: mean=148.3774, std=4.7913, min=140.5166, max=158.3032, unique=3371
[2025-07-17 14:17:34] INFO train_model: sma_50_4h: mean=148.4186, std=4.8114, min=140.9014, max=158.1807, unique=3371
[2025-07-17 14:17:34] INFO train_model: ema_12_4h: mean=148.3664, std=4.7822, min=140.4309, max=158.3803, unique=3375
[2025-07-17 14:17:34] INFO train_model: ema_26_4h: mean=148.3857, std=4.7868, min=140.6371, max=158.2477, unique=3375
[2025-07-17 14:17:34] INFO train_model: rsi_14_4h: mean=48.7915, std=32.4685, min=0.0000, max=100.0000, unique=1344
[2025-07-17 14:17:34] INFO train_model: macd_4h: mean=-0.0193, std=0.2230, min=-0.9388, max=0.7986, unique=3375
[2025-07-17 14:17:34] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2085, min=-0.8130, max=0.7178, unique=3375
[2025-07-17 14:17:34] INFO train_model: bb_high_4h: mean=149.0474, std=4.7645, min=140.8112, max=158.6366, unique=3375
[2025-07-17 14:17:34] INFO train_model: bb_low_4h: mean=147.7074, std=4.8492, min=139.1342, max=158.0493, unique=3375
[2025-07-17 14:17:34] INFO train_model: atr_14_4h: mean=0.6244, std=0.2423, min=0.1483, max=2.0255, unique=3307
[2025-07-17 14:17:34] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1941, min=0.0338, max=1.2700, unique=3375
[2025-07-17 14:17:34] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:17:34] INFO train_model: atr_14: mean=775.4054, std=316.9231, min=0.0000, max=2432.8175, unique=3363
[2025-07-17 14:17:34] INFO train_model: volatility_20: mean=826.6802, std=541.7585, min=141.7903, max=3956.2747, unique=3356
[2025-07-17 14:17:34] INFO train_model: Auditing data quality before training...
[2025-07-17 14:17:34] INFO train_model: Entering audit_data_quality
[2025-07-17 14:17:36] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: double_top
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-17 14:17:36] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-17 14:17:36] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 14:17:36] INFO train_model: Entering audit_data_quality
[2025-07-17 14:17:37] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:17:37] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'double_bottom', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 14:17:37] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:17:37] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 14:17:37] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 14:17:37] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 14:17:37] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 14:17:37] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 14:30:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:30:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:30:11] INFO train_model: Model is starting a new training session...
[2025-07-17 14:30:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 14:30:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:30:11] INFO train_model: Preparing target variable...
[2025-07-17 14:30:11] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:30:11] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:30:11] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:30:11] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:30:11] INFO train_model: Dropping NaN targets...
[2025-07-17 14:30:11] INFO train_model: Class balance before upsampling: {0: 3099, 1: 1593}
[2025-07-17 14:30:11] INFO train_model: Upsampling successful.
[2025-07-17 14:30:11] INFO train_model: Splitting train/test...
[2025-07-17 14:30:11] INFO train_model: Scaling features...
[2025-07-17 14:30:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 14:30:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 14:30:13] INFO train_model: Model fit complete.
[2025-07-17 14:30:13] INFO train_model: Model Accuracy: 0.8508
[2025-07-17 14:30:13] INFO train_model: 
Classification Report:
[2025-07-17 14:30:13] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.83      0.85       620
           1       0.84      0.87      0.85       620

    accuracy                           0.85      1240
   macro avg       0.85      0.85      0.85      1240
weighted avg       0.85      0.85      0.85      1240

[2025-07-17 14:30:13] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 14:30:13] INFO train_model: Feature distributions before training:
[2025-07-17 14:30:13] INFO train_model: supply_zone: mean=0.4403, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: demand_zone: mean=0.3664, std=0.4819, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: head_shoulders: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: rising_wedge: mean=0.2700, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:13] INFO train_model: sma_20_4h: mean=149.6321, std=4.7029, min=140.5166, max=158.3032, unique=4663
[2025-07-17 14:30:13] INFO train_model: sma_50_4h: mean=149.6364, std=4.6817, min=140.9014, max=158.1807, unique=4638
[2025-07-17 14:30:13] INFO train_model: ema_12_4h: mean=149.6312, std=4.7046, min=140.4309, max=158.3803, unique=4692
[2025-07-17 14:30:13] INFO train_model: ema_26_4h: mean=149.6320, std=4.6901, min=140.6371, max=158.2477, unique=4692
[2025-07-17 14:30:13] INFO train_model: rsi_14_4h: mean=50.4438, std=32.8869, min=0.0000, max=100.0000, unique=1832
[2025-07-17 14:30:13] INFO train_model: macd_4h: mean=-0.0008, std=0.2226, min=-0.9388, max=0.8699, unique=4692
[2025-07-17 14:30:13] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2086, min=-0.8130, max=0.7790, unique=4692
[2025-07-17 14:30:13] INFO train_model: bb_high_4h: mean=150.2836, std=4.6773, min=140.8112, max=158.6366, unique=4673
[2025-07-17 14:30:13] INFO train_model: bb_low_4h: mean=148.9806, std=4.7594, min=139.1342, max=158.0493, unique=4673
[2025-07-17 14:30:13] INFO train_model: atr_14_4h: mean=0.6038, std=0.2338, min=0.1483, max=2.0255, unique=4559
[2025-07-17 14:30:13] INFO train_model: volatility_20_4h: mean=0.3257, std=0.1919, min=0.0338, max=1.3017, unique=4673
[2025-07-17 14:30:13] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:13] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4680
[2025-07-17 14:30:13] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4673
[2025-07-17 14:30:13] INFO train_model: Auditing data quality before training...
[2025-07-17 14:30:13] INFO train_model: Entering audit_data_quality
[2025-07-17 14:30:14] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: double_top
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-17 14:30:14] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-17 14:30:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 14:30:14] INFO train_model: Entering audit_data_quality
[2025-07-17 14:30:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:30:15] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 14:30:15] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:30:15] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 14:30:15] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 14:30:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 14:30:15] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 14:30:15] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 14:30:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:30:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:30:28] INFO train_model: Model is starting a new training session...
[2025-07-17 14:30:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 14:30:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:30:28] INFO train_model: Preparing target variable...
[2025-07-17 14:30:28] INFO train_model: Entering prepare_target_variable
[2025-07-17 14:30:28] INFO train_model: Exiting prepare_target_variable
[2025-07-17 14:30:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 14:30:28] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:30:28] INFO train_model: Dropping NaN targets...
[2025-07-17 14:30:28] INFO train_model: Class balance before upsampling: {0: 1741, 1: 1634}
[2025-07-17 14:30:28] INFO train_model: Upsampling successful.
[2025-07-17 14:30:28] INFO train_model: Splitting train/test...
[2025-07-17 14:30:28] INFO train_model: Scaling features...
[2025-07-17 14:30:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 14:30:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 14:30:29] INFO train_model: Model fit complete.
[2025-07-17 14:30:29] INFO train_model: Model Accuracy: 0.7819
[2025-07-17 14:30:29] INFO train_model: 
Classification Report:
[2025-07-17 14:30:29] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.80      0.79       349
           1       0.79      0.76      0.78       348

    accuracy                           0.78       697
   macro avg       0.78      0.78      0.78       697
weighted avg       0.78      0.78      0.78       697

[2025-07-17 14:30:29] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 14:30:29] INFO train_model: Feature distributions before training:
[2025-07-17 14:30:29] INFO train_model: supply_zone: mean=0.2222, std=0.4158, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: demand_zone: mean=0.1656, std=0.3718, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: head_shoulders: mean=0.0332, std=0.1791, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1799, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: rising_wedge: mean=0.2554, std=0.4362, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: falling_wedge: mean=0.2658, std=0.4418, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: fakeout_up: mean=0.0041, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 14:30:29] INFO train_model: sma_20_4h: mean=148.3774, std=4.7913, min=140.5166, max=158.3032, unique=3371
[2025-07-17 14:30:29] INFO train_model: sma_50_4h: mean=148.4186, std=4.8114, min=140.9014, max=158.1807, unique=3371
[2025-07-17 14:30:29] INFO train_model: ema_12_4h: mean=148.3664, std=4.7822, min=140.4309, max=158.3803, unique=3375
[2025-07-17 14:30:29] INFO train_model: ema_26_4h: mean=148.3857, std=4.7868, min=140.6371, max=158.2477, unique=3375
[2025-07-17 14:30:29] INFO train_model: rsi_14_4h: mean=48.7915, std=32.4685, min=0.0000, max=100.0000, unique=1344
[2025-07-17 14:30:29] INFO train_model: macd_4h: mean=-0.0193, std=0.2230, min=-0.9388, max=0.7986, unique=3375
[2025-07-17 14:30:29] INFO train_model: macd_signal_4h: mean=-0.0193, std=0.2085, min=-0.8130, max=0.7178, unique=3375
[2025-07-17 14:30:29] INFO train_model: bb_high_4h: mean=149.0474, std=4.7645, min=140.8112, max=158.6366, unique=3375
[2025-07-17 14:30:29] INFO train_model: bb_low_4h: mean=147.7074, std=4.8492, min=139.1342, max=158.0493, unique=3375
[2025-07-17 14:30:29] INFO train_model: atr_14_4h: mean=0.6244, std=0.2423, min=0.1483, max=2.0255, unique=3307
[2025-07-17 14:30:29] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1941, min=0.0338, max=1.2700, unique=3375
[2025-07-17 14:30:29] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 14:30:29] INFO train_model: atr_14: mean=775.4054, std=316.9231, min=0.0000, max=2432.8175, unique=3363
[2025-07-17 14:30:29] INFO train_model: volatility_20: mean=826.6802, std=541.7585, min=141.7903, max=3956.2747, unique=3356
[2025-07-17 14:30:29] INFO train_model: Auditing data quality before training...
[2025-07-17 14:30:29] INFO train_model: Entering audit_data_quality
[2025-07-17 14:30:30] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: double_top
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-17 14:30:30] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-17 14:30:30] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 14:30:30] INFO train_model: Entering audit_data_quality
[2025-07-17 14:30:31] INFO train_model: Exiting audit_data_quality
[2025-07-17 14:30:31] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'double_bottom', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 14:30:31] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 14:30:31] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 14:30:31] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 14:30:31] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 14:30:31] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 14:30:31] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 16:00:10] INFO train_model: Entering prepare_target_variable
[2025-07-17 16:00:10] INFO train_model: Exiting prepare_target_variable
[2025-07-17 16:00:10] INFO train_model: Model is starting a new training session...
[2025-07-17 16:00:10] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 16:00:10] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 16:00:10] INFO train_model: Preparing target variable...
[2025-07-17 16:00:10] INFO train_model: Entering prepare_target_variable
[2025-07-17 16:00:10] INFO train_model: Exiting prepare_target_variable
[2025-07-17 16:00:10] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 16:00:10] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 16:00:10] INFO train_model: Dropping NaN targets...
[2025-07-17 16:00:10] INFO train_model: Class balance before upsampling: {0: 3103, 1: 1593}
[2025-07-17 16:00:10] INFO train_model: Upsampling successful.
[2025-07-17 16:00:10] INFO train_model: Splitting train/test...
[2025-07-17 16:00:10] INFO train_model: Scaling features...
[2025-07-17 16:00:10] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 16:00:10] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 16:00:11] INFO train_model: Model fit complete.
[2025-07-17 16:00:11] INFO train_model: Model Accuracy: 0.8422
[2025-07-17 16:00:11] INFO train_model: 
Classification Report:
[2025-07-17 16:00:11] INFO train_model:               precision    recall  f1-score   support

           0       0.85      0.84      0.84       621
           1       0.84      0.85      0.84       621

    accuracy                           0.84      1242
   macro avg       0.84      0.84      0.84      1242
weighted avg       0.84      0.84      0.84      1242

[2025-07-17 16:00:11] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 16:00:11] INFO train_model: Feature distributions before training:
[2025-07-17 16:00:11] INFO train_model: supply_zone: mean=0.4402, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: demand_zone: mean=0.3661, std=0.4818, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: head_shoulders: mean=0.0307, std=0.1724, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: rising_wedge: mean=0.2702, std=0.4441, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: falling_wedge: mean=0.2402, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:11] INFO train_model: sma_20_4h: mean=149.6310, std=4.7010, min=140.5166, max=158.3032, unique=4667
[2025-07-17 16:00:11] INFO train_model: sma_50_4h: mean=149.6354, std=4.6798, min=140.9014, max=158.1807, unique=4642
[2025-07-17 16:00:11] INFO train_model: ema_12_4h: mean=149.6302, std=4.7027, min=140.4309, max=158.3803, unique=4696
[2025-07-17 16:00:11] INFO train_model: ema_26_4h: mean=149.6310, std=4.6882, min=140.6371, max=158.2477, unique=4696
[2025-07-17 16:00:11] INFO train_model: rsi_14_4h: mean=50.4576, std=32.8791, min=0.0000, max=100.0000, unique=1834
[2025-07-17 16:00:11] INFO train_model: macd_4h: mean=-0.0008, std=0.2225, min=-0.9388, max=0.8699, unique=4696
[2025-07-17 16:00:11] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2085, min=-0.8130, max=0.7790, unique=4696
[2025-07-17 16:00:11] INFO train_model: bb_high_4h: mean=150.2824, std=4.6755, min=140.8112, max=158.6366, unique=4677
[2025-07-17 16:00:11] INFO train_model: bb_low_4h: mean=148.9796, std=4.7575, min=139.1342, max=158.0493, unique=4677
[2025-07-17 16:00:11] INFO train_model: atr_14_4h: mean=0.6037, std=0.2338, min=0.1483, max=2.0255, unique=4562
[2025-07-17 16:00:11] INFO train_model: volatility_20_4h: mean=0.3257, std=0.1918, min=0.0338, max=1.3017, unique=4677
[2025-07-17 16:00:11] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:11] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4684
[2025-07-17 16:00:11] INFO train_model: volatility_20: mean=0.3282, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-17 16:00:11] INFO train_model: Auditing data quality before training...
[2025-07-17 16:00:11] INFO train_model: Entering audit_data_quality
[2025-07-17 16:00:14] INFO train_model: Exiting audit_data_quality
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: double_top
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-17 16:00:14] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-17 16:00:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 16:00:14] INFO train_model: Entering audit_data_quality
[2025-07-17 16:00:15] INFO train_model: Exiting audit_data_quality
[2025-07-17 16:00:15] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 16:00:15] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 16:00:15] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 16:00:15] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 16:00:15] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 16:00:15] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 16:00:15] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 16:00:27] INFO train_model: Entering prepare_target_variable
[2025-07-17 16:00:27] INFO train_model: Exiting prepare_target_variable
[2025-07-17 16:00:27] INFO train_model: Model is starting a new training session...
[2025-07-17 16:00:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 16:00:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 16:00:27] INFO train_model: Preparing target variable...
[2025-07-17 16:00:27] INFO train_model: Entering prepare_target_variable
[2025-07-17 16:00:27] INFO train_model: Exiting prepare_target_variable
[2025-07-17 16:00:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h',
       'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h',
       'volatility_20_4h', 'fib_levels', 'wyckoff_phases', 'future_return',
       'target'],
      dtype='object')
[2025-07-17 16:00:27] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 16:00:27] INFO train_model: Dropping NaN targets...
[2025-07-17 16:00:27] INFO train_model: Class balance before upsampling: {0: 1744, 1: 1634}
[2025-07-17 16:00:27] INFO train_model: Upsampling successful.
[2025-07-17 16:00:27] INFO train_model: Splitting train/test...
[2025-07-17 16:00:27] INFO train_model: Scaling features...
[2025-07-17 16:00:27] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 16:00:27] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 16:00:28] INFO train_model: Model fit complete.
[2025-07-17 16:00:28] INFO train_model: Model Accuracy: 0.8152
[2025-07-17 16:00:28] INFO train_model: 
Classification Report:
[2025-07-17 16:00:28] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.80      0.81       349
           1       0.81      0.83      0.82       349

    accuracy                           0.82       698
   macro avg       0.82      0.82      0.82       698
weighted avg       0.82      0.82      0.82       698

[2025-07-17 16:00:28] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 16:00:28] INFO train_model: Feature distributions before training:
[2025-07-17 16:00:28] INFO train_model: supply_zone: mean=0.2220, std=0.4157, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: demand_zone: mean=0.1661, std=0.3722, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: head_shoulders: mean=0.0332, std=0.1791, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: inv_head_shoulders: mean=0.0335, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: rising_wedge: mean=0.2552, std=0.4360, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: falling_wedge: mean=0.2655, std=0.4417, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: fakeout_up: mean=0.0041, std=0.0643, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: fakeout_down: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-17 16:00:28] INFO train_model: sma_20_4h: mean=148.3774, std=4.7892, min=140.5166, max=158.3032, unique=3374
[2025-07-17 16:00:28] INFO train_model: sma_50_4h: mean=148.4188, std=4.8093, min=140.9014, max=158.1807, unique=3374
[2025-07-17 16:00:28] INFO train_model: ema_12_4h: mean=148.3665, std=4.7800, min=140.4309, max=158.3803, unique=3378
[2025-07-17 16:00:28] INFO train_model: ema_26_4h: mean=148.3858, std=4.7847, min=140.6371, max=158.2477, unique=3378
[2025-07-17 16:00:28] INFO train_model: rsi_14_4h: mean=48.8145, std=32.4656, min=0.0000, max=100.0000, unique=1346
[2025-07-17 16:00:28] INFO train_model: macd_4h: mean=-0.0192, std=0.2229, min=-0.9388, max=0.7986, unique=3378
[2025-07-17 16:00:28] INFO train_model: macd_signal_4h: mean=-0.0192, std=0.2084, min=-0.8130, max=0.7178, unique=3378
[2025-07-17 16:00:28] INFO train_model: bb_high_4h: mean=149.0473, std=4.7624, min=140.8112, max=158.6366, unique=3378
[2025-07-17 16:00:28] INFO train_model: bb_low_4h: mean=147.7075, std=4.8470, min=139.1342, max=158.0493, unique=3378
[2025-07-17 16:00:28] INFO train_model: atr_14_4h: mean=0.6243, std=0.2423, min=0.1483, max=2.0255, unique=3309
[2025-07-17 16:00:28] INFO train_model: volatility_20_4h: mean=0.3350, std=0.1941, min=0.0338, max=1.2700, unique=3378
[2025-07-17 16:00:28] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 16:00:28] INFO train_model: atr_14: mean=775.3688, std=316.7847, min=0.0000, max=2432.8175, unique=3366
[2025-07-17 16:00:28] INFO train_model: volatility_20: mean=826.4315, std=541.5821, min=141.7903, max=3956.2747, unique=3359
[2025-07-17 16:00:28] INFO train_model: Auditing data quality before training...
[2025-07-17 16:00:28] INFO train_model: Entering audit_data_quality
[2025-07-17 16:00:30] INFO train_model: Exiting audit_data_quality
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: double_top
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-17 16:00:30] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-17 16:00:30] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 16:00:30] INFO train_model: Entering audit_data_quality
[2025-07-17 16:00:32] INFO train_model: Exiting audit_data_quality
[2025-07-17 16:00:32] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'double_top', 'double_bottom', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 16:00:32] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 16:00:32] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 16:00:32] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 16:00:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 16:00:32] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 16:00:32] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 17:16:38] INFO train_model: Exiting audit_data_quality
[2025-07-17 17:16:38] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 17:16:38] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 17:16:38] WARNING train_model: Removing constant feature: double_top
[2025-07-17 17:16:38] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 17:16:38] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 17:16:38] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 17:16:38] INFO train_model: Entering audit_data_quality
[2025-07-17 17:16:42] INFO train_model: Exiting audit_data_quality
[2025-07-17 17:16:42] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 17:16:42] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 17:16:42] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 17:16:42] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 17:16:42] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 17:16:42] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 17:16:42] INFO train_model: Exiting audit_data_quality
[2025-07-17 17:16:42] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 17:16:42] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-17 17:16:42] WARNING train_model: Removing constant feature: double_top
[2025-07-17 17:16:42] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 17:16:42] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 17:16:42] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 17:16:42] INFO train_model: Entering audit_data_quality
[2025-07-17 17:16:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 17:16:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 17:16:59] INFO train_model: Model is starting a new training session...
[2025-07-17 17:16:59] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 17:16:59] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 17:16:59] INFO train_model: Preparing target variable...
[2025-07-17 17:16:59] INFO train_model: Entering prepare_target_variable
[2025-07-17 17:16:59] INFO train_model: Exiting prepare_target_variable
[2025-07-17 17:16:59] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 17:16:59] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 17:16:59] INFO train_model: Dropping NaN targets...
[2025-07-17 17:16:59] INFO train_model: Class balance before upsampling: {0: 1745, 1: 1634}
[2025-07-17 17:16:59] INFO train_model: Upsampling successful.
[2025-07-17 17:16:59] INFO train_model: Splitting train/test...
[2025-07-17 17:16:59] INFO train_model: Scaling features...
[2025-07-17 17:16:59] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 17:16:59] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 17:17:01] INFO train_model: Model fit complete.
[2025-07-17 17:17:01] INFO train_model: Model Accuracy: 0.7665
[2025-07-17 17:17:01] INFO train_model: 
Classification Report:
[2025-07-17 17:17:01] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.80      0.77       349
           1       0.79      0.73      0.76       349

    accuracy                           0.77       698
   macro avg       0.77      0.77      0.77       698
weighted avg       0.77      0.77      0.77       698

[2025-07-17 17:17:01] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 17:17:01] INFO train_model: Feature distributions before training:
[2025-07-17 17:17:01] INFO train_model: supply_zone: mean=0.2220, std=0.4156, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: demand_zone: mean=0.1660, std=0.3722, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: wyckoff_markdown: mean=0.3356, std=0.4723, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: wyckoff_markup: mean=0.4374, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: wyckoff_unknown: mean=0.0118, std=0.1082, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:17:01] INFO train_model: wyckoff_distribution: mean=0.2152, std=0.4110, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: head_shoulders: mean=0.0331, std=0.1790, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: inv_head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:17:01] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:17:01] INFO train_model: rising_wedge: mean=0.2551, std=0.4360, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: falling_wedge: mean=0.2655, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: fakeout_up: mean=0.0041, std=0.0642, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: fakeout_down: mean=0.0065, std=0.0804, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:17:01] INFO train_model: sma_20_4h: mean=148.3774, std=4.7885, min=140.5166, max=158.3032, unique=3375
[2025-07-17 17:17:01] INFO train_model: sma_50_4h: mean=148.4188, std=4.8086, min=140.9014, max=158.1807, unique=3375
[2025-07-17 17:17:01] INFO train_model: ema_12_4h: mean=148.3666, std=4.7793, min=140.4309, max=158.3803, unique=3379
[2025-07-17 17:17:01] INFO train_model: ema_26_4h: mean=148.3858, std=4.7840, min=140.6371, max=158.2477, unique=3379
[2025-07-17 17:17:01] INFO train_model: rsi_14_4h: mean=48.8150, std=32.4602, min=0.0000, max=100.0000, unique=1346
[2025-07-17 17:17:01] INFO train_model: macd_4h: mean=-0.0192, std=0.2229, min=-0.9388, max=0.7986, unique=3379
[2025-07-17 17:17:01] INFO train_model: macd_signal_4h: mean=-0.0192, std=0.2083, min=-0.8130, max=0.7178, unique=3379
[2025-07-17 17:17:01] INFO train_model: bb_high_4h: mean=149.0473, std=4.7617, min=140.8112, max=158.6366, unique=3379
[2025-07-17 17:17:01] INFO train_model: bb_low_4h: mean=147.7075, std=4.8463, min=139.1342, max=158.0493, unique=3379
[2025-07-17 17:17:01] INFO train_model: atr_14_4h: mean=0.6243, std=0.2422, min=0.1483, max=2.0255, unique=3310
[2025-07-17 17:17:01] INFO train_model: volatility_20_4h: mean=0.3349, std=0.1940, min=0.0338, max=1.2700, unique=3379
[2025-07-17 17:17:01] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3379
[2025-07-17 17:17:01] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3377
[2025-07-17 17:17:01] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3379
[2025-07-17 17:17:01] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:17:01] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:17:01] INFO train_model: Auditing data quality before training...
[2025-07-17 17:17:01] INFO train_model: Entering audit_data_quality
[2025-07-17 17:48:47] INFO train_model: Exiting audit_data_quality
[2025-07-17 17:48:47] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'head_shoulders', 'inv_head_shoulders', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 17:48:47] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-17 17:48:47] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 17:48:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 17:48:47] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 17:48:47] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 17:48:49] INFO train_model: Exiting audit_data_quality
[2025-07-17 17:48:49] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-17 17:48:49] WARNING train_model: Removing constant feature: double_top
[2025-07-17 17:48:49] WARNING train_model: Removing constant feature: double_bottom
[2025-07-17 17:48:49] WARNING train_model: Removing constant feature: atr_14
[2025-07-17 17:48:49] WARNING train_model: Removing constant feature: volatility_20
[2025-07-17 17:48:49] INFO train_model: Auditing data quality after removing constant features...
[2025-07-17 17:48:49] INFO train_model: Entering audit_data_quality
[2025-07-17 17:48:57] INFO train_model: Exiting audit_data_quality
[2025-07-17 17:48:57] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-17 17:48:57] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-17 17:48:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-17 17:48:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-17 17:48:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-17 17:48:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-17 17:49:37] INFO train_model: Entering prepare_target_variable
[2025-07-17 17:49:37] INFO train_model: Exiting prepare_target_variable
[2025-07-17 17:49:37] INFO train_model: Model is starting a new training session...
[2025-07-17 17:49:37] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 17:49:37] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 17:49:37] INFO train_model: Preparing target variable...
[2025-07-17 17:49:37] INFO train_model: Entering prepare_target_variable
[2025-07-17 17:49:37] INFO train_model: Exiting prepare_target_variable
[2025-07-17 17:49:37] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 17:49:37] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 17:49:37] INFO train_model: Dropping NaN targets...
[2025-07-17 17:49:37] INFO train_model: Class balance before upsampling: {0: 3103, 1: 1593}
[2025-07-17 17:49:37] INFO train_model: Upsampling successful.
[2025-07-17 17:49:37] INFO train_model: Splitting train/test...
[2025-07-17 17:49:37] INFO train_model: Scaling features...
[2025-07-17 17:49:37] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 17:49:37] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 17:49:39] INFO train_model: Model fit complete.
[2025-07-17 17:49:39] INFO train_model: Model Accuracy: 0.8116
[2025-07-17 17:49:39] INFO train_model: 
Classification Report:
[2025-07-17 17:49:39] INFO train_model:               precision    recall  f1-score   support

           0       0.81      0.82      0.81       621
           1       0.82      0.81      0.81       621

    accuracy                           0.81      1242
   macro avg       0.81      0.81      0.81      1242
weighted avg       0.81      0.81      0.81      1242

[2025-07-17 17:49:39] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 17:49:39] INFO train_model: Feature distributions before training:
[2025-07-17 17:49:39] INFO train_model: supply_zone: mean=0.4402, std=0.4965, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: demand_zone: mean=0.3661, std=0.4818, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: wyckoff_markdown: mean=0.5006, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: wyckoff_markup: mean=0.4908, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: wyckoff_unknown: mean=0.0085, std=0.0919, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:49:39] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:49:39] INFO train_model: head_shoulders: mean=0.0307, std=0.1724, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:49:39] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: rising_wedge: mean=0.2702, std=0.4441, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: falling_wedge: mean=0.2402, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:49:39] INFO train_model: sma_20_4h: mean=149.0284, std=10.5991, min=0.0000, max=158.3032, unique=4668
[2025-07-17 17:49:39] INFO train_model: sma_50_4h: mean=148.0776, std=15.9109, min=0.0000, max=158.1807, unique=4643
[2025-07-17 17:49:39] INFO train_model: ema_12_4h: mean=149.6302, std=4.7027, min=140.4309, max=158.3803, unique=4696
[2025-07-17 17:49:39] INFO train_model: ema_26_4h: mean=149.6310, std=4.6882, min=140.6371, max=158.2477, unique=4696
[2025-07-17 17:49:39] INFO train_model: rsi_14_4h: mean=50.1825, std=32.8825, min=0.0000, max=100.0000, unique=1834
[2025-07-17 17:49:39] INFO train_model: macd_4h: mean=-0.0008, std=0.2225, min=-0.9388, max=0.8699, unique=4696
[2025-07-17 17:49:39] INFO train_model: macd_signal_4h: mean=-0.0008, std=0.2085, min=-0.8130, max=0.7790, unique=4696
[2025-07-17 17:49:39] INFO train_model: bb_high_4h: mean=149.6779, std=10.6249, min=0.0000, max=158.6366, unique=4678
[2025-07-17 17:49:39] INFO train_model: bb_low_4h: mean=148.3790, std=10.5873, min=0.0000, max=158.0493, unique=4678
[2025-07-17 17:49:39] INFO train_model: atr_14_4h: mean=0.6026, std=0.2357, min=0.0000, max=2.0255, unique=4564
[2025-07-17 17:49:39] INFO train_model: volatility_20_4h: mean=0.3247, std=0.1929, min=0.0000, max=1.3017, unique=4678
[2025-07-17 17:49:39] INFO train_model: price_vs_sma20_4h: mean=-0.0000, std=0.0034, min=-0.0154, max=0.0185, unique=4678
[2025-07-17 17:49:39] INFO train_model: price_vs_sma50_4h: mean=-0.0000, std=0.0052, min=-0.0229, max=0.0210, unique=4646
[2025-07-17 17:49:39] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=4648
[2025-07-17 17:49:39] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:49:39] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:49:39] INFO train_model: Auditing data quality before training...
[2025-07-17 17:49:39] INFO train_model: Entering audit_data_quality
[2025-07-17 17:50:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 17:50:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 17:50:05] INFO train_model: Model is starting a new training session...
[2025-07-17 17:50:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 17:50:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 17:50:05] INFO train_model: Preparing target variable...
[2025-07-17 17:50:05] INFO train_model: Entering prepare_target_variable
[2025-07-17 17:50:05] INFO train_model: Exiting prepare_target_variable
[2025-07-17 17:50:05] INFO train_model: df columns after prepare_target_variable: Index(['Close', 'High', 'Low', 'Open', 'Volume', 'supply_zone', 'demand_zone',
       'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown',
       'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders',
       'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge',
       'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h',
       'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h',
       'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14',
       'volatility_20', 'future_return', 'target'],
      dtype='object')
[2025-07-17 17:50:05] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 17:50:05] INFO train_model: Dropping NaN targets...
[2025-07-17 17:50:05] INFO train_model: Class balance before upsampling: {0: 1745, 1: 1634}
[2025-07-17 17:50:05] INFO train_model: Upsampling successful.
[2025-07-17 17:50:05] INFO train_model: Splitting train/test...
[2025-07-17 17:50:05] INFO train_model: Scaling features...
[2025-07-17 17:50:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 17:50:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 17:50:07] INFO train_model: Model fit complete.
[2025-07-17 17:50:07] INFO train_model: Model Accuracy: 0.7736
[2025-07-17 17:50:07] INFO train_model: 
Classification Report:
[2025-07-17 17:50:07] INFO train_model:               precision    recall  f1-score   support

           0       0.76      0.80      0.78       349
           1       0.79      0.74      0.77       349

    accuracy                           0.77       698
   macro avg       0.77      0.77      0.77       698
weighted avg       0.77      0.77      0.77       698

[2025-07-17 17:50:07] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-17 17:50:07] INFO train_model: Feature distributions before training:
[2025-07-17 17:50:07] INFO train_model: supply_zone: mean=0.2220, std=0.4156, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: demand_zone: mean=0.1660, std=0.3722, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: wyckoff_markdown: mean=0.3356, std=0.4723, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: wyckoff_markup: mean=0.4374, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: wyckoff_unknown: mean=0.0118, std=0.1082, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:50:07] INFO train_model: wyckoff_distribution: mean=0.2152, std=0.4110, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: head_shoulders: mean=0.0331, std=0.1790, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: inv_head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:50:07] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:50:07] INFO train_model: rising_wedge: mean=0.2551, std=0.4360, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: falling_wedge: mean=0.2655, std=0.4416, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: fakeout_up: mean=0.0041, std=0.0642, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: fakeout_down: mean=0.0065, std=0.0804, min=0.0000, max=1.0000, unique=2
[2025-07-17 17:50:07] INFO train_model: sma_20_4h: mean=148.3774, std=4.7885, min=140.5166, max=158.3032, unique=3375
[2025-07-17 17:50:07] INFO train_model: sma_50_4h: mean=148.4188, std=4.8086, min=140.9014, max=158.1807, unique=3375
[2025-07-17 17:50:07] INFO train_model: ema_12_4h: mean=148.3666, std=4.7793, min=140.4309, max=158.3803, unique=3379
[2025-07-17 17:50:07] INFO train_model: ema_26_4h: mean=148.3858, std=4.7840, min=140.6371, max=158.2477, unique=3379
[2025-07-17 17:50:07] INFO train_model: rsi_14_4h: mean=48.8150, std=32.4602, min=0.0000, max=100.0000, unique=1346
[2025-07-17 17:50:07] INFO train_model: macd_4h: mean=-0.0192, std=0.2229, min=-0.9388, max=0.7986, unique=3379
[2025-07-17 17:50:07] INFO train_model: macd_signal_4h: mean=-0.0192, std=0.2083, min=-0.8130, max=0.7178, unique=3379
[2025-07-17 17:50:07] INFO train_model: bb_high_4h: mean=149.0473, std=4.7617, min=140.8112, max=158.6366, unique=3379
[2025-07-17 17:50:07] INFO train_model: bb_low_4h: mean=147.7075, std=4.8463, min=139.1342, max=158.0493, unique=3379
[2025-07-17 17:50:07] INFO train_model: atr_14_4h: mean=0.6243, std=0.2422, min=0.1483, max=2.0255, unique=3311
[2025-07-17 17:50:07] INFO train_model: volatility_20_4h: mean=0.3349, std=0.1940, min=0.0338, max=1.2700, unique=3379
[2025-07-17 17:50:07] INFO train_model: price_vs_sma20_4h: mean=-0.0002, std=0.0035, min=-0.0154, max=0.0185, unique=3379
[2025-07-17 17:50:07] INFO train_model: price_vs_sma50_4h: mean=-0.0004, std=0.0053, min=-0.0229, max=0.0202, unique=3377
[2025-07-17 17:50:07] INFO train_model: trend_strength_4h: mean=0.0025, std=0.0020, min=0.0000, max=0.0125, unique=3379
[2025-07-17 17:50:07] INFO train_model: atr_14: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:50:07] INFO train_model: volatility_20: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 17:50:07] INFO train_model: Auditing data quality before training...
[2025-07-17 17:50:07] INFO train_model: Entering audit_data_quality
[2025-07-17 18:55:48] INFO train_model: Model is starting a new training session...
[2025-07-17 18:55:48] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 18:55:48] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'fib_levels', 'wyckoff_phases'],
      dtype='object')
[2025-07-17 18:55:48] INFO train_model: Preparing target variable...
[2025-07-17 18:55:48] INFO train_model: Entering prepare_target_variable
[2025-07-17 18:55:48] INFO train_model: Exiting prepare_target_variable
[2025-07-17 18:55:48] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'fib_levels', 'wyckoff_phases', 'future_return', 'target'],
      dtype='object')
[2025-07-17 18:55:48] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 18:55:48] INFO train_model: Dropping NaN targets...
[2025-07-17 18:55:48] INFO train_model: Class balance before upsampling: {0: 3105, 1: 1593}
[2025-07-17 18:55:48] INFO train_model: Upsampling successful.
[2025-07-17 18:55:48] INFO train_model: Splitting train/test...
[2025-07-17 18:55:48] INFO train_model: Scaling features...
[2025-07-17 18:55:48] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 18:55:48] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 18:55:49] INFO train_model: Model fit complete.
[2025-07-17 18:55:49] INFO train_model: Model Accuracy: 0.6747
[2025-07-17 18:55:49] INFO train_model: 
Classification Report:
[2025-07-17 18:55:49] INFO train_model:               precision    recall  f1-score   support

           0       0.68      0.65      0.67       621
           1       0.67      0.70      0.68       621

    accuracy                           0.67      1242
   macro avg       0.68      0.67      0.67      1242
weighted avg       0.68      0.67      0.67      1242

[2025-07-17 18:55:49] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 18:55:49] INFO train_model: Feature distributions before training:
[2025-07-17 18:55:49] INFO train_model: supply_zone: mean=0.4400, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: demand_zone: mean=0.3659, std=0.4817, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: head_shoulders: mean=0.0307, std=0.1724, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1775, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: rising_wedge: mean=0.2701, std=0.4441, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: falling_wedge: mean=0.2401, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 18:55:49] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 18:55:49] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4686
[2025-07-17 18:55:49] INFO train_model: volatility_20: mean=0.3282, std=0.1835, min=0.0344, max=1.3004, unique=4679
[2025-07-17 18:55:49] INFO train_model: Auditing data quality before training...
[2025-07-17 18:55:49] INFO train_model: Entering audit_data_quality
[2025-07-17 19:28:48] INFO train_model: Model is starting a new training session...
[2025-07-17 19:28:48] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 19:28:48] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'fib_levels', 'wyckoff_phases'],
      dtype='object')
[2025-07-17 19:28:48] INFO train_model: Preparing target variable...
[2025-07-17 19:28:48] INFO train_model: Entering prepare_target_variable
[2025-07-17 19:28:48] INFO train_model: Exiting prepare_target_variable
[2025-07-17 19:28:48] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'fib_levels', 'wyckoff_phases', 'future_return', 'target'],
      dtype='object')
[2025-07-17 19:28:48] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 19:28:48] INFO train_model: Dropping NaN targets...
[2025-07-17 19:28:48] INFO train_model: Class balance before upsampling: {0: 3106, 1: 1593}
[2025-07-17 19:28:48] INFO train_model: Upsampling successful.
[2025-07-17 19:28:48] INFO train_model: Splitting train/test...
[2025-07-17 19:28:48] INFO train_model: Scaling features...
[2025-07-17 19:28:48] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 19:28:48] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 19:28:49] INFO train_model: Model fit complete.
[2025-07-17 19:28:49] INFO train_model: Model Accuracy: 0.6822
[2025-07-17 19:28:49] INFO train_model: 
Classification Report:
[2025-07-17 19:28:49] INFO train_model:               precision    recall  f1-score   support

           0       0.70      0.64      0.67       622
           1       0.67      0.73      0.70       621

    accuracy                           0.68      1243
   macro avg       0.68      0.68      0.68      1243
weighted avg       0.68      0.68      0.68      1243

[2025-07-17 19:28:49] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 19:28:49] INFO train_model: Feature distributions before training:
[2025-07-17 19:28:49] INFO train_model: supply_zone: mean=0.4399, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: demand_zone: mean=0.3658, std=0.4817, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: head_shoulders: mean=0.0306, std=0.1724, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1775, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: rising_wedge: mean=0.2703, std=0.4441, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: falling_wedge: mean=0.2401, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:28:49] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:28:49] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4687
[2025-07-17 19:28:49] INFO train_model: volatility_20: mean=0.3281, std=0.1835, min=0.0344, max=1.3004, unique=4680
[2025-07-17 19:28:49] INFO train_model: Auditing data quality before training...
[2025-07-17 19:28:49] INFO train_model: Entering audit_data_quality
[2025-07-17 19:43:17] INFO train_model: Model is starting a new training session...
[2025-07-17 19:43:17] INFO train_model: Model is cleaning and preparing data...
[2025-07-17 19:43:17] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'fib_levels', 'wyckoff_phases'],
      dtype='object')
[2025-07-17 19:43:17] INFO train_model: Preparing target variable...
[2025-07-17 19:43:17] INFO train_model: Entering prepare_target_variable
[2025-07-17 19:43:17] INFO train_model: Exiting prepare_target_variable
[2025-07-17 19:43:17] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'fib_levels', 'wyckoff_phases', 'future_return', 'target'],
      dtype='object')
[2025-07-17 19:43:17] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-17 19:43:17] INFO train_model: Dropping NaN targets...
[2025-07-17 19:43:17] INFO train_model: Class balance before upsampling: {0: 3106, 1: 1593}
[2025-07-17 19:43:17] INFO train_model: Upsampling successful.
[2025-07-17 19:43:17] INFO train_model: Splitting train/test...
[2025-07-17 19:43:17] INFO train_model: Scaling features...
[2025-07-17 19:43:17] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-17 19:43:17] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-17 19:43:19] INFO train_model: Model fit complete.
[2025-07-17 19:43:19] INFO train_model: Model Accuracy: 0.6766
[2025-07-17 19:43:19] INFO train_model: 
Classification Report:
[2025-07-17 19:43:19] INFO train_model:               precision    recall  f1-score   support

           0       0.69      0.64      0.66       622
           1       0.66      0.72      0.69       621

    accuracy                           0.68      1243
   macro avg       0.68      0.68      0.68      1243
weighted avg       0.68      0.68      0.68      1243

[2025-07-17 19:43:19] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-17 19:43:19] INFO train_model: Feature distributions before training:
[2025-07-17 19:43:19] INFO train_model: supply_zone: mean=0.4399, std=0.4964, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: demand_zone: mean=0.3658, std=0.4817, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: head_shoulders: mean=0.0306, std=0.1724, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1775, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: rising_wedge: mean=0.2703, std=0.4441, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: falling_wedge: mean=0.2401, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-17 19:43:19] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-17 19:43:19] INFO train_model: atr_14: mean=0.3416, std=0.1042, min=0.0000, max=0.9927, unique=4687
[2025-07-17 19:43:19] INFO train_model: volatility_20: mean=0.3281, std=0.1835, min=0.0344, max=1.3004, unique=4680
[2025-07-17 19:43:19] INFO train_model: Auditing data quality before training...
[2025-07-17 19:43:19] INFO train_model: Entering audit_data_quality
[2025-07-18 16:12:11] INFO train_model: Batch retraining all models for all pairs in Config.TRADING_PAIRS...
[2025-07-18 16:12:11] INFO train_model: Retraining model for EURUSD...
[2025-07-18 16:12:18] INFO train_model: Model is starting a new training session...
[2025-07-18 16:12:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 16:12:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-18 16:12:18] INFO train_model: Preparing target variable...
[2025-07-18 16:12:18] INFO train_model: Entering prepare_target_variable
[2025-07-18 16:12:18] INFO train_model: Exiting prepare_target_variable
[2025-07-18 16:12:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-18 16:12:18] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 16:12:18] INFO train_model: Dropping NaN targets...
[2025-07-18 16:12:18] INFO train_model: Class balance before upsampling: {0: 3307, 1: 1413}
[2025-07-18 16:12:18] INFO train_model: Upsampling successful.
[2025-07-18 16:12:18] INFO train_model: Splitting train/test...
[2025-07-18 16:12:18] INFO train_model: Scaling features...
[2025-07-18 16:12:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 16:12:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 16:12:19] INFO train_model: Model fit complete.
[2025-07-18 16:12:19] INFO train_model: Model Accuracy: 0.7158
[2025-07-18 16:12:19] INFO train_model: 
Classification Report:
[2025-07-18 16:12:19] INFO train_model:               precision    recall  f1-score   support

           0       0.72      0.71      0.72       662
           1       0.71      0.72      0.72       661

    accuracy                           0.72      1323
   macro avg       0.72      0.72      0.72      1323
weighted avg       0.72      0.72      0.72      1323

[2025-07-18 16:12:19] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-18 16:12:20] INFO train_model: Model registered in ModelRegistry for EURUSD, version 94eb05d81b85d90c2795518243f96e99
[2025-07-18 16:12:20] INFO train_model: Feature distributions before training:
[2025-07-18 16:12:20] INFO train_model: supply_zone: mean=0.4831, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: demand_zone: mean=0.4657, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: head_shoulders: mean=0.0303, std=0.1714, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1691, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: double_top: mean=0.0331, std=0.1788, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: double_bottom: mean=0.0436, std=0.2043, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: rising_wedge: mean=0.2364, std=0.4249, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: falling_wedge: mean=0.2290, std=0.4203, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: fakeout_down: mean=0.0042, std=0.0650, min=0.0000, max=1.0000, unique=2
[2025-07-18 16:12:20] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 16:12:20] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4708
[2025-07-18 16:12:20] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4653
[2025-07-18 16:12:20] INFO train_model: Auditing data quality before training...
[2025-07-18 16:12:20] INFO train_model: Entering audit_data_quality
[2025-07-18 17:10:45] INFO train_model: Batch retraining all models for all pairs in Config.TRADING_PAIRS...
[2025-07-18 17:10:45] INFO train_model: Retraining model for EURUSD...
[2025-07-18 17:10:47] INFO train_model: Model is starting a new training session...
[2025-07-18 17:10:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 17:10:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d',
       'fib_levels', 'wyckoff_phases', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=114)
[2025-07-18 17:10:47] INFO train_model: Preparing target variable...
[2025-07-18 17:10:47] INFO train_model: Entering prepare_target_variable
[2025-07-18 17:10:47] INFO train_model: Exiting prepare_target_variable
[2025-07-18 17:10:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=116)
[2025-07-18 17:10:47] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 17:10:47] INFO train_model: Dropping NaN targets...
[2025-07-18 17:10:47] INFO train_model: Class balance before upsampling: {0: 104, 1: 93}
[2025-07-18 17:10:47] INFO train_model: Upsampling successful.
[2025-07-18 17:10:47] INFO train_model: Splitting train/test...
[2025-07-18 17:10:47] INFO train_model: Scaling features...
[2025-07-18 17:10:47] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 17:10:47] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 17:10:48] INFO train_model: Model fit complete.
[2025-07-18 17:10:48] INFO train_model: Model Accuracy: 0.6429
[2025-07-18 17:10:48] INFO train_model: 
Classification Report:
[2025-07-18 17:10:48] INFO train_model:               precision    recall  f1-score   support

           0       0.64      0.67      0.65        21
           1       0.65      0.62      0.63        21

    accuracy                           0.64        42
   macro avg       0.64      0.64      0.64        42
weighted avg       0.64      0.64      0.64        42

[2025-07-18 17:10:48] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-18 17:10:48] INFO train_model: Model registered in ModelRegistry for EURUSD, version 2b1cc48e5c0bf6ff024941f7ea234e72
[2025-07-18 17:10:48] INFO train_model: Feature distributions before training:
[2025-07-18 17:10:48] INFO train_model: supply_zone: mean=0.4619, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: demand_zone: mean=0.4365, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: head_shoulders: mean=0.0711, std=0.2576, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1723, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: double_top: mean=0.0203, std=0.1414, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: double_bottom: mean=0.0355, std=0.1856, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: rising_wedge: mean=0.3299, std=0.4714, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: falling_wedge: mean=0.1421, std=0.3501, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: fakeout_up: mean=0.0051, std=0.0712, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:10:48] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: sma_20_4h: mean=1.0896, std=0.0459, min=1.0219, max=1.1795, unique=196
[2025-07-18 17:10:48] INFO train_model: sma_50_4h: mean=1.0894, std=0.0457, min=1.0248, max=1.1791, unique=195
[2025-07-18 17:10:48] INFO train_model: ema_12_4h: mean=1.0896, std=0.0460, min=1.0236, max=1.1797, unique=197
[2025-07-18 17:10:48] INFO train_model: ema_26_4h: mean=1.0895, std=0.0458, min=1.0233, max=1.1792, unique=197
[2025-07-18 17:10:48] INFO train_model: rsi_14_4h: mean=51.1382, std=33.2214, min=0.0000, max=100.0000, unique=150
[2025-07-18 17:10:48] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0039, max=0.0066, unique=197
[2025-07-18 17:10:48] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0034, max=0.0057, unique=197
[2025-07-18 17:10:48] INFO train_model: bb_high_4h: mean=1.0935, std=0.0461, min=1.0268, max=1.1823, unique=196
[2025-07-18 17:10:48] INFO train_model: bb_low_4h: mean=1.0857, std=0.0459, min=1.0169, max=1.1776, unique=196
[2025-07-18 17:10:48] INFO train_model: atr_14_4h: mean=0.0032, std=0.0015, min=0.0012, max=0.0107, unique=196
[2025-07-18 17:10:48] INFO train_model: volatility_20_4h: mean=0.0019, std=0.0013, min=0.0002, max=0.0096, unique=196
[2025-07-18 17:10:48] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:10:48] INFO train_model: atr_14: mean=0.0018, std=0.0007, min=0.0000, max=0.0052, unique=197
[2025-07-18 17:10:48] INFO train_model: volatility_20: mean=0.0021, std=0.0012, min=0.0004, max=0.0093, unique=196
[2025-07-18 17:10:48] INFO train_model: Auditing data quality before training...
[2025-07-18 17:10:48] INFO train_model: Entering audit_data_quality
[2025-07-18 17:12:02] INFO train_model: Batch retraining all models for all pairs in Config.TRADING_PAIRS...
[2025-07-18 17:12:02] INFO train_model: Retraining model for EURUSD...
[2025-07-18 17:12:04] INFO train_model: Model is starting a new training session...
[2025-07-18 17:12:04] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 17:12:04] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d',
       'fib_levels', 'wyckoff_phases', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=114)
[2025-07-18 17:12:04] INFO train_model: Preparing target variable...
[2025-07-18 17:12:04] INFO train_model: Entering prepare_target_variable
[2025-07-18 17:12:04] INFO train_model: Exiting prepare_target_variable
[2025-07-18 17:12:04] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=116)
[2025-07-18 17:12:04] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 17:12:04] INFO train_model: Dropping NaN targets...
[2025-07-18 17:12:04] INFO train_model: Class balance before upsampling: {0: 104, 1: 93}
[2025-07-18 17:12:04] INFO train_model: Upsampling successful.
[2025-07-18 17:12:04] INFO train_model: Splitting train/test...
[2025-07-18 17:12:04] INFO train_model: Scaling features...
[2025-07-18 17:12:04] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 17:12:04] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 17:12:05] INFO train_model: Model fit complete.
[2025-07-18 17:12:05] INFO train_model: Model Accuracy: 0.6429
[2025-07-18 17:12:05] INFO train_model: 
Classification Report:
[2025-07-18 17:12:05] INFO train_model:               precision    recall  f1-score   support

           0       0.64      0.67      0.65        21
           1       0.65      0.62      0.63        21

    accuracy                           0.64        42
   macro avg       0.64      0.64      0.64        42
weighted avg       0.64      0.64      0.64        42

[2025-07-18 17:12:05] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-18 17:12:05] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "2b1cc48e5c0bf6ff024941f7ea234e72" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "2b1cc48e5c0bf6ff024941f7ea234e72" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': '2b1cc48e5c0bf6ff024941f7ea234e72'}}
[2025-07-18 17:12:05] INFO train_model: Feature distributions before training:
[2025-07-18 17:12:05] INFO train_model: supply_zone: mean=0.4619, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: demand_zone: mean=0.4365, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: head_shoulders: mean=0.0711, std=0.2576, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1723, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: double_top: mean=0.0203, std=0.1414, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: double_bottom: mean=0.0355, std=0.1856, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: rising_wedge: mean=0.3299, std=0.4714, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: falling_wedge: mean=0.1421, std=0.3501, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: fakeout_up: mean=0.0051, std=0.0712, min=0.0000, max=1.0000, unique=2
[2025-07-18 17:12:05] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: sma_20_4h: mean=1.0896, std=0.0459, min=1.0219, max=1.1795, unique=196
[2025-07-18 17:12:05] INFO train_model: sma_50_4h: mean=1.0894, std=0.0457, min=1.0248, max=1.1791, unique=195
[2025-07-18 17:12:05] INFO train_model: ema_12_4h: mean=1.0896, std=0.0460, min=1.0236, max=1.1797, unique=197
[2025-07-18 17:12:05] INFO train_model: ema_26_4h: mean=1.0895, std=0.0458, min=1.0233, max=1.1792, unique=197
[2025-07-18 17:12:05] INFO train_model: rsi_14_4h: mean=51.1382, std=33.2214, min=0.0000, max=100.0000, unique=150
[2025-07-18 17:12:05] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0039, max=0.0066, unique=197
[2025-07-18 17:12:05] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0034, max=0.0057, unique=197
[2025-07-18 17:12:05] INFO train_model: bb_high_4h: mean=1.0935, std=0.0461, min=1.0268, max=1.1823, unique=196
[2025-07-18 17:12:05] INFO train_model: bb_low_4h: mean=1.0857, std=0.0459, min=1.0169, max=1.1776, unique=196
[2025-07-18 17:12:05] INFO train_model: atr_14_4h: mean=0.0032, std=0.0015, min=0.0012, max=0.0107, unique=196
[2025-07-18 17:12:05] INFO train_model: volatility_20_4h: mean=0.0019, std=0.0013, min=0.0002, max=0.0096, unique=196
[2025-07-18 17:12:05] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 17:12:05] INFO train_model: atr_14: mean=0.0018, std=0.0007, min=0.0000, max=0.0052, unique=197
[2025-07-18 17:12:05] INFO train_model: volatility_20: mean=0.0021, std=0.0012, min=0.0004, max=0.0093, unique=196
[2025-07-18 17:12:05] INFO train_model: Auditing data quality before training...
[2025-07-18 17:12:05] INFO train_model: Entering audit_data_quality
[2025-07-18 19:47:15] INFO train_model: Model is starting a new training session...
[2025-07-18 19:47:15] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 19:47:15] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'regime_label', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-18 19:47:15] INFO train_model: Preparing target variable...
[2025-07-18 19:47:15] INFO train_model: Entering prepare_target_variable
[2025-07-18 19:47:15] INFO train_model: Exiting prepare_target_variable
[2025-07-18 19:47:15] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'regime_label', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-18 19:47:15] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 19:47:15] INFO train_model: Dropping NaN targets...
[2025-07-18 19:47:15] INFO train_model: Class balance before upsampling: {0: 3110, 1: 1590}
[2025-07-18 19:47:15] INFO train_model: Upsampling successful.
[2025-07-18 19:47:15] INFO train_model: Splitting train/test...
[2025-07-18 19:47:15] INFO train_model: Scaling features...
[2025-07-18 19:47:15] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 19:47:15] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 19:47:16] INFO train_model: Model fit complete.
[2025-07-18 19:47:16] INFO train_model: Model Accuracy: 0.6744
[2025-07-18 19:47:16] INFO train_model: 
Classification Report:
[2025-07-18 19:47:16] INFO train_model:               precision    recall  f1-score   support

           0       0.69      0.64      0.66       622
           1       0.66      0.71      0.69       622

    accuracy                           0.67      1244
   macro avg       0.68      0.67      0.67      1244
weighted avg       0.68      0.67      0.67      1244

[2025-07-18 19:47:16] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 19:47:16] INFO train_model: Model registered in ModelRegistry for USDJPY, version f7daeeab06a39c5caa6e62eba65c358f
[2025-07-18 19:47:16] INFO train_model: Feature distributions before training:
[2025-07-18 19:47:16] INFO train_model: supply_zone: mean=0.4368, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: demand_zone: mean=0.3696, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1780, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: rising_wedge: mean=0.2679, std=0.4429, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: falling_wedge: mean=0.2404, std=0.4274, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:47:16] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:47:16] INFO train_model: atr_14: mean=0.3417, std=0.1040, min=0.0000, max=0.9927, unique=4688
[2025-07-18 19:47:16] INFO train_model: volatility_20: mean=0.3280, std=0.1837, min=0.0344, max=1.3004, unique=4681
[2025-07-18 19:47:16] INFO train_model: Auditing data quality before training...
[2025-07-18 19:47:16] INFO train_model: Entering audit_data_quality
[2025-07-18 19:48:31] INFO train_model: Model is starting a new training session...
[2025-07-18 19:48:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 19:48:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d',
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=119)
[2025-07-18 19:48:31] INFO train_model: Preparing target variable...
[2025-07-18 19:48:31] INFO train_model: Entering prepare_target_variable
[2025-07-18 19:48:31] INFO train_model: Exiting prepare_target_variable
[2025-07-18 19:48:31] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=121)
[2025-07-18 19:48:31] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 19:48:31] INFO train_model: Dropping NaN targets...
[2025-07-18 19:48:31] INFO train_model: Class balance before upsampling: {0: 108, 1: 89}
[2025-07-18 19:48:31] INFO train_model: Upsampling successful.
[2025-07-18 19:48:31] INFO train_model: Splitting train/test...
[2025-07-18 19:48:31] INFO train_model: Scaling features...
[2025-07-18 19:48:31] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 19:48:31] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 19:48:31] INFO train_model: Model fit complete.
[2025-07-18 19:48:31] INFO train_model: Model Accuracy: 0.7273
[2025-07-18 19:48:31] INFO train_model: 
Classification Report:
[2025-07-18 19:48:31] INFO train_model:               precision    recall  f1-score   support

           0       0.69      0.82      0.75        22
           1       0.78      0.64      0.70        22

    accuracy                           0.73        44
   macro avg       0.74      0.73      0.72        44
weighted avg       0.74      0.73      0.72        44

[2025-07-18 19:48:31] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 19:48:31] INFO train_model: Model registered in ModelRegistry for USDJPY, version 68128ac4f1882038fd0efd075e04b432
[2025-07-18 19:48:31] INFO train_model: Feature distributions before training:
[2025-07-18 19:48:31] INFO train_model: supply_zone: mean=0.4924, std=0.5012, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:48:31] INFO train_model: demand_zone: mean=0.4365, std=0.4972, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:48:31] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: head_shoulders: mean=0.0457, std=0.2093, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:48:31] INFO train_model: inv_head_shoulders: mean=0.0508, std=0.2201, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:48:31] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: rising_wedge: mean=0.4213, std=0.4950, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:48:31] INFO train_model: falling_wedge: mean=0.1117, std=0.3158, min=0.0000, max=1.0000, unique=2
[2025-07-18 19:48:31] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: sma_20_4h: mean=1.0896, std=0.0459, min=1.0219, max=1.1795, unique=196
[2025-07-18 19:48:31] INFO train_model: sma_50_4h: mean=1.0894, std=0.0457, min=1.0248, max=1.1791, unique=195
[2025-07-18 19:48:31] INFO train_model: ema_12_4h: mean=1.0896, std=0.0460, min=1.0236, max=1.1797, unique=197
[2025-07-18 19:48:31] INFO train_model: ema_26_4h: mean=1.0895, std=0.0458, min=1.0233, max=1.1792, unique=197
[2025-07-18 19:48:31] INFO train_model: rsi_14_4h: mean=51.1382, std=33.2214, min=0.0000, max=100.0000, unique=150
[2025-07-18 19:48:31] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0039, max=0.0066, unique=197
[2025-07-18 19:48:31] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0034, max=0.0057, unique=197
[2025-07-18 19:48:31] INFO train_model: bb_high_4h: mean=1.0935, std=0.0461, min=1.0268, max=1.1823, unique=196
[2025-07-18 19:48:31] INFO train_model: bb_low_4h: mean=1.0857, std=0.0459, min=1.0169, max=1.1776, unique=196
[2025-07-18 19:48:31] INFO train_model: atr_14_4h: mean=0.0032, std=0.0015, min=0.0012, max=0.0107, unique=196
[2025-07-18 19:48:31] INFO train_model: volatility_20_4h: mean=0.0019, std=0.0013, min=0.0002, max=0.0096, unique=196
[2025-07-18 19:48:31] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 19:48:31] INFO train_model: atr_14: mean=0.3312, std=0.1063, min=0.0000, max=0.8629, unique=197
[2025-07-18 19:48:31] INFO train_model: volatility_20: mean=0.3264, std=0.1829, min=0.0839, max=1.2551, unique=196
[2025-07-18 19:48:31] INFO train_model: Auditing data quality before training...
[2025-07-18 19:48:31] INFO train_model: Entering audit_data_quality
[2025-07-18 20:16:33] INFO train_model: Model is starting a new training session...
[2025-07-18 20:16:33] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 20:16:33] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d',
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=122)
[2025-07-18 20:16:33] INFO train_model: Preparing target variable...
[2025-07-18 20:16:33] INFO train_model: Entering prepare_target_variable
[2025-07-18 20:16:33] INFO train_model: Exiting prepare_target_variable
[2025-07-18 20:16:33] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=124)
[2025-07-18 20:16:33] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 20:16:33] INFO train_model: Dropping NaN targets...
[2025-07-18 20:16:33] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1590}
[2025-07-18 20:16:33] INFO train_model: Upsampling successful.
[2025-07-18 20:16:33] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 20:16:33] INFO train_model: Splitting train/test...
[2025-07-18 20:16:33] INFO train_model: Scaling features...
[2025-07-18 20:16:33] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 20:16:33] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 20:16:35] INFO train_model: Model fit complete.
[2025-07-18 20:16:35] INFO train_model: Model Accuracy: 0.8583
[2025-07-18 20:16:35] INFO train_model: 
Classification Report:
[2025-07-18 20:16:35] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.84      0.86       621
           1       0.84      0.88      0.86       621

    accuracy                           0.86      1242
   macro avg       0.86      0.86      0.86      1242
weighted avg       0.86      0.86      0.86      1242

[2025-07-18 20:16:35] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 20:16:35] INFO train_model: Model registered in ModelRegistry for USDJPY, version 543827b99676486ff53b06f3d9983490
[2025-07-18 20:16:35] INFO train_model: Feature distributions before training:
[2025-07-18 20:16:35] INFO train_model: supply_zone: mean=0.4363, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: demand_zone: mean=0.3688, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:16:35] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:16:35] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:16:35] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:16:35] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:16:35] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:16:35] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: rising_wedge: mean=0.2682, std=0.4431, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: falling_wedge: mean=0.2399, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:16:35] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4641
[2025-07-18 20:16:35] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4616
[2025-07-18 20:16:35] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4694
[2025-07-18 20:16:35] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4694
[2025-07-18 20:16:35] INFO train_model: rsi_14_4h: mean=51.1473, std=32.6406, min=0.0000, max=100.0000, unique=1779
[2025-07-18 20:16:35] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4694
[2025-07-18 20:16:35] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4694
[2025-07-18 20:16:35] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4643
[2025-07-18 20:16:35] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4643
[2025-07-18 20:16:35] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4679
[2025-07-18 20:16:35] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4633
[2025-07-18 20:22:45] INFO train_model: Batch retraining all models for all pairs in Config.TRADING_PAIRS...
[2025-07-18 20:22:45] INFO train_model: Retraining model for EURUSD...
[2025-07-18 20:22:54] INFO train_model: Model is starting a new training session...
[2025-07-18 20:22:54] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 20:22:54] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d',
       'fib_levels', 'wyckoff_phases', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=123)
[2025-07-18 20:22:54] INFO train_model: Preparing target variable...
[2025-07-18 20:22:54] INFO train_model: Entering prepare_target_variable
[2025-07-18 20:22:54] INFO train_model: Exiting prepare_target_variable
[2025-07-18 20:22:54] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=125)
[2025-07-18 20:22:54] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 20:22:54] INFO train_model: Dropping NaN targets...
[2025-07-18 20:22:54] INFO train_model: Class balance before upsampling: {0: 3310, 1: 1413}
[2025-07-18 20:22:54] INFO train_model: Upsampling successful.
[2025-07-18 20:22:54] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 20:22:54] INFO train_model: Splitting train/test...
[2025-07-18 20:22:54] INFO train_model: Scaling features...
[2025-07-18 20:22:54] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 20:22:54] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 20:22:55] INFO train_model: Model fit complete.
[2025-07-18 20:22:55] INFO train_model: Model Accuracy: 0.8565
[2025-07-18 20:22:55] INFO train_model: 
Classification Report:
[2025-07-18 20:22:55] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       662
           1       0.86      0.85      0.86       662

    accuracy                           0.86      1324
   macro avg       0.86      0.86      0.86      1324
weighted avg       0.86      0.86      0.86      1324

[2025-07-18 20:22:55] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-18 20:22:55] INFO train_model: Model registered in ModelRegistry for EURUSD, version 7aa8c8a49e992e72a192578babf5c854
[2025-07-18 20:22:55] INFO train_model: Feature distributions before training:
[2025-07-18 20:22:55] INFO train_model: supply_zone: mean=0.4830, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: demand_zone: mean=0.4658, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:22:55] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:22:55] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:22:55] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:22:55] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:22:55] INFO train_model: head_shoulders: mean=0.0303, std=0.1714, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: double_bottom: mean=0.0436, std=0.2043, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: rising_wedge: mean=0.2363, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: falling_wedge: mean=0.2289, std=0.4202, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:22:55] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4669
[2025-07-18 20:22:55] INFO train_model: sma_50_4h: mean=1.0900, std=0.0457, min=1.0239, max=1.1794, unique=4645
[2025-07-18 20:22:55] INFO train_model: ema_12_4h: mean=1.0903, std=0.0460, min=1.0207, max=1.1802, unique=4723
[2025-07-18 20:22:55] INFO train_model: ema_26_4h: mean=1.0902, std=0.0459, min=1.0222, max=1.1797, unique=4723
[2025-07-18 20:22:55] INFO train_model: rsi_14_4h: mean=51.1261, std=32.6021, min=0.0000, max=100.0000, unique=1781
[2025-07-18 20:22:55] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4723
[2025-07-18 20:22:55] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4723
[2025-07-18 20:22:55] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4671
[2025-07-18 20:22:55] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4671
[2025-07-18 20:22:55] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4708
[2025-07-18 20:22:55] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4661
[2025-07-18 20:22:55] ERROR train_model: Error retraining model for EURUSD: unsupported format string passed to Series.__format__
[2025-07-18 20:22:55] INFO train_model: Retraining model for GBPUSD...
[2025-07-18 20:23:07] ERROR train_model: No price data for GBPUSD, skipping.
[2025-07-18 20:23:07] INFO train_model: Retraining model for USDJPY...
[2025-07-18 20:23:19] INFO train_model: Model is starting a new training session...
[2025-07-18 20:23:19] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 20:23:19] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d',
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=122)
[2025-07-18 20:23:19] INFO train_model: Preparing target variable...
[2025-07-18 20:23:19] INFO train_model: Entering prepare_target_variable
[2025-07-18 20:23:19] INFO train_model: Exiting prepare_target_variable
[2025-07-18 20:23:19] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=124)
[2025-07-18 20:23:19] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 20:23:19] INFO train_model: Dropping NaN targets...
[2025-07-18 20:23:19] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1590}
[2025-07-18 20:23:19] INFO train_model: Upsampling successful.
[2025-07-18 20:23:19] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 20:23:19] INFO train_model: Splitting train/test...
[2025-07-18 20:23:19] INFO train_model: Scaling features...
[2025-07-18 20:23:19] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 20:23:19] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 20:23:20] INFO train_model: Model fit complete.
[2025-07-18 20:23:20] INFO train_model: Model Accuracy: 0.8583
[2025-07-18 20:23:20] INFO train_model: 
Classification Report:
[2025-07-18 20:23:20] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.84      0.86       621
           1       0.84      0.88      0.86       621

    accuracy                           0.86      1242
   macro avg       0.86      0.86      0.86      1242
weighted avg       0.86      0.86      0.86      1242

[2025-07-18 20:23:20] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 20:23:20] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "543827b99676486ff53b06f3d9983490" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "543827b99676486ff53b06f3d9983490" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': '543827b99676486ff53b06f3d9983490'}}
[2025-07-18 20:23:20] INFO train_model: Feature distributions before training:
[2025-07-18 20:23:20] INFO train_model: supply_zone: mean=0.4363, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: demand_zone: mean=0.3688, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:20] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:20] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:20] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:20] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:20] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:20] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: rising_wedge: mean=0.2682, std=0.4431, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: falling_wedge: mean=0.2399, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:20] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4641
[2025-07-18 20:23:20] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4616
[2025-07-18 20:23:20] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4694
[2025-07-18 20:23:20] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4694
[2025-07-18 20:23:20] INFO train_model: rsi_14_4h: mean=51.1473, std=32.6406, min=0.0000, max=100.0000, unique=1779
[2025-07-18 20:23:20] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4694
[2025-07-18 20:23:20] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4694
[2025-07-18 20:23:20] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4643
[2025-07-18 20:23:20] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4643
[2025-07-18 20:23:20] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4679
[2025-07-18 20:23:20] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4633
[2025-07-18 20:23:20] ERROR train_model: Error retraining model for USDJPY: unsupported format string passed to Series.__format__
[2025-07-18 20:23:20] INFO train_model: Retraining model for USDCHF...
[2025-07-18 20:23:39] INFO train_model: Model is starting a new training session...
[2025-07-18 20:23:39] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 20:23:39] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'regime_label', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-18 20:23:39] INFO train_model: Preparing target variable...
[2025-07-18 20:23:39] INFO train_model: Entering prepare_target_variable
[2025-07-18 20:23:39] INFO train_model: Exiting prepare_target_variable
[2025-07-18 20:23:39] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'regime_label', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-18 20:23:39] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 20:23:39] INFO train_model: Dropping NaN targets...
[2025-07-18 20:23:39] INFO train_model: Class balance before upsampling: {0: 3430, 1: 1271}
[2025-07-18 20:23:39] INFO train_model: Upsampling successful.
[2025-07-18 20:23:39] INFO train_model: Splitting train/test...
[2025-07-18 20:23:39] INFO train_model: Scaling features...
[2025-07-18 20:23:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 20:23:39] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 20:23:40] INFO train_model: Model fit complete.
[2025-07-18 20:23:40] INFO train_model: Model Accuracy: 0.7143
[2025-07-18 20:23:40] INFO train_model: 
Classification Report:
[2025-07-18 20:23:40] INFO train_model:               precision    recall  f1-score   support

           0       0.72      0.69      0.71       686
           1       0.71      0.74      0.72       686

    accuracy                           0.71      1372
   macro avg       0.71      0.71      0.71      1372
weighted avg       0.71      0.71      0.71      1372

[2025-07-18 20:23:40] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-18 20:23:40] INFO train_model: Model registered in ModelRegistry for USDCHF, version 8636e7cf87a6074604b30c6311e7a3b9
[2025-07-18 20:23:40] INFO train_model: Feature distributions before training:
[2025-07-18 20:23:40] INFO train_model: supply_zone: mean=0.5020, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: demand_zone: mean=0.4863, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: inv_head_shoulders: mean=0.0313, std=0.1741, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: rising_wedge: mean=0.2251, std=0.4177, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: falling_wedge: mean=0.2317, std=0.4219, min=0.0000, max=1.0000, unique=2
[2025-07-18 20:23:40] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 20:23:40] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4689
[2025-07-18 20:23:40] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4677
[2025-07-18 20:23:40] INFO train_model: Auditing data quality before training...
[2025-07-18 20:23:40] INFO train_model: Entering audit_data_quality
[2025-07-18 21:12:27] INFO train_model: Model is starting a new training session...
[2025-07-18 21:12:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:12:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:12:27] INFO train_model: Preparing target variable...
[2025-07-18 21:12:27] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:12:27] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:12:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-18 21:12:27] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:12:27] INFO train_model: Dropping NaN targets...
[2025-07-18 21:12:27] INFO train_model: Class balance before upsampling: {0: 3333, 1: 1392}
[2025-07-18 21:12:27] INFO train_model: Upsampling successful.
[2025-07-18 21:12:27] INFO train_model: Splitting train/test...
[2025-07-18 21:12:27] INFO train_model: Scaling features...
[2025-07-18 21:12:27] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:12:27] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:12:28] INFO train_model: Model fit complete.
[2025-07-18 21:12:28] INFO train_model: Model Accuracy: 0.7166
[2025-07-18 21:12:28] INFO train_model: 
Classification Report:
[2025-07-18 21:12:28] INFO train_model:               precision    recall  f1-score   support

           0       0.73      0.70      0.71       667
           1       0.71      0.74      0.72       667

    accuracy                           0.72      1334
   macro avg       0.72      0.72      0.72      1334
weighted avg       0.72      0.72      0.72      1334

[2025-07-18 21:12:28] INFO train_model: Model, scaler, and features saved for GBPUSD
[2025-07-18 21:12:28] INFO train_model: Model registered in ModelRegistry for GBPUSD, version 3a2487c02b4898f786d8b059b441413b
[2025-07-18 21:12:28] INFO train_model: Feature distributions before training:
[2025-07-18 21:12:28] INFO train_model: supply_zone: mean=0.5033, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: demand_zone: mean=0.4792, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: inv_head_shoulders: mean=0.0320, std=0.1759, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: double_top: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: double_bottom: mean=0.0044, std=0.0665, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: rising_wedge: mean=0.2406, std=0.4275, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: falling_wedge: mean=0.2241, std=0.4171, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: fakeout_up: mean=0.0055, std=0.0740, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: fakeout_down: mean=0.0070, std=0.0833, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:12:28] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:12:28] INFO train_model: atr_14: mean=0.0020, std=0.0006, min=0.0000, max=0.0049, unique=4713
[2025-07-18 21:12:28] INFO train_model: volatility_20: mean=0.0021, std=0.0012, min=0.0004, max=0.0080, unique=4698
[2025-07-18 21:12:28] INFO train_model: Auditing data quality before training...
[2025-07-18 21:12:29] INFO train_model: Entering audit_data_quality
[2025-07-18 21:15:24] INFO train_model: Model is starting a new training session...
[2025-07-18 21:15:24] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:15:24] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:15:24] INFO train_model: Preparing target variable...
[2025-07-18 21:15:24] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:15:24] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:15:24] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-18 21:15:24] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:15:24] INFO train_model: Dropping NaN targets...
[2025-07-18 21:15:24] INFO train_model: Class balance before upsampling: {0: 3110, 1: 1592}
[2025-07-18 21:15:24] INFO train_model: Upsampling successful.
[2025-07-18 21:15:24] INFO train_model: Splitting train/test...
[2025-07-18 21:15:24] INFO train_model: Scaling features...
[2025-07-18 21:15:24] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:15:24] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:15:25] INFO train_model: Model fit complete.
[2025-07-18 21:15:25] INFO train_model: Model Accuracy: 0.6584
[2025-07-18 21:15:25] INFO train_model: 
Classification Report:
[2025-07-18 21:15:25] INFO train_model:               precision    recall  f1-score   support

           0       0.66      0.64      0.65       622
           1       0.65      0.67      0.66       622

    accuracy                           0.66      1244
   macro avg       0.66      0.66      0.66      1244
weighted avg       0.66      0.66      0.66      1244

[2025-07-18 21:15:25] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 21:15:25] INFO train_model: Model registered in ModelRegistry for USDJPY, version 83dc1aaf0fdc6dac48ab512552106007
[2025-07-18 21:15:25] INFO train_model: Feature distributions before training:
[2025-07-18 21:15:25] INFO train_model: supply_zone: mean=0.4370, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: demand_zone: mean=0.3694, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1780, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: rising_wedge: mean=0.2682, std=0.4431, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: falling_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:25] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:25] INFO train_model: atr_14: mean=0.3416, std=0.1040, min=0.0000, max=0.9927, unique=4690
[2025-07-18 21:15:25] INFO train_model: volatility_20: mean=0.3279, std=0.1837, min=0.0344, max=1.3004, unique=4683
[2025-07-18 21:15:25] INFO train_model: Auditing data quality before training...
[2025-07-18 21:15:25] INFO train_model: Entering audit_data_quality
[2025-07-18 21:15:26] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-18 21:15:26] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-18 21:15:26] INFO train_model: Auditing data quality after removing constant features...
[2025-07-18 21:15:26] INFO train_model: Entering audit_data_quality
[2025-07-18 21:15:27] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:15:27] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-18 21:15:27] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:15:27] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-18 21:15:27] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-18 21:15:28] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-18 21:15:28] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-18 21:15:28] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-18 21:15:51] INFO train_model: Model is starting a new training session...
[2025-07-18 21:15:51] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:15:51] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:15:51] INFO train_model: Preparing target variable...
[2025-07-18 21:15:51] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:15:51] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:15:51] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-18 21:15:51] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:15:51] INFO train_model: Dropping NaN targets...
[2025-07-18 21:15:51] INFO train_model: Class balance before upsampling: {0: 3192, 1: 1567}
[2025-07-18 21:15:51] INFO train_model: Upsampling successful.
[2025-07-18 21:15:51] INFO train_model: Splitting train/test...
[2025-07-18 21:15:51] INFO train_model: Scaling features...
[2025-07-18 21:15:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:15:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:15:52] INFO train_model: Model fit complete.
[2025-07-18 21:15:52] INFO train_model: Model Accuracy: 0.7079
[2025-07-18 21:15:52] INFO train_model: 
Classification Report:
[2025-07-18 21:15:52] INFO train_model:               precision    recall  f1-score   support

           0       0.70      0.74      0.72       639
           1       0.72      0.67      0.70       638

    accuracy                           0.71      1277
   macro avg       0.71      0.71      0.71      1277
weighted avg       0.71      0.71      0.71      1277

[2025-07-18 21:15:52] INFO train_model: Model, scaler, and features saved for AUDUSD
[2025-07-18 21:15:52] INFO train_model: Model registered in ModelRegistry for AUDUSD, version 3ab555434515d2049f85e5d45490fbd9
[2025-07-18 21:15:52] INFO train_model: Feature distributions before training:
[2025-07-18 21:15:52] INFO train_model: supply_zone: mean=0.4131, std=0.4924, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: demand_zone: mean=0.4093, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: head_shoulders: mean=0.0321, std=0.1764, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: inv_head_shoulders: mean=0.0340, std=0.1814, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: double_top: mean=0.0059, std=0.0765, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: double_bottom: mean=0.0032, std=0.0561, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: rising_wedge: mean=0.2437, std=0.4294, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: falling_wedge: mean=0.2570, std=0.4370, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: fakeout_up: mean=0.0027, std=0.0522, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: fakeout_down: mean=0.0050, std=0.0708, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:15:52] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:15:52] INFO train_model: atr_14: mean=0.0015, std=0.0010, min=0.0000, max=0.0161, unique=4747
[2025-07-18 21:15:52] INFO train_model: volatility_20: mean=0.0015, std=0.0016, min=0.0000, max=0.0199, unique=4729
[2025-07-18 21:15:52] INFO train_model: Auditing data quality before training...
[2025-07-18 21:15:52] INFO train_model: Entering audit_data_quality
[2025-07-18 21:15:53] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-18 21:15:53] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-18 21:15:53] INFO train_model: Auditing data quality after removing constant features...
[2025-07-18 21:15:53] INFO train_model: Entering audit_data_quality
[2025-07-18 21:15:54] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:15:54] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-18 21:15:54] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:15:54] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_AUDUSD_features.json
[2025-07-18 21:15:54] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-18 21:15:54] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-18 21:15:54] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-18 21:15:54] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-18 21:16:09] INFO train_model: Model is starting a new training session...
[2025-07-18 21:16:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:16:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:16:09] INFO train_model: Preparing target variable...
[2025-07-18 21:16:09] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:16:09] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:16:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-18 21:16:09] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:16:09] INFO train_model: Dropping NaN targets...
[2025-07-18 21:16:09] INFO train_model: Class balance before upsampling: {0: 3121, 1: 1638}
[2025-07-18 21:16:09] INFO train_model: Upsampling successful.
[2025-07-18 21:16:09] INFO train_model: Splitting train/test...
[2025-07-18 21:16:09] INFO train_model: Scaling features...
[2025-07-18 21:16:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:16:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:16:10] INFO train_model: Model fit complete.
[2025-07-18 21:16:10] INFO train_model: Model Accuracy: 0.6829
[2025-07-18 21:16:10] INFO train_model: 
Classification Report:
[2025-07-18 21:16:10] INFO train_model:               precision    recall  f1-score   support

           0       0.69      0.67      0.68       625
           1       0.68      0.70      0.69       624

    accuracy                           0.68      1249
   macro avg       0.68      0.68      0.68      1249
weighted avg       0.68      0.68      0.68      1249

[2025-07-18 21:16:10] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-18 21:16:10] INFO train_model: Model registered in ModelRegistry for NZDUSD, version 748619b30ef98f19c988309302575e78
[2025-07-18 21:16:10] INFO train_model: Feature distributions before training:
[2025-07-18 21:16:10] INFO train_model: supply_zone: mean=0.4108, std=0.4920, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: demand_zone: mean=0.4259, std=0.4945, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: double_top: mean=0.0109, std=0.1040, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: double_bottom: mean=0.0227, std=0.1489, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: rising_wedge: mean=0.2402, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: falling_wedge: mean=0.2465, std=0.4310, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: fakeout_up: mean=0.0065, std=0.0805, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: fakeout_down: mean=0.0076, std=0.0867, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:10] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:10] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4747
[2025-07-18 21:16:10] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4720
[2025-07-18 21:16:10] INFO train_model: Auditing data quality before training...
[2025-07-18 21:16:10] INFO train_model: Entering audit_data_quality
[2025-07-18 21:16:11] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-18 21:16:11] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-18 21:16:11] INFO train_model: Auditing data quality after removing constant features...
[2025-07-18 21:16:11] INFO train_model: Entering audit_data_quality
[2025-07-18 21:16:12] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:16:12] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-18 21:16:12] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:16:12] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDUSD_features.json
[2025-07-18 21:16:12] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-18 21:16:12] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-18 21:16:12] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-18 21:16:12] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-18 21:16:29] INFO train_model: Model is starting a new training session...
[2025-07-18 21:16:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:16:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:16:29] INFO train_model: Preparing target variable...
[2025-07-18 21:16:29] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:16:29] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:16:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-18 21:16:29] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:16:29] INFO train_model: Dropping NaN targets...
[2025-07-18 21:16:29] INFO train_model: Class balance before upsampling: {0: 3672, 1: 1084}
[2025-07-18 21:16:29] INFO train_model: Upsampling successful.
[2025-07-18 21:16:29] INFO train_model: Splitting train/test...
[2025-07-18 21:16:29] INFO train_model: Scaling features...
[2025-07-18 21:16:29] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:16:29] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:16:31] INFO train_model: Model fit complete.
[2025-07-18 21:16:31] INFO train_model: Model Accuracy: 0.7474
[2025-07-18 21:16:31] INFO train_model: 
Classification Report:
[2025-07-18 21:16:31] INFO train_model:               precision    recall  f1-score   support

           0       0.76      0.73      0.74       735
           1       0.74      0.76      0.75       734

    accuracy                           0.75      1469
   macro avg       0.75      0.75      0.75      1469
weighted avg       0.75      0.75      0.75      1469

[2025-07-18 21:16:31] INFO train_model: Model, scaler, and features saved for USDCAD
[2025-07-18 21:16:31] INFO train_model: Model registered in ModelRegistry for USDCAD, version 82dc68ccf2044ed4b80d098702a7f3a7
[2025-07-18 21:16:31] INFO train_model: Feature distributions before training:
[2025-07-18 21:16:31] INFO train_model: supply_zone: mean=0.5927, std=0.4914, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: demand_zone: mean=0.5845, std=0.4929, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: head_shoulders: mean=0.0343, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: inv_head_shoulders: mean=0.0341, std=0.1814, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: double_top: mean=0.0023, std=0.0480, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: double_bottom: mean=0.0063, std=0.0792, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: rising_wedge: mean=0.2355, std=0.4244, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: falling_wedge: mean=0.1937, std=0.3952, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: fakeout_down: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:31] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:31] INFO train_model: atr_14: mean=0.0022, std=0.0008, min=0.0000, max=0.0077, unique=4744
[2025-07-18 21:16:31] INFO train_model: volatility_20: mean=0.0018, std=0.0013, min=0.0000, max=0.0130, unique=4727
[2025-07-18 21:16:31] INFO train_model: Auditing data quality before training...
[2025-07-18 21:16:31] INFO train_model: Entering audit_data_quality
[2025-07-18 21:16:32] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-18 21:16:32] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-18 21:16:32] INFO train_model: Auditing data quality after removing constant features...
[2025-07-18 21:16:32] INFO train_model: Entering audit_data_quality
[2025-07-18 21:16:32] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:16:32] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-18 21:16:32] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:16:32] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDCAD_features.json
[2025-07-18 21:16:32] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-18 21:16:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-18 21:16:32] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-18 21:16:32] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-18 21:16:52] INFO train_model: Model is starting a new training session...
[2025-07-18 21:16:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:16:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:16:52] INFO train_model: Preparing target variable...
[2025-07-18 21:16:52] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:16:52] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:16:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-18 21:16:52] INFO train_model: Final feature columns used for training: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:16:52] INFO train_model: Dropping NaN targets...
[2025-07-18 21:16:52] INFO train_model: Class balance before upsampling: {0: 3163, 1: 1564}
[2025-07-18 21:16:52] INFO train_model: Upsampling successful.
[2025-07-18 21:16:52] INFO train_model: Splitting train/test...
[2025-07-18 21:16:52] INFO train_model: Scaling features...
[2025-07-18 21:16:52] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:16:52] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:16:53] INFO train_model: Model fit complete.
[2025-07-18 21:16:53] INFO train_model: Model Accuracy: 0.6477
[2025-07-18 21:16:53] INFO train_model: 
Classification Report:
[2025-07-18 21:16:53] INFO train_model:               precision    recall  f1-score   support

           0       0.65      0.65      0.65       633
           1       0.65      0.65      0.65       633

    accuracy                           0.65      1266
   macro avg       0.65      0.65      0.65      1266
weighted avg       0.65      0.65      0.65      1266

[2025-07-18 21:16:53] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-18 21:16:53] INFO train_model: Model registered in ModelRegistry for EURJPY, version 1ad2c6801bc3c80470e9d2edf56145ec
[2025-07-18 21:16:53] INFO train_model: Feature distributions before training:
[2025-07-18 21:16:53] INFO train_model: supply_zone: mean=0.4777, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: demand_zone: mean=0.4005, std=0.4900, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: rising_wedge: mean=0.2689, std=0.4434, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:16:53] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:16:53] INFO train_model: atr_14: mean=0.3453, std=0.1084, min=0.0000, max=0.8613, unique=4715
[2025-07-18 21:16:53] INFO train_model: volatility_20: mean=0.3103, std=0.1648, min=0.0681, max=1.3557, unique=4707
[2025-07-18 21:16:53] INFO train_model: Auditing data quality before training...
[2025-07-18 21:16:53] INFO train_model: Entering audit_data_quality
[2025-07-18 21:16:54] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-18 21:16:54] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-18 21:16:54] INFO train_model: Auditing data quality after removing constant features...
[2025-07-18 21:16:54] INFO train_model: Entering audit_data_quality
[2025-07-18 21:16:55] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:16:55] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h']
[2025-07-18 21:16:55] INFO train_model: [DEBUG] About to save feature columns: ['supply_zone', 'demand_zone', 'wyckoff_markdown', 'wyckoff_markup', 'wyckoff_unknown', 'wyckoff_accumulation', 'wyckoff_distribution', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'atr_14', 'volatility_20']
[2025-07-18 21:16:55] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_EURJPY_features.json
[2025-07-18 21:16:55] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-18 21:16:55] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-18 21:16:55] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-18 21:16:55] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-18 21:33:42] INFO train_model: Model is starting a new training session...
[2025-07-18 21:33:42] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:33:42] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:33:42] INFO train_model: Preparing target variable...
[2025-07-18 21:33:42] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:33:42] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:33:42] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-18 21:33:42] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:33:42] INFO train_model: Dropping NaN targets...
[2025-07-18 21:33:42] INFO train_model: Class balance before upsampling: {0: 3069, 1: 1660}
[2025-07-18 21:33:42] INFO train_model: Upsampling successful.
[2025-07-18 21:33:42] INFO train_model: Splitting train/test...
[2025-07-18 21:33:42] INFO train_model: Scaling features...
[2025-07-18 21:33:42] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:33:42] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:33:44] INFO train_model: Model fit complete.
[2025-07-18 21:33:44] INFO train_model: Model Accuracy: 0.8184
[2025-07-18 21:33:44] INFO train_model: 
Classification Report:
[2025-07-18 21:33:44] INFO train_model:               precision    recall  f1-score   support

           0       0.81      0.83      0.82       614
           1       0.82      0.81      0.82       614

    accuracy                           0.82      1228
   macro avg       0.82      0.82      0.82      1228
weighted avg       0.82      0.82      0.82      1228

[2025-07-18 21:33:44] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-18 21:33:44] INFO train_model: Model registered in ModelRegistry for NZDJPY, version d0faf13984868dd875cd642e1f694873
[2025-07-18 21:33:44] INFO train_model: Feature distributions before training:
[2025-07-18 21:33:44] INFO train_model: atr_14: mean=0.2434, std=0.2273, min=0.0000, max=3.8441, unique=4717
[2025-07-18 21:33:44] INFO train_model: volatility_20: mean=0.2228, std=0.2568, min=0.0393, max=3.3139, unique=4707
[2025-07-18 21:33:44] INFO train_model: sma_20: mean=87.3661, std=2.2032, min=81.5998, max=92.2272, unique=4689
[2025-07-18 21:33:44] INFO train_model: sma_50: mean=87.3739, std=2.1952, min=82.0270, max=91.9825, unique=4672
[2025-07-18 21:33:44] INFO train_model: sma_200: mean=87.4215, std=2.1961, min=83.2736, max=91.5912, unique=4522
[2025-07-18 21:33:44] INFO train_model: ema_12: mean=87.3639, std=2.2031, min=81.3860, max=92.2433, unique=4729
[2025-07-18 21:33:44] INFO train_model: ema_26: mean=87.3676, std=2.1953, min=81.7433, max=92.1009, unique=4729
[2025-07-18 21:33:44] INFO train_model: rsi_14: mean=49.9062, std=11.8526, min=11.9091, max=86.8743, unique=4689
[2025-07-18 21:33:44] INFO train_model: macd: mean=-0.0035, std=0.1377, min=-0.7910, max=1.4460, unique=4704
[2025-07-18 21:33:44] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9525, unique=4696
[2025-07-18 21:33:44] INFO train_model: bb_high: mean=87.8003, std=2.1259, min=82.3688, max=92.6084, unique=4707
[2025-07-18 21:33:44] INFO train_model: bb_low: mean=86.9318, std=2.3854, min=77.4318, max=92.0349, unique=4707
[2025-07-18 21:33:44] INFO train_model: stoch_k: mean=51.5838, std=26.9549, min=0.7728, max=239.3692, unique=4662
[2025-07-18 21:33:44] INFO train_model: stoch_d: mean=51.5687, std=24.5758, min=3.8824, max=173.4048, unique=4702
[2025-07-18 21:33:44] INFO train_model: fib_0: mean=87.7999, std=2.1193, min=82.4090, max=92.4600, unique=1116
[2025-07-18 21:33:44] INFO train_model: dist_to_fib_0: mean=-0.4377, std=0.4915, min=-6.7800, max=3.6510, unique=1670
[2025-07-18 21:33:44] INFO train_model: fib_236: mean=87.5872, std=2.1506, min=81.9488, max=92.3562, unique=2142
[2025-07-18 21:33:44] INFO train_model: dist_to_fib_236: mean=-0.2250, std=0.4027, min=-5.1658, max=4.4022, unique=4669
[2025-07-18 21:33:44] INFO train_model: fib_382: mean=87.4556, std=2.1752, min=81.6641, max=92.2919, unique=2142
[2025-07-18 21:33:44] INFO train_model: dist_to_fib_382: mean=-0.0934, std=0.3701, min=-4.1671, max=4.8669, unique=4669
[2025-07-18 21:33:44] INFO train_model: fib_500: mean=87.3492, std=2.1980, min=81.4340, max=92.2400, unique=2035
[2025-07-18 21:33:44] INFO train_model: dist_to_fib_500: mean=0.0130, std=0.3604, min=-3.3600, max=5.2425, unique=3140
[2025-07-18 21:33:44] INFO train_model: fib_618: mean=87.2429, std=2.2232, min=81.2039, max=92.1881, unique=2142
[2025-07-18 21:33:44] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3671, min=-2.5529, max=5.6181, unique=4669
[2025-07-18 21:33:44] INFO train_model: fib_786: mean=87.0914, std=2.2631, min=80.8763, max=92.1142, unique=2142
[2025-07-18 21:33:44] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4028, min=-1.4038, max=6.1528, unique=4669
[2025-07-18 21:33:44] INFO train_model: fib_100: mean=86.8986, std=2.3206, min=80.4530, max=92.0200, unique=1085
[2025-07-18 21:33:44] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4820, min=0.0060, max=6.8340, unique=1692
[2025-07-18 21:33:44] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=2445
[2025-07-18 21:33:44] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=2481
[2025-07-18 21:33:44] INFO train_model: trendline_up: mean=0.4906, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: trendline_down: mean=0.5014, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: breakout_high: mean=0.0025, std=0.0503, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: dist_to_high: mean=-0.4383, std=0.4963, min=-6.7220, max=3.3740, unique=1729
[2025-07-18 21:33:44] INFO train_model: dist_to_low: mean=0.4621, std=0.4921, min=-0.4180, max=6.8340, unique=1739
[2025-07-18 21:33:44] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: vol_spike_std: mean=0.1292, std=0.3355, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: supply_zone: mean=0.4140, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: demand_zone: mean=0.3779, std=0.4849, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: choch: mean=0.1567, std=0.3635, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4708
[2025-07-18 21:33:44] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2419, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: regime_zscore: mean=-0.0103, std=1.0095, min=-7.2841, max=9.1563, unique=4629
[2025-07-18 21:33:44] INFO train_model: doji: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bullish_engulfing: mean=0.0550, std=0.2280, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: pin_bar: mean=0.3022, std=0.4593, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bullish_engulfing_bar: mean=0.0550, std=0.2280, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: inside_bar: mean=0.1408, std=0.3479, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1718, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: double_top: mean=0.0032, std=0.0562, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: double_bottom: mean=0.0021, std=0.0459, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: rising_wedge: mean=0.2702, std=0.4441, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: falling_wedge: mean=0.2631, std=0.4403, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bullish_flag: mean=0.0245, std=0.1547, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bearish_flag: mean=0.0290, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bullish_pennant: mean=0.1317, std=0.3382, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bearish_pennant: mean=0.1178, std=0.3224, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: morning_star: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: evening_star: mean=0.0366, std=0.1878, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: bullish_harami: mean=0.0472, std=0.2120, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: bearish_harami: mean=0.0508, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: dark_cloud_cover: mean=0.1110, std=0.3142, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: regime_label_bear: mean=0.4303, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: regime_label_bull: mean=0.5274, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: market_regime_choppy: mean=0.2908, std=0.4542, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: market_regime_downtrend: mean=0.2364, std=0.4249, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: market_regime_range: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: market_regime_uptrend: mean=0.1846, std=0.3880, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:33:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:33:44] INFO train_model: Auditing data quality before training...
[2025-07-18 21:33:44] INFO train_model: Entering audit_data_quality
[2025-07-18 21:33:47] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: is_ranging
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: fib_levels
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-18 21:33:47] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-18 21:33:47] INFO train_model: Auditing data quality after removing constant features...
[2025-07-18 21:33:47] INFO train_model: Entering audit_data_quality
[2025-07-18 21:33:51] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:33:51] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:33:51] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:33:51] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDJPY_features.json
[2025-07-18 21:33:51] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-18 21:33:51] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-18 21:33:51] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-18 21:33:51] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-18 21:34:26] INFO train_model: Model is starting a new training session...
[2025-07-18 21:34:26] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:34:26] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-18 21:34:26] INFO train_model: Preparing target variable...
[2025-07-18 21:34:26] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:34:26] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:34:26] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-18 21:34:26] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:34:26] INFO train_model: Dropping NaN targets...
[2025-07-18 21:34:26] INFO train_model: Class balance before upsampling: {0: 2607, 1: 2189}
[2025-07-18 21:34:26] INFO train_model: Upsampling successful.
[2025-07-18 21:34:26] INFO train_model: Splitting train/test...
[2025-07-18 21:34:26] INFO train_model: Scaling features...
[2025-07-18 21:34:26] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:34:26] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:34:28] INFO train_model: Model fit complete.
[2025-07-18 21:34:28] INFO train_model: Model Accuracy: 0.8035
[2025-07-18 21:34:28] INFO train_model: 
Classification Report:
[2025-07-18 21:34:28] INFO train_model:               precision    recall  f1-score   support

           0       0.79      0.82      0.81       522
           1       0.81      0.79      0.80       521

    accuracy                           0.80      1043
   macro avg       0.80      0.80      0.80      1043
weighted avg       0.80      0.80      0.80      1043

[2025-07-18 21:34:28] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-18 21:34:28] INFO train_model: Model registered in ModelRegistry for BTCUSD, version b6b77a6c1d753e03a828179772aba7c1
[2025-07-18 21:34:28] INFO train_model: Feature distributions before training:
[2025-07-18 21:34:28] INFO train_model: atr_14: mean=702.2963, std=314.4022, min=0.0000, max=2432.8175, unique=4784
[2025-07-18 21:34:28] INFO train_model: volatility_20: mean=722.6291, std=522.4479, min=61.2969, max=3956.2747, unique=4777
[2025-07-18 21:34:28] INFO train_model: sma_20: mean=97454.1877, std=9874.6393, min=76687.9180, max=121103.9988, unique=4777
[2025-07-18 21:34:28] INFO train_model: sma_50: mean=97374.7344, std=9751.4390, min=77951.8447, max=119557.6389, unique=4747
[2025-07-18 21:34:28] INFO train_model: sma_200: mean=97078.5870, std=9156.1802, min=80836.6129, max=118185.3330, unique=4597
[2025-07-18 21:34:28] INFO train_model: ema_12: mean=97473.1038, std=9898.6829, min=76579.0411, max=121438.5343, unique=4796
[2025-07-18 21:34:28] INFO train_model: ema_26: mean=97434.4499, std=9830.9229, min=77204.8141, max=120532.2026, unique=4796
[2025-07-18 21:34:28] INFO train_model: rsi_14: mean=51.2343, std=12.0126, min=12.9206, max=94.1391, unique=4783
[2025-07-18 21:34:28] INFO train_model: macd: mean=38.4847, std=501.1194, min=-1881.4601, max=2409.3781, unique=4771
[2025-07-18 21:34:28] INFO train_model: macd_signal: mean=38.0342, std=465.8963, min=-1668.9823, max=2004.6298, unique=4763
[2025-07-18 21:34:28] INFO train_model: bb_high: mean=98862.8511, std=9798.6898, min=77878.7912, max=123631.2152, unique=4777
[2025-07-18 21:34:28] INFO train_model: bb_low: mean=96045.5243, std=10053.7115, min=73141.7504, max=119063.2808, unique=4777
[2025-07-18 21:34:28] INFO train_model: stoch_k: mean=52.1983, std=26.9490, min=0.0000, max=100.0000, unique=4764
[2025-07-18 21:34:28] INFO train_model: stoch_d: mean=52.2559, std=24.4048, min=4.0848, max=97.8432, unique=4781
[2025-07-18 21:34:28] INFO train_model: fib_0: mean=98903.4791, std=9801.2867, min=77879.0234, max=123077.6328, unique=1200
[2025-07-18 21:34:28] INFO train_model: dist_to_fib_0: mean=-1400.0832, std=1333.9705, min=-10522.6016, max=0.0000, unique=4736
[2025-07-18 21:34:28] INFO train_model: fib_236: mean=98198.5776, std=9839.3185, min=77124.2364, max=122164.0787, unique=2229
[2025-07-18 21:34:28] INFO train_model: dist_to_fib_236: mean=-695.1817, std=1115.5902, min=-7889.1863, max=2479.4287, unique=4777
[2025-07-18 21:34:28] INFO train_model: fib_382: mean=97762.4945, std=9871.7936, min=76657.2919, max=121598.9138, unique=2229
[2025-07-18 21:34:28] INFO train_model: dist_to_fib_382: mean=-259.0986, std=1044.8061, min=-6260.0396, max=4013.8442, unique=4777
[2025-07-18 21:34:28] INFO train_model: fib_500: mean=97410.0437, std=9902.9842, min=76279.8984, max=121142.1367, unique=2229
[2025-07-18 21:34:28] INFO train_model: dist_to_fib_500: mean=93.3522, std=1033.1777, min=-4943.3320, max=5253.9883, unique=4767
[2025-07-18 21:34:28] INFO train_model: fib_618: mean=97057.5930, std=9938.5497, min=75902.5049, max=120685.3596, unique=2229
[2025-07-18 21:34:28] INFO train_model: dist_to_fib_618: mean=445.8029, std=1064.0384, min=-3626.6244, max=6494.1323, unique=4777
[2025-07-18 21:34:28] INFO train_model: fib_786: mean=96555.7987, std=9996.6403, min=75365.1989, max=120035.0330, unique=2229
[2025-07-18 21:34:28] INFO train_model: dist_to_fib_786: mean=947.5972, std=1173.7475, min=-1751.9899, max=8259.7611, unique=4777
[2025-07-18 21:34:28] INFO train_model: fib_100: mean=95916.6083, std=10083.0983, min=74467.7031, max=119206.6406, unique=1264
[2025-07-18 21:34:28] INFO train_model: dist_to_fib_100: mean=1586.7875, std=1396.9013, min=0.0000, max=10508.8359, unique=4736
[2025-07-18 21:34:28] INFO train_model: trendline_slope_high: mean=5.3079, std=100.3399, min=-488.7707, max=449.7492, unique=4763
[2025-07-18 21:34:28] INFO train_model: trendline_slope_low: mean=5.3006, std=103.7266, min=-487.6711, max=479.1137, unique=4765
[2025-07-18 21:34:28] INFO train_model: trendline_up: mean=0.5119, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: trendline_down: mean=0.4621, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: breakout_high: mean=0.0108, std=0.1036, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: breakout_low: mean=0.0127, std=0.1121, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: dist_to_high: mean=-1387.9182, std=1380.5127, min=-10522.6016, max=250.3906, unique=4765
[2025-07-18 21:34:28] INFO train_model: dist_to_low: mean=1590.9628, std=1453.6998, min=-257.3125, max=10508.8359, unique=4768
[2025-07-18 21:34:28] INFO train_model: vol_spike_atr: mean=0.0367, std=0.1880, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: vol_spike_std: mean=0.1641, std=0.3704, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: is_trending: mean=0.0236, std=0.1517, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: supply_zone: mean=0.2166, std=0.4120, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: demand_zone: mean=0.1887, std=0.3913, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: bos: mean=0.0236, std=0.1517, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: choch: mean=0.1599, std=0.3666, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: vol_cluster_std: mean=0.0044, std=0.0026, min=0.0006, max=0.0169, unique=4776
[2025-07-18 21:34:28] INFO train_model: vol_cluster_high: mean=0.1282, std=0.3344, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: regime_zscore: mean=-0.0208, std=1.0153, min=-5.7567, max=6.9376, unique=4696
[2025-07-18 21:34:28] INFO train_model: doji: mean=0.0801, std=0.2714, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: hammer: mean=0.0273, std=0.1630, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bearish_engulfing: mean=0.0550, std=0.2281, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: pin_bar: mean=0.2289, std=0.4202, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bearish_engulfing_bar: mean=0.0550, std=0.2281, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: inside_bar: mean=0.1405, std=0.3476, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: inv_head_shoulders: mean=0.0342, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: rising_wedge: mean=0.2542, std=0.4354, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: falling_wedge: mean=0.2506, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: fakeout_up: mean=0.0052, std=0.0720, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: fakeout_down: mean=0.0060, std=0.0775, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bullish_flag: mean=0.0256, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bearish_flag: mean=0.0256, std=0.1581, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bullish_pennant: mean=0.1405, std=0.3476, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bearish_pennant: mean=0.1395, std=0.3465, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: morning_star: mean=0.0377, std=0.1906, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: evening_star: mean=0.0354, std=0.1849, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: bullish_harami: mean=0.0605, std=0.2384, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: bearish_harami: mean=0.0586, std=0.2349, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: dark_cloud_cover: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: regime_label_bear: mean=0.4041, std=0.4908, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: regime_label_bull: mean=0.5542, std=0.4971, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: regime_label_neutral: mean=0.0417, std=0.1999, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: market_regime_choppy: mean=0.2521, std=0.4343, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: market_regime_downtrend: mean=0.2465, std=0.4310, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: market_regime_range: mean=0.2383, std=0.4261, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: market_regime_uptrend: mean=0.2631, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:34:28] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:34:28] INFO train_model: Auditing data quality before training...
[2025-07-18 21:34:28] INFO train_model: Entering audit_data_quality
[2025-07-18 21:34:31] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: is_ranging
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: fib_levels
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-18 21:34:31] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-18 21:34:31] INFO train_model: Auditing data quality after removing constant features...
[2025-07-18 21:34:31] INFO train_model: Entering audit_data_quality
[2025-07-18 21:34:34] INFO train_model: Exiting audit_data_quality
[2025-07-18 21:34:34] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:34:34] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:34:34] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-18 21:34:34] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-18 21:34:34] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-18 21:34:34] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-18 21:34:34] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-18 21:35:55] INFO train_model: Model is starting a new training session...
[2025-07-18 21:35:55] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:35:55] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-18 21:35:55] INFO train_model: Preparing target variable...
[2025-07-18 21:35:55] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:35:55] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:35:55] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-18 21:35:55] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:35:55] INFO train_model: Dropping NaN targets...
[2025-07-18 21:35:55] INFO train_model: Class balance before upsampling: {0: 3311, 1: 1413}
[2025-07-18 21:35:55] INFO train_model: Upsampling successful.
[2025-07-18 21:35:55] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:35:55] INFO train_model: Splitting train/test...
[2025-07-18 21:35:55] INFO train_model: Scaling features...
[2025-07-18 21:35:55] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:35:55] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:35:57] INFO train_model: Model fit complete.
[2025-07-18 21:35:57] INFO train_model: Model Accuracy: 0.8891
[2025-07-18 21:35:57] INFO train_model: 
Classification Report:
[2025-07-18 21:35:57] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.89      0.89       663
           1       0.89      0.88      0.89       662

    accuracy                           0.89      1325
   macro avg       0.89      0.89      0.89      1325
weighted avg       0.89      0.89      0.89      1325

[2025-07-18 21:35:57] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-18 21:35:57] INFO train_model: Model registered in ModelRegistry for EURUSD, version d6aed022f2785cd411f9ebf442a82d78
[2025-07-18 21:35:57] INFO train_model: Feature distributions before training:
[2025-07-18 21:35:57] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4712
[2025-07-18 21:35:57] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4657
[2025-07-18 21:35:57] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4665
[2025-07-18 21:35:57] INFO train_model: sma_50: mean=1.0900, std=0.0457, min=1.0239, max=1.1795, unique=4648
[2025-07-18 21:35:57] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4516
[2025-07-18 21:35:57] INFO train_model: ema_12: mean=1.0903, std=0.0460, min=1.0212, max=1.1801, unique=4724
[2025-07-18 21:35:57] INFO train_model: ema_26: mean=1.0902, std=0.0459, min=1.0226, max=1.1796, unique=4724
[2025-07-18 21:35:57] INFO train_model: rsi_14: mean=50.2977, std=12.2316, min=12.4560, max=90.7375, unique=4455
[2025-07-18 21:35:57] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4699
[2025-07-18 21:35:57] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4691
[2025-07-18 21:35:57] INFO train_model: bb_high: mean=1.0939, std=0.0462, min=1.0240, max=1.1830, unique=4665
[2025-07-18 21:35:57] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4665
[2025-07-18 21:35:57] INFO train_model: stoch_k: mean=50.0620, std=27.4237, min=0.0000, max=100.0000, unique=4354
[2025-07-18 21:35:57] INFO train_model: stoch_d: mean=50.0829, std=24.8683, min=2.6519, max=97.5215, unique=4677
[2025-07-18 21:35:57] INFO train_model: fib_0: mean=1.0943, std=0.0462, min=1.0248, max=1.1832, unique=634
[2025-07-18 21:35:57] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3778
[2025-07-18 21:35:57] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-18 21:35:57] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4266
[2025-07-18 21:35:57] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-18 21:35:57] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4266
[2025-07-18 21:35:57] INFO train_model: fib_500: mean=1.0903, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-18 21:35:57] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4260
[2025-07-18 21:35:57] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-18 21:35:57] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4266
[2025-07-18 21:35:57] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-18 21:35:57] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4266
[2025-07-18 21:35:57] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-18 21:35:57] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3814
[2025-07-18 21:35:57] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4442
[2025-07-18 21:35:57] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4458
[2025-07-18 21:35:57] INFO train_model: trendline_up: mean=0.4695, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: trendline_down: mean=0.4970, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3774
[2025-07-18 21:35:57] INFO train_model: dist_to_low: mean=0.0041, std=0.0038, min=-0.0107, max=0.0345, unique=3779
[2025-07-18 21:35:57] INFO train_model: vol_spike_atr: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: vol_spike_std: mean=0.1571, std=0.3639, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:35:57] INFO train_model: supply_zone: mean=0.4829, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:35:57] INFO train_model: demand_zone: mean=0.4659, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:13] INFO train_model: Model is starting a new training session...
[2025-07-18 21:36:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:36:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-18 21:36:13] INFO train_model: Preparing target variable...
[2025-07-18 21:36:13] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:36:13] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:36:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-18 21:36:13] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:36:13] INFO train_model: Dropping NaN targets...
[2025-07-18 21:36:13] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1591}
[2025-07-18 21:36:13] INFO train_model: Upsampling successful.
[2025-07-18 21:36:13] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:36:13] INFO train_model: Splitting train/test...
[2025-07-18 21:36:13] INFO train_model: Scaling features...
[2025-07-18 21:36:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:36:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:36:15] INFO train_model: Model fit complete.
[2025-07-18 21:36:15] INFO train_model: Model Accuracy: 0.8768
[2025-07-18 21:36:15] INFO train_model: 
Classification Report:
[2025-07-18 21:36:15] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.87      0.88       621
           1       0.88      0.88      0.88       621

    accuracy                           0.88      1242
   macro avg       0.88      0.88      0.88      1242
weighted avg       0.88      0.88      0.88      1242

[2025-07-18 21:36:15] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 21:36:15] INFO train_model: Model registered in ModelRegistry for USDJPY, version 55e6ecc4f3b7d434fd512ca82b69de0f
[2025-07-18 21:36:15] INFO train_model: Feature distributions before training:
[2025-07-18 21:36:15] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4683
[2025-07-18 21:36:15] INFO train_model: volatility_20: mean=0.3282, std=0.1836, min=0.0344, max=1.3004, unique=4676
[2025-07-18 21:36:15] INFO train_model: sma_20: mean=149.6161, std=4.6964, min=140.5323, max=158.2940, unique=4674
[2025-07-18 21:36:15] INFO train_model: sma_50: mean=149.6184, std=4.6755, min=140.8684, max=158.1650, unique=4646
[2025-07-18 21:36:15] INFO train_model: sma_200: mean=149.6743, std=4.5832, min=142.1838, max=157.7724, unique=4495
[2025-07-18 21:36:15] INFO train_model: ema_12: mean=149.6149, std=4.6981, min=140.4143, max=158.3392, unique=4695
[2025-07-18 21:36:15] INFO train_model: ema_26: mean=149.6161, std=4.6836, min=140.6181, max=158.2242, unique=4695
[2025-07-18 21:36:15] INFO train_model: rsi_14: mean=50.5802, std=12.9323, min=8.6902, max=92.4381, unique=4672
[2025-07-18 21:36:15] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4670
[2025-07-18 21:36:15] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4662
[2025-07-18 21:36:15] INFO train_model: bb_high: mean=150.2558, std=4.6743, min=140.9707, max=158.5972, unique=4676
[2025-07-18 21:36:15] INFO train_model: bb_low: mean=148.9763, std=4.7454, min=139.2981, max=158.0618, unique=4676
[2025-07-18 21:36:15] INFO train_model: stoch_k: mean=52.3492, std=27.0591, min=0.0000, max=99.6649, unique=4671
[2025-07-18 21:36:15] INFO train_model: stoch_d: mean=52.3561, std=25.0037, min=3.8543, max=96.6848, unique=4678
[2025-07-18 21:36:15] INFO train_model: fib_0: mean=150.2813, std=4.6552, min=141.0760, max=158.8790, unique=1210
[2025-07-18 21:36:15] INFO train_model: dist_to_fib_0: mean=-0.6655, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-18 21:36:15] INFO train_model: fib_236: mean=149.9556, std=4.6623, min=140.8676, max=158.5797, unique=2255
[2025-07-18 21:36:15] INFO train_model: dist_to_fib_236: mean=-0.3398, std=0.4877, min=-3.8081, max=0.7712, unique=4657
[2025-07-18 21:36:15] INFO train_model: fib_382: mean=149.7541, std=4.6689, min=140.6792, max=158.3946, unique=2255
[2025-07-18 21:36:15] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4634, min=-3.0330, max=1.2871, unique=4657
[2025-07-18 21:36:15] INFO train_model: fib_500: mean=149.5913, std=4.6755, min=140.5270, max=158.2450, unique=2224
[2025-07-18 21:36:15] INFO train_model: dist_to_fib_500: mean=0.0245, std=0.4555, min=-2.4065, max=1.7885, unique=4395
[2025-07-18 21:36:15] INFO train_model: fib_618: mean=149.4284, std=4.6831, min=140.3748, max=158.1640, unique=2255
[2025-07-18 21:36:15] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4657
[2025-07-18 21:36:15] INFO train_model: fib_786: mean=149.1966, std=4.6959, min=140.1581, max=158.0580, unique=2255
[2025-07-18 21:36:15] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4822, min=-0.8881, max=3.0037, unique=4657
[2025-07-18 21:36:15] INFO train_model: fib_100: mean=148.9012, std=4.7152, min=139.8820, max=157.9230, unique=1168
[2025-07-18 21:36:15] INFO train_model: dist_to_fib_100: mean=0.7146, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-18 21:36:15] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3785
[2025-07-18 21:36:15] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3834
[2025-07-18 21:36:15] INFO train_model: trendline_up: mean=0.5044, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: trendline_down: mean=0.4784, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: dist_to_high: mean=-0.6658, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-18 21:36:15] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-18 21:36:15] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:36:15] INFO train_model: supply_zone: mean=0.4364, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:15] INFO train_model: demand_zone: mean=0.3687, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:37] INFO train_model: Model is starting a new training session...
[2025-07-18 21:36:37] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:36:37] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-18 21:36:37] INFO train_model: Preparing target variable...
[2025-07-18 21:36:37] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:36:37] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:36:37] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-18 21:36:37] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:36:37] INFO train_model: Dropping NaN targets...
[2025-07-18 21:36:37] INFO train_model: Class balance before upsampling: {0: 3090, 1: 1634}
[2025-07-18 21:36:37] INFO train_model: Upsampling successful.
[2025-07-18 21:36:37] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:36:37] INFO train_model: Splitting train/test...
[2025-07-18 21:36:37] INFO train_model: Scaling features...
[2025-07-18 21:36:37] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:36:37] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:36:39] INFO train_model: Model fit complete.
[2025-07-18 21:36:39] INFO train_model: Model Accuracy: 0.8762
[2025-07-18 21:36:39] INFO train_model: 
Classification Report:
[2025-07-18 21:36:39] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.89      0.88       618
           1       0.88      0.87      0.87       618

    accuracy                           0.88      1236
   macro avg       0.88      0.88      0.88      1236
weighted avg       0.88      0.88      0.88      1236

[2025-07-18 21:36:39] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-18 21:36:39] INFO train_model: Model registered in ModelRegistry for NZDUSD, version ac5fd7677670439b0636e4aa1e79776a
[2025-07-18 21:36:39] INFO train_model: Feature distributions before training:
[2025-07-18 21:36:39] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4712
[2025-07-18 21:36:39] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4685
[2025-07-18 21:36:39] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4689
[2025-07-18 21:36:39] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4660
[2025-07-18 21:36:39] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4522
[2025-07-18 21:36:39] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4724
[2025-07-18 21:36:39] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4724
[2025-07-18 21:36:39] INFO train_model: rsi_14: mean=49.3833, std=12.3851, min=11.3290, max=91.7839, unique=4588
[2025-07-18 21:36:39] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4699
[2025-07-18 21:36:39] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4691
[2025-07-18 21:36:39] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4691
[2025-07-18 21:36:39] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4691
[2025-07-18 21:36:39] INFO train_model: stoch_k: mean=49.1926, std=28.8112, min=0.0000, max=100.0000, unique=4550
[2025-07-18 21:36:39] INFO train_model: stoch_d: mean=49.2229, std=26.3686, min=2.3676, max=99.2269, unique=4695
[2025-07-18 21:36:39] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-18 21:36:39] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4326
[2025-07-18 21:36:39] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2133
[2025-07-18 21:36:39] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4557
[2025-07-18 21:36:39] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2133
[2025-07-18 21:36:39] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4557
[2025-07-18 21:36:39] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2133
[2025-07-18 21:36:39] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4550
[2025-07-18 21:36:39] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2133
[2025-07-18 21:36:39] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4557
[2025-07-18 21:36:39] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2133
[2025-07-18 21:36:39] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4557
[2025-07-18 21:36:39] INFO train_model: fib_100: mean=0.5817, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-18 21:36:39] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4297
[2025-07-18 21:36:39] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4622
[2025-07-18 21:36:39] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4616
[2025-07-18 21:36:39] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: trendline_down: mean=0.5248, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4312
[2025-07-18 21:36:39] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4295
[2025-07-18 21:36:39] INFO train_model: vol_spike_atr: mean=0.0155, std=0.1234, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:36:39] INFO train_model: supply_zone: mean=0.4096, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:36:39] INFO train_model: demand_zone: mean=0.4246, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:53] INFO train_model: Model is starting a new training session...
[2025-07-18 21:45:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:45:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-18 21:45:53] INFO train_model: Preparing target variable...
[2025-07-18 21:45:53] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:45:53] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:45:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-18 21:45:53] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:45:53] INFO train_model: Dropping NaN targets...
[2025-07-18 21:45:53] INFO train_model: Class balance before upsampling: {0: 3311, 1: 1413}
[2025-07-18 21:45:53] INFO train_model: Upsampling successful.
[2025-07-18 21:45:53] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:45:53] INFO train_model: Splitting train/test...
[2025-07-18 21:45:53] INFO train_model: Scaling features...
[2025-07-18 21:45:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:45:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:45:55] INFO train_model: Model fit complete.
[2025-07-18 21:45:55] INFO train_model: Model Accuracy: 0.8891
[2025-07-18 21:45:55] INFO train_model: 
Classification Report:
[2025-07-18 21:45:55] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.89      0.89       663
           1       0.89      0.88      0.89       662

    accuracy                           0.89      1325
   macro avg       0.89      0.89      0.89      1325
weighted avg       0.89      0.89      0.89      1325

[2025-07-18 21:45:55] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-18 21:45:55] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "d6aed022f2785cd411f9ebf442a82d78" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "d6aed022f2785cd411f9ebf442a82d78" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'd6aed022f2785cd411f9ebf442a82d78'}}
[2025-07-18 21:45:55] INFO train_model: Feature distributions before training:
[2025-07-18 21:45:55] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4712
[2025-07-18 21:45:55] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4657
[2025-07-18 21:45:55] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4665
[2025-07-18 21:45:55] INFO train_model: sma_50: mean=1.0900, std=0.0457, min=1.0239, max=1.1795, unique=4648
[2025-07-18 21:45:55] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4516
[2025-07-18 21:45:55] INFO train_model: ema_12: mean=1.0903, std=0.0460, min=1.0212, max=1.1801, unique=4724
[2025-07-18 21:45:55] INFO train_model: ema_26: mean=1.0902, std=0.0459, min=1.0226, max=1.1796, unique=4724
[2025-07-18 21:45:55] INFO train_model: rsi_14: mean=50.2977, std=12.2316, min=12.4560, max=90.7375, unique=4455
[2025-07-18 21:45:55] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4699
[2025-07-18 21:45:55] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4691
[2025-07-18 21:45:55] INFO train_model: bb_high: mean=1.0939, std=0.0462, min=1.0240, max=1.1830, unique=4665
[2025-07-18 21:45:55] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4665
[2025-07-18 21:45:55] INFO train_model: stoch_k: mean=50.0620, std=27.4237, min=0.0000, max=100.0000, unique=4354
[2025-07-18 21:45:55] INFO train_model: stoch_d: mean=50.0829, std=24.8683, min=2.6519, max=97.5215, unique=4677
[2025-07-18 21:45:55] INFO train_model: fib_0: mean=1.0943, std=0.0462, min=1.0248, max=1.1832, unique=634
[2025-07-18 21:45:55] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3778
[2025-07-18 21:45:55] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-18 21:45:55] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4266
[2025-07-18 21:45:55] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-18 21:45:55] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4266
[2025-07-18 21:45:55] INFO train_model: fib_500: mean=1.0903, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-18 21:45:55] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4260
[2025-07-18 21:45:55] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-18 21:45:55] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4266
[2025-07-18 21:45:55] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-18 21:45:55] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4266
[2025-07-18 21:45:55] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-18 21:45:55] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3814
[2025-07-18 21:45:55] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4442
[2025-07-18 21:45:55] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4458
[2025-07-18 21:45:55] INFO train_model: trendline_up: mean=0.4695, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: trendline_down: mean=0.4970, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3774
[2025-07-18 21:45:55] INFO train_model: dist_to_low: mean=0.0041, std=0.0038, min=-0.0107, max=0.0345, unique=3779
[2025-07-18 21:45:55] INFO train_model: vol_spike_atr: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: vol_spike_std: mean=0.1571, std=0.3639, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:45:55] INFO train_model: supply_zone: mean=0.4829, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:55] INFO train_model: demand_zone: mean=0.4659, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:45:58] INFO train_model: Model is starting a new training session...
[2025-07-18 21:45:58] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:45:58] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-18 21:45:58] INFO train_model: Preparing target variable...
[2025-07-18 21:45:58] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:45:58] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:45:58] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-18 21:45:58] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:45:58] INFO train_model: Dropping NaN targets...
[2025-07-18 21:45:58] INFO train_model: Class balance before upsampling: {0: 3311, 1: 1413}
[2025-07-18 21:45:58] INFO train_model: Upsampling successful.
[2025-07-18 21:45:58] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:45:58] INFO train_model: Splitting train/test...
[2025-07-18 21:45:58] INFO train_model: Scaling features...
[2025-07-18 21:45:58] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:45:58] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:46:00] INFO train_model: Model fit complete.
[2025-07-18 21:46:00] INFO train_model: Model Accuracy: 0.8891
[2025-07-18 21:46:00] INFO train_model: 
Classification Report:
[2025-07-18 21:46:00] INFO train_model:               precision    recall  f1-score   support

           0       0.89      0.89      0.89       663
           1       0.89      0.88      0.89       662

    accuracy                           0.89      1325
   macro avg       0.89      0.89      0.89      1325
weighted avg       0.89      0.89      0.89      1325

[2025-07-18 21:46:00] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-18 21:46:00] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "d6aed022f2785cd411f9ebf442a82d78" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "d6aed022f2785cd411f9ebf442a82d78" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'd6aed022f2785cd411f9ebf442a82d78'}}
[2025-07-18 21:46:00] INFO train_model: Feature distributions before training:
[2025-07-18 21:46:00] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4712
[2025-07-18 21:46:00] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4657
[2025-07-18 21:46:00] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4665
[2025-07-18 21:46:00] INFO train_model: sma_50: mean=1.0900, std=0.0457, min=1.0239, max=1.1795, unique=4648
[2025-07-18 21:46:00] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4516
[2025-07-18 21:46:00] INFO train_model: ema_12: mean=1.0903, std=0.0460, min=1.0212, max=1.1801, unique=4724
[2025-07-18 21:46:00] INFO train_model: ema_26: mean=1.0902, std=0.0459, min=1.0226, max=1.1796, unique=4724
[2025-07-18 21:46:00] INFO train_model: rsi_14: mean=50.2977, std=12.2316, min=12.4560, max=90.7375, unique=4455
[2025-07-18 21:46:00] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4699
[2025-07-18 21:46:00] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4691
[2025-07-18 21:46:00] INFO train_model: bb_high: mean=1.0939, std=0.0462, min=1.0240, max=1.1830, unique=4665
[2025-07-18 21:46:00] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4665
[2025-07-18 21:46:00] INFO train_model: stoch_k: mean=50.0620, std=27.4237, min=0.0000, max=100.0000, unique=4354
[2025-07-18 21:46:00] INFO train_model: stoch_d: mean=50.0829, std=24.8683, min=2.6519, max=97.5215, unique=4677
[2025-07-18 21:46:00] INFO train_model: fib_0: mean=1.0943, std=0.0462, min=1.0248, max=1.1832, unique=634
[2025-07-18 21:46:00] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3778
[2025-07-18 21:46:00] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-18 21:46:00] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4266
[2025-07-18 21:46:00] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-18 21:46:00] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4266
[2025-07-18 21:46:00] INFO train_model: fib_500: mean=1.0903, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-18 21:46:00] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4260
[2025-07-18 21:46:00] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-18 21:46:00] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4266
[2025-07-18 21:46:00] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-18 21:46:00] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4266
[2025-07-18 21:46:00] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-18 21:46:00] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3814
[2025-07-18 21:46:00] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4442
[2025-07-18 21:46:00] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4458
[2025-07-18 21:46:00] INFO train_model: trendline_up: mean=0.4695, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: trendline_down: mean=0.4970, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3774
[2025-07-18 21:46:00] INFO train_model: dist_to_low: mean=0.0041, std=0.0038, min=-0.0107, max=0.0345, unique=3779
[2025-07-18 21:46:00] INFO train_model: vol_spike_atr: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: vol_spike_std: mean=0.1571, std=0.3639, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:46:00] INFO train_model: supply_zone: mean=0.4829, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:00] INFO train_model: demand_zone: mean=0.4659, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:18] INFO train_model: Model is starting a new training session...
[2025-07-18 21:46:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:46:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-18 21:46:18] INFO train_model: Preparing target variable...
[2025-07-18 21:46:18] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:46:18] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:46:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-18 21:46:18] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:46:18] INFO train_model: Dropping NaN targets...
[2025-07-18 21:46:18] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1591}
[2025-07-18 21:46:18] INFO train_model: Upsampling successful.
[2025-07-18 21:46:18] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:46:18] INFO train_model: Splitting train/test...
[2025-07-18 21:46:18] INFO train_model: Scaling features...
[2025-07-18 21:46:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:46:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:46:20] INFO train_model: Model fit complete.
[2025-07-18 21:46:20] INFO train_model: Model Accuracy: 0.8768
[2025-07-18 21:46:20] INFO train_model: 
Classification Report:
[2025-07-18 21:46:20] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.87      0.88       621
           1       0.88      0.88      0.88       621

    accuracy                           0.88      1242
   macro avg       0.88      0.88      0.88      1242
weighted avg       0.88      0.88      0.88      1242

[2025-07-18 21:46:20] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 21:46:20] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "55e6ecc4f3b7d434fd512ca82b69de0f" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "55e6ecc4f3b7d434fd512ca82b69de0f" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': '55e6ecc4f3b7d434fd512ca82b69de0f'}}
[2025-07-18 21:46:20] INFO train_model: Feature distributions before training:
[2025-07-18 21:46:20] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4683
[2025-07-18 21:46:20] INFO train_model: volatility_20: mean=0.3282, std=0.1836, min=0.0344, max=1.3004, unique=4676
[2025-07-18 21:46:20] INFO train_model: sma_20: mean=149.6161, std=4.6964, min=140.5323, max=158.2940, unique=4674
[2025-07-18 21:46:20] INFO train_model: sma_50: mean=149.6184, std=4.6755, min=140.8684, max=158.1650, unique=4646
[2025-07-18 21:46:20] INFO train_model: sma_200: mean=149.6743, std=4.5832, min=142.1838, max=157.7724, unique=4495
[2025-07-18 21:46:20] INFO train_model: ema_12: mean=149.6149, std=4.6981, min=140.4143, max=158.3392, unique=4695
[2025-07-18 21:46:20] INFO train_model: ema_26: mean=149.6161, std=4.6836, min=140.6181, max=158.2242, unique=4695
[2025-07-18 21:46:20] INFO train_model: rsi_14: mean=50.5802, std=12.9323, min=8.6902, max=92.4381, unique=4672
[2025-07-18 21:46:20] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4670
[2025-07-18 21:46:20] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4662
[2025-07-18 21:46:20] INFO train_model: bb_high: mean=150.2558, std=4.6743, min=140.9707, max=158.5972, unique=4676
[2025-07-18 21:46:20] INFO train_model: bb_low: mean=148.9763, std=4.7454, min=139.2981, max=158.0618, unique=4676
[2025-07-18 21:46:20] INFO train_model: stoch_k: mean=52.3492, std=27.0591, min=0.0000, max=99.6649, unique=4671
[2025-07-18 21:46:20] INFO train_model: stoch_d: mean=52.3561, std=25.0037, min=3.8543, max=96.6848, unique=4678
[2025-07-18 21:46:20] INFO train_model: fib_0: mean=150.2813, std=4.6552, min=141.0760, max=158.8790, unique=1210
[2025-07-18 21:46:20] INFO train_model: dist_to_fib_0: mean=-0.6655, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-18 21:46:20] INFO train_model: fib_236: mean=149.9556, std=4.6623, min=140.8676, max=158.5797, unique=2255
[2025-07-18 21:46:20] INFO train_model: dist_to_fib_236: mean=-0.3398, std=0.4877, min=-3.8081, max=0.7712, unique=4657
[2025-07-18 21:46:20] INFO train_model: fib_382: mean=149.7541, std=4.6689, min=140.6792, max=158.3946, unique=2255
[2025-07-18 21:46:20] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4634, min=-3.0330, max=1.2871, unique=4657
[2025-07-18 21:46:20] INFO train_model: fib_500: mean=149.5913, std=4.6755, min=140.5270, max=158.2450, unique=2224
[2025-07-18 21:46:20] INFO train_model: dist_to_fib_500: mean=0.0245, std=0.4555, min=-2.4065, max=1.7885, unique=4395
[2025-07-18 21:46:20] INFO train_model: fib_618: mean=149.4284, std=4.6831, min=140.3748, max=158.1640, unique=2255
[2025-07-18 21:46:20] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4657
[2025-07-18 21:46:20] INFO train_model: fib_786: mean=149.1966, std=4.6959, min=140.1581, max=158.0580, unique=2255
[2025-07-18 21:46:20] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4822, min=-0.8881, max=3.0037, unique=4657
[2025-07-18 21:46:20] INFO train_model: fib_100: mean=148.9012, std=4.7152, min=139.8820, max=157.9230, unique=1168
[2025-07-18 21:46:20] INFO train_model: dist_to_fib_100: mean=0.7146, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-18 21:46:20] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3785
[2025-07-18 21:46:20] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3834
[2025-07-18 21:46:20] INFO train_model: trendline_up: mean=0.5044, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: trendline_down: mean=0.4784, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: dist_to_high: mean=-0.6658, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-18 21:46:20] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-18 21:46:20] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:46:20] INFO train_model: supply_zone: mean=0.4364, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:20] INFO train_model: demand_zone: mean=0.3687, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:23] INFO train_model: Model is starting a new training session...
[2025-07-18 21:46:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:46:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-18 21:46:23] INFO train_model: Preparing target variable...
[2025-07-18 21:46:23] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:46:23] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:46:23] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-18 21:46:23] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:46:23] INFO train_model: Dropping NaN targets...
[2025-07-18 21:46:23] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1591}
[2025-07-18 21:46:23] INFO train_model: Upsampling successful.
[2025-07-18 21:46:23] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:46:23] INFO train_model: Splitting train/test...
[2025-07-18 21:46:23] INFO train_model: Scaling features...
[2025-07-18 21:46:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:46:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:46:26] INFO train_model: Model fit complete.
[2025-07-18 21:46:26] INFO train_model: Model Accuracy: 0.8768
[2025-07-18 21:46:26] INFO train_model: 
Classification Report:
[2025-07-18 21:46:26] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.87      0.88       621
           1       0.88      0.88      0.88       621

    accuracy                           0.88      1242
   macro avg       0.88      0.88      0.88      1242
weighted avg       0.88      0.88      0.88      1242

[2025-07-18 21:46:26] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-18 21:46:26] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "55e6ecc4f3b7d434fd512ca82b69de0f" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "55e6ecc4f3b7d434fd512ca82b69de0f" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': '55e6ecc4f3b7d434fd512ca82b69de0f'}}
[2025-07-18 21:46:26] INFO train_model: Feature distributions before training:
[2025-07-18 21:46:26] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4683
[2025-07-18 21:46:26] INFO train_model: volatility_20: mean=0.3282, std=0.1836, min=0.0344, max=1.3004, unique=4676
[2025-07-18 21:46:26] INFO train_model: sma_20: mean=149.6161, std=4.6964, min=140.5323, max=158.2940, unique=4674
[2025-07-18 21:46:26] INFO train_model: sma_50: mean=149.6184, std=4.6755, min=140.8684, max=158.1650, unique=4646
[2025-07-18 21:46:26] INFO train_model: sma_200: mean=149.6743, std=4.5832, min=142.1838, max=157.7724, unique=4495
[2025-07-18 21:46:26] INFO train_model: ema_12: mean=149.6149, std=4.6981, min=140.4143, max=158.3392, unique=4695
[2025-07-18 21:46:26] INFO train_model: ema_26: mean=149.6161, std=4.6836, min=140.6181, max=158.2242, unique=4695
[2025-07-18 21:46:26] INFO train_model: rsi_14: mean=50.5802, std=12.9323, min=8.6902, max=92.4381, unique=4672
[2025-07-18 21:46:26] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4670
[2025-07-18 21:46:26] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4662
[2025-07-18 21:46:26] INFO train_model: bb_high: mean=150.2558, std=4.6743, min=140.9707, max=158.5972, unique=4676
[2025-07-18 21:46:26] INFO train_model: bb_low: mean=148.9763, std=4.7454, min=139.2981, max=158.0618, unique=4676
[2025-07-18 21:46:26] INFO train_model: stoch_k: mean=52.3492, std=27.0591, min=0.0000, max=99.6649, unique=4671
[2025-07-18 21:46:26] INFO train_model: stoch_d: mean=52.3561, std=25.0037, min=3.8543, max=96.6848, unique=4678
[2025-07-18 21:46:26] INFO train_model: fib_0: mean=150.2813, std=4.6552, min=141.0760, max=158.8790, unique=1210
[2025-07-18 21:46:26] INFO train_model: dist_to_fib_0: mean=-0.6655, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-18 21:46:26] INFO train_model: fib_236: mean=149.9556, std=4.6623, min=140.8676, max=158.5797, unique=2255
[2025-07-18 21:46:26] INFO train_model: dist_to_fib_236: mean=-0.3398, std=0.4877, min=-3.8081, max=0.7712, unique=4657
[2025-07-18 21:46:26] INFO train_model: fib_382: mean=149.7541, std=4.6689, min=140.6792, max=158.3946, unique=2255
[2025-07-18 21:46:26] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4634, min=-3.0330, max=1.2871, unique=4657
[2025-07-18 21:46:26] INFO train_model: fib_500: mean=149.5913, std=4.6755, min=140.5270, max=158.2450, unique=2224
[2025-07-18 21:46:26] INFO train_model: dist_to_fib_500: mean=0.0245, std=0.4555, min=-2.4065, max=1.7885, unique=4395
[2025-07-18 21:46:26] INFO train_model: fib_618: mean=149.4284, std=4.6831, min=140.3748, max=158.1640, unique=2255
[2025-07-18 21:46:26] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4657
[2025-07-18 21:46:26] INFO train_model: fib_786: mean=149.1966, std=4.6959, min=140.1581, max=158.0580, unique=2255
[2025-07-18 21:46:26] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4822, min=-0.8881, max=3.0037, unique=4657
[2025-07-18 21:46:26] INFO train_model: fib_100: mean=148.9012, std=4.7152, min=139.8820, max=157.9230, unique=1168
[2025-07-18 21:46:26] INFO train_model: dist_to_fib_100: mean=0.7146, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-18 21:46:26] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3785
[2025-07-18 21:46:26] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3834
[2025-07-18 21:46:26] INFO train_model: trendline_up: mean=0.5044, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: trendline_down: mean=0.4784, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: dist_to_high: mean=-0.6658, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-18 21:46:26] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-18 21:46:26] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:46:26] INFO train_model: supply_zone: mean=0.4364, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:26] INFO train_model: demand_zone: mean=0.3687, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:48] INFO train_model: Model is starting a new training session...
[2025-07-18 21:46:48] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:46:48] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-18 21:46:48] INFO train_model: Preparing target variable...
[2025-07-18 21:46:48] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:46:48] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:46:48] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-18 21:46:48] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:46:48] INFO train_model: Dropping NaN targets...
[2025-07-18 21:46:48] INFO train_model: Class balance before upsampling: {0: 3090, 1: 1634}
[2025-07-18 21:46:48] INFO train_model: Upsampling successful.
[2025-07-18 21:46:48] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:46:48] INFO train_model: Splitting train/test...
[2025-07-18 21:46:48] INFO train_model: Scaling features...
[2025-07-18 21:46:48] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:46:48] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:46:50] INFO train_model: Model fit complete.
[2025-07-18 21:46:50] INFO train_model: Model Accuracy: 0.8762
[2025-07-18 21:46:50] INFO train_model: 
Classification Report:
[2025-07-18 21:46:50] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.89      0.88       618
           1       0.88      0.87      0.87       618

    accuracy                           0.88      1236
   macro avg       0.88      0.88      0.88      1236
weighted avg       0.88      0.88      0.88      1236

[2025-07-18 21:46:50] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-18 21:46:50] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "ac5fd7677670439b0636e4aa1e79776a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "ac5fd7677670439b0636e4aa1e79776a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': 'ac5fd7677670439b0636e4aa1e79776a'}}
[2025-07-18 21:46:50] INFO train_model: Feature distributions before training:
[2025-07-18 21:46:50] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4712
[2025-07-18 21:46:50] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4685
[2025-07-18 21:46:50] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4689
[2025-07-18 21:46:50] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4660
[2025-07-18 21:46:50] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4522
[2025-07-18 21:46:50] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4724
[2025-07-18 21:46:50] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4724
[2025-07-18 21:46:50] INFO train_model: rsi_14: mean=49.3833, std=12.3851, min=11.3290, max=91.7839, unique=4588
[2025-07-18 21:46:50] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4699
[2025-07-18 21:46:50] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4691
[2025-07-18 21:46:50] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4691
[2025-07-18 21:46:50] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4691
[2025-07-18 21:46:50] INFO train_model: stoch_k: mean=49.1926, std=28.8112, min=0.0000, max=100.0000, unique=4550
[2025-07-18 21:46:50] INFO train_model: stoch_d: mean=49.2229, std=26.3686, min=2.3676, max=99.2269, unique=4695
[2025-07-18 21:46:50] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-18 21:46:50] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4326
[2025-07-18 21:46:50] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2133
[2025-07-18 21:46:50] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4557
[2025-07-18 21:46:50] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2133
[2025-07-18 21:46:50] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4557
[2025-07-18 21:46:50] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2133
[2025-07-18 21:46:50] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4550
[2025-07-18 21:46:50] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2133
[2025-07-18 21:46:50] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4557
[2025-07-18 21:46:50] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2133
[2025-07-18 21:46:50] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4557
[2025-07-18 21:46:50] INFO train_model: fib_100: mean=0.5817, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-18 21:46:50] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4297
[2025-07-18 21:46:50] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4622
[2025-07-18 21:46:50] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4616
[2025-07-18 21:46:50] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: trendline_down: mean=0.5248, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4312
[2025-07-18 21:46:50] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4295
[2025-07-18 21:46:50] INFO train_model: vol_spike_atr: mean=0.0155, std=0.1234, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:46:50] INFO train_model: supply_zone: mean=0.4096, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:50] INFO train_model: demand_zone: mean=0.4246, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:53] INFO train_model: Model is starting a new training session...
[2025-07-18 21:46:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:46:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-18 21:46:53] INFO train_model: Preparing target variable...
[2025-07-18 21:46:53] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:46:53] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:46:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-18 21:46:53] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:46:53] INFO train_model: Dropping NaN targets...
[2025-07-18 21:46:53] INFO train_model: Class balance before upsampling: {0: 3090, 1: 1634}
[2025-07-18 21:46:53] INFO train_model: Upsampling successful.
[2025-07-18 21:46:53] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:46:53] INFO train_model: Splitting train/test...
[2025-07-18 21:46:53] INFO train_model: Scaling features...
[2025-07-18 21:46:53] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:46:53] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:46:55] INFO train_model: Model fit complete.
[2025-07-18 21:46:55] INFO train_model: Model Accuracy: 0.8762
[2025-07-18 21:46:55] INFO train_model: 
Classification Report:
[2025-07-18 21:46:55] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.89      0.88       618
           1       0.88      0.87      0.87       618

    accuracy                           0.88      1236
   macro avg       0.88      0.88      0.88      1236
weighted avg       0.88      0.88      0.88      1236

[2025-07-18 21:46:55] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-18 21:46:55] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "ac5fd7677670439b0636e4aa1e79776a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "ac5fd7677670439b0636e4aa1e79776a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': 'ac5fd7677670439b0636e4aa1e79776a'}}
[2025-07-18 21:46:55] INFO train_model: Feature distributions before training:
[2025-07-18 21:46:55] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4712
[2025-07-18 21:46:55] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4685
[2025-07-18 21:46:55] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4689
[2025-07-18 21:46:55] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4660
[2025-07-18 21:46:55] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4522
[2025-07-18 21:46:55] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4724
[2025-07-18 21:46:55] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4724
[2025-07-18 21:46:55] INFO train_model: rsi_14: mean=49.3833, std=12.3851, min=11.3290, max=91.7839, unique=4588
[2025-07-18 21:46:55] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4699
[2025-07-18 21:46:55] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4691
[2025-07-18 21:46:55] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4691
[2025-07-18 21:46:55] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4691
[2025-07-18 21:46:55] INFO train_model: stoch_k: mean=49.1926, std=28.8112, min=0.0000, max=100.0000, unique=4550
[2025-07-18 21:46:55] INFO train_model: stoch_d: mean=49.2229, std=26.3686, min=2.3676, max=99.2269, unique=4695
[2025-07-18 21:46:55] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-18 21:46:55] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4326
[2025-07-18 21:46:55] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2133
[2025-07-18 21:46:55] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4557
[2025-07-18 21:46:55] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2133
[2025-07-18 21:46:55] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4557
[2025-07-18 21:46:55] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2133
[2025-07-18 21:46:55] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4550
[2025-07-18 21:46:55] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2133
[2025-07-18 21:46:55] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4557
[2025-07-18 21:46:55] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2133
[2025-07-18 21:46:55] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4557
[2025-07-18 21:46:55] INFO train_model: fib_100: mean=0.5817, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-18 21:46:55] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4297
[2025-07-18 21:46:55] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4622
[2025-07-18 21:46:55] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4616
[2025-07-18 21:46:55] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: trendline_down: mean=0.5248, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4312
[2025-07-18 21:46:55] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4295
[2025-07-18 21:46:55] INFO train_model: vol_spike_atr: mean=0.0155, std=0.1234, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:46:55] INFO train_model: supply_zone: mean=0.4096, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:46:55] INFO train_model: demand_zone: mean=0.4246, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:22] INFO train_model: Model is starting a new training session...
[2025-07-18 21:47:22] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:47:22] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-18 21:47:22] INFO train_model: Preparing target variable...
[2025-07-18 21:47:22] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:47:22] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:47:22] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-18 21:47:22] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:47:22] INFO train_model: Dropping NaN targets...
[2025-07-18 21:47:22] INFO train_model: Class balance before upsampling: {0: 3065, 1: 1657}
[2025-07-18 21:47:22] INFO train_model: Upsampling successful.
[2025-07-18 21:47:22] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:47:22] INFO train_model: Splitting train/test...
[2025-07-18 21:47:22] INFO train_model: Scaling features...
[2025-07-18 21:47:22] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:47:22] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:47:24] INFO train_model: Model fit complete.
[2025-07-18 21:47:24] INFO train_model: Model Accuracy: 0.8613
[2025-07-18 21:47:24] INFO train_model: 
Classification Report:
[2025-07-18 21:47:24] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.84      0.86       613
           1       0.85      0.88      0.86       613

    accuracy                           0.86      1226
   macro avg       0.86      0.86      0.86      1226
weighted avg       0.86      0.86      0.86      1226

[2025-07-18 21:47:24] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-18 21:47:24] INFO train_model: Model registered in ModelRegistry for NZDJPY, version 5c2219656f1d107b1dd226e5f55bc492
[2025-07-18 21:47:24] INFO train_model: Feature distributions before training:
[2025-07-18 21:47:24] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8441, unique=4710
[2025-07-18 21:47:24] INFO train_model: volatility_20: mean=0.2229, std=0.2570, min=0.0393, max=3.3139, unique=4700
[2025-07-18 21:47:24] INFO train_model: sma_20: mean=87.3660, std=2.2041, min=81.5998, max=92.2272, unique=4699
[2025-07-18 21:47:24] INFO train_model: sma_50: mean=87.3740, std=2.1960, min=82.0270, max=91.9825, unique=4670
[2025-07-18 21:47:24] INFO train_model: sma_200: mean=87.4220, std=2.1969, min=83.2736, max=91.5912, unique=4518
[2025-07-18 21:47:24] INFO train_model: ema_12: mean=87.3639, std=2.2039, min=81.3860, max=92.2433, unique=4722
[2025-07-18 21:47:24] INFO train_model: ema_26: mean=87.3676, std=2.1961, min=81.7433, max=92.1009, unique=4722
[2025-07-18 21:47:24] INFO train_model: rsi_14: mean=49.8985, std=11.8511, min=11.9091, max=86.8743, unique=4682
[2025-07-18 21:47:24] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4460, unique=4697
[2025-07-18 21:47:24] INFO train_model: macd_signal: mean=-0.0040, std=0.1245, min=-0.6881, max=0.9525, unique=4689
[2025-07-18 21:47:24] INFO train_model: bb_high: mean=87.8005, std=2.1268, min=82.3688, max=92.6084, unique=4701
[2025-07-18 21:47:24] INFO train_model: bb_low: mean=86.9316, std=2.3863, min=77.4318, max=92.0349, unique=4701
[2025-07-18 21:47:24] INFO train_model: stoch_k: mean=51.5665, std=26.9502, min=0.7728, max=239.3692, unique=4670
[2025-07-18 21:47:24] INFO train_model: stoch_d: mean=51.5588, std=24.5765, min=3.8824, max=173.4048, unique=4696
[2025-07-18 21:47:24] INFO train_model: fib_0: mean=87.8001, std=2.1201, min=82.4090, max=92.4600, unique=1115
[2025-07-18 21:47:24] INFO train_model: dist_to_fib_0: mean=-0.4380, std=0.4917, min=-6.7800, max=3.6510, unique=2674
[2025-07-18 21:47:24] INFO train_model: fib_236: mean=87.5873, std=2.1514, min=81.9488, max=92.3562, unique=2139
[2025-07-18 21:47:24] INFO train_model: dist_to_fib_236: mean=-0.2252, std=0.4029, min=-5.1658, max=4.4022, unique=4666
[2025-07-18 21:47:24] INFO train_model: fib_382: mean=87.4556, std=2.1760, min=81.6641, max=92.2919, unique=2139
[2025-07-18 21:47:24] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8669, unique=4666
[2025-07-18 21:47:24] INFO train_model: fib_500: mean=87.3492, std=2.1988, min=81.4340, max=92.2400, unique=2083
[2025-07-18 21:47:24] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2425, unique=4264
[2025-07-18 21:47:24] INFO train_model: fib_618: mean=87.2428, std=2.2240, min=81.2039, max=92.1881, unique=2139
[2025-07-18 21:47:24] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6181, unique=4665
[2025-07-18 21:47:24] INFO train_model: fib_786: mean=87.0913, std=2.2639, min=80.8763, max=92.1142, unique=2139
[2025-07-18 21:47:24] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1528, unique=4665
[2025-07-18 21:47:24] INFO train_model: fib_100: mean=86.8984, std=2.3213, min=80.4530, max=92.0200, unique=1083
[2025-07-18 21:47:24] INFO train_model: dist_to_fib_100: mean=0.4638, std=0.4822, min=0.0060, max=6.8340, unique=2741
[2025-07-18 21:47:24] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3388
[2025-07-18 21:47:24] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-18 21:47:24] INFO train_model: trendline_up: mean=0.4903, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: trendline_down: mean=0.5017, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: dist_to_high: mean=-0.4386, std=0.4965, min=-6.7220, max=3.3740, unique=2742
[2025-07-18 21:47:24] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8340, unique=2784
[2025-07-18 21:47:24] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: vol_spike_std: mean=0.1294, std=0.3357, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:47:24] INFO train_model: supply_zone: mean=0.4136, std=0.4925, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:24] INFO train_model: demand_zone: mean=0.3782, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:27] INFO train_model: Model is starting a new training session...
[2025-07-18 21:47:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:47:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-18 21:47:27] INFO train_model: Preparing target variable...
[2025-07-18 21:47:27] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:47:27] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:47:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-18 21:47:27] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:47:27] INFO train_model: Dropping NaN targets...
[2025-07-18 21:47:27] INFO train_model: Class balance before upsampling: {0: 3065, 1: 1657}
[2025-07-18 21:47:27] INFO train_model: Upsampling successful.
[2025-07-18 21:47:27] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:47:27] INFO train_model: Splitting train/test...
[2025-07-18 21:47:27] INFO train_model: Scaling features...
[2025-07-18 21:47:27] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:47:27] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:47:29] INFO train_model: Model fit complete.
[2025-07-18 21:47:29] INFO train_model: Model Accuracy: 0.8613
[2025-07-18 21:47:29] INFO train_model: 
Classification Report:
[2025-07-18 21:47:29] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.84      0.86       613
           1       0.85      0.88      0.86       613

    accuracy                           0.86      1226
   macro avg       0.86      0.86      0.86      1226
weighted avg       0.86      0.86      0.86      1226

[2025-07-18 21:47:29] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-18 21:47:29] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "5c2219656f1d107b1dd226e5f55bc492" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "5c2219656f1d107b1dd226e5f55bc492" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': '5c2219656f1d107b1dd226e5f55bc492'}}
[2025-07-18 21:47:29] INFO train_model: Feature distributions before training:
[2025-07-18 21:47:29] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8441, unique=4710
[2025-07-18 21:47:29] INFO train_model: volatility_20: mean=0.2229, std=0.2570, min=0.0393, max=3.3139, unique=4700
[2025-07-18 21:47:29] INFO train_model: sma_20: mean=87.3660, std=2.2041, min=81.5998, max=92.2272, unique=4699
[2025-07-18 21:47:29] INFO train_model: sma_50: mean=87.3740, std=2.1960, min=82.0270, max=91.9825, unique=4670
[2025-07-18 21:47:29] INFO train_model: sma_200: mean=87.4220, std=2.1969, min=83.2736, max=91.5912, unique=4518
[2025-07-18 21:47:29] INFO train_model: ema_12: mean=87.3639, std=2.2039, min=81.3860, max=92.2433, unique=4722
[2025-07-18 21:47:29] INFO train_model: ema_26: mean=87.3676, std=2.1961, min=81.7433, max=92.1009, unique=4722
[2025-07-18 21:47:29] INFO train_model: rsi_14: mean=49.8985, std=11.8511, min=11.9091, max=86.8743, unique=4682
[2025-07-18 21:47:29] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4460, unique=4697
[2025-07-18 21:47:29] INFO train_model: macd_signal: mean=-0.0040, std=0.1245, min=-0.6881, max=0.9525, unique=4689
[2025-07-18 21:47:29] INFO train_model: bb_high: mean=87.8005, std=2.1268, min=82.3688, max=92.6084, unique=4701
[2025-07-18 21:47:29] INFO train_model: bb_low: mean=86.9316, std=2.3863, min=77.4318, max=92.0349, unique=4701
[2025-07-18 21:47:29] INFO train_model: stoch_k: mean=51.5665, std=26.9502, min=0.7728, max=239.3692, unique=4670
[2025-07-18 21:47:29] INFO train_model: stoch_d: mean=51.5588, std=24.5765, min=3.8824, max=173.4048, unique=4696
[2025-07-18 21:47:29] INFO train_model: fib_0: mean=87.8001, std=2.1201, min=82.4090, max=92.4600, unique=1115
[2025-07-18 21:47:29] INFO train_model: dist_to_fib_0: mean=-0.4380, std=0.4917, min=-6.7800, max=3.6510, unique=2674
[2025-07-18 21:47:29] INFO train_model: fib_236: mean=87.5873, std=2.1514, min=81.9488, max=92.3562, unique=2139
[2025-07-18 21:47:29] INFO train_model: dist_to_fib_236: mean=-0.2252, std=0.4029, min=-5.1658, max=4.4022, unique=4666
[2025-07-18 21:47:29] INFO train_model: fib_382: mean=87.4556, std=2.1760, min=81.6641, max=92.2919, unique=2139
[2025-07-18 21:47:29] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8669, unique=4666
[2025-07-18 21:47:29] INFO train_model: fib_500: mean=87.3492, std=2.1988, min=81.4340, max=92.2400, unique=2083
[2025-07-18 21:47:29] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2425, unique=4264
[2025-07-18 21:47:29] INFO train_model: fib_618: mean=87.2428, std=2.2240, min=81.2039, max=92.1881, unique=2139
[2025-07-18 21:47:29] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6181, unique=4665
[2025-07-18 21:47:29] INFO train_model: fib_786: mean=87.0913, std=2.2639, min=80.8763, max=92.1142, unique=2139
[2025-07-18 21:47:29] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1528, unique=4665
[2025-07-18 21:47:29] INFO train_model: fib_100: mean=86.8984, std=2.3213, min=80.4530, max=92.0200, unique=1083
[2025-07-18 21:47:29] INFO train_model: dist_to_fib_100: mean=0.4638, std=0.4822, min=0.0060, max=6.8340, unique=2741
[2025-07-18 21:47:29] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3388
[2025-07-18 21:47:29] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-18 21:47:29] INFO train_model: trendline_up: mean=0.4903, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: trendline_down: mean=0.5017, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: dist_to_high: mean=-0.4386, std=0.4965, min=-6.7220, max=3.3740, unique=2742
[2025-07-18 21:47:29] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8340, unique=2784
[2025-07-18 21:47:29] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: vol_spike_std: mean=0.1294, std=0.3357, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:47:29] INFO train_model: supply_zone: mean=0.4136, std=0.4925, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:47:29] INFO train_model: demand_zone: mean=0.3782, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:23] INFO train_model: Model is starting a new training session...
[2025-07-18 21:48:23] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:48:23] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-18 21:48:23] INFO train_model: Preparing target variable...
[2025-07-18 21:48:23] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:48:23] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:48:23] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-18 21:48:23] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:48:23] INFO train_model: Dropping NaN targets...
[2025-07-18 21:48:23] INFO train_model: Class balance before upsampling: {0: 1754, 1: 1649}
[2025-07-18 21:48:23] INFO train_model: Upsampling successful.
[2025-07-18 21:48:23] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:48:23] INFO train_model: Splitting train/test...
[2025-07-18 21:48:23] INFO train_model: Scaling features...
[2025-07-18 21:48:23] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:48:23] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:48:25] INFO train_model: Model fit complete.
[2025-07-18 21:48:25] INFO train_model: Model Accuracy: 0.8419
[2025-07-18 21:48:25] INFO train_model: 
Classification Report:
[2025-07-18 21:48:25] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.88      0.85       351
           1       0.87      0.81      0.84       351

    accuracy                           0.84       702
   macro avg       0.84      0.84      0.84       702
weighted avg       0.84      0.84      0.84       702

[2025-07-18 21:48:25] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-18 21:48:25] INFO train_model: Model registered in ModelRegistry for BTCUSD, version 4eb383772e0f571a4c01237d00135b62
[2025-07-18 21:48:25] INFO train_model: Feature distributions before training:
[2025-07-18 21:48:25] INFO train_model: atr_14: mean=775.3843, std=316.1215, min=0.0000, max=2432.8175, unique=3391
[2025-07-18 21:48:25] INFO train_model: volatility_20: mean=826.2720, std=540.9980, min=141.7903, max=3956.2747, unique=3384
[2025-07-18 21:48:25] INFO train_model: sma_20: mean=97510.0073, std=10030.6624, min=76687.9180, max=121103.9988, unique=3384
[2025-07-18 21:48:25] INFO train_model: sma_50: mean=97406.1776, std=9850.0075, min=77951.8447, max=119557.6389, unique=3372
[2025-07-18 21:48:25] INFO train_model: sma_200: mean=97174.0168, std=9266.0905, min=80836.6129, max=118153.3667, unique=3271
[2025-07-18 21:48:25] INFO train_model: ema_12: mean=97550.2593, std=10066.2502, min=76579.0411, max=121438.5343, unique=3403
[2025-07-18 21:48:25] INFO train_model: ema_26: mean=97492.2006, std=9972.9217, min=77204.8141, max=120532.2026, unique=3403
[2025-07-18 21:48:25] INFO train_model: rsi_14: mean=51.9578, std=12.7134, min=12.9206, max=94.1391, unique=3390
[2025-07-18 21:48:25] INFO train_model: macd: mean=56.9855, std=548.8429, min=-1881.4601, max=2409.3781, unique=3380
[2025-07-18 21:48:25] INFO train_model: macd_signal: mean=51.6079, std=509.6646, min=-1668.9823, max=2004.6298, unique=3379
[2025-07-18 21:48:25] INFO train_model: bb_high: mean=99120.7080, std=9936.5187, min=77878.7912, max=123631.2152, unique=3384
[2025-07-18 21:48:25] INFO train_model: bb_low: mean=95899.3066, std=10233.1975, min=73141.7504, max=119063.2808, unique=3384
[2025-07-18 21:48:25] INFO train_model: stoch_k: mean=53.4931, std=27.3517, min=0.0000, max=100.0000, unique=3379
[2025-07-18 21:48:25] INFO train_model: stoch_d: mean=53.6256, std=24.8203, min=4.9246, max=97.8432, unique=3388
[2025-07-18 21:48:25] INFO train_model: fib_0: mean=99143.5968, std=9931.2892, min=77879.0234, max=123077.6328, unique=884
[2025-07-18 21:48:25] INFO train_model: dist_to_fib_0: mean=-1534.7218, std=1431.2623, min=-10522.6016, max=0.0000, unique=3368
[2025-07-18 21:48:25] INFO train_model: fib_236: mean=98344.1556, std=9981.8390, min=77124.2364, max=122164.0787, unique=1602
[2025-07-18 21:48:25] INFO train_model: dist_to_fib_236: mean=-735.2806, std=1220.5316, min=-7889.1863, max=2479.4287, unique=3384
[2025-07-18 21:48:25] INFO train_model: fib_382: mean=97849.5861, std=10022.0370, min=76657.2919, max=121598.9138, unique=1602
[2025-07-18 21:48:25] INFO train_model: dist_to_fib_382: mean=-240.7111, std=1151.2498, min=-6260.0396, max=4013.8442, unique=3384
[2025-07-18 21:48:25] INFO train_model: fib_500: mean=97449.8655, std=10059.4454, min=76279.8984, max=121142.1367, unique=1602
[2025-07-18 21:48:25] INFO train_model: dist_to_fib_500: mean=159.0095, std=1137.4900, min=-4943.3320, max=5253.9883, unique=3378
[2025-07-18 21:48:25] INFO train_model: fib_618: mean=97050.1449, std=10101.1993, min=75902.5049, max=120685.3596, unique=1602
[2025-07-18 21:48:25] INFO train_model: dist_to_fib_618: mean=558.7301, std=1163.1683, min=-3626.6244, max=6494.1323, unique=3384
[2025-07-18 21:48:25] INFO train_model: fib_786: mean=96481.0512, std=10168.0366, min=75365.1989, max=120035.0330, unique=1602
[2025-07-18 21:48:25] INFO train_model: dist_to_fib_786: mean=1127.8238, std=1262.2739, min=-1751.9899, max=8259.7611, unique=3384
[2025-07-18 21:48:25] INFO train_model: fib_100: mean=95756.1342, std=10265.5013, min=74467.7031, max=119206.6406, unique=924
[2025-07-18 21:48:25] INFO train_model: dist_to_fib_100: mean=1852.7408, std=1471.5280, min=0.0000, max=10508.8359, unique=3363
[2025-07-18 21:48:25] INFO train_model: trendline_slope_high: mean=10.1005, std=110.4311, min=-488.7707, max=418.4305, unique=3377
[2025-07-18 21:48:25] INFO train_model: trendline_slope_low: mean=8.9953, std=114.8168, min=-487.6711, max=479.1137, unique=3382
[2025-07-18 21:48:25] INFO train_model: trendline_up: mean=0.5386, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: trendline_down: mean=0.4475, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: breakout_high: mean=0.0103, std=0.1009, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: breakout_low: mean=0.0132, std=0.1142, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: dist_to_high: mean=-1512.2685, std=1488.6810, min=-10522.6016, max=250.3906, unique=3387
[2025-07-18 21:48:25] INFO train_model: dist_to_low: mean=1859.1558, std=1537.3110, min=-257.3125, max=10508.8359, unique=3391
[2025-07-18 21:48:25] INFO train_model: vol_spike_atr: mean=0.0408, std=0.1980, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: vol_spike_std: mean=0.1772, std=0.3819, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: is_trending: mean=0.0235, std=0.1515, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:48:25] INFO train_model: supply_zone: mean=0.2207, std=0.4148, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:25] INFO train_model: demand_zone: mean=0.1663, std=0.3724, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:27] INFO train_model: Model is starting a new training session...
[2025-07-18 21:48:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-18 21:48:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-18 21:48:27] INFO train_model: Preparing target variable...
[2025-07-18 21:48:27] INFO train_model: Entering prepare_target_variable
[2025-07-18 21:48:27] INFO train_model: Exiting prepare_target_variable
[2025-07-18 21:48:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-18 21:48:27] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-18 21:48:27] INFO train_model: Dropping NaN targets...
[2025-07-18 21:48:28] INFO train_model: Class balance before upsampling: {0: 1754, 1: 1649}
[2025-07-18 21:48:28] INFO train_model: Upsampling successful.
[2025-07-18 21:48:28] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-18 21:48:28] INFO train_model: Splitting train/test...
[2025-07-18 21:48:28] INFO train_model: Scaling features...
[2025-07-18 21:48:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-18 21:48:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-18 21:48:29] INFO train_model: Model fit complete.
[2025-07-18 21:48:29] INFO train_model: Model Accuracy: 0.8419
[2025-07-18 21:48:29] INFO train_model: 
Classification Report:
[2025-07-18 21:48:29] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.88      0.85       351
           1       0.87      0.81      0.84       351

    accuracy                           0.84       702
   macro avg       0.84      0.84      0.84       702
weighted avg       0.84      0.84      0.84       702

[2025-07-18 21:48:29] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-18 21:48:29] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "4eb383772e0f571a4c01237d00135b62" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "4eb383772e0f571a4c01237d00135b62" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_BTCUSD', 'version': '4eb383772e0f571a4c01237d00135b62'}}
[2025-07-18 21:48:29] INFO train_model: Feature distributions before training:
[2025-07-18 21:48:29] INFO train_model: atr_14: mean=775.3843, std=316.1215, min=0.0000, max=2432.8175, unique=3391
[2025-07-18 21:48:29] INFO train_model: volatility_20: mean=826.2720, std=540.9980, min=141.7903, max=3956.2747, unique=3384
[2025-07-18 21:48:29] INFO train_model: sma_20: mean=97510.0073, std=10030.6624, min=76687.9180, max=121103.9988, unique=3384
[2025-07-18 21:48:29] INFO train_model: sma_50: mean=97406.1776, std=9850.0075, min=77951.8447, max=119557.6389, unique=3372
[2025-07-18 21:48:29] INFO train_model: sma_200: mean=97174.0168, std=9266.0905, min=80836.6129, max=118153.3667, unique=3271
[2025-07-18 21:48:29] INFO train_model: ema_12: mean=97550.2593, std=10066.2502, min=76579.0411, max=121438.5343, unique=3403
[2025-07-18 21:48:29] INFO train_model: ema_26: mean=97492.2006, std=9972.9217, min=77204.8141, max=120532.2026, unique=3403
[2025-07-18 21:48:29] INFO train_model: rsi_14: mean=51.9578, std=12.7134, min=12.9206, max=94.1391, unique=3390
[2025-07-18 21:48:29] INFO train_model: macd: mean=56.9855, std=548.8429, min=-1881.4601, max=2409.3781, unique=3380
[2025-07-18 21:48:29] INFO train_model: macd_signal: mean=51.6079, std=509.6646, min=-1668.9823, max=2004.6298, unique=3379
[2025-07-18 21:48:29] INFO train_model: bb_high: mean=99120.7080, std=9936.5187, min=77878.7912, max=123631.2152, unique=3384
[2025-07-18 21:48:29] INFO train_model: bb_low: mean=95899.3066, std=10233.1975, min=73141.7504, max=119063.2808, unique=3384
[2025-07-18 21:48:29] INFO train_model: stoch_k: mean=53.4931, std=27.3517, min=0.0000, max=100.0000, unique=3379
[2025-07-18 21:48:29] INFO train_model: stoch_d: mean=53.6256, std=24.8203, min=4.9246, max=97.8432, unique=3388
[2025-07-18 21:48:29] INFO train_model: fib_0: mean=99143.5968, std=9931.2892, min=77879.0234, max=123077.6328, unique=884
[2025-07-18 21:48:29] INFO train_model: dist_to_fib_0: mean=-1534.7218, std=1431.2623, min=-10522.6016, max=0.0000, unique=3368
[2025-07-18 21:48:29] INFO train_model: fib_236: mean=98344.1556, std=9981.8390, min=77124.2364, max=122164.0787, unique=1602
[2025-07-18 21:48:29] INFO train_model: dist_to_fib_236: mean=-735.2806, std=1220.5316, min=-7889.1863, max=2479.4287, unique=3384
[2025-07-18 21:48:29] INFO train_model: fib_382: mean=97849.5861, std=10022.0370, min=76657.2919, max=121598.9138, unique=1602
[2025-07-18 21:48:29] INFO train_model: dist_to_fib_382: mean=-240.7111, std=1151.2498, min=-6260.0396, max=4013.8442, unique=3384
[2025-07-18 21:48:29] INFO train_model: fib_500: mean=97449.8655, std=10059.4454, min=76279.8984, max=121142.1367, unique=1602
[2025-07-18 21:48:29] INFO train_model: dist_to_fib_500: mean=159.0095, std=1137.4900, min=-4943.3320, max=5253.9883, unique=3378
[2025-07-18 21:48:29] INFO train_model: fib_618: mean=97050.1449, std=10101.1993, min=75902.5049, max=120685.3596, unique=1602
[2025-07-18 21:48:29] INFO train_model: dist_to_fib_618: mean=558.7301, std=1163.1683, min=-3626.6244, max=6494.1323, unique=3384
[2025-07-18 21:48:29] INFO train_model: fib_786: mean=96481.0512, std=10168.0366, min=75365.1989, max=120035.0330, unique=1602
[2025-07-18 21:48:29] INFO train_model: dist_to_fib_786: mean=1127.8238, std=1262.2739, min=-1751.9899, max=8259.7611, unique=3384
[2025-07-18 21:48:29] INFO train_model: fib_100: mean=95756.1342, std=10265.5013, min=74467.7031, max=119206.6406, unique=924
[2025-07-18 21:48:29] INFO train_model: dist_to_fib_100: mean=1852.7408, std=1471.5280, min=0.0000, max=10508.8359, unique=3363
[2025-07-18 21:48:29] INFO train_model: trendline_slope_high: mean=10.1005, std=110.4311, min=-488.7707, max=418.4305, unique=3377
[2025-07-18 21:48:29] INFO train_model: trendline_slope_low: mean=8.9953, std=114.8168, min=-487.6711, max=479.1137, unique=3382
[2025-07-18 21:48:29] INFO train_model: trendline_up: mean=0.5386, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: trendline_down: mean=0.4475, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: breakout_high: mean=0.0103, std=0.1009, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: breakout_low: mean=0.0132, std=0.1142, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: dist_to_high: mean=-1512.2685, std=1488.6810, min=-10522.6016, max=250.3906, unique=3387
[2025-07-18 21:48:29] INFO train_model: dist_to_low: mean=1859.1558, std=1537.3110, min=-257.3125, max=10508.8359, unique=3391
[2025-07-18 21:48:29] INFO train_model: vol_spike_atr: mean=0.0408, std=0.1980, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: vol_spike_std: mean=0.1772, std=0.3819, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: is_trending: mean=0.0235, std=0.1515, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-18 21:48:29] INFO train_model: supply_zone: mean=0.2207, std=0.4148, min=0.0000, max=1.0000, unique=2
[2025-07-18 21:48:29] INFO train_model: demand_zone: mean=0.1663, std=0.3724, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:21] INFO train_model: Model is starting a new training session...
[2025-07-19 00:00:21] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:00:21] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:00:21] INFO train_model: Preparing target variable...
[2025-07-19 00:00:21] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:00:21] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:00:21] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:00:21] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:00:21] INFO train_model: Dropping NaN targets...
[2025-07-19 00:00:21] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 00:00:21] INFO train_model: Upsampling successful.
[2025-07-19 00:00:21] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:00:21] INFO train_model: Splitting train/test...
[2025-07-19 00:00:21] INFO train_model: Scaling features...
[2025-07-19 00:00:21] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:00:21] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:00:24] INFO train_model: Model fit complete.
[2025-07-19 00:00:24] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 00:00:24] INFO train_model: 
Classification Report:
[2025-07-19 00:00:24] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 00:00:24] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 00:00:24] INFO train_model: Model registered in ModelRegistry for EURUSD, version c91140e1dc00d2cb1ca730fcaf6eed6a
[2025-07-19 00:00:24] INFO train_model: Feature distributions before training:
[2025-07-19 00:00:24] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 00:00:24] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 00:00:24] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 00:00:24] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 00:00:24] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 00:00:24] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 00:00:24] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 00:00:24] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 00:00:24] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 00:00:24] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 00:00:24] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 00:00:24] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 00:00:24] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 00:00:24] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 00:00:24] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 00:00:24] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 00:00:24] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 00:00:24] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 00:00:24] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 00:00:24] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 00:00:24] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 00:00:24] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 00:00:24] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 00:00:24] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 00:00:24] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 00:00:24] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 00:00:24] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 00:00:24] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 00:00:24] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 00:00:24] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 00:00:24] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 00:00:24] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 00:00:24] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:24] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:24] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:27] INFO train_model: Model is starting a new training session...
[2025-07-19 00:00:27] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:00:27] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:00:27] INFO train_model: Preparing target variable...
[2025-07-19 00:00:27] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:00:27] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:00:27] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:00:27] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:00:27] INFO train_model: Dropping NaN targets...
[2025-07-19 00:00:27] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 00:00:27] INFO train_model: Upsampling successful.
[2025-07-19 00:00:27] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:00:27] INFO train_model: Splitting train/test...
[2025-07-19 00:00:27] INFO train_model: Scaling features...
[2025-07-19 00:00:27] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:00:27] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:00:29] INFO train_model: Model fit complete.
[2025-07-19 00:00:29] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 00:00:29] INFO train_model: 
Classification Report:
[2025-07-19 00:00:29] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 00:00:29] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 00:00:29] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 00:00:29] INFO train_model: Feature distributions before training:
[2025-07-19 00:00:29] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 00:00:29] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 00:00:29] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 00:00:29] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 00:00:29] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 00:00:29] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 00:00:29] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 00:00:29] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 00:00:29] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 00:00:29] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 00:00:29] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 00:00:29] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 00:00:29] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 00:00:29] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 00:00:29] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 00:00:29] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 00:00:29] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 00:00:29] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 00:00:29] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 00:00:29] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 00:00:29] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 00:00:29] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 00:00:29] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 00:00:29] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 00:00:29] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 00:00:29] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 00:00:29] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 00:00:29] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 00:00:29] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 00:00:29] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 00:00:29] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 00:00:29] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 00:00:29] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:29] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:29] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:45] INFO train_model: Model is starting a new training session...
[2025-07-19 00:00:45] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:00:45] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 00:00:45] INFO train_model: Preparing target variable...
[2025-07-19 00:00:45] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:00:45] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:00:45] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 00:00:45] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:00:45] INFO train_model: Dropping NaN targets...
[2025-07-19 00:00:45] INFO train_model: Class balance before upsampling: {0: 3110, 1: 1592}
[2025-07-19 00:00:45] INFO train_model: Upsampling successful.
[2025-07-19 00:00:45] INFO train_model: Splitting train/test...
[2025-07-19 00:00:45] INFO train_model: Scaling features...
[2025-07-19 00:00:45] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:00:45] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:00:46] INFO train_model: Model fit complete.
[2025-07-19 00:00:46] INFO train_model: Model Accuracy: 0.8207
[2025-07-19 00:00:46] INFO train_model: 
Classification Report:
[2025-07-19 00:00:46] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.81      0.82       622
           1       0.81      0.83      0.82       622

    accuracy                           0.82      1244
   macro avg       0.82      0.82      0.82      1244
weighted avg       0.82      0.82      0.82      1244

[2025-07-19 00:00:46] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 00:00:46] INFO train_model: Model registered in ModelRegistry for USDJPY, version b1091431cfcc446e2d165f9167d0771d
[2025-07-19 00:00:46] INFO train_model: Feature distributions before training:
[2025-07-19 00:00:46] INFO train_model: atr_14: mean=0.3416, std=0.1040, min=0.0000, max=0.9927, unique=4690
[2025-07-19 00:00:46] INFO train_model: volatility_20: mean=0.3279, std=0.1837, min=0.0344, max=1.3004, unique=4683
[2025-07-19 00:00:46] INFO train_model: sma_20: mean=149.6241, std=4.6995, min=140.5323, max=158.2940, unique=4678
[2025-07-19 00:00:46] INFO train_model: sma_50: mean=149.6263, std=4.6784, min=140.8684, max=158.1650, unique=4652
[2025-07-19 00:00:46] INFO train_model: sma_200: mean=149.6799, std=4.5836, min=142.1838, max=157.7724, unique=4500
[2025-07-19 00:00:46] INFO train_model: ema_12: mean=149.6229, std=4.7011, min=140.4143, max=158.3392, unique=4702
[2025-07-19 00:00:46] INFO train_model: ema_26: mean=149.6240, std=4.6866, min=140.6181, max=158.2242, unique=4702
[2025-07-19 00:00:46] INFO train_model: rsi_14: mean=50.5788, std=12.9257, min=8.6902, max=92.4381, unique=4676
[2025-07-19 00:00:46] INFO train_model: macd: mean=-0.0008, std=0.2229, min=-0.9230, max=0.8730, unique=4677
[2025-07-19 00:00:46] INFO train_model: macd_signal: mean=-0.0012, std=0.2088, min=-0.8065, max=0.7956, unique=4669
[2025-07-19 00:00:46] INFO train_model: bb_high: mean=150.2633, std=4.6767, min=140.9707, max=158.5972, unique=4683
[2025-07-19 00:00:46] INFO train_model: bb_low: mean=148.9849, std=4.7491, min=139.2981, max=158.0618, unique=4683
[2025-07-19 00:00:46] INFO train_model: stoch_k: mean=52.3511, std=27.0512, min=0.0000, max=99.6649, unique=4670
[2025-07-19 00:00:46] INFO train_model: stoch_d: mean=52.3592, std=25.0024, min=3.8543, max=96.6848, unique=4685
[2025-07-19 00:00:46] INFO train_model: fib_0: mean=150.2887, std=4.6576, min=141.0760, max=158.8790, unique=1210
[2025-07-19 00:00:46] INFO train_model: dist_to_fib_0: mean=-0.6650, std=0.5552, min=-5.0610, max=-0.0050, unique=2187
[2025-07-19 00:00:46] INFO train_model: fib_236: mean=149.9633, std=4.6650, min=140.8676, max=158.5797, unique=2255
[2025-07-19 00:00:46] INFO train_model: dist_to_fib_236: mean=-0.3396, std=0.4875, min=-3.8081, max=0.7712, unique=4659
[2025-07-19 00:00:46] INFO train_model: fib_382: mean=149.7620, std=4.6718, min=140.6792, max=158.3946, unique=2255
[2025-07-19 00:00:46] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4631, min=-3.0330, max=1.2871, unique=4659
[2025-07-19 00:00:46] INFO train_model: fib_500: mean=149.5993, std=4.6786, min=140.5270, max=158.2450, unique=2206
[2025-07-19 00:00:46] INFO train_model: dist_to_fib_500: mean=0.0245, std=0.4552, min=-2.4065, max=1.7885, unique=3611
[2025-07-19 00:00:46] INFO train_model: fib_618: mean=149.4365, std=4.6864, min=140.3748, max=158.1640, unique=2255
[2025-07-19 00:00:46] INFO train_model: dist_to_fib_618: mean=0.1872, std=0.4585, min=-1.7800, max=2.2899, unique=4659
[2025-07-19 00:00:46] INFO train_model: fib_786: mean=149.2049, std=4.6994, min=140.1581, max=158.0580, unique=2255
[2025-07-19 00:00:46] INFO train_model: dist_to_fib_786: mean=0.4188, std=0.4819, min=-0.8881, max=3.0037, unique=4659
[2025-07-19 00:00:46] INFO train_model: fib_100: mean=148.9098, std=4.7190, min=139.8820, max=157.9230, unique=1168
[2025-07-19 00:00:46] INFO train_model: dist_to_fib_100: mean=0.7139, std=0.5389, min=0.0000, max=3.9130, unique=2197
[2025-07-19 00:00:46] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=2986
[2025-07-19 00:00:46] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3048
[2025-07-19 00:00:46] INFO train_model: trendline_up: mean=0.5040, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: dist_to_high: mean=-0.6653, std=0.5818, min=-5.0610, max=0.5750, unique=2227
[2025-07-19 00:00:46] INFO train_model: dist_to_low: mean=0.7120, std=0.5649, min=-0.3640, max=3.9130, unique=2274
[2025-07-19 00:00:46] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: supply_zone: mean=0.4370, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: demand_zone: mean=0.3694, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: choch: mean=0.1436, std=0.3507, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4682
[2025-07-19 00:00:46] INFO train_model: vol_cluster_high: mean=0.1014, std=0.3020, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: regime_zscore: mean=-0.0187, std=1.0033, min=-5.8436, max=6.5511, unique=4602
[2025-07-19 00:00:46] INFO train_model: doji: mean=0.1104, std=0.3134, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: hammer: mean=0.0262, std=0.1596, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: pin_bar: mean=0.2890, std=0.4534, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1780, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: rising_wedge: mean=0.2682, std=0.4431, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: falling_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bullish_flag: mean=0.0196, std=0.1385, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bearish_flag: mean=0.0217, std=0.1457, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bullish_pennant: mean=0.1280, std=0.3342, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bearish_pennant: mean=0.1359, std=0.3427, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: morning_star: mean=0.0404, std=0.1969, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: evening_star: mean=0.0362, std=0.1867, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bullish_harami: mean=0.0549, std=0.2278, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: bearish_harami: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: dark_cloud_cover: mean=0.1187, std=0.3234, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: regime_label_bear: mean=0.4828, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: regime_label_bull: mean=0.4747, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: market_regime_choppy: mean=0.2401, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: market_regime_downtrend: mean=0.2886, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: market_regime_range: mean=0.2512, std=0.4337, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: market_regime_uptrend: mean=0.2201, std=0.4144, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:46] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:46] INFO train_model: Auditing data quality before training...
[2025-07-19 00:00:46] INFO train_model: Entering audit_data_quality
[2025-07-19 00:00:50] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 00:00:50] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 00:00:50] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 00:00:50] INFO train_model: Entering audit_data_quality
[2025-07-19 00:00:54] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:00:54] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:00:54] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:00:54] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-19 00:00:54] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 00:00:54] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 00:00:54] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 00:00:54] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 00:00:57] INFO train_model: Model is starting a new training session...
[2025-07-19 00:00:57] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:00:57] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:00:57] INFO train_model: Preparing target variable...
[2025-07-19 00:00:57] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:00:57] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:00:57] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:00:57] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:00:57] INFO train_model: Dropping NaN targets...
[2025-07-19 00:00:57] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 00:00:57] INFO train_model: Upsampling successful.
[2025-07-19 00:00:57] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:00:57] INFO train_model: Splitting train/test...
[2025-07-19 00:00:57] INFO train_model: Scaling features...
[2025-07-19 00:00:57] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:00:57] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:00:59] INFO train_model: Model fit complete.
[2025-07-19 00:00:59] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 00:00:59] INFO train_model: 
Classification Report:
[2025-07-19 00:00:59] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 00:00:59] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 00:00:59] INFO train_model: Model registered in ModelRegistry for USDJPY, version d2a3f9696a22ac049479f92536f55c6d
[2025-07-19 00:00:59] INFO train_model: Feature distributions before training:
[2025-07-19 00:00:59] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 00:00:59] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 00:00:59] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 00:00:59] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 00:00:59] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 00:00:59] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 00:00:59] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 00:00:59] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 00:00:59] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 00:00:59] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 00:00:59] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 00:00:59] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 00:00:59] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 00:00:59] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 00:00:59] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 00:00:59] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 00:00:59] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 00:00:59] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 00:00:59] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 00:00:59] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 00:00:59] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 00:00:59] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 00:00:59] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 00:00:59] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 00:00:59] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 00:00:59] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 00:00:59] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 00:00:59] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 00:00:59] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 00:00:59] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 00:00:59] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 00:00:59] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 00:00:59] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:00:59] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:00:59] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:13] INFO train_model: Model is starting a new training session...
[2025-07-19 00:01:13] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:01:13] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:01:13] INFO train_model: Preparing target variable...
[2025-07-19 00:01:13] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:01:13] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:01:13] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:01:13] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:01:13] INFO train_model: Dropping NaN targets...
[2025-07-19 00:01:13] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 00:01:13] INFO train_model: Upsampling successful.
[2025-07-19 00:01:13] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:01:13] INFO train_model: Splitting train/test...
[2025-07-19 00:01:13] INFO train_model: Scaling features...
[2025-07-19 00:01:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:01:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:01:15] INFO train_model: Model fit complete.
[2025-07-19 00:01:15] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 00:01:15] INFO train_model: 
Classification Report:
[2025-07-19 00:01:15] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 00:01:15] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 00:01:15] INFO train_model: Model registered in ModelRegistry for USDJPY, version d6e3be744efa17b9ae37e0677c855588
[2025-07-19 00:01:15] INFO train_model: Feature distributions before training:
[2025-07-19 00:01:15] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 00:01:15] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 00:01:15] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 00:01:15] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 00:01:15] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 00:01:15] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 00:01:15] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 00:01:15] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 00:01:15] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 00:01:15] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 00:01:15] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 00:01:15] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 00:01:15] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 00:01:15] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 00:01:15] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 00:01:15] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 00:01:15] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 00:01:15] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 00:01:15] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 00:01:15] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 00:01:15] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 00:01:15] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 00:01:15] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 00:01:15] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 00:01:15] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 00:01:15] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 00:01:15] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 00:01:15] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 00:01:15] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 00:01:15] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 00:01:15] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 00:01:15] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 00:01:15] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:15] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:15] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:28] INFO train_model: Model is starting a new training session...
[2025-07-19 00:01:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:01:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-19 00:01:28] INFO train_model: Preparing target variable...
[2025-07-19 00:01:28] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:01:28] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:01:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-19 00:01:28] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:01:28] INFO train_model: Dropping NaN targets...
[2025-07-19 00:01:28] INFO train_model: Class balance before upsampling: {0: 3430, 1: 1272}
[2025-07-19 00:01:29] INFO train_model: Upsampling successful.
[2025-07-19 00:01:29] INFO train_model: Splitting train/test...
[2025-07-19 00:01:29] INFO train_model: Scaling features...
[2025-07-19 00:01:29] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:01:29] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:01:30] INFO train_model: Model fit complete.
[2025-07-19 00:01:30] INFO train_model: Model Accuracy: 0.8754
[2025-07-19 00:01:30] INFO train_model: 
Classification Report:
[2025-07-19 00:01:30] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.87      0.87       686
           1       0.87      0.88      0.88       686

    accuracy                           0.88      1372
   macro avg       0.88      0.88      0.88      1372
weighted avg       0.88      0.88      0.88      1372

[2025-07-19 00:01:30] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 00:01:30] INFO train_model: Model registered in ModelRegistry for USDCHF, version 1c32864d0edae82c3b1b65620192ce7b
[2025-07-19 00:01:30] INFO train_model: Feature distributions before training:
[2025-07-19 00:01:30] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4690
[2025-07-19 00:01:30] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4678
[2025-07-19 00:01:30] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4654
[2025-07-19 00:01:30] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4641
[2025-07-19 00:01:30] INFO train_model: sma_200: mean=0.8643, std=0.0363, min=0.7943, max=0.9132, unique=4497
[2025-07-19 00:01:30] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4702
[2025-07-19 00:01:30] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4702
[2025-07-19 00:01:30] INFO train_model: rsi_14: mean=49.8641, std=12.3936, min=7.7095, max=97.7161, unique=4663
[2025-07-19 00:01:30] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4677
[2025-07-19 00:01:30] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4669
[2025-07-19 00:01:30] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4678
[2025-07-19 00:01:30] INFO train_model: bb_low: mean=0.8601, std=0.0381, min=0.7878, max=0.9160, unique=4678
[2025-07-19 00:01:30] INFO train_model: stoch_k: mean=51.0515, std=26.3623, min=0.6580, max=98.9585, unique=4614
[2025-07-19 00:01:30] INFO train_model: stoch_d: mean=51.0710, std=24.0553, min=3.0053, max=95.8670, unique=4678
[2025-07-19 00:01:30] INFO train_model: fib_0: mean=0.8662, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 00:01:30] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=1419
[2025-07-19 00:01:30] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 00:01:30] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4613
[2025-07-19 00:01:30] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 00:01:30] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4613
[2025-07-19 00:01:30] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2007
[2025-07-19 00:01:30] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=2761
[2025-07-19 00:01:30] INFO train_model: fib_618: mean=0.8622, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 00:01:30] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4613
[2025-07-19 00:01:30] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 00:01:30] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4613
[2025-07-19 00:01:30] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 00:01:30] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=1367
[2025-07-19 00:01:30] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=2056
[2025-07-19 00:01:30] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=2075
[2025-07-19 00:01:30] INFO train_model: trendline_up: mean=0.5004, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=1453
[2025-07-19 00:01:30] INFO train_model: dist_to_low: mean=0.0031, std=0.0027, min=-0.0015, max=0.0207, unique=1403
[2025-07-19 00:01:30] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: vol_spike_std: mean=0.1559, std=0.3628, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: supply_zone: mean=0.5019, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: demand_zone: mean=0.4862, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: choch: mean=0.1623, std=0.3687, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4681
[2025-07-19 00:01:30] INFO train_model: vol_cluster_high: mean=0.1061, std=0.3080, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: regime_zscore: mean=-0.0095, std=1.0048, min=-5.9027, max=7.4977, unique=4602
[2025-07-19 00:01:30] INFO train_model: doji: mean=0.1236, std=0.3291, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bullish_engulfing: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bearish_engulfing: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: pin_bar: mean=0.3120, std=0.4634, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bullish_engulfing_bar: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bearish_engulfing_bar: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: inside_bar: mean=0.1427, std=0.3498, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: inv_head_shoulders: mean=0.0313, std=0.1740, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: rising_wedge: mean=0.2250, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: falling_wedge: mean=0.2318, std=0.4220, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: bullish_flag: mean=0.0247, std=0.1551, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bearish_flag: mean=0.0289, std=0.1676, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bullish_pennant: mean=0.1338, std=0.3404, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bearish_pennant: mean=0.1433, std=0.3505, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: morning_star: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: evening_star: mean=0.0402, std=0.1964, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bullish_harami: mean=0.0574, std=0.2327, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: bearish_harami: mean=0.0444, std=0.2061, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: dark_cloud_cover: mean=0.1114, std=0.3147, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: regime_label_bear: mean=0.4866, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: regime_label_bull: mean=0.4709, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1646, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: market_regime_consolidation: mean=0.0542, std=0.2265, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: market_regime_downtrend: mean=0.2254, std=0.4179, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: market_regime_range: mean=0.5270, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: market_regime_uptrend: mean=0.1655, std=0.3716, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:30] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:30] INFO train_model: Auditing data quality before training...
[2025-07-19 00:01:30] INFO train_model: Entering audit_data_quality
[2025-07-19 00:01:34] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 00:01:34] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 00:01:34] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 00:01:34] INFO train_model: Entering audit_data_quality
[2025-07-19 00:01:36] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:01:36] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:01:36] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:01:36] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDCHF_features.json
[2025-07-19 00:01:36] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 00:01:36] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 00:01:36] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 00:01:36] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 00:01:39] INFO train_model: Model is starting a new training session...
[2025-07-19 00:01:39] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:01:39] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:01:39] INFO train_model: Preparing target variable...
[2025-07-19 00:01:39] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:01:39] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:01:39] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:01:39] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:01:39] INFO train_model: Dropping NaN targets...
[2025-07-19 00:01:39] INFO train_model: Class balance before upsampling: {0: 3426, 1: 1272}
[2025-07-19 00:01:39] INFO train_model: Upsampling successful.
[2025-07-19 00:01:39] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:01:39] INFO train_model: Splitting train/test...
[2025-07-19 00:01:39] INFO train_model: Scaling features...
[2025-07-19 00:01:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:01:39] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:01:42] INFO train_model: Model fit complete.
[2025-07-19 00:01:42] INFO train_model: Model Accuracy: 0.9059
[2025-07-19 00:01:42] INFO train_model: 
Classification Report:
[2025-07-19 00:01:42] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.90      0.91       686
           1       0.90      0.91      0.91       685

    accuracy                           0.91      1371
   macro avg       0.91      0.91      0.91      1371
weighted avg       0.91      0.91      0.91      1371

[2025-07-19 00:01:42] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 00:01:42] INFO train_model: Model registered in ModelRegistry for USDCHF, version a36a889b62f1371c96a2129e8900e40e
[2025-07-19 00:01:42] INFO train_model: Feature distributions before training:
[2025-07-19 00:01:42] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4686
[2025-07-19 00:01:42] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4674
[2025-07-19 00:01:42] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4672
[2025-07-19 00:01:42] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4646
[2025-07-19 00:01:42] INFO train_model: sma_200: mean=0.8642, std=0.0363, min=0.7943, max=0.9132, unique=4495
[2025-07-19 00:01:42] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4698
[2025-07-19 00:01:42] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4698
[2025-07-19 00:01:42] INFO train_model: rsi_14: mean=49.8631, std=12.3988, min=7.7095, max=97.7161, unique=4664
[2025-07-19 00:01:42] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4673
[2025-07-19 00:01:42] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4665
[2025-07-19 00:01:42] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4677
[2025-07-19 00:01:42] INFO train_model: bb_low: mean=0.8600, std=0.0381, min=0.7878, max=0.9160, unique=4677
[2025-07-19 00:01:42] INFO train_model: stoch_k: mean=51.0566, std=26.3720, min=0.6580, max=98.9585, unique=4646
[2025-07-19 00:01:42] INFO train_model: stoch_d: mean=51.0798, std=24.0633, min=3.0053, max=95.8670, unique=4679
[2025-07-19 00:01:42] INFO train_model: fib_0: mean=0.8661, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 00:01:42] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=2430
[2025-07-19 00:01:42] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 00:01:42] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4619
[2025-07-19 00:01:42] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 00:01:42] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4619
[2025-07-19 00:01:42] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2040
[2025-07-19 00:01:42] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=4125
[2025-07-19 00:01:42] INFO train_model: fib_618: mean=0.8621, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 00:01:42] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4619
[2025-07-19 00:01:42] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 00:01:42] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4619
[2025-07-19 00:01:42] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 00:01:42] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=2380
[2025-07-19 00:01:42] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=3110
[2025-07-19 00:01:42] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=3122
[2025-07-19 00:01:42] INFO train_model: trendline_up: mean=0.5009, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=2487
[2025-07-19 00:01:42] INFO train_model: dist_to_low: mean=0.0032, std=0.0027, min=-0.0015, max=0.0207, unique=2431
[2025-07-19 00:01:42] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: vol_spike_std: mean=0.1560, std=0.3629, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:42] INFO train_model: supply_zone: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:42] INFO train_model: demand_zone: mean=0.4857, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:45] INFO train_model: Model is starting a new training session...
[2025-07-19 00:01:45] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:01:45] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:01:45] INFO train_model: Preparing target variable...
[2025-07-19 00:01:45] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:01:45] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:01:45] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:01:45] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:01:45] INFO train_model: Dropping NaN targets...
[2025-07-19 00:01:45] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 00:01:45] INFO train_model: Upsampling successful.
[2025-07-19 00:01:46] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:01:46] INFO train_model: Splitting train/test...
[2025-07-19 00:01:46] INFO train_model: Scaling features...
[2025-07-19 00:01:46] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:01:46] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:01:48] INFO train_model: Model fit complete.
[2025-07-19 00:01:48] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 00:01:48] INFO train_model: 
Classification Report:
[2025-07-19 00:01:48] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 00:01:48] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 00:01:48] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd6e3be744efa17b9ae37e0677c855588'}}
[2025-07-19 00:01:48] INFO train_model: Feature distributions before training:
[2025-07-19 00:01:48] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 00:01:48] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 00:01:48] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 00:01:48] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 00:01:48] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 00:01:48] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 00:01:48] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 00:01:48] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 00:01:48] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 00:01:48] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 00:01:48] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 00:01:48] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 00:01:48] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 00:01:48] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 00:01:48] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 00:01:48] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 00:01:48] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 00:01:48] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 00:01:48] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 00:01:48] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 00:01:48] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 00:01:48] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 00:01:48] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 00:01:48] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 00:01:48] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 00:01:48] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 00:01:48] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 00:01:48] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 00:01:48] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 00:01:48] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 00:01:48] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 00:01:48] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 00:01:48] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:01:48] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:01:48] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:05] INFO train_model: Model is starting a new training session...
[2025-07-19 00:02:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:02:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-19 00:02:05] INFO train_model: Preparing target variable...
[2025-07-19 00:02:05] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:02:05] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:02:05] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-19 00:02:05] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:05] INFO train_model: Dropping NaN targets...
[2025-07-19 00:02:05] INFO train_model: Class balance before upsampling: {0: 3122, 1: 1638}
[2025-07-19 00:02:05] INFO train_model: Upsampling successful.
[2025-07-19 00:02:05] INFO train_model: Splitting train/test...
[2025-07-19 00:02:05] INFO train_model: Scaling features...
[2025-07-19 00:02:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:02:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:02:06] INFO train_model: Model fit complete.
[2025-07-19 00:02:06] INFO train_model: Model Accuracy: 0.8447
[2025-07-19 00:02:06] INFO train_model: 
Classification Report:
[2025-07-19 00:02:06] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.87      0.85       625
           1       0.86      0.82      0.84       624

    accuracy                           0.84      1249
   macro avg       0.85      0.84      0.84      1249
weighted avg       0.85      0.84      0.84      1249

[2025-07-19 00:02:06] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 00:02:06] INFO train_model: Model registered in ModelRegistry for NZDUSD, version 2bfa20aa78505eabdaf0592f69c66f1d
[2025-07-19 00:02:06] INFO train_model: Feature distributions before training:
[2025-07-19 00:02:06] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4748
[2025-07-19 00:02:06] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4721
[2025-07-19 00:02:06] INFO train_model: sma_20: mean=0.5842, std=0.0158, min=0.5544, max=0.6102, unique=4719
[2025-07-19 00:02:06] INFO train_model: sma_50: mean=0.5842, std=0.0157, min=0.5560, max=0.6092, unique=4691
[2025-07-19 00:02:06] INFO train_model: sma_200: mean=0.5843, std=0.0154, min=0.5597, max=0.6067, unique=4555
[2025-07-19 00:02:06] INFO train_model: ema_12: mean=0.5842, std=0.0158, min=0.5541, max=0.6105, unique=4760
[2025-07-19 00:02:06] INFO train_model: ema_26: mean=0.5842, std=0.0157, min=0.5554, max=0.6098, unique=4760
[2025-07-19 00:02:06] INFO train_model: rsi_14: mean=49.3336, std=12.4278, min=11.3290, max=91.7839, unique=4589
[2025-07-19 00:02:06] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4735
[2025-07-19 00:02:06] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4727
[2025-07-19 00:02:06] INFO train_model: bb_high: mean=0.5866, std=0.0157, min=0.5570, max=0.6121, unique=4721
[2025-07-19 00:02:06] INFO train_model: bb_low: mean=0.5817, std=0.0160, min=0.5486, max=0.6084, unique=4721
[2025-07-19 00:02:06] INFO train_model: stoch_k: mean=49.3172, std=28.9279, min=0.0000, max=100.0000, unique=4564
[2025-07-19 00:02:06] INFO train_model: stoch_d: mean=49.3608, std=26.4954, min=2.3676, max=100.0000, unique=4718
[2025-07-19 00:02:06] INFO train_model: fib_0: mean=0.5867, std=0.0157, min=0.5573, max=0.6122, unique=811
[2025-07-19 00:02:06] INFO train_model: dist_to_fib_0: mean=-0.0025, std=0.0022, min=-0.0229, max=0.0000, unique=4285
[2025-07-19 00:02:06] INFO train_model: fib_236: mean=0.5855, std=0.0157, min=0.5560, max=0.6113, unique=2149
[2025-07-19 00:02:06] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4578
[2025-07-19 00:02:06] INFO train_model: fib_382: mean=0.5848, std=0.0157, min=0.5547, max=0.6107, unique=2149
[2025-07-19 00:02:06] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4578
[2025-07-19 00:02:06] INFO train_model: fib_500: mean=0.5842, std=0.0157, min=0.5537, max=0.6103, unique=2149
[2025-07-19 00:02:06] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4534
[2025-07-19 00:02:06] INFO train_model: fib_618: mean=0.5836, std=0.0158, min=0.5526, max=0.6098, unique=2149
[2025-07-19 00:02:06] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4578
[2025-07-19 00:02:06] INFO train_model: fib_786: mean=0.5827, std=0.0158, min=0.5511, max=0.6092, unique=2149
[2025-07-19 00:02:06] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4578
[2025-07-19 00:02:06] INFO train_model: fib_100: mean=0.5816, std=0.0159, min=0.5492, max=0.6083, unique=817
[2025-07-19 00:02:06] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4255
[2025-07-19 00:02:06] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4611
[2025-07-19 00:02:06] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4611
[2025-07-19 00:02:06] INFO train_model: trendline_up: mean=0.4624, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: trendline_down: mean=0.5235, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: breakout_high: mean=0.0137, std=0.1161, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: breakout_low: mean=0.0174, std=0.1309, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4275
[2025-07-19 00:02:06] INFO train_model: dist_to_low: mean=0.0025, std=0.0023, min=-0.0067, max=0.0157, unique=4250
[2025-07-19 00:02:06] INFO train_model: vol_spike_atr: mean=0.0153, std=0.1229, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: vol_spike_std: mean=0.1334, std=0.3400, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: is_trending: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: supply_zone: mean=0.4107, std=0.4920, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: demand_zone: mean=0.4258, std=0.4945, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: bos: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: choch: mean=0.1508, std=0.3579, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4733
[2025-07-19 00:02:06] INFO train_model: vol_cluster_high: mean=0.0746, std=0.2627, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: regime_zscore: mean=0.0097, std=1.0032, min=-7.1754, max=7.0756, unique=4657
[2025-07-19 00:02:06] INFO train_model: doji: mean=0.1025, std=0.3034, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: hammer: mean=0.0166, std=0.1278, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bullish_engulfing: mean=0.0351, std=0.1840, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bearish_engulfing: mean=0.0353, std=0.1845, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: pin_bar: mean=0.2342, std=0.4236, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bullish_engulfing_bar: mean=0.0351, std=0.1840, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bearish_engulfing_bar: mean=0.0353, std=0.1845, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: inside_bar: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: double_top: mean=0.0109, std=0.1040, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: double_bottom: mean=0.0227, std=0.1489, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: rising_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: falling_wedge: mean=0.2464, std=0.4310, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: fakeout_up: mean=0.0065, std=0.0804, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: fakeout_down: mean=0.0076, std=0.0866, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bullish_flag: mean=0.0250, std=0.1561, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bearish_flag: mean=0.0223, std=0.1476, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bullish_pennant: mean=0.1317, std=0.3382, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bearish_pennant: mean=0.1237, std=0.3293, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: morning_star: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: evening_star: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0251, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: three_black_crows: mean=0.0004, std=0.0205, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bullish_harami: mean=0.0403, std=0.1968, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: bearish_harami: mean=0.0366, std=0.1877, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: dark_cloud_cover: mean=0.0769, std=0.2664, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: regime_label_bear: mean=0.5128, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: regime_label_bull: mean=0.4452, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: regime_label_neutral: mean=0.0420, std=0.2006, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0410, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: market_regime_consolidation: mean=0.2134, std=0.4098, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: market_regime_downtrend: mean=0.1910, std=0.3931, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: market_regime_range: mean=0.4048, std=0.4909, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: market_regime_uptrend: mean=0.1891, std=0.3916, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:06] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:06] INFO train_model: Auditing data quality before training...
[2025-07-19 00:02:06] INFO train_model: Entering audit_data_quality
[2025-07-19 00:02:10] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 00:02:10] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 00:02:10] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 00:02:10] INFO train_model: Entering audit_data_quality
[2025-07-19 00:02:13] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:02:13] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:13] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:13] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDUSD_features.json
[2025-07-19 00:02:13] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 00:02:13] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 00:02:13] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 00:02:13] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 00:02:16] INFO train_model: Model is starting a new training session...
[2025-07-19 00:02:16] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:02:16] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:02:16] INFO train_model: Preparing target variable...
[2025-07-19 00:02:16] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:02:16] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:02:16] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:02:16] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:16] INFO train_model: Dropping NaN targets...
[2025-07-19 00:02:16] INFO train_model: Class balance before upsampling: {0: 3092, 1: 1634}
[2025-07-19 00:02:16] INFO train_model: Upsampling successful.
[2025-07-19 00:02:16] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:02:16] INFO train_model: Splitting train/test...
[2025-07-19 00:02:16] INFO train_model: Scaling features...
[2025-07-19 00:02:17] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:02:17] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:02:19] INFO train_model: Model fit complete.
[2025-07-19 00:02:19] INFO train_model: Model Accuracy: 0.8828
[2025-07-19 00:02:19] INFO train_model: 
Classification Report:
[2025-07-19 00:02:19] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       619
           1       0.88      0.88      0.88       618

    accuracy                           0.88      1237
   macro avg       0.88      0.88      0.88      1237
weighted avg       0.88      0.88      0.88      1237

[2025-07-19 00:02:19] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 00:02:19] INFO train_model: Model registered in ModelRegistry for NZDUSD, version 46975954b9064b2dac5cdbcbe3844bca
[2025-07-19 00:02:19] INFO train_model: Feature distributions before training:
[2025-07-19 00:02:19] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4714
[2025-07-19 00:02:19] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4687
[2025-07-19 00:02:19] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4691
[2025-07-19 00:02:19] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4662
[2025-07-19 00:02:19] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4524
[2025-07-19 00:02:19] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4726
[2025-07-19 00:02:19] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4726
[2025-07-19 00:02:19] INFO train_model: rsi_14: mean=49.3849, std=12.3827, min=11.3290, max=91.7839, unique=4589
[2025-07-19 00:02:19] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4701
[2025-07-19 00:02:19] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4693
[2025-07-19 00:02:19] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4693
[2025-07-19 00:02:19] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4693
[2025-07-19 00:02:19] INFO train_model: stoch_k: mean=49.1792, std=28.8128, min=0.0000, max=100.0000, unique=4552
[2025-07-19 00:02:19] INFO train_model: stoch_d: mean=49.2137, std=26.3670, min=2.3676, max=99.2269, unique=4697
[2025-07-19 00:02:19] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-19 00:02:19] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4327
[2025-07-19 00:02:19] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2134
[2025-07-19 00:02:19] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4559
[2025-07-19 00:02:19] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2134
[2025-07-19 00:02:19] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4559
[2025-07-19 00:02:19] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2134
[2025-07-19 00:02:19] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4552
[2025-07-19 00:02:19] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2134
[2025-07-19 00:02:19] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4559
[2025-07-19 00:02:19] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2134
[2025-07-19 00:02:19] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4559
[2025-07-19 00:02:19] INFO train_model: fib_100: mean=0.5818, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-19 00:02:19] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4299
[2025-07-19 00:02:19] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4623
[2025-07-19 00:02:19] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4618
[2025-07-19 00:02:19] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: trendline_down: mean=0.5245, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4313
[2025-07-19 00:02:19] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4297
[2025-07-19 00:02:19] INFO train_model: vol_spike_atr: mean=0.0154, std=0.1233, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:19] INFO train_model: supply_zone: mean=0.4094, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:19] INFO train_model: demand_zone: mean=0.4245, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:22] INFO train_model: Model is starting a new training session...
[2025-07-19 00:02:22] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:02:22] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:02:22] INFO train_model: Preparing target variable...
[2025-07-19 00:02:22] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:02:22] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:02:22] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:02:22] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:22] INFO train_model: Dropping NaN targets...
[2025-07-19 00:02:22] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 00:02:22] INFO train_model: Upsampling successful.
[2025-07-19 00:02:22] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:02:22] INFO train_model: Splitting train/test...
[2025-07-19 00:02:22] INFO train_model: Scaling features...
[2025-07-19 00:02:22] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:02:22] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:02:24] INFO train_model: Model fit complete.
[2025-07-19 00:02:24] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 00:02:24] INFO train_model: 
Classification Report:
[2025-07-19 00:02:24] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 00:02:24] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 00:02:24] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd6e3be744efa17b9ae37e0677c855588'}}
[2025-07-19 00:02:24] INFO train_model: Feature distributions before training:
[2025-07-19 00:02:24] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 00:02:24] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 00:02:24] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 00:02:24] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 00:02:24] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 00:02:24] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 00:02:24] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 00:02:24] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 00:02:24] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 00:02:24] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 00:02:24] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 00:02:24] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 00:02:24] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 00:02:24] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 00:02:24] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 00:02:24] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 00:02:24] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 00:02:24] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 00:02:24] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 00:02:24] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 00:02:24] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 00:02:24] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 00:02:24] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 00:02:24] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 00:02:24] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 00:02:24] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 00:02:24] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 00:02:24] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 00:02:24] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 00:02:24] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 00:02:24] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 00:02:24] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 00:02:24] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:02:24] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:02:24] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:02:24] INFO train_model: news_sentiment: mean=0.0325, std=0.0000, min=0.0325, max=0.0325, unique=1
[2025-07-19 00:02:24] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 00:02:24] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 00:02:24] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:02:24] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 00:02:24] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 00:02:24] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 00:02:24] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 00:02:24] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 00:02:24] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 00:02:24] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 00:02:24] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 00:02:24] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 00:02:24] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 00:02:24] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 00:02:24] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:02:24] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:02:24] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:02:24] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:02:24] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:02:24] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 00:02:24] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 00:02:24] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 00:02:24] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 00:02:24] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 00:02:24] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:02:24] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:02:24] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 00:02:24] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:02:24] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:02:24] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 00:02:24] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 00:02:24] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:02:24] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:24] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:24] INFO train_model: Auditing data quality before training...
[2025-07-19 00:02:24] INFO train_model: Entering audit_data_quality
[2025-07-19 00:02:37] INFO train_model: Model is starting a new training session...
[2025-07-19 00:02:37] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:02:37] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 00:02:37] INFO train_model: Preparing target variable...
[2025-07-19 00:02:37] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:02:37] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:02:37] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 00:02:37] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:37] INFO train_model: Dropping NaN targets...
[2025-07-19 00:02:37] INFO train_model: Class balance before upsampling: {0: 3164, 1: 1564}
[2025-07-19 00:02:37] INFO train_model: Upsampling successful.
[2025-07-19 00:02:37] INFO train_model: Splitting train/test...
[2025-07-19 00:02:37] INFO train_model: Scaling features...
[2025-07-19 00:02:37] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:02:37] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:02:38] INFO train_model: Model fit complete.
[2025-07-19 00:02:38] INFO train_model: Model Accuracy: 0.8602
[2025-07-19 00:02:38] INFO train_model: 
Classification Report:
[2025-07-19 00:02:38] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       633
           1       0.86      0.86      0.86       633

    accuracy                           0.86      1266
   macro avg       0.86      0.86      0.86      1266
weighted avg       0.86      0.86      0.86      1266

[2025-07-19 00:02:38] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 00:02:38] INFO train_model: Model registered in ModelRegistry for EURJPY, version 8fd6ec8353249320693711106689a19a
[2025-07-19 00:02:38] INFO train_model: Feature distributions before training:
[2025-07-19 00:02:38] INFO train_model: atr_14: mean=0.3453, std=0.1084, min=0.0000, max=0.8613, unique=4716
[2025-07-19 00:02:38] INFO train_model: volatility_20: mean=0.3102, std=0.1648, min=0.0681, max=1.3557, unique=4708
[2025-07-19 00:02:38] INFO train_model: sma_20: mean=162.8974, std=3.4577, min=155.8359, max=172.8918, unique=4694
[2025-07-19 00:02:38] INFO train_model: sma_50: mean=162.8657, std=3.3915, min=156.1946, max=172.5970, unique=4668
[2025-07-19 00:02:38] INFO train_model: sma_200: mean=162.7246, std=3.0692, min=156.6790, max=172.1544, unique=4525
[2025-07-19 00:02:38] INFO train_model: ema_12: mean=162.9054, std=3.4719, min=155.6248, max=172.9037, unique=4728
[2025-07-19 00:02:38] INFO train_model: ema_26: mean=162.8913, std=3.4355, min=155.9072, max=172.7909, unique=4728
[2025-07-19 00:02:38] INFO train_model: rsi_14: mean=51.0117, std=11.8290, min=16.6264, max=87.9679, unique=4701
[2025-07-19 00:02:38] INFO train_model: macd: mean=0.0142, std=0.2002, min=-0.5343, max=0.7069, unique=4703
[2025-07-19 00:02:38] INFO train_model: macd_signal: mean=0.0136, std=0.1870, min=-0.4700, max=0.6611, unique=4695
[2025-07-19 00:02:38] INFO train_model: bb_high: mean=163.5022, std=3.3752, min=156.6277, max=173.3643, unique=4708
[2025-07-19 00:02:38] INFO train_model: bb_low: mean=162.2927, std=3.5675, min=154.8377, max=172.7094, unique=4708
[2025-07-19 00:02:38] INFO train_model: stoch_k: mean=52.6172, std=26.1445, min=0.0000, max=99.4364, unique=4693
[2025-07-19 00:02:38] INFO train_model: stoch_d: mean=52.6535, std=23.9300, min=3.6709, max=96.7048, unique=4711
[2025-07-19 00:02:38] INFO train_model: fib_0: mean=163.5466, std=3.3557, min=156.7820, max=173.2420, unique=1122
[2025-07-19 00:02:38] INFO train_model: dist_to_fib_0: mean=-0.6291, std=0.4938, min=-3.4340, max=-0.0090, unique=2065
[2025-07-19 00:02:38] INFO train_model: fib_236: mean=163.2304, std=3.4000, min=156.3121, max=173.0891, unique=2150
[2025-07-19 00:02:38] INFO train_model: dist_to_fib_236: mean=-0.3129, std=0.4370, min=-2.4716, max=0.9103, unique=4694
[2025-07-19 00:02:38] INFO train_model: fib_382: mean=163.0348, std=3.4300, min=156.0214, max=172.9945, unique=2150
[2025-07-19 00:02:38] INFO train_model: dist_to_fib_382: mean=-0.1173, std=0.4216, min=-1.8762, max=1.5799, unique=4694
[2025-07-19 00:02:38] INFO train_model: fib_500: mean=162.8767, std=3.4556, min=155.7865, max=172.9180, unique=2063
[2025-07-19 00:02:38] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4218, min=-1.4335, max=2.1210, unique=3518
[2025-07-19 00:02:38] INFO train_model: fib_618: mean=162.7186, std=3.4824, min=155.5516, max=172.8415, unique=2150
[2025-07-19 00:02:38] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4334, min=-1.0813, max=2.6622, unique=4694
[2025-07-19 00:02:38] INFO train_model: fib_786: mean=162.4935, std=3.5227, min=155.2171, max=172.7327, unique=2150
[2025-07-19 00:02:38] INFO train_model: dist_to_fib_786: mean=0.4240, std=0.4677, min=-0.5798, max=3.4326, unique=4694
[2025-07-19 00:02:38] INFO train_model: fib_100: mean=162.2068, std=3.5772, min=154.7910, max=172.5940, unique=1112
[2025-07-19 00:02:38] INFO train_model: dist_to_fib_100: mean=0.7107, std=0.5355, min=0.0000, max=4.4140, unique=2178
[2025-07-19 00:02:38] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=2925
[2025-07-19 00:02:38] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=2961
[2025-07-19 00:02:38] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: trendline_down: mean=0.4719, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: dist_to_high: mean=-0.6269, std=0.5162, min=-3.4340, max=0.3400, unique=2119
[2025-07-19 00:02:38] INFO train_model: dist_to_low: mean=0.7119, std=0.5609, min=-0.9330, max=4.4140, unique=2241
[2025-07-19 00:02:38] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: vol_spike_std: mean=0.1366, std=0.3435, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: supply_zone: mean=0.4778, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: demand_zone: mean=0.4004, std=0.4900, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: choch: mean=0.1508, std=0.3579, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4708
[2025-07-19 00:02:38] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2541, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: regime_zscore: mean=-0.0079, std=0.9935, min=-6.5566, max=5.1800, unique=4628
[2025-07-19 00:02:38] INFO train_model: doji: mean=0.1199, std=0.3249, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: hammer: mean=0.0214, std=0.1446, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bearish_engulfing: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: pin_bar: mean=0.3135, std=0.4639, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bearish_engulfing_bar: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: inside_bar: mean=0.1451, std=0.3522, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: head_shoulders: mean=0.0334, std=0.1797, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: rising_wedge: mean=0.2690, std=0.4435, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bullish_flag: mean=0.0231, std=0.1501, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bearish_flag: mean=0.0231, std=0.1501, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bullish_pennant: mean=0.1375, std=0.3444, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bearish_pennant: mean=0.1305, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: morning_star: mean=0.0419, std=0.2003, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: evening_star: mean=0.0381, std=0.1914, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bullish_harami: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: bearish_harami: mean=0.0491, std=0.2160, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: dark_cloud_cover: mean=0.1140, std=0.3178, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: regime_label_bear: mean=0.3858, std=0.4868, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: regime_label_bull: mean=0.5719, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: market_regime_choppy: mean=0.2523, std=0.4344, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: market_regime_downtrend: mean=0.2187, std=0.4134, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: market_regime_range: mean=0.2946, std=0.4559, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: market_regime_uptrend: mean=0.2343, std=0.4236, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:38] INFO train_model: Auditing data quality before training...
[2025-07-19 00:02:38] INFO train_model: Entering audit_data_quality
[2025-07-19 00:02:43] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 00:02:43] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 00:02:43] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 00:02:43] INFO train_model: Entering audit_data_quality
[2025-07-19 00:02:46] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:02:46] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:46] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:46] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_EURJPY_features.json
[2025-07-19 00:02:46] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 00:02:46] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 00:02:46] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 00:02:46] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 00:02:49] INFO train_model: Model is starting a new training session...
[2025-07-19 00:02:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:02:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:02:49] INFO train_model: Preparing target variable...
[2025-07-19 00:02:49] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:02:49] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:02:49] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:02:49] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:02:49] INFO train_model: Dropping NaN targets...
[2025-07-19 00:02:49] INFO train_model: Class balance before upsampling: {0: 3158, 1: 1566}
[2025-07-19 00:02:49] INFO train_model: Upsampling successful.
[2025-07-19 00:02:49] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:02:49] INFO train_model: Splitting train/test...
[2025-07-19 00:02:49] INFO train_model: Scaling features...
[2025-07-19 00:02:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:02:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:02:51] INFO train_model: Model fit complete.
[2025-07-19 00:02:51] INFO train_model: Model Accuracy: 0.8782
[2025-07-19 00:02:51] INFO train_model: 
Classification Report:
[2025-07-19 00:02:51] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       632
           1       0.88      0.88      0.88       632

    accuracy                           0.88      1264
   macro avg       0.88      0.88      0.88      1264
weighted avg       0.88      0.88      0.88      1264

[2025-07-19 00:02:51] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 00:02:51] INFO train_model: Model registered in ModelRegistry for EURJPY, version 6d8690ed5b572aeaa54af22750c34057
[2025-07-19 00:02:51] INFO train_model: Feature distributions before training:
[2025-07-19 00:02:51] INFO train_model: atr_14: mean=0.3453, std=0.1085, min=0.0000, max=0.8613, unique=4712
[2025-07-19 00:02:51] INFO train_model: volatility_20: mean=0.3104, std=0.1648, min=0.0681, max=1.3557, unique=4704
[2025-07-19 00:02:51] INFO train_model: sma_20: mean=162.8970, std=3.4592, min=155.8359, max=172.8918, unique=4704
[2025-07-19 00:02:51] INFO train_model: sma_50: mean=162.8653, std=3.3929, min=156.1946, max=172.5970, unique=4672
[2025-07-19 00:02:51] INFO train_model: sma_200: mean=162.7251, std=3.0704, min=156.6790, max=172.1544, unique=4521
[2025-07-19 00:02:51] INFO train_model: ema_12: mean=162.9049, std=3.4734, min=155.6248, max=172.9037, unique=4724
[2025-07-19 00:02:51] INFO train_model: ema_26: mean=162.8909, std=3.4369, min=155.9072, max=172.7909, unique=4724
[2025-07-19 00:02:51] INFO train_model: rsi_14: mean=51.0080, std=11.8331, min=16.6264, max=87.9679, unique=4699
[2025-07-19 00:02:51] INFO train_model: macd: mean=0.0142, std=0.2003, min=-0.5343, max=0.7069, unique=4699
[2025-07-19 00:02:51] INFO train_model: macd_signal: mean=0.0136, std=0.1871, min=-0.4700, max=0.6611, unique=4691
[2025-07-19 00:02:51] INFO train_model: bb_high: mean=163.5020, std=3.3766, min=156.6277, max=173.3643, unique=4704
[2025-07-19 00:02:51] INFO train_model: bb_low: mean=162.2919, std=3.5689, min=154.8377, max=172.7094, unique=4704
[2025-07-19 00:02:51] INFO train_model: stoch_k: mean=52.6125, std=26.1493, min=0.0000, max=99.4364, unique=4698
[2025-07-19 00:02:51] INFO train_model: stoch_d: mean=52.6532, std=23.9367, min=3.6709, max=96.7048, unique=4708
[2025-07-19 00:02:51] INFO train_model: fib_0: mean=163.5464, std=3.3571, min=156.7820, max=173.2420, unique=1122
[2025-07-19 00:02:51] INFO train_model: dist_to_fib_0: mean=-0.6294, std=0.4939, min=-3.4340, max=-0.0090, unique=3106
[2025-07-19 00:02:51] INFO train_model: fib_236: mean=163.2300, std=3.4014, min=156.3121, max=173.0891, unique=2150
[2025-07-19 00:02:51] INFO train_model: dist_to_fib_236: mean=-0.3131, std=0.4371, min=-2.4716, max=0.9103, unique=4693
[2025-07-19 00:02:51] INFO train_model: fib_382: mean=163.0343, std=3.4314, min=156.0214, max=172.9945, unique=2150
[2025-07-19 00:02:51] INFO train_model: dist_to_fib_382: mean=-0.1174, std=0.4217, min=-1.8762, max=1.5799, unique=4693
[2025-07-19 00:02:51] INFO train_model: fib_500: mean=162.8762, std=3.4570, min=155.7865, max=172.9180, unique=2110
[2025-07-19 00:02:51] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4220, min=-1.4335, max=2.1210, unique=4391
[2025-07-19 00:02:51] INFO train_model: fib_618: mean=162.7180, std=3.4838, min=155.5516, max=172.8415, unique=2150
[2025-07-19 00:02:51] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4336, min=-1.0813, max=2.6622, unique=4693
[2025-07-19 00:02:51] INFO train_model: fib_786: mean=162.4928, std=3.5241, min=155.2171, max=172.7327, unique=2150
[2025-07-19 00:02:51] INFO train_model: dist_to_fib_786: mean=0.4241, std=0.4679, min=-0.5798, max=3.4326, unique=4693
[2025-07-19 00:02:51] INFO train_model: fib_100: mean=162.2060, std=3.5787, min=154.7910, max=172.5940, unique=1112
[2025-07-19 00:02:51] INFO train_model: dist_to_fib_100: mean=0.7110, std=0.5356, min=0.0000, max=4.4140, unique=3220
[2025-07-19 00:02:51] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=3776
[2025-07-19 00:02:51] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=3825
[2025-07-19 00:02:51] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: trendline_down: mean=0.4723, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: dist_to_high: mean=-0.6273, std=0.5162, min=-3.4340, max=0.3400, unique=3182
[2025-07-19 00:02:51] INFO train_model: dist_to_low: mean=0.7121, std=0.5611, min=-0.9330, max=4.4140, unique=3281
[2025-07-19 00:02:51] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: vol_spike_std: mean=0.1367, std=0.3436, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:02:51] INFO train_model: supply_zone: mean=0.4773, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:02:51] INFO train_model: demand_zone: mean=0.4005, std=0.4901, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:11] INFO train_model: Model is starting a new training session...
[2025-07-19 00:03:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:03:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 00:03:11] INFO train_model: Preparing target variable...
[2025-07-19 00:03:11] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:03:11] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:03:11] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 00:03:11] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:03:11] INFO train_model: Dropping NaN targets...
[2025-07-19 00:03:11] INFO train_model: Class balance before upsampling: {0: 3070, 1: 1660}
[2025-07-19 00:03:11] INFO train_model: Upsampling successful.
[2025-07-19 00:03:11] INFO train_model: Splitting train/test...
[2025-07-19 00:03:11] INFO train_model: Scaling features...
[2025-07-19 00:03:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:03:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:03:13] INFO train_model: Model fit complete.
[2025-07-19 00:03:13] INFO train_model: Model Accuracy: 0.8176
[2025-07-19 00:03:13] INFO train_model: 
Classification Report:
[2025-07-19 00:03:13] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.81      0.82       614
           1       0.82      0.82      0.82       614

    accuracy                           0.82      1228
   macro avg       0.82      0.82      0.82      1228
weighted avg       0.82      0.82      0.82      1228

[2025-07-19 00:03:13] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 00:03:13] INFO train_model: Model registered in ModelRegistry for NZDJPY, version ef37d9c4f3bb1067978918f0c2fc8a3e
[2025-07-19 00:03:13] INFO train_model: Feature distributions before training:
[2025-07-19 00:03:13] INFO train_model: atr_14: mean=0.2434, std=0.2274, min=0.0000, max=3.8450, unique=4718
[2025-07-19 00:03:13] INFO train_model: volatility_20: mean=0.2228, std=0.2569, min=0.0393, max=3.3152, unique=4708
[2025-07-19 00:03:13] INFO train_model: sma_20: mean=87.3663, std=2.2031, min=81.5998, max=92.2272, unique=4690
[2025-07-19 00:03:13] INFO train_model: sma_50: mean=87.3741, std=2.1950, min=82.0271, max=91.9825, unique=4673
[2025-07-19 00:03:13] INFO train_model: sma_200: mean=87.4217, std=2.1959, min=83.2738, max=91.5912, unique=4523
[2025-07-19 00:03:13] INFO train_model: ema_12: mean=87.3642, std=2.2029, min=81.3860, max=92.2433, unique=4730
[2025-07-19 00:03:13] INFO train_model: ema_26: mean=87.3679, std=2.1951, min=81.7434, max=92.1009, unique=4730
[2025-07-19 00:03:13] INFO train_model: rsi_14: mean=49.9093, std=11.8533, min=11.9091, max=86.8743, unique=4690
[2025-07-19 00:03:13] INFO train_model: macd: mean=-0.0034, std=0.1378, min=-0.7910, max=1.4467, unique=4705
[2025-07-19 00:03:13] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4697
[2025-07-19 00:03:13] INFO train_model: bb_high: mean=87.8006, std=2.1258, min=82.3688, max=92.6084, unique=4708
[2025-07-19 00:03:13] INFO train_model: bb_low: mean=86.9321, std=2.3853, min=77.4303, max=92.0349, unique=4708
[2025-07-19 00:03:13] INFO train_model: stoch_k: mean=51.5854, std=26.9527, min=0.7728, max=239.4568, unique=4663
[2025-07-19 00:03:13] INFO train_model: stoch_d: mean=51.5699, std=24.5735, min=3.8824, max=173.4622, unique=4703
[2025-07-19 00:03:13] INFO train_model: fib_0: mean=87.8001, std=2.1191, min=82.4090, max=92.4600, unique=1116
[2025-07-19 00:03:13] INFO train_model: dist_to_fib_0: mean=-0.4376, std=0.4915, min=-6.7800, max=3.6535, unique=1671
[2025-07-19 00:03:13] INFO train_model: fib_236: mean=87.5874, std=2.1504, min=81.9488, max=92.3562, unique=2142
[2025-07-19 00:03:13] INFO train_model: dist_to_fib_236: mean=-0.2249, std=0.4027, min=-5.1658, max=4.4047, unique=4670
[2025-07-19 00:03:13] INFO train_model: fib_382: mean=87.4559, std=2.1751, min=81.6641, max=92.2919, unique=2142
[2025-07-19 00:03:13] INFO train_model: dist_to_fib_382: mean=-0.0933, std=0.3701, min=-4.1671, max=4.8694, unique=4670
[2025-07-19 00:03:13] INFO train_model: fib_500: mean=87.3495, std=2.1978, min=81.4340, max=92.2400, unique=2035
[2025-07-19 00:03:13] INFO train_model: dist_to_fib_500: mean=0.0130, std=0.3604, min=-3.3600, max=5.2450, unique=3141
[2025-07-19 00:03:13] INFO train_model: fib_618: mean=87.2432, std=2.2230, min=81.2039, max=92.1881, unique=2142
[2025-07-19 00:03:13] INFO train_model: dist_to_fib_618: mean=0.1194, std=0.3671, min=-2.5529, max=5.6206, unique=4670
[2025-07-19 00:03:13] INFO train_model: fib_786: mean=87.0917, std=2.2630, min=80.8763, max=92.1142, unique=2142
[2025-07-19 00:03:13] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4028, min=-1.4038, max=6.1553, unique=4670
[2025-07-19 00:03:13] INFO train_model: fib_100: mean=86.8989, std=2.3204, min=80.4530, max=92.0200, unique=1085
[2025-07-19 00:03:13] INFO train_model: dist_to_fib_100: mean=0.4636, std=0.4820, min=0.0060, max=6.8365, unique=1692
[2025-07-19 00:03:13] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0292, min=-0.2149, max=0.3140, unique=2446
[2025-07-19 00:03:13] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=2481
[2025-07-19 00:03:13] INFO train_model: trendline_up: mean=0.4907, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: trendline_down: mean=0.5013, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: breakout_high: mean=0.0025, std=0.0503, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: dist_to_high: mean=-0.4382, std=0.4963, min=-6.7220, max=3.3765, unique=1730
[2025-07-19 00:03:13] INFO train_model: dist_to_low: mean=0.4621, std=0.4922, min=-0.4180, max=6.8365, unique=1739
[2025-07-19 00:03:13] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0981, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: vol_spike_std: mean=0.1292, std=0.3354, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: supply_zone: mean=0.4142, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: demand_zone: mean=0.3778, std=0.4849, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: choch: mean=0.1567, std=0.3635, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4709
[2025-07-19 00:03:13] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2418, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: regime_zscore: mean=-0.0102, std=1.0094, min=-7.2839, max=9.1570, unique=4630
[2025-07-19 00:03:13] INFO train_model: doji: mean=0.1233, std=0.3288, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: hammer: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2284, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: pin_bar: mean=0.3021, std=0.4592, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2284, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: inside_bar: mean=0.1408, std=0.3479, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: inv_head_shoulders: mean=0.0304, std=0.1718, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: double_top: mean=0.0032, std=0.0562, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: double_bottom: mean=0.0021, std=0.0459, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: rising_wedge: mean=0.2704, std=0.4442, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: falling_wedge: mean=0.2630, std=0.4403, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bullish_flag: mean=0.0245, std=0.1547, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bearish_flag: mean=0.0290, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bullish_pennant: mean=0.1317, std=0.3382, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bearish_pennant: mean=0.1180, std=0.3226, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: morning_star: mean=0.0429, std=0.2027, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: evening_star: mean=0.0366, std=0.1877, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: bullish_harami: mean=0.0471, std=0.2120, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: bearish_harami: mean=0.0507, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: dark_cloud_cover: mean=0.1110, std=0.3142, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: regime_label_bear: mean=0.4302, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: regime_label_bull: mean=0.5275, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: market_regime_choppy: mean=0.2907, std=0.4541, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: market_regime_downtrend: mean=0.2364, std=0.4249, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: market_regime_range: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: market_regime_uptrend: mean=0.1848, std=0.3882, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:13] INFO train_model: Auditing data quality before training...
[2025-07-19 00:03:13] INFO train_model: Entering audit_data_quality
[2025-07-19 00:03:17] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 00:03:17] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 00:03:17] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 00:03:17] INFO train_model: Entering audit_data_quality
[2025-07-19 00:03:20] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:03:20] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:03:20] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:03:20] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDJPY_features.json
[2025-07-19 00:03:20] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 00:03:20] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 00:03:20] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 00:03:20] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 00:03:24] INFO train_model: Model is starting a new training session...
[2025-07-19 00:03:24] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:03:24] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:03:24] INFO train_model: Preparing target variable...
[2025-07-19 00:03:24] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:03:24] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:03:24] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:03:24] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:03:24] INFO train_model: Dropping NaN targets...
[2025-07-19 00:03:24] INFO train_model: Class balance before upsampling: {0: 3067, 1: 1657}
[2025-07-19 00:03:24] INFO train_model: Upsampling successful.
[2025-07-19 00:03:24] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:03:24] INFO train_model: Splitting train/test...
[2025-07-19 00:03:24] INFO train_model: Scaling features...
[2025-07-19 00:03:24] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:03:24] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:03:26] INFO train_model: Model fit complete.
[2025-07-19 00:03:26] INFO train_model: Model Accuracy: 0.8419
[2025-07-19 00:03:26] INFO train_model: 
Classification Report:
[2025-07-19 00:03:26] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.85      0.84       614
           1       0.84      0.84      0.84       613

    accuracy                           0.84      1227
   macro avg       0.84      0.84      0.84      1227
weighted avg       0.84      0.84      0.84      1227

[2025-07-19 00:03:26] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 00:03:26] INFO train_model: Model registered in ModelRegistry for NZDJPY, version 81cb0af832d014abc50b04a59db67ee5
[2025-07-19 00:03:26] INFO train_model: Feature distributions before training:
[2025-07-19 00:03:26] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8450, unique=4712
[2025-07-19 00:03:26] INFO train_model: volatility_20: mean=0.2228, std=0.2570, min=0.0393, max=3.3152, unique=4702
[2025-07-19 00:03:26] INFO train_model: sma_20: mean=87.3666, std=2.2038, min=81.5998, max=92.2272, unique=4701
[2025-07-19 00:03:26] INFO train_model: sma_50: mean=87.3744, std=2.1956, min=82.0271, max=91.9825, unique=4673
[2025-07-19 00:03:26] INFO train_model: sma_200: mean=87.4223, std=2.1965, min=83.2738, max=91.5912, unique=4521
[2025-07-19 00:03:26] INFO train_model: ema_12: mean=87.3644, std=2.2035, min=81.3860, max=92.2433, unique=4724
[2025-07-19 00:03:26] INFO train_model: ema_26: mean=87.3681, std=2.1958, min=81.7434, max=92.1009, unique=4724
[2025-07-19 00:03:26] INFO train_model: rsi_14: mean=49.9041, std=11.8518, min=11.9091, max=86.8743, unique=4685
[2025-07-19 00:03:26] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4467, unique=4699
[2025-07-19 00:03:26] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4691
[2025-07-19 00:03:26] INFO train_model: bb_high: mean=87.8010, std=2.1265, min=82.3688, max=92.6084, unique=4703
[2025-07-19 00:03:26] INFO train_model: bb_low: mean=86.9322, std=2.3861, min=77.4303, max=92.0349, unique=4703
[2025-07-19 00:03:26] INFO train_model: stoch_k: mean=51.5672, std=26.9451, min=0.7728, max=239.4568, unique=4672
[2025-07-19 00:03:26] INFO train_model: stoch_d: mean=51.5617, std=24.5719, min=3.8824, max=173.4622, unique=4698
[2025-07-19 00:03:26] INFO train_model: fib_0: mean=87.8005, std=2.1197, min=82.4090, max=92.4600, unique=1115
[2025-07-19 00:03:26] INFO train_model: dist_to_fib_0: mean=-0.4378, std=0.4917, min=-6.7800, max=3.6535, unique=2675
[2025-07-19 00:03:26] INFO train_model: fib_236: mean=87.5878, std=2.1510, min=81.9488, max=92.3562, unique=2140
[2025-07-19 00:03:26] INFO train_model: dist_to_fib_236: mean=-0.2251, std=0.4029, min=-5.1658, max=4.4047, unique=4668
[2025-07-19 00:03:26] INFO train_model: fib_382: mean=87.4561, std=2.1757, min=81.6641, max=92.2919, unique=2140
[2025-07-19 00:03:26] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8694, unique=4668
[2025-07-19 00:03:26] INFO train_model: fib_500: mean=87.3498, std=2.1984, min=81.4340, max=92.2400, unique=2084
[2025-07-19 00:03:26] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2450, unique=4266
[2025-07-19 00:03:26] INFO train_model: fib_618: mean=87.2434, std=2.2236, min=81.2039, max=92.1881, unique=2140
[2025-07-19 00:03:26] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6206, unique=4667
[2025-07-19 00:03:26] INFO train_model: fib_786: mean=87.0919, std=2.2636, min=80.8763, max=92.1142, unique=2140
[2025-07-19 00:03:26] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1553, unique=4667
[2025-07-19 00:03:26] INFO train_model: fib_100: mean=86.8990, std=2.3210, min=80.4530, max=92.0200, unique=1084
[2025-07-19 00:03:26] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4822, min=0.0060, max=6.8365, unique=2743
[2025-07-19 00:03:26] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3389
[2025-07-19 00:03:26] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-19 00:03:26] INFO train_model: trendline_up: mean=0.4905, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: trendline_down: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: dist_to_high: mean=-0.4384, std=0.4965, min=-6.7220, max=3.3765, unique=2743
[2025-07-19 00:03:26] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8365, unique=2785
[2025-07-19 00:03:26] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: vol_spike_std: mean=0.1293, std=0.3356, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:26] INFO train_model: supply_zone: mean=0.4138, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:26] INFO train_model: demand_zone: mean=0.3781, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:48] INFO train_model: Model is starting a new training session...
[2025-07-19 00:03:48] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:03:48] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 00:03:48] INFO train_model: Preparing target variable...
[2025-07-19 00:03:48] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:03:48] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:03:48] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 00:03:48] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:03:48] INFO train_model: Dropping NaN targets...
[2025-07-19 00:03:48] INFO train_model: Class balance before upsampling: {0: 2610, 1: 2189}
[2025-07-19 00:03:48] INFO train_model: Upsampling successful.
[2025-07-19 00:03:48] INFO train_model: Splitting train/test...
[2025-07-19 00:03:48] INFO train_model: Scaling features...
[2025-07-19 00:03:48] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:03:48] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:03:50] INFO train_model: Model fit complete.
[2025-07-19 00:03:50] INFO train_model: Model Accuracy: 0.7548
[2025-07-19 00:03:50] INFO train_model: 
Classification Report:
[2025-07-19 00:03:50] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.76      0.76       522
           1       0.76      0.75      0.75       522

    accuracy                           0.75      1044
   macro avg       0.75      0.75      0.75      1044
weighted avg       0.75      0.75      0.75      1044

[2025-07-19 00:03:50] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 00:03:50] INFO train_model: Model registered in ModelRegistry for BTCUSD, version 6a8ac6b8cc0971d2d66a07abe586c07f
[2025-07-19 00:03:50] INFO train_model: Feature distributions before training:
[2025-07-19 00:03:50] INFO train_model: atr_14: mean=702.3351, std=314.3090, min=0.0000, max=2432.8175, unique=4787
[2025-07-19 00:03:50] INFO train_model: volatility_20: mean=722.8883, std=522.3875, min=61.2969, max=3956.2747, unique=4780
[2025-07-19 00:03:50] INFO train_model: sma_20: mean=97467.5783, std=9886.0637, min=76687.9180, max=121103.9988, unique=4780
[2025-07-19 00:03:50] INFO train_model: sma_50: mean=97388.1903, std=9763.2280, min=77951.8447, max=119557.6389, unique=4750
[2025-07-19 00:03:50] INFO train_model: sma_200: mean=97091.8232, std=9168.6071, min=80836.6129, max=118285.0359, unique=4600
[2025-07-19 00:03:50] INFO train_model: ema_12: mean=97485.9997, std=9909.0152, min=76579.0411, max=121438.5343, unique=4799
[2025-07-19 00:03:50] INFO train_model: ema_26: mean=97447.6719, std=9842.0605, min=77204.8141, max=120532.2026, unique=4799
[2025-07-19 00:03:50] INFO train_model: rsi_14: mean=51.2262, std=12.0133, min=12.9206, max=94.1391, unique=4786
[2025-07-19 00:03:50] INFO train_model: macd: mean=38.1588, std=501.1322, min=-1881.4601, max=2409.3781, unique=4774
[2025-07-19 00:03:50] INFO train_model: macd_signal: mean=37.8262, std=465.8257, min=-1668.9823, max=2004.6298, unique=4766
[2025-07-19 00:03:50] INFO train_model: bb_high: mean=98876.7470, std=9811.3741, min=77878.7912, max=123631.2152, unique=4780
[2025-07-19 00:03:50] INFO train_model: bb_low: mean=96058.4096, std=10063.7668, min=73141.7504, max=119063.2808, unique=4780
[2025-07-19 00:03:50] INFO train_model: stoch_k: mean=52.1831, std=26.9474, min=0.0000, max=100.0000, unique=4767
[2025-07-19 00:03:50] INFO train_model: stoch_d: mean=52.2364, std=24.4099, min=4.0848, max=97.8432, unique=4784
[2025-07-19 00:03:50] INFO train_model: fib_0: mean=98917.1729, std=9813.5111, min=77879.0234, max=123077.6328, unique=1200
[2025-07-19 00:03:50] INFO train_model: dist_to_fib_0: mean=-1401.1822, std=1334.2799, min=-10522.6016, max=0.0000, unique=4739
[2025-07-19 00:03:50] INFO train_model: fib_236: mean=98212.1362, std=9851.1729, min=77124.2364, max=122164.0787, unique=2229
[2025-07-19 00:03:50] INFO train_model: dist_to_fib_236: mean=-696.1455, std=1115.9096, min=-7889.1863, max=2479.4287, unique=4780
[2025-07-19 00:03:50] INFO train_model: fib_382: mean=97775.9694, std=9883.4058, min=76657.2919, max=121598.9138, unique=2229
[2025-07-19 00:03:50] INFO train_model: dist_to_fib_382: mean=-259.9787, std=1045.0742, min=-6260.0396, max=4013.8442, unique=4780
[2025-07-19 00:03:50] INFO train_model: fib_500: mean=97423.4510, std=9914.3938, min=76279.8984, max=121142.1367, unique=2229
[2025-07-19 00:03:50] INFO train_model: dist_to_fib_500: mean=92.5397, std=1033.3672, min=-4943.3320, max=5253.9883, unique=4770
[2025-07-19 00:03:50] INFO train_model: fib_618: mean=97070.9326, std=9949.7510, min=75902.5049, max=120685.3596, unique=2229
[2025-07-19 00:03:50] INFO train_model: dist_to_fib_618: mean=445.0581, std=1064.1239, min=-3626.6244, max=6494.1323, unique=4780
[2025-07-19 00:03:50] INFO train_model: fib_786: mean=96569.0420, std=10007.5359, min=75365.1989, max=120035.0330, unique=2229
[2025-07-19 00:03:50] INFO train_model: dist_to_fib_786: mean=946.9486, std=1173.6676, min=-1751.9899, max=8259.7611, unique=4780
[2025-07-19 00:03:50] INFO train_model: fib_100: mean=95929.7291, std=10093.5907, min=74467.7031, max=119206.6406, unique=1264
[2025-07-19 00:03:50] INFO train_model: dist_to_fib_100: mean=1586.2616, std=1396.6226, min=0.0000, max=10508.8359, unique=4738
[2025-07-19 00:03:50] INFO train_model: trendline_slope_high: mean=5.2242, std=100.3640, min=-488.7707, max=449.7492, unique=4766
[2025-07-19 00:03:50] INFO train_model: trendline_slope_low: mean=5.2211, std=103.7433, min=-487.6711, max=479.1137, unique=4768
[2025-07-19 00:03:50] INFO train_model: trendline_up: mean=0.5116, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: trendline_down: mean=0.4624, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: breakout_high: mean=0.0108, std=0.1035, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: breakout_low: mean=0.0127, std=0.1120, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: dist_to_high: mean=-1389.0248, std=1380.7928, min=-10522.6016, max=250.3906, unique=4768
[2025-07-19 00:03:50] INFO train_model: dist_to_low: mean=1590.4183, std=1453.4108, min=-257.3125, max=10508.8359, unique=4770
[2025-07-19 00:03:50] INFO train_model: vol_spike_atr: mean=0.0367, std=0.1880, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: vol_spike_std: mean=0.1640, std=0.3703, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: is_trending: mean=0.0235, std=0.1516, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: supply_zone: mean=0.2165, std=0.4119, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: demand_zone: mean=0.1886, std=0.3912, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: bos: mean=0.0235, std=0.1516, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: choch: mean=0.1598, std=0.3665, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: vol_cluster_std: mean=0.0044, std=0.0026, min=0.0006, max=0.0169, unique=4779
[2025-07-19 00:03:50] INFO train_model: vol_cluster_high: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: regime_zscore: mean=-0.0207, std=1.0150, min=-5.7567, max=6.9376, unique=4699
[2025-07-19 00:03:50] INFO train_model: doji: mean=0.0802, std=0.2717, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: hammer: mean=0.0273, std=0.1630, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bullish_engulfing: mean=0.0515, std=0.2210, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bearish_engulfing: mean=0.0550, std=0.2280, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: pin_bar: mean=0.2292, std=0.4204, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bullish_engulfing_bar: mean=0.0515, std=0.2210, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bearish_engulfing_bar: mean=0.0550, std=0.2280, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: inside_bar: mean=0.1407, std=0.3477, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: head_shoulders: mean=0.0338, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: inv_head_shoulders: mean=0.0342, std=0.1817, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: rising_wedge: mean=0.2540, std=0.4353, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: falling_wedge: mean=0.2509, std=0.4336, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: fakeout_up: mean=0.0052, std=0.0720, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: fakeout_down: mean=0.0063, std=0.0788, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bullish_flag: mean=0.0256, std=0.1580, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bearish_flag: mean=0.0256, std=0.1580, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bullish_pennant: mean=0.1404, std=0.3475, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bearish_pennant: mean=0.1394, std=0.3464, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: morning_star: mean=0.0377, std=0.1905, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: evening_star: mean=0.0354, std=0.1849, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: bullish_harami: mean=0.0604, std=0.2383, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: bearish_harami: mean=0.0586, std=0.2348, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: dark_cloud_cover: mean=0.1121, std=0.3155, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: regime_label_bear: mean=0.4038, std=0.4907, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: regime_label_bull: mean=0.5545, std=0.4971, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: regime_label_neutral: mean=0.0417, std=0.1999, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: market_regime_choppy: mean=0.2519, std=0.4342, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: market_regime_downtrend: mean=0.2463, std=0.4309, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: market_regime_range: mean=0.2388, std=0.4264, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: market_regime_uptrend: mean=0.2630, std=0.4403, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:03:50] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:03:50] INFO train_model: Auditing data quality before training...
[2025-07-19 00:03:50] INFO train_model: Entering audit_data_quality
[2025-07-19 00:03:53] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 00:03:53] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 00:03:53] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 00:03:53] INFO train_model: Entering audit_data_quality
[2025-07-19 00:03:57] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:03:57] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:03:57] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:03:57] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-19 00:03:57] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 00:03:57] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 00:03:57] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 00:03:57] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 00:04:00] INFO train_model: Model is starting a new training session...
[2025-07-19 00:04:00] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:04:00] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:04:00] INFO train_model: Preparing target variable...
[2025-07-19 00:04:00] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:04:00] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:04:00] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:04:00] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:04:00] INFO train_model: Dropping NaN targets...
[2025-07-19 00:04:00] INFO train_model: Class balance before upsampling: {0: 1756, 1: 1649}
[2025-07-19 00:04:00] INFO train_model: Upsampling successful.
[2025-07-19 00:04:00] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:04:00] INFO train_model: Splitting train/test...
[2025-07-19 00:04:00] INFO train_model: Scaling features...
[2025-07-19 00:04:00] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:04:00] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:04:02] INFO train_model: Model fit complete.
[2025-07-19 00:04:02] INFO train_model: Model Accuracy: 0.8407
[2025-07-19 00:04:02] INFO train_model: 
Classification Report:
[2025-07-19 00:04:02] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.88      0.85       352
           1       0.87      0.80      0.83       351

    accuracy                           0.84       703
   macro avg       0.84      0.84      0.84       703
weighted avg       0.84      0.84      0.84       703

[2025-07-19 00:04:02] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 00:04:02] INFO train_model: Model registered in ModelRegistry for BTCUSD, version eb0ff77fa4b36a24bcbc54b1f625c4bc
[2025-07-19 00:04:02] INFO train_model: Feature distributions before training:
[2025-07-19 00:04:02] INFO train_model: atr_14: mean=775.4003, std=316.0294, min=0.0000, max=2432.8175, unique=3393
[2025-07-19 00:04:02] INFO train_model: volatility_20: mean=826.4518, std=540.8902, min=141.7903, max=3956.2747, unique=3386
[2025-07-19 00:04:02] INFO train_model: sma_20: mean=97522.6680, std=10041.3094, min=76687.9180, max=121103.9988, unique=3386
[2025-07-19 00:04:02] INFO train_model: sma_50: mean=97418.8359, std=9860.9512, min=77951.8447, max=119557.6389, unique=3374
[2025-07-19 00:04:02] INFO train_model: sma_200: mean=97186.3680, std=9277.3719, min=80836.6129, max=118218.3794, unique=3273
[2025-07-19 00:04:02] INFO train_model: ema_12: mean=97562.4057, std=10075.7614, min=76579.0411, max=121438.5343, unique=3405
[2025-07-19 00:04:02] INFO train_model: ema_26: mean=97504.6570, std=9983.2269, min=77204.8141, max=120532.2026, unique=3405
[2025-07-19 00:04:02] INFO train_model: rsi_14: mean=51.9483, std=12.7157, min=12.9206, max=94.1391, unique=3392
[2025-07-19 00:04:02] INFO train_model: macd: mean=56.6762, std=548.8301, min=-1881.4601, max=2409.3781, unique=3382
[2025-07-19 00:04:02] INFO train_model: macd_signal: mean=51.4470, std=509.5585, min=-1668.9823, max=2004.6298, unique=3381
[2025-07-19 00:04:02] INFO train_model: bb_high: mean=99133.7191, std=9948.0915, min=77878.7912, max=123631.2152, unique=3386
[2025-07-19 00:04:02] INFO train_model: bb_low: mean=95911.6169, std=10242.7896, min=73141.7504, max=119063.2808, unique=3386
[2025-07-19 00:04:02] INFO train_model: stoch_k: mean=53.4726, std=27.3568, min=0.0000, max=100.0000, unique=3381
[2025-07-19 00:04:02] INFO train_model: stoch_d: mean=53.6005, std=24.8348, min=4.9246, max=97.8432, unique=3390
[2025-07-19 00:04:02] INFO train_model: fib_0: mean=99156.3224, std=9942.2422, min=77879.0234, max=123077.6328, unique=884
[2025-07-19 00:04:02] INFO train_model: dist_to_fib_0: mean=-1535.7735, std=1431.4995, min=-10522.6016, max=0.0000, unique=3370
[2025-07-19 00:04:02] INFO train_model: fib_236: mean=98356.8132, std=9992.5600, min=77124.2364, max=122164.0787, unique=1603
[2025-07-19 00:04:02] INFO train_model: dist_to_fib_236: mean=-736.2643, std=1220.8478, min=-7889.1863, max=2479.4287, unique=3386
[2025-07-19 00:04:02] INFO train_model: fib_382: mean=97862.2016, std=10032.6013, min=76657.2919, max=121598.9138, unique=1603
[2025-07-19 00:04:02] INFO train_model: dist_to_fib_382: mean=-241.6527, std=1151.5671, min=-6260.0396, max=4013.8442, unique=3386
[2025-07-19 00:04:02] INFO train_model: fib_500: mean=97462.4470, std=10069.8761, min=76279.8984, max=121142.1367, unique=1603
[2025-07-19 00:04:02] INFO train_model: dist_to_fib_500: mean=158.1019, std=1137.7723, min=-4943.3320, max=5253.9883, unique=3380
[2025-07-19 00:04:02] INFO train_model: fib_618: mean=97062.6924, std=10111.4906, min=75902.5049, max=120685.3596, unique=1603
[2025-07-19 00:04:02] INFO train_model: dist_to_fib_618: mean=557.8565, std=1163.3851, min=-3626.6244, max=6494.1323, unique=3386
[2025-07-19 00:04:02] INFO train_model: fib_786: mean=96493.5503, std=10178.1199, min=75365.1989, max=120035.0330, unique=1603
[2025-07-19 00:04:02] INFO train_model: dist_to_fib_786: mean=1126.9986, std=1262.3623, min=-1751.9899, max=8259.7611, unique=3386
[2025-07-19 00:04:02] INFO train_model: fib_100: mean=95768.5717, std=10275.3046, min=74467.7031, max=119206.6406, unique=925
[2025-07-19 00:04:02] INFO train_model: dist_to_fib_100: mean=1851.9772, std=1471.4329, min=0.0000, max=10508.8359, unique=3365
[2025-07-19 00:04:02] INFO train_model: trendline_slope_high: mean=10.0115, std=110.4604, min=-488.7707, max=418.4305, unique=3379
[2025-07-19 00:04:02] INFO train_model: trendline_slope_low: mean=8.9114, std=114.8354, min=-487.6711, max=479.1137, unique=3384
[2025-07-19 00:04:02] INFO train_model: trendline_up: mean=0.5383, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: trendline_down: mean=0.4479, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: breakout_high: mean=0.0103, std=0.1009, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: breakout_low: mean=0.0132, std=0.1142, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: dist_to_high: mean=-1513.3334, std=1488.8920, min=-10522.6016, max=250.3906, unique=3389
[2025-07-19 00:04:02] INFO train_model: dist_to_low: mean=1858.2876, std=1537.2841, min=-257.3125, max=10508.8359, unique=3393
[2025-07-19 00:04:02] INFO train_model: vol_spike_atr: mean=0.0408, std=0.1979, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: vol_spike_std: mean=0.1771, std=0.3818, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: is_trending: mean=0.0235, std=0.1515, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:02] INFO train_model: supply_zone: mean=0.2206, std=0.4147, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:02] INFO train_model: demand_zone: mean=0.1665, std=0.3726, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:15] INFO train_model: Model is starting a new training session...
[2025-07-19 00:04:15] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:04:15] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 00:04:15] INFO train_model: Preparing target variable...
[2025-07-19 00:04:15] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:04:15] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:04:15] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 00:04:15] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:04:15] INFO train_model: Dropping NaN targets...
[2025-07-19 00:04:15] INFO train_model: Class balance before upsampling: {0: 4724, 1: 4035}
[2025-07-19 00:04:15] INFO train_model: Upsampling successful.
[2025-07-19 00:04:15] INFO train_model: Splitting train/test...
[2025-07-19 00:04:15] INFO train_model: Scaling features...
[2025-07-19 00:04:15] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:04:15] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:04:17] INFO train_model: Model fit complete.
[2025-07-19 00:04:17] INFO train_model: Model Accuracy: 0.7545
[2025-07-19 00:04:17] INFO train_model: 
Classification Report:
[2025-07-19 00:04:17] INFO train_model:               precision    recall  f1-score   support

           0       0.75      0.77      0.76       945
           1       0.76      0.74      0.75       945

    accuracy                           0.75      1890
   macro avg       0.75      0.75      0.75      1890
weighted avg       0.75      0.75      0.75      1890

[2025-07-19 00:04:17] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 00:04:17] INFO train_model: Model registered in ModelRegistry for BTCUSD, version d5aa8eb55525a10b6a39d3d293814c4f
[2025-07-19 00:04:17] INFO train_model: Feature distributions before training:
[2025-07-19 00:04:17] INFO train_model: atr_14: mean=663.0559, std=308.0273, min=0.0000, max=2432.8175, unique=8747
[2025-07-19 00:04:17] INFO train_model: volatility_20: mean=674.6249, std=490.3524, min=61.2969, max=3956.2747, unique=8740
[2025-07-19 00:04:17] INFO train_model: sma_20: mean=86551.8047, std=17648.9235, min=53086.6750, max=121103.9988, unique=8740
[2025-07-19 00:04:17] INFO train_model: sma_50: mean=86463.2433, std=17589.0649, min=54150.0817, max=119557.6389, unique=8710
[2025-07-19 00:04:17] INFO train_model: sma_200: mean=86016.9354, std=17309.9095, min=56019.7319, max=118285.0359, unique=8559
[2025-07-19 00:04:17] INFO train_model: ema_12: mean=86575.3184, std=17659.0091, min=52717.5253, max=121438.5343, unique=8759
[2025-07-19 00:04:17] INFO train_model: ema_26: mean=86531.4247, std=17629.0362, min=54289.5561, max=120532.2026, unique=8759
[2025-07-19 00:04:17] INFO train_model: rsi_14: mean=51.2838, std=11.9099, min=12.9206, max=90.2253, unique=8746
[2025-07-19 00:04:17] INFO train_model: macd: mean=45.3065, std=480.4633, min=-2308.6514, max=2409.3781, unique=8734
[2025-07-19 00:04:17] INFO train_model: macd_signal: mean=45.2850, std=448.9416, min=-2026.1798, max=2004.6298, unique=8726
[2025-07-19 00:04:17] INFO train_model: bb_high: mean=87866.8908, std=17813.3317, min=54657.4325, max=123631.2152, unique=8740
[2025-07-19 00:04:17] INFO train_model: bb_low: mean=85236.7187, std=17535.1533, min=48580.8019, max=119063.2808, unique=8740
[2025-07-19 00:04:17] INFO train_model: stoch_k: mean=52.5024, std=26.6040, min=0.0000, max=100.0000, unique=8712
[2025-07-19 00:04:17] INFO train_model: stoch_d: mean=52.5384, std=23.9668, min=2.7373, max=97.8432, unique=8744
[2025-07-19 00:04:17] INFO train_model: fib_0: mean=87917.1152, std=17809.1324, min=54452.7734, max=123077.6328, unique=2136
[2025-07-19 00:04:17] INFO train_model: dist_to_fib_0: mean=-1302.8441, std=1229.8166, min=-10522.6016, max=0.0000, unique=8637
[2025-07-19 00:04:17] INFO train_model: fib_236: mean=87254.9452, std=17727.7937, min=54022.4864, max=122164.0787, unique=3962
[2025-07-19 00:04:17] INFO train_model: dist_to_fib_236: mean=-640.6741, std=1025.8278, min=-7889.1863, max=2479.4287, unique=8740
[2025-07-19 00:04:17] INFO train_model: fib_382: mean=86845.2977, std=17681.8354, min=53222.5085, max=121598.9138, unique=3962
[2025-07-19 00:04:17] INFO train_model: dist_to_fib_382: mean=-231.0266, std=963.5921, min=-6260.0396, max=4013.8442, unique=8739
[2025-07-19 00:04:17] INFO train_model: fib_500: mean=86514.2127, std=17647.1492, min=52526.8008, max=121142.1367, unique=3962
[2025-07-19 00:04:17] INFO train_model: dist_to_fib_500: mean=100.0584, std=958.2699, min=-4943.3320, max=5253.9883, unique=8697
[2025-07-19 00:04:17] INFO train_model: fib_618: mean=86183.1277, std=17614.6745, min=51831.0931, max=120685.3596, unique=3962
[2025-07-19 00:04:17] INFO train_model: dist_to_fib_618: mean=431.1434, std=994.1649, min=-3626.6244, max=6494.1323, unique=8740
[2025-07-19 00:04:17] INFO train_model: fib_786: mean=85711.7524, std=17572.2790, min=50840.5939, max=120035.0330, unique=3962
[2025-07-19 00:04:17] INFO train_model: dist_to_fib_786: mean=902.5187, std=1107.5687, min=-1889.2530, max=8259.7611, unique=8740
[2025-07-19 00:04:17] INFO train_model: fib_100: mean=85111.3101, std=17524.8541, min=49578.8867, max=119206.6406, unique=2237
[2025-07-19 00:04:17] INFO train_model: dist_to_fib_100: mean=1502.9610, std=1328.9349, min=0.0000, max=10508.8359, unique=8635
[2025-07-19 00:04:17] INFO train_model: trendline_slope_high: mean=6.2384, std=94.4613, min=-488.7707, max=449.7492, unique=8700
[2025-07-19 00:04:17] INFO train_model: trendline_slope_low: mean=6.2023, std=97.1827, min=-554.4365, max=479.1137, unique=8701
[2025-07-19 00:04:17] INFO train_model: trendline_up: mean=0.5143, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: trendline_down: mean=0.4649, std=0.4988, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: breakout_high: mean=0.0111, std=0.1047, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: breakout_low: mean=0.0116, std=0.1073, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: dist_to_high: mean=-1295.9557, std=1275.3010, min=-10522.6016, max=359.2578, unique=8672
[2025-07-19 00:04:17] INFO train_model: dist_to_low: mean=1503.9824, std=1379.6115, min=-408.2344, max=10508.8359, unique=8677
[2025-07-19 00:04:17] INFO train_model: vol_spike_atr: mean=0.0320, std=0.1759, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: vol_spike_std: mean=0.1658, std=0.3719, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: is_trending: mean=0.0227, std=0.1490, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: supply_zone: mean=0.2076, std=0.4056, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: demand_zone: mean=0.1772, std=0.3819, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: bos: mean=0.0227, std=0.1490, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: choch: mean=0.1596, std=0.3663, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: vol_cluster_std: mean=0.0047, std=0.0026, min=0.0006, max=0.0222, unique=8739
[2025-07-19 00:04:17] INFO train_model: vol_cluster_high: mean=0.1304, std=0.3367, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: regime_zscore: mean=-0.0147, std=1.0168, min=-6.5962, max=6.9376, unique=8659
[2025-07-19 00:04:17] INFO train_model: doji: mean=0.0814, std=0.2735, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: hammer: mean=0.0268, std=0.1616, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bullish_engulfing: mean=0.0531, std=0.2242, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bearish_engulfing: mean=0.0578, std=0.2333, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: pin_bar: mean=0.2334, std=0.4230, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bullish_engulfing_bar: mean=0.0531, std=0.2242, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bearish_engulfing_bar: mean=0.0578, std=0.2333, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: inside_bar: mean=0.1470, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: head_shoulders: mean=0.0338, std=0.1807, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: inv_head_shoulders: mean=0.0329, std=0.1783, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: rising_wedge: mean=0.2475, std=0.4316, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: falling_wedge: mean=0.2512, std=0.4337, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: fakeout_up: mean=0.0056, std=0.0746, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: fakeout_down: mean=0.0069, std=0.0825, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bullish_flag: mean=0.0261, std=0.1596, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bearish_flag: mean=0.0258, std=0.1586, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bullish_pennant: mean=0.1410, std=0.3480, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bearish_pennant: mean=0.1328, std=0.3394, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: morning_star: mean=0.0361, std=0.1865, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: evening_star: mean=0.0370, std=0.1887, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: bullish_harami: mean=0.0628, std=0.2426, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: bearish_harami: mean=0.0596, std=0.2368, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: dark_cloud_cover: mean=0.1133, std=0.3169, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: regime_label_bear: mean=0.3946, std=0.4888, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: regime_label_bull: mean=0.5826, std=0.4932, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: regime_label_neutral: mean=0.0228, std=0.1494, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: market_regime_choppy: mean=0.2199, std=0.4142, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: market_regime_downtrend: mean=0.2747, std=0.4464, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: market_regime_range: mean=0.2176, std=0.4126, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: market_regime_uptrend: mean=0.2878, std=0.4528, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:04:17] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:04:17] INFO train_model: Auditing data quality before training...
[2025-07-19 00:04:17] INFO train_model: Entering audit_data_quality
[2025-07-19 00:05:36] INFO train_model: Model is starting a new training session...
[2025-07-19 00:05:36] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:05:36] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=123)
[2025-07-19 00:05:36] INFO train_model: Preparing target variable...
[2025-07-19 00:05:36] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:05:36] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:05:36] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=125)
[2025-07-19 00:05:36] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:05:36] INFO train_model: Dropping NaN targets...
[2025-07-19 00:05:36] INFO train_model: Class balance before upsampling: {0: 2414, 1: 2311}
[2025-07-19 00:05:36] INFO train_model: Upsampling successful.
[2025-07-19 00:05:36] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:05:36] INFO train_model: Splitting train/test...
[2025-07-19 00:05:36] INFO train_model: Scaling features...
[2025-07-19 00:05:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:05:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:05:38] INFO train_model: Model fit complete.
[2025-07-19 00:05:38] INFO train_model: Model Accuracy: 0.8313
[2025-07-19 00:05:38] INFO train_model: 
Classification Report:
[2025-07-19 00:05:38] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.83      0.83       483
           1       0.83      0.83      0.83       483

    accuracy                           0.83       966
   macro avg       0.83      0.83      0.83       966
weighted avg       0.83      0.83      0.83       966

[2025-07-19 00:05:38] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 00:05:38] INFO train_model: Model registered in ModelRegistry for BTCUSD, version 9ffdbd6d5ffa8692d45737563256cd83
[2025-07-19 00:05:38] INFO train_model: Feature distributions before training:
[2025-07-19 00:05:38] INFO train_model: atr_14: mean=790.2925, std=316.4131, min=248.5360, max=2432.8175, unique=4725
[2025-07-19 00:05:38] INFO train_model: volatility_20: mean=826.8249, std=533.2637, min=141.7903, max=3956.2747, unique=4725
[2025-07-19 00:05:38] INFO train_model: sma_20: mean=94356.7082, std=12268.7071, min=62628.1240, max=121103.9988, unique=4725
[2025-07-19 00:05:38] INFO train_model: sma_50: mean=94197.6233, std=12256.8055, min=62799.2954, max=119557.6389, unique=4725
[2025-07-19 00:05:38] INFO train_model: sma_200: mean=93600.1157, std=12291.7664, min=62183.0844, max=118218.3794, unique=4724
[2025-07-19 00:05:38] INFO train_model: ema_12: mean=94411.1552, std=12263.4838, min=62644.2626, max=121438.5343, unique=4725
[2025-07-19 00:05:38] INFO train_model: ema_26: mean=94330.8663, std=12247.0436, min=62673.5403, max=120532.2026, unique=4725
[2025-07-19 00:05:38] INFO train_model: rsi_14: mean=52.2288, std=12.4379, min=12.9206, max=90.2253, unique=4725
[2025-07-19 00:05:38] INFO train_model: macd: mean=80.2889, std=560.5874, min=-1881.4601, max=2409.3781, unique=4725
[2025-07-19 00:05:38] INFO train_model: macd_signal: mean=76.0059, std=522.8613, min=-1668.9823, max=2004.6298, unique=4725
[2025-07-19 00:05:38] INFO train_model: bb_high: mean=95968.4866, std=12347.6445, min=63008.0505, max=123631.2152, unique=4725
[2025-07-19 00:05:38] INFO train_model: bb_low: mean=92744.9299, std=12277.5908, min=61485.6176, max=119063.2808, unique=4725
[2025-07-19 00:05:38] INFO train_model: stoch_k: mean=53.8668, std=27.2018, min=0.0000, max=100.0000, unique=4708
[2025-07-19 00:05:38] INFO train_model: stoch_d: mean=53.9087, std=24.5302, min=4.8709, max=97.8432, unique=4725
[2025-07-19 00:05:38] INFO train_model: fib_0: mean=96011.1458, std=12315.0639, min=63086.8359, max=123077.6328, unique=1209
[2025-07-19 00:05:38] INFO train_model: dist_to_fib_0: mean=-1525.7156, std=1389.9513, min=-10522.6016, max=0.0000, unique=4700
[2025-07-19 00:05:38] INFO train_model: fib_236: mean=95207.3054, std=12281.0821, min=62841.1609, max=122164.0787, unique=2197
[2025-07-19 00:05:38] INFO train_model: dist_to_fib_236: mean=-721.8751, std=1190.5630, min=-7889.1863, max=2479.4287, unique=4725
[2025-07-19 00:05:38] INFO train_model: fib_382: mean=94710.0142, std=12267.2667, min=62689.1754, max=121598.9138, unique=2197
[2025-07-19 00:05:38] INFO train_model: dist_to_fib_382: mean=-224.5840, std=1130.0725, min=-6260.0396, max=4013.8442, unique=4724
[2025-07-19 00:05:38] INFO train_model: fib_500: mean=94308.0940, std=12260.1433, min=62566.3379, max=121142.1367, unique=2197
[2025-07-19 00:05:38] INFO train_model: dist_to_fib_500: mean=177.3363, std=1123.8300, min=-4943.3320, max=5253.9883, unique=4708
[2025-07-19 00:05:38] INFO train_model: fib_618: mean=93906.1737, std=12256.6406, min=62443.5004, max=120685.3596, unique=2197
[2025-07-19 00:05:38] INFO train_model: dist_to_fib_618: mean=579.2565, std=1156.6193, min=-3626.6244, max=6494.1323, unique=4725
[2025-07-19 00:05:38] INFO train_model: fib_786: mean=93333.9483, std=12257.9063, min=62268.6130, max=120035.0330, unique=2197
[2025-07-19 00:05:38] INFO train_model: dist_to_fib_786: mean=1151.4819, std=1263.9286, min=-1751.9899, max=8259.7611, unique=4725
[2025-07-19 00:05:38] INFO train_model: fib_100: mean=92605.0421, std=12270.1504, min=62045.8398, max=119206.6406, unique=1276
[2025-07-19 00:05:38] INFO train_model: dist_to_fib_100: mean=1880.3881, std=1479.5901, min=0.0000, max=10508.8359, unique=4692
[2025-07-19 00:05:38] INFO train_model: trendline_slope_high: mean=12.6293, std=110.5220, min=-488.7707, max=418.4305, unique=4710
[2025-07-19 00:05:38] INFO train_model: trendline_slope_low: mean=11.3012, std=113.7325, min=-487.6711, max=479.1137, unique=4719
[2025-07-19 00:05:38] INFO train_model: trendline_up: mean=0.5517, std=0.4974, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: trendline_down: mean=0.4415, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: breakout_high: mean=0.0129, std=0.1129, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: breakout_low: mean=0.0131, std=0.1138, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: dist_to_high: mean=-1509.4770, std=1448.7133, min=-10522.6016, max=359.2578, unique=4702
[2025-07-19 00:05:38] INFO train_model: dist_to_low: mean=1889.9598, std=1544.1018, min=-408.2344, max=10508.8359, unique=4706
[2025-07-19 00:05:38] INFO train_model: vol_spike_atr: mean=0.0372, std=0.1894, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: vol_spike_std: mean=0.1793, std=0.3836, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: is_trending: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: supply_zone: mean=0.2180, std=0.4129, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: demand_zone: mean=0.1583, std=0.3651, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:05:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:05:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:05:38] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: bos: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: choch: mean=0.1547, std=0.3617, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: vol_cluster_std: mean=0.0052, std=0.0026, min=0.0011, max=0.0169, unique=4725
[2025-07-19 00:05:38] INFO train_model: vol_cluster_high: mean=0.1850, std=0.3883, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: regime_zscore: mean=0.0070, std=1.1316, min=-5.7567, max=6.9376, unique=4725
[2025-07-19 00:05:38] INFO train_model: doji: mean=0.0804, std=0.2720, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: hammer: mean=0.0241, std=0.1535, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bullish_engulfing: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bearish_engulfing: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: pin_bar: mean=0.2360, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bullish_engulfing_bar: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bearish_engulfing_bar: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: inside_bar: mean=0.1407, std=0.3478, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: rising_wedge: mean=0.2506, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: falling_wedge: mean=0.2595, std=0.4384, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: fakeout_up: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: fakeout_down: mean=0.0083, std=0.0905, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bullish_flag: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bearish_flag: mean=0.0267, std=0.1611, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bullish_pennant: mean=0.1308, std=0.3372, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bearish_pennant: mean=0.1255, std=0.3313, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: morning_star: mean=0.0394, std=0.1945, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: evening_star: mean=0.0383, std=0.1920, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: bullish_harami: mean=0.0603, std=0.2381, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: bearish_harami: mean=0.0590, std=0.2357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: dark_cloud_cover: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:05:38] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4671
[2025-07-19 00:05:38] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4647
[2025-07-19 00:05:38] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4725
[2025-07-19 00:05:38] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4725
[2025-07-19 00:05:38] INFO train_model: rsi_14_4h: mean=51.1047, std=32.5781, min=0.0000, max=100.0000, unique=1783
[2025-07-19 00:05:38] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4725
[2025-07-19 00:05:38] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4725
[2025-07-19 00:05:38] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4673
[2025-07-19 00:05:38] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4673
[2025-07-19 00:05:38] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4710
[2025-07-19 00:05:38] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4663
[2025-07-19 00:05:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:05:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:05:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:05:38] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:05:38] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:05:38] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4655
[2025-07-19 00:05:38] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4725
[2025-07-19 00:05:38] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4725
[2025-07-19 00:05:38] INFO train_model: rsi_14_1d: mean=47.2804, std=49.9313, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4725
[2025-07-19 00:05:38] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4725
[2025-07-19 00:05:38] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:05:38] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:05:38] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:05:38] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:05:38] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:05:38] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4655
[2025-07-19 00:05:38] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4655
[2025-07-19 00:05:38] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:05:38] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: regime_label_bear: mean=0.3926, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: regime_label_bull: mean=0.6074, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: market_regime_choppy: mean=0.2125, std=0.4091, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: market_regime_downtrend: mean=0.2582, std=0.4377, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: market_regime_range: mean=0.2195, std=0.4139, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: market_regime_uptrend: mean=0.3098, std=0.4625, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:05:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:05:38] INFO train_model: Auditing data quality before training...
[2025-07-19 00:05:38] INFO train_model: Entering audit_data_quality
[2025-07-19 00:20:09] INFO train_model: Model is starting a new training session...
[2025-07-19 00:20:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:20:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:20:09] INFO train_model: Preparing target variable...
[2025-07-19 00:20:09] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:20:09] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:20:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:20:09] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:20:09] INFO train_model: Dropping NaN targets...
[2025-07-19 00:20:10] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 00:20:10] INFO train_model: Upsampling successful.
[2025-07-19 00:20:10] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:20:10] INFO train_model: Splitting train/test...
[2025-07-19 00:20:10] INFO train_model: Scaling features...
[2025-07-19 00:20:10] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:20:10] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:20:12] INFO train_model: Model fit complete.
[2025-07-19 00:20:12] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 00:20:12] INFO train_model: 
Classification Report:
[2025-07-19 00:20:12] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 00:20:12] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 00:20:12] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 00:20:12] INFO train_model: Feature distributions before training:
[2025-07-19 00:20:12] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 00:20:12] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 00:20:12] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 00:20:12] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 00:20:12] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 00:20:12] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 00:20:12] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 00:20:12] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 00:20:12] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 00:20:12] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 00:20:12] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 00:20:12] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 00:20:12] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 00:20:12] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 00:20:12] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 00:20:12] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 00:20:12] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 00:20:12] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 00:20:12] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 00:20:12] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 00:20:12] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 00:20:12] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 00:20:12] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 00:20:12] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 00:20:12] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 00:20:12] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 00:20:12] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 00:20:12] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 00:20:12] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 00:20:12] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 00:20:12] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 00:20:12] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 00:20:12] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:12] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:12] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:12] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 00:20:12] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 00:20:12] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:12] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 00:20:12] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 00:20:12] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 00:20:12] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 00:20:12] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 00:20:12] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 00:20:12] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 00:20:12] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 00:20:12] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 00:20:12] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 00:20:12] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 00:20:12] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:12] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:12] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:12] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:12] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:20:12] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 00:20:12] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 00:20:12] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 00:20:12] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 00:20:12] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 00:20:12] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:20:12] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:20:12] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:20:12] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:20:12] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:20:12] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 00:20:12] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 00:20:12] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:12] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:12] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:12] INFO train_model: Auditing data quality before training...
[2025-07-19 00:20:12] INFO train_model: Entering audit_data_quality
[2025-07-19 00:20:17] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:20:20] INFO train_model: Model is starting a new training session...
[2025-07-19 00:20:20] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:20:20] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:20:20] INFO train_model: Preparing target variable...
[2025-07-19 00:20:20] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:20:20] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:20:20] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:20:20] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:20:20] INFO train_model: Dropping NaN targets...
[2025-07-19 00:20:20] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 00:20:20] INFO train_model: Upsampling successful.
[2025-07-19 00:20:20] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:20:20] INFO train_model: Splitting train/test...
[2025-07-19 00:20:20] INFO train_model: Scaling features...
[2025-07-19 00:20:20] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:20:20] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:20:22] INFO train_model: Model fit complete.
[2025-07-19 00:20:22] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 00:20:22] INFO train_model: 
Classification Report:
[2025-07-19 00:20:22] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 00:20:22] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 00:20:22] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 00:20:22] INFO train_model: Feature distributions before training:
[2025-07-19 00:20:22] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 00:20:22] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 00:20:22] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 00:20:22] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 00:20:22] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 00:20:22] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 00:20:22] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 00:20:22] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 00:20:22] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 00:20:22] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 00:20:22] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 00:20:22] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 00:20:22] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 00:20:22] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 00:20:22] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 00:20:22] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 00:20:22] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 00:20:22] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 00:20:22] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 00:20:22] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 00:20:22] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 00:20:22] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 00:20:22] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 00:20:22] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 00:20:22] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 00:20:22] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 00:20:22] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 00:20:22] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 00:20:22] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 00:20:22] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 00:20:22] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 00:20:22] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 00:20:22] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:22] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:22] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:22] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 00:20:22] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 00:20:22] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:22] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 00:20:22] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 00:20:22] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 00:20:22] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 00:20:22] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 00:20:22] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 00:20:22] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 00:20:22] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 00:20:22] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 00:20:22] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 00:20:22] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 00:20:22] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:22] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:22] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:20:22] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:22] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:20:22] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 00:20:22] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 00:20:22] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 00:20:22] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 00:20:22] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 00:20:22] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:20:22] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:20:22] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:20:22] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:20:22] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:20:22] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 00:20:22] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 00:20:22] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:22] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:22] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:22] INFO train_model: Auditing data quality before training...
[2025-07-19 00:20:22] INFO train_model: Entering audit_data_quality
[2025-07-19 00:20:27] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:20:37] INFO train_model: Model is starting a new training session...
[2025-07-19 00:20:37] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:20:37] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:20:37] INFO train_model: Preparing target variable...
[2025-07-19 00:20:37] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:20:37] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:20:37] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:20:37] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:20:37] INFO train_model: Dropping NaN targets...
[2025-07-19 00:20:37] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 00:20:37] INFO train_model: Upsampling successful.
[2025-07-19 00:20:37] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:20:37] INFO train_model: Splitting train/test...
[2025-07-19 00:20:37] INFO train_model: Scaling features...
[2025-07-19 00:20:37] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:20:37] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:20:40] INFO train_model: Model fit complete.
[2025-07-19 00:20:40] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 00:20:40] INFO train_model: 
Classification Report:
[2025-07-19 00:20:40] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 00:20:40] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 00:20:40] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd2a3f9696a22ac049479f92536f55c6d'}}
[2025-07-19 00:20:40] INFO train_model: Feature distributions before training:
[2025-07-19 00:20:40] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 00:20:40] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 00:20:40] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 00:20:40] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 00:20:40] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 00:20:40] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 00:20:40] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 00:20:40] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 00:20:40] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 00:20:40] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 00:20:40] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 00:20:40] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 00:20:40] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 00:20:40] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 00:20:40] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 00:20:40] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 00:20:40] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 00:20:40] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 00:20:40] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 00:20:40] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 00:20:40] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 00:20:40] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 00:20:40] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 00:20:40] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 00:20:40] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 00:20:40] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 00:20:40] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 00:20:40] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 00:20:40] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 00:20:40] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 00:20:40] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 00:20:40] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 00:20:40] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:40] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:40] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:40] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 00:20:40] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 00:20:40] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:40] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 00:20:40] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 00:20:40] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 00:20:40] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 00:20:40] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 00:20:40] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 00:20:40] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 00:20:40] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 00:20:40] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 00:20:40] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 00:20:40] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 00:20:40] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:40] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:40] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:40] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:40] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:20:40] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 00:20:40] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 00:20:40] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 00:20:40] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 00:20:40] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 00:20:40] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:20:40] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:20:40] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 00:20:40] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:20:40] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:20:40] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 00:20:40] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 00:20:40] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:40] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:40] INFO train_model: Auditing data quality before training...
[2025-07-19 00:20:40] INFO train_model: Entering audit_data_quality
[2025-07-19 00:20:44] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:20:47] INFO train_model: Model is starting a new training session...
[2025-07-19 00:20:47] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:20:47] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:20:47] INFO train_model: Preparing target variable...
[2025-07-19 00:20:47] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:20:47] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:20:47] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:20:47] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:20:47] INFO train_model: Dropping NaN targets...
[2025-07-19 00:20:47] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 00:20:47] INFO train_model: Upsampling successful.
[2025-07-19 00:20:47] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:20:47] INFO train_model: Splitting train/test...
[2025-07-19 00:20:47] INFO train_model: Scaling features...
[2025-07-19 00:20:47] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:20:47] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:20:49] INFO train_model: Model fit complete.
[2025-07-19 00:20:49] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 00:20:49] INFO train_model: 
Classification Report:
[2025-07-19 00:20:49] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 00:20:49] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 00:20:49] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd2a3f9696a22ac049479f92536f55c6d'}}
[2025-07-19 00:20:49] INFO train_model: Feature distributions before training:
[2025-07-19 00:20:49] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 00:20:49] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 00:20:49] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 00:20:49] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 00:20:49] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 00:20:49] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 00:20:49] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 00:20:49] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 00:20:49] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 00:20:49] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 00:20:49] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 00:20:49] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 00:20:49] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 00:20:49] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 00:20:49] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 00:20:49] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 00:20:49] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 00:20:49] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 00:20:49] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 00:20:49] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 00:20:49] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 00:20:49] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 00:20:49] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 00:20:49] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 00:20:49] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 00:20:49] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 00:20:49] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 00:20:49] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 00:20:49] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 00:20:49] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 00:20:49] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 00:20:49] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 00:20:49] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:49] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:49] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:49] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 00:20:49] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 00:20:49] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:49] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 00:20:49] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 00:20:49] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 00:20:49] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 00:20:49] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 00:20:49] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 00:20:49] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 00:20:49] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 00:20:49] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 00:20:49] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 00:20:49] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 00:20:49] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:49] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:49] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 00:20:49] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:49] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:20:49] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 00:20:49] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 00:20:49] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 00:20:49] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 00:20:49] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 00:20:49] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:20:49] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:20:49] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 00:20:49] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:20:49] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:20:49] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 00:20:49] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 00:20:49] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:20:49] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:20:49] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:20:49] INFO train_model: Auditing data quality before training...
[2025-07-19 00:20:49] INFO train_model: Entering audit_data_quality
[2025-07-19 00:20:54] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:21:05] INFO train_model: Model is starting a new training session...
[2025-07-19 00:21:05] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:21:05] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:21:05] INFO train_model: Preparing target variable...
[2025-07-19 00:21:05] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:21:05] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:21:05] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:21:05] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:21:05] INFO train_model: Dropping NaN targets...
[2025-07-19 00:21:05] INFO train_model: Class balance before upsampling: {0: 3426, 1: 1272}
[2025-07-19 00:21:05] INFO train_model: Upsampling successful.
[2025-07-19 00:21:05] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:21:05] INFO train_model: Splitting train/test...
[2025-07-19 00:21:05] INFO train_model: Scaling features...
[2025-07-19 00:21:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:21:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:21:07] INFO train_model: Model fit complete.
[2025-07-19 00:21:07] INFO train_model: Model Accuracy: 0.9059
[2025-07-19 00:21:07] INFO train_model: 
Classification Report:
[2025-07-19 00:21:07] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.90      0.91       686
           1       0.90      0.91      0.91       685

    accuracy                           0.91      1371
   macro avg       0.91      0.91      0.91      1371
weighted avg       0.91      0.91      0.91      1371

[2025-07-19 00:21:07] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 00:21:07] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': 'a36a889b62f1371c96a2129e8900e40e'}}
[2025-07-19 00:21:07] INFO train_model: Feature distributions before training:
[2025-07-19 00:21:07] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4686
[2025-07-19 00:21:07] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4674
[2025-07-19 00:21:07] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4672
[2025-07-19 00:21:07] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4646
[2025-07-19 00:21:07] INFO train_model: sma_200: mean=0.8642, std=0.0363, min=0.7943, max=0.9132, unique=4495
[2025-07-19 00:21:07] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4698
[2025-07-19 00:21:07] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4698
[2025-07-19 00:21:07] INFO train_model: rsi_14: mean=49.8631, std=12.3988, min=7.7095, max=97.7161, unique=4664
[2025-07-19 00:21:07] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4673
[2025-07-19 00:21:07] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4665
[2025-07-19 00:21:07] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4677
[2025-07-19 00:21:07] INFO train_model: bb_low: mean=0.8600, std=0.0381, min=0.7878, max=0.9160, unique=4677
[2025-07-19 00:21:07] INFO train_model: stoch_k: mean=51.0566, std=26.3720, min=0.6580, max=98.9585, unique=4646
[2025-07-19 00:21:07] INFO train_model: stoch_d: mean=51.0798, std=24.0633, min=3.0053, max=95.8670, unique=4679
[2025-07-19 00:21:07] INFO train_model: fib_0: mean=0.8661, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 00:21:07] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=2430
[2025-07-19 00:21:07] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 00:21:07] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4619
[2025-07-19 00:21:07] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 00:21:07] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4619
[2025-07-19 00:21:07] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2040
[2025-07-19 00:21:07] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=4125
[2025-07-19 00:21:07] INFO train_model: fib_618: mean=0.8621, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 00:21:07] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4619
[2025-07-19 00:21:07] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 00:21:07] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4619
[2025-07-19 00:21:07] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 00:21:07] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=2380
[2025-07-19 00:21:07] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=3110
[2025-07-19 00:21:07] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=3122
[2025-07-19 00:21:07] INFO train_model: trendline_up: mean=0.5009, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=2487
[2025-07-19 00:21:07] INFO train_model: dist_to_low: mean=0.0032, std=0.0027, min=-0.0015, max=0.0207, unique=2431
[2025-07-19 00:21:07] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: vol_spike_std: mean=0.1560, std=0.3629, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: supply_zone: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: demand_zone: mean=0.4857, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:07] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:07] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:07] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: choch: mean=0.1620, std=0.3685, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4677
[2025-07-19 00:21:07] INFO train_model: vol_cluster_high: mean=0.1062, std=0.3081, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: regime_zscore: mean=-0.0097, std=1.0052, min=-5.9027, max=7.4977, unique=4598
[2025-07-19 00:21:07] INFO train_model: doji: mean=0.1237, std=0.3292, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bullish_engulfing: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bearish_engulfing: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: pin_bar: mean=0.3125, std=0.4636, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bullish_engulfing_bar: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bearish_engulfing_bar: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: inside_bar: mean=0.1428, std=0.3499, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: head_shoulders: mean=0.0343, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: rising_wedge: mean=0.2252, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: falling_wedge: mean=0.2320, std=0.4222, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: bullish_flag: mean=0.0245, std=0.1545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bearish_flag: mean=0.0289, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bullish_pennant: mean=0.1337, std=0.3403, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bearish_pennant: mean=0.1433, std=0.3504, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: morning_star: mean=0.0370, std=0.1889, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: evening_star: mean=0.0402, std=0.1965, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bullish_harami: mean=0.0575, std=0.2328, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: bearish_harami: mean=0.0445, std=0.2062, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8249, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:07] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4645
[2025-07-19 00:21:07] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4620
[2025-07-19 00:21:07] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4698
[2025-07-19 00:21:07] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4698
[2025-07-19 00:21:07] INFO train_model: rsi_14_4h: mean=51.1069, std=32.6123, min=0.0000, max=100.0000, unique=1782
[2025-07-19 00:21:07] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4698
[2025-07-19 00:21:07] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4698
[2025-07-19 00:21:07] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4647
[2025-07-19 00:21:07] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4647
[2025-07-19 00:21:07] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4683
[2025-07-19 00:21:07] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4637
[2025-07-19 00:21:07] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:07] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:07] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:07] INFO train_model: structure_trend_4h: mean=0.8169, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:07] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:21:07] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4628
[2025-07-19 00:21:07] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4698
[2025-07-19 00:21:07] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4698
[2025-07-19 00:21:07] INFO train_model: rsi_14_1d: mean=47.2116, std=49.9275, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4698
[2025-07-19 00:21:07] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4698
[2025-07-19 00:21:07] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:21:07] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:21:07] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 00:21:07] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:21:07] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:21:07] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4628
[2025-07-19 00:21:07] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4628
[2025-07-19 00:21:07] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2842, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:07] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: regime_label_bear: mean=0.4870, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: regime_label_bull: mean=0.4704, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2019, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: market_regime_consolidation: mean=0.0534, std=0.2249, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: market_regime_downtrend: mean=0.2256, std=0.4180, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: market_regime_range: mean=0.5285, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: market_regime_uptrend: mean=0.1645, std=0.3708, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:07] INFO train_model: Auditing data quality before training...
[2025-07-19 00:21:07] INFO train_model: Entering audit_data_quality
[2025-07-19 00:21:12] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:21:14] INFO train_model: Model is starting a new training session...
[2025-07-19 00:21:14] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:21:14] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:21:14] INFO train_model: Preparing target variable...
[2025-07-19 00:21:14] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:21:14] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:21:14] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:21:15] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:21:15] INFO train_model: Dropping NaN targets...
[2025-07-19 00:21:15] INFO train_model: Class balance before upsampling: {0: 3426, 1: 1272}
[2025-07-19 00:21:15] INFO train_model: Upsampling successful.
[2025-07-19 00:21:15] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:21:15] INFO train_model: Splitting train/test...
[2025-07-19 00:21:15] INFO train_model: Scaling features...
[2025-07-19 00:21:15] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:21:15] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:21:17] INFO train_model: Model fit complete.
[2025-07-19 00:21:17] INFO train_model: Model Accuracy: 0.9059
[2025-07-19 00:21:17] INFO train_model: 
Classification Report:
[2025-07-19 00:21:17] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.90      0.91       686
           1       0.90      0.91      0.91       685

    accuracy                           0.91      1371
   macro avg       0.91      0.91      0.91      1371
weighted avg       0.91      0.91      0.91      1371

[2025-07-19 00:21:17] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 00:21:17] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': 'a36a889b62f1371c96a2129e8900e40e'}}
[2025-07-19 00:21:17] INFO train_model: Feature distributions before training:
[2025-07-19 00:21:17] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4686
[2025-07-19 00:21:17] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4674
[2025-07-19 00:21:17] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4672
[2025-07-19 00:21:17] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4646
[2025-07-19 00:21:17] INFO train_model: sma_200: mean=0.8642, std=0.0363, min=0.7943, max=0.9132, unique=4495
[2025-07-19 00:21:17] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4698
[2025-07-19 00:21:17] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4698
[2025-07-19 00:21:17] INFO train_model: rsi_14: mean=49.8631, std=12.3988, min=7.7095, max=97.7161, unique=4664
[2025-07-19 00:21:17] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4673
[2025-07-19 00:21:17] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4665
[2025-07-19 00:21:17] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4677
[2025-07-19 00:21:17] INFO train_model: bb_low: mean=0.8600, std=0.0381, min=0.7878, max=0.9160, unique=4677
[2025-07-19 00:21:17] INFO train_model: stoch_k: mean=51.0566, std=26.3720, min=0.6580, max=98.9585, unique=4646
[2025-07-19 00:21:17] INFO train_model: stoch_d: mean=51.0798, std=24.0633, min=3.0053, max=95.8670, unique=4679
[2025-07-19 00:21:17] INFO train_model: fib_0: mean=0.8661, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 00:21:17] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=2430
[2025-07-19 00:21:17] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 00:21:17] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4619
[2025-07-19 00:21:17] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 00:21:17] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4619
[2025-07-19 00:21:17] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2040
[2025-07-19 00:21:17] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=4125
[2025-07-19 00:21:17] INFO train_model: fib_618: mean=0.8621, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 00:21:17] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4619
[2025-07-19 00:21:17] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 00:21:17] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4619
[2025-07-19 00:21:17] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 00:21:17] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=2380
[2025-07-19 00:21:17] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=3110
[2025-07-19 00:21:17] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=3122
[2025-07-19 00:21:17] INFO train_model: trendline_up: mean=0.5009, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=2487
[2025-07-19 00:21:17] INFO train_model: dist_to_low: mean=0.0032, std=0.0027, min=-0.0015, max=0.0207, unique=2431
[2025-07-19 00:21:17] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: vol_spike_std: mean=0.1560, std=0.3629, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: supply_zone: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: demand_zone: mean=0.4857, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:17] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:17] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:17] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: choch: mean=0.1620, std=0.3685, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4677
[2025-07-19 00:21:17] INFO train_model: vol_cluster_high: mean=0.1062, std=0.3081, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: regime_zscore: mean=-0.0097, std=1.0052, min=-5.9027, max=7.4977, unique=4598
[2025-07-19 00:21:17] INFO train_model: doji: mean=0.1237, std=0.3292, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bullish_engulfing: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bearish_engulfing: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: pin_bar: mean=0.3125, std=0.4636, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bullish_engulfing_bar: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bearish_engulfing_bar: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: inside_bar: mean=0.1428, std=0.3499, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: head_shoulders: mean=0.0343, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: rising_wedge: mean=0.2252, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: falling_wedge: mean=0.2320, std=0.4222, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: bullish_flag: mean=0.0245, std=0.1545, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bearish_flag: mean=0.0289, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bullish_pennant: mean=0.1337, std=0.3403, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bearish_pennant: mean=0.1433, std=0.3504, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: morning_star: mean=0.0370, std=0.1889, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: evening_star: mean=0.0402, std=0.1965, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bullish_harami: mean=0.0575, std=0.2328, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: bearish_harami: mean=0.0445, std=0.2062, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8249, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:17] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4645
[2025-07-19 00:21:17] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4620
[2025-07-19 00:21:17] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4698
[2025-07-19 00:21:17] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4698
[2025-07-19 00:21:17] INFO train_model: rsi_14_4h: mean=51.1069, std=32.6123, min=0.0000, max=100.0000, unique=1782
[2025-07-19 00:21:17] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4698
[2025-07-19 00:21:17] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4698
[2025-07-19 00:21:17] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4647
[2025-07-19 00:21:17] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4647
[2025-07-19 00:21:17] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4683
[2025-07-19 00:21:17] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4637
[2025-07-19 00:21:17] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:17] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:17] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 00:21:17] INFO train_model: structure_trend_4h: mean=0.8169, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:17] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:21:17] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4628
[2025-07-19 00:21:17] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4698
[2025-07-19 00:21:17] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4698
[2025-07-19 00:21:17] INFO train_model: rsi_14_1d: mean=47.2116, std=49.9275, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4698
[2025-07-19 00:21:17] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4698
[2025-07-19 00:21:17] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:21:17] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:21:17] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 00:21:17] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:21:17] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:21:17] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4628
[2025-07-19 00:21:17] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4628
[2025-07-19 00:21:17] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2842, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:17] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: regime_label_bear: mean=0.4870, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: regime_label_bull: mean=0.4704, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2019, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: market_regime_consolidation: mean=0.0534, std=0.2249, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: market_regime_downtrend: mean=0.2256, std=0.4180, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: market_regime_range: mean=0.5285, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: market_regime_uptrend: mean=0.1645, std=0.3708, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:17] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:17] INFO train_model: Auditing data quality before training...
[2025-07-19 00:21:17] INFO train_model: Entering audit_data_quality
[2025-07-19 00:21:22] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:21:32] INFO train_model: Model is starting a new training session...
[2025-07-19 00:21:32] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:21:32] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:21:32] INFO train_model: Preparing target variable...
[2025-07-19 00:21:32] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:21:32] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:21:32] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:21:32] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:21:32] INFO train_model: Dropping NaN targets...
[2025-07-19 00:21:32] INFO train_model: Class balance before upsampling: {0: 3092, 1: 1634}
[2025-07-19 00:21:32] INFO train_model: Upsampling successful.
[2025-07-19 00:21:32] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:21:32] INFO train_model: Splitting train/test...
[2025-07-19 00:21:32] INFO train_model: Scaling features...
[2025-07-19 00:21:32] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:21:32] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:21:34] INFO train_model: Model fit complete.
[2025-07-19 00:21:34] INFO train_model: Model Accuracy: 0.8828
[2025-07-19 00:21:34] INFO train_model: 
Classification Report:
[2025-07-19 00:21:34] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       619
           1       0.88      0.88      0.88       618

    accuracy                           0.88      1237
   macro avg       0.88      0.88      0.88      1237
weighted avg       0.88      0.88      0.88      1237

[2025-07-19 00:21:34] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 00:21:34] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '46975954b9064b2dac5cdbcbe3844bca'}}
[2025-07-19 00:21:34] INFO train_model: Feature distributions before training:
[2025-07-19 00:21:34] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4714
[2025-07-19 00:21:34] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4687
[2025-07-19 00:21:34] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4691
[2025-07-19 00:21:34] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4662
[2025-07-19 00:21:34] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4524
[2025-07-19 00:21:34] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4726
[2025-07-19 00:21:34] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4726
[2025-07-19 00:21:34] INFO train_model: rsi_14: mean=49.3849, std=12.3827, min=11.3290, max=91.7839, unique=4589
[2025-07-19 00:21:34] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4701
[2025-07-19 00:21:34] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4693
[2025-07-19 00:21:34] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4693
[2025-07-19 00:21:34] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4693
[2025-07-19 00:21:34] INFO train_model: stoch_k: mean=49.1792, std=28.8128, min=0.0000, max=100.0000, unique=4552
[2025-07-19 00:21:34] INFO train_model: stoch_d: mean=49.2137, std=26.3670, min=2.3676, max=99.2269, unique=4697
[2025-07-19 00:21:34] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-19 00:21:34] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4327
[2025-07-19 00:21:34] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2134
[2025-07-19 00:21:34] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4559
[2025-07-19 00:21:34] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2134
[2025-07-19 00:21:34] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4559
[2025-07-19 00:21:34] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2134
[2025-07-19 00:21:34] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4552
[2025-07-19 00:21:34] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2134
[2025-07-19 00:21:34] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4559
[2025-07-19 00:21:34] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2134
[2025-07-19 00:21:34] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4559
[2025-07-19 00:21:34] INFO train_model: fib_100: mean=0.5818, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-19 00:21:34] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4299
[2025-07-19 00:21:34] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4623
[2025-07-19 00:21:34] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4618
[2025-07-19 00:21:34] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: trendline_down: mean=0.5245, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4313
[2025-07-19 00:21:34] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4297
[2025-07-19 00:21:34] INFO train_model: vol_spike_atr: mean=0.0154, std=0.1233, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: supply_zone: mean=0.4094, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: demand_zone: mean=0.4245, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:34] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:34] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:34] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: bos: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: choch: mean=0.1504, std=0.3575, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4700
[2025-07-19 00:21:34] INFO train_model: vol_cluster_high: mean=0.0751, std=0.2636, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: regime_zscore: mean=0.0090, std=1.0066, min=-7.1754, max=7.0756, unique=4626
[2025-07-19 00:21:34] INFO train_model: doji: mean=0.0961, std=0.2947, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: hammer: mean=0.0174, std=0.1306, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bullish_engulfing: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bearish_engulfing: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: pin_bar: mean=0.2357, std=0.4245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bullish_engulfing_bar: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bearish_engulfing_bar: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: inside_bar: mean=0.1126, std=0.3161, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: double_top: mean=0.0110, std=0.1043, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: double_bottom: mean=0.0229, std=0.1494, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: rising_wedge: mean=0.2391, std=0.4266, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: falling_wedge: mean=0.2482, std=0.4320, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: fakeout_up: mean=0.0066, std=0.0807, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: fakeout_down: mean=0.0076, std=0.0870, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bullish_flag: mean=0.0250, std=0.1560, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bearish_flag: mean=0.0222, std=0.1474, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bullish_pennant: mean=0.1306, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bearish_pennant: mean=0.1242, std=0.3299, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: morning_star: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: evening_star: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bullish_harami: mean=0.0406, std=0.1974, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: bearish_harami: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: dark_cloud_cover: mean=0.0781, std=0.2683, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:34] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 00:21:34] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 00:21:34] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 00:21:34] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 00:21:34] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 00:21:34] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 00:21:34] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 00:21:34] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 00:21:34] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 00:21:34] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 00:21:34] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 00:21:34] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:34] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:34] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:34] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:34] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:21:34] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 00:21:34] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 00:21:34] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 00:21:34] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 00:21:34] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 00:21:34] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:21:34] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:21:34] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:21:34] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:21:34] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:21:34] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 00:21:34] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 00:21:34] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:34] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: regime_label_bear: mean=0.5099, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: regime_label_bull: mean=0.4477, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: market_regime_consolidation: mean=0.2120, std=0.4088, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: market_regime_downtrend: mean=0.1885, std=0.3912, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: market_regime_range: mean=0.4075, std=0.4914, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: market_regime_uptrend: mean=0.1902, std=0.3925, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:34] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:34] INFO train_model: Auditing data quality before training...
[2025-07-19 00:21:34] INFO train_model: Entering audit_data_quality
[2025-07-19 00:21:39] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:21:42] INFO train_model: Model is starting a new training session...
[2025-07-19 00:21:42] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:21:42] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 00:21:42] INFO train_model: Preparing target variable...
[2025-07-19 00:21:42] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:21:42] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:21:42] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 00:21:42] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:21:42] INFO train_model: Dropping NaN targets...
[2025-07-19 00:21:42] INFO train_model: Class balance before upsampling: {0: 3092, 1: 1634}
[2025-07-19 00:21:42] INFO train_model: Upsampling successful.
[2025-07-19 00:21:42] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:21:42] INFO train_model: Splitting train/test...
[2025-07-19 00:21:42] INFO train_model: Scaling features...
[2025-07-19 00:21:42] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:21:42] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:21:44] INFO train_model: Model fit complete.
[2025-07-19 00:21:44] INFO train_model: Model Accuracy: 0.8828
[2025-07-19 00:21:44] INFO train_model: 
Classification Report:
[2025-07-19 00:21:44] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       619
           1       0.88      0.88      0.88       618

    accuracy                           0.88      1237
   macro avg       0.88      0.88      0.88      1237
weighted avg       0.88      0.88      0.88      1237

[2025-07-19 00:21:44] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 00:21:44] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '46975954b9064b2dac5cdbcbe3844bca'}}
[2025-07-19 00:21:44] INFO train_model: Feature distributions before training:
[2025-07-19 00:21:44] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4714
[2025-07-19 00:21:44] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4687
[2025-07-19 00:21:44] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4691
[2025-07-19 00:21:44] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4662
[2025-07-19 00:21:44] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4524
[2025-07-19 00:21:44] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4726
[2025-07-19 00:21:44] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4726
[2025-07-19 00:21:44] INFO train_model: rsi_14: mean=49.3849, std=12.3827, min=11.3290, max=91.7839, unique=4589
[2025-07-19 00:21:44] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4701
[2025-07-19 00:21:44] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4693
[2025-07-19 00:21:44] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4693
[2025-07-19 00:21:44] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4693
[2025-07-19 00:21:44] INFO train_model: stoch_k: mean=49.1792, std=28.8128, min=0.0000, max=100.0000, unique=4552
[2025-07-19 00:21:44] INFO train_model: stoch_d: mean=49.2137, std=26.3670, min=2.3676, max=99.2269, unique=4697
[2025-07-19 00:21:44] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-19 00:21:44] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4327
[2025-07-19 00:21:44] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2134
[2025-07-19 00:21:44] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4559
[2025-07-19 00:21:44] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2134
[2025-07-19 00:21:44] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4559
[2025-07-19 00:21:44] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2134
[2025-07-19 00:21:44] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4552
[2025-07-19 00:21:44] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2134
[2025-07-19 00:21:44] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4559
[2025-07-19 00:21:44] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2134
[2025-07-19 00:21:44] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4559
[2025-07-19 00:21:44] INFO train_model: fib_100: mean=0.5818, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-19 00:21:44] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4299
[2025-07-19 00:21:44] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4623
[2025-07-19 00:21:44] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4618
[2025-07-19 00:21:44] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: trendline_down: mean=0.5245, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4313
[2025-07-19 00:21:44] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4297
[2025-07-19 00:21:44] INFO train_model: vol_spike_atr: mean=0.0154, std=0.1233, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: supply_zone: mean=0.4094, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: demand_zone: mean=0.4245, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:44] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:44] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:44] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: bos: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: choch: mean=0.1504, std=0.3575, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4700
[2025-07-19 00:21:44] INFO train_model: vol_cluster_high: mean=0.0751, std=0.2636, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: regime_zscore: mean=0.0090, std=1.0066, min=-7.1754, max=7.0756, unique=4626
[2025-07-19 00:21:44] INFO train_model: doji: mean=0.0961, std=0.2947, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: hammer: mean=0.0174, std=0.1306, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bullish_engulfing: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bearish_engulfing: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: pin_bar: mean=0.2357, std=0.4245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bullish_engulfing_bar: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bearish_engulfing_bar: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: inside_bar: mean=0.1126, std=0.3161, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: double_top: mean=0.0110, std=0.1043, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: double_bottom: mean=0.0229, std=0.1494, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: rising_wedge: mean=0.2391, std=0.4266, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: falling_wedge: mean=0.2482, std=0.4320, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: fakeout_up: mean=0.0066, std=0.0807, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: fakeout_down: mean=0.0076, std=0.0870, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bullish_flag: mean=0.0250, std=0.1560, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bearish_flag: mean=0.0222, std=0.1474, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bullish_pennant: mean=0.1306, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bearish_pennant: mean=0.1242, std=0.3299, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: morning_star: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: evening_star: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bullish_harami: mean=0.0406, std=0.1974, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: bearish_harami: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: dark_cloud_cover: mean=0.0781, std=0.2683, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:44] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 00:21:44] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 00:21:44] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 00:21:44] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 00:21:44] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 00:21:44] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 00:21:44] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 00:21:44] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 00:21:44] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 00:21:44] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 00:21:44] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 00:21:44] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:44] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:44] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 00:21:44] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:44] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:21:44] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 00:21:44] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 00:21:44] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 00:21:44] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 00:21:44] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 00:21:44] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:21:44] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:21:44] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:21:44] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:21:44] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:21:44] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 00:21:44] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 00:21:44] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:21:44] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: regime_label_bear: mean=0.5099, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: regime_label_bull: mean=0.4477, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: market_regime_consolidation: mean=0.2120, std=0.4088, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: market_regime_downtrend: mean=0.1885, std=0.3912, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: market_regime_range: mean=0.4075, std=0.4914, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: market_regime_uptrend: mean=0.1902, std=0.3925, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:21:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:21:44] INFO train_model: Auditing data quality before training...
[2025-07-19 00:21:44] INFO train_model: Entering audit_data_quality
[2025-07-19 00:21:49] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:21:59] INFO train_model: Model is starting a new training session...
[2025-07-19 00:21:59] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:21:59] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:21:59] INFO train_model: Preparing target variable...
[2025-07-19 00:21:59] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:21:59] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:21:59] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:21:59] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:21:59] INFO train_model: Dropping NaN targets...
[2025-07-19 00:21:59] INFO train_model: Class balance before upsampling: {0: 3158, 1: 1566}
[2025-07-19 00:21:59] INFO train_model: Upsampling successful.
[2025-07-19 00:21:59] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:21:59] INFO train_model: Splitting train/test...
[2025-07-19 00:21:59] INFO train_model: Scaling features...
[2025-07-19 00:21:59] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:21:59] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:22:01] INFO train_model: Model fit complete.
[2025-07-19 00:22:01] INFO train_model: Model Accuracy: 0.8782
[2025-07-19 00:22:01] INFO train_model: 
Classification Report:
[2025-07-19 00:22:01] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       632
           1       0.88      0.88      0.88       632

    accuracy                           0.88      1264
   macro avg       0.88      0.88      0.88      1264
weighted avg       0.88      0.88      0.88      1264

[2025-07-19 00:22:01] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 00:22:01] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '6d8690ed5b572aeaa54af22750c34057'}}
[2025-07-19 00:22:01] INFO train_model: Feature distributions before training:
[2025-07-19 00:22:01] INFO train_model: atr_14: mean=0.3453, std=0.1085, min=0.0000, max=0.8613, unique=4712
[2025-07-19 00:22:01] INFO train_model: volatility_20: mean=0.3104, std=0.1648, min=0.0681, max=1.3557, unique=4704
[2025-07-19 00:22:01] INFO train_model: sma_20: mean=162.8970, std=3.4592, min=155.8359, max=172.8918, unique=4704
[2025-07-19 00:22:01] INFO train_model: sma_50: mean=162.8653, std=3.3929, min=156.1946, max=172.5970, unique=4672
[2025-07-19 00:22:01] INFO train_model: sma_200: mean=162.7251, std=3.0704, min=156.6790, max=172.1544, unique=4521
[2025-07-19 00:22:01] INFO train_model: ema_12: mean=162.9049, std=3.4734, min=155.6248, max=172.9037, unique=4724
[2025-07-19 00:22:01] INFO train_model: ema_26: mean=162.8909, std=3.4369, min=155.9072, max=172.7909, unique=4724
[2025-07-19 00:22:01] INFO train_model: rsi_14: mean=51.0080, std=11.8331, min=16.6264, max=87.9679, unique=4699
[2025-07-19 00:22:01] INFO train_model: macd: mean=0.0142, std=0.2003, min=-0.5343, max=0.7069, unique=4699
[2025-07-19 00:22:01] INFO train_model: macd_signal: mean=0.0136, std=0.1871, min=-0.4700, max=0.6611, unique=4691
[2025-07-19 00:22:01] INFO train_model: bb_high: mean=163.5020, std=3.3766, min=156.6277, max=173.3643, unique=4704
[2025-07-19 00:22:01] INFO train_model: bb_low: mean=162.2919, std=3.5689, min=154.8377, max=172.7094, unique=4704
[2025-07-19 00:22:01] INFO train_model: stoch_k: mean=52.6125, std=26.1493, min=0.0000, max=99.4364, unique=4698
[2025-07-19 00:22:01] INFO train_model: stoch_d: mean=52.6532, std=23.9367, min=3.6709, max=96.7048, unique=4708
[2025-07-19 00:22:01] INFO train_model: fib_0: mean=163.5464, std=3.3571, min=156.7820, max=173.2420, unique=1122
[2025-07-19 00:22:01] INFO train_model: dist_to_fib_0: mean=-0.6294, std=0.4939, min=-3.4340, max=-0.0090, unique=3106
[2025-07-19 00:22:01] INFO train_model: fib_236: mean=163.2300, std=3.4014, min=156.3121, max=173.0891, unique=2150
[2025-07-19 00:22:01] INFO train_model: dist_to_fib_236: mean=-0.3131, std=0.4371, min=-2.4716, max=0.9103, unique=4693
[2025-07-19 00:22:01] INFO train_model: fib_382: mean=163.0343, std=3.4314, min=156.0214, max=172.9945, unique=2150
[2025-07-19 00:22:01] INFO train_model: dist_to_fib_382: mean=-0.1174, std=0.4217, min=-1.8762, max=1.5799, unique=4693
[2025-07-19 00:22:01] INFO train_model: fib_500: mean=162.8762, std=3.4570, min=155.7865, max=172.9180, unique=2110
[2025-07-19 00:22:01] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4220, min=-1.4335, max=2.1210, unique=4391
[2025-07-19 00:22:01] INFO train_model: fib_618: mean=162.7180, std=3.4838, min=155.5516, max=172.8415, unique=2150
[2025-07-19 00:22:01] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4336, min=-1.0813, max=2.6622, unique=4693
[2025-07-19 00:22:01] INFO train_model: fib_786: mean=162.4928, std=3.5241, min=155.2171, max=172.7327, unique=2150
[2025-07-19 00:22:01] INFO train_model: dist_to_fib_786: mean=0.4241, std=0.4679, min=-0.5798, max=3.4326, unique=4693
[2025-07-19 00:22:01] INFO train_model: fib_100: mean=162.2060, std=3.5787, min=154.7910, max=172.5940, unique=1112
[2025-07-19 00:22:01] INFO train_model: dist_to_fib_100: mean=0.7110, std=0.5356, min=0.0000, max=4.4140, unique=3220
[2025-07-19 00:22:01] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=3776
[2025-07-19 00:22:01] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=3825
[2025-07-19 00:22:01] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: trendline_down: mean=0.4723, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: dist_to_high: mean=-0.6273, std=0.5162, min=-3.4340, max=0.3400, unique=3182
[2025-07-19 00:22:01] INFO train_model: dist_to_low: mean=0.7121, std=0.5611, min=-0.9330, max=4.4140, unique=3281
[2025-07-19 00:22:01] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: vol_spike_std: mean=0.1367, std=0.3436, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: supply_zone: mean=0.4773, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: demand_zone: mean=0.4005, std=0.4901, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:01] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:01] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:01] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: choch: mean=0.1507, std=0.3578, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4704
[2025-07-19 00:22:01] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2542, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: regime_zscore: mean=-0.0081, std=0.9939, min=-6.5566, max=5.1800, unique=4624
[2025-07-19 00:22:01] INFO train_model: doji: mean=0.1196, std=0.3245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: hammer: mean=0.0218, std=0.1461, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bearish_engulfing: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: pin_bar: mean=0.3135, std=0.4640, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bearish_engulfing_bar: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: inside_bar: mean=0.1452, std=0.3524, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: rising_wedge: mean=0.2688, std=0.4434, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: falling_wedge: mean=0.2299, std=0.4208, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bullish_flag: mean=0.0231, std=0.1502, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bearish_flag: mean=0.0229, std=0.1495, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bullish_pennant: mean=0.1376, std=0.3445, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bearish_pennant: mean=0.1304, std=0.3368, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: morning_star: mean=0.0419, std=0.2004, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: evening_star: mean=0.0381, std=0.1915, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bullish_harami: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: bearish_harami: mean=0.0491, std=0.2161, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: dark_cloud_cover: mean=0.1143, std=0.3182, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:01] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 00:22:01] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 00:22:01] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 00:22:01] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 00:22:01] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 00:22:01] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 00:22:01] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 00:22:01] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 00:22:01] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 00:22:01] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 00:22:01] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 00:22:01] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:01] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:01] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:01] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:01] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:22:01] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 00:22:01] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 00:22:01] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 00:22:01] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 00:22:01] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 00:22:01] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:22:01] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:22:01] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:22:01] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:22:01] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:22:01] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 00:22:01] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 00:22:01] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:01] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: regime_label_bear: mean=0.3861, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: regime_label_bull: mean=0.5715, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: market_regime_choppy: mean=0.2517, std=0.4340, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: market_regime_downtrend: mean=0.2189, std=0.4135, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: market_regime_range: mean=0.2949, std=0.4560, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: market_regime_uptrend: mean=0.2345, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:01] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:01] INFO train_model: Auditing data quality before training...
[2025-07-19 00:22:01] INFO train_model: Entering audit_data_quality
[2025-07-19 00:22:06] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:22:09] INFO train_model: Model is starting a new training session...
[2025-07-19 00:22:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:22:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:22:09] INFO train_model: Preparing target variable...
[2025-07-19 00:22:09] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:22:09] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:22:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:22:09] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:22:09] INFO train_model: Dropping NaN targets...
[2025-07-19 00:22:09] INFO train_model: Class balance before upsampling: {0: 3158, 1: 1566}
[2025-07-19 00:22:10] INFO train_model: Upsampling successful.
[2025-07-19 00:22:10] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:22:10] INFO train_model: Splitting train/test...
[2025-07-19 00:22:10] INFO train_model: Scaling features...
[2025-07-19 00:22:10] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:22:10] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:22:13] INFO train_model: Model fit complete.
[2025-07-19 00:22:13] INFO train_model: Model Accuracy: 0.8782
[2025-07-19 00:22:13] INFO train_model: 
Classification Report:
[2025-07-19 00:22:13] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       632
           1       0.88      0.88      0.88       632

    accuracy                           0.88      1264
   macro avg       0.88      0.88      0.88      1264
weighted avg       0.88      0.88      0.88      1264

[2025-07-19 00:22:13] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 00:22:13] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '6d8690ed5b572aeaa54af22750c34057'}}
[2025-07-19 00:22:13] INFO train_model: Feature distributions before training:
[2025-07-19 00:22:13] INFO train_model: atr_14: mean=0.3453, std=0.1085, min=0.0000, max=0.8613, unique=4712
[2025-07-19 00:22:13] INFO train_model: volatility_20: mean=0.3104, std=0.1648, min=0.0681, max=1.3557, unique=4704
[2025-07-19 00:22:13] INFO train_model: sma_20: mean=162.8970, std=3.4592, min=155.8359, max=172.8918, unique=4704
[2025-07-19 00:22:13] INFO train_model: sma_50: mean=162.8653, std=3.3929, min=156.1946, max=172.5970, unique=4672
[2025-07-19 00:22:13] INFO train_model: sma_200: mean=162.7251, std=3.0704, min=156.6790, max=172.1544, unique=4521
[2025-07-19 00:22:13] INFO train_model: ema_12: mean=162.9049, std=3.4734, min=155.6248, max=172.9037, unique=4724
[2025-07-19 00:22:13] INFO train_model: ema_26: mean=162.8909, std=3.4369, min=155.9072, max=172.7909, unique=4724
[2025-07-19 00:22:13] INFO train_model: rsi_14: mean=51.0080, std=11.8331, min=16.6264, max=87.9679, unique=4699
[2025-07-19 00:22:13] INFO train_model: macd: mean=0.0142, std=0.2003, min=-0.5343, max=0.7069, unique=4699
[2025-07-19 00:22:13] INFO train_model: macd_signal: mean=0.0136, std=0.1871, min=-0.4700, max=0.6611, unique=4691
[2025-07-19 00:22:13] INFO train_model: bb_high: mean=163.5020, std=3.3766, min=156.6277, max=173.3643, unique=4704
[2025-07-19 00:22:13] INFO train_model: bb_low: mean=162.2919, std=3.5689, min=154.8377, max=172.7094, unique=4704
[2025-07-19 00:22:13] INFO train_model: stoch_k: mean=52.6125, std=26.1493, min=0.0000, max=99.4364, unique=4698
[2025-07-19 00:22:13] INFO train_model: stoch_d: mean=52.6532, std=23.9367, min=3.6709, max=96.7048, unique=4708
[2025-07-19 00:22:13] INFO train_model: fib_0: mean=163.5464, std=3.3571, min=156.7820, max=173.2420, unique=1122
[2025-07-19 00:22:13] INFO train_model: dist_to_fib_0: mean=-0.6294, std=0.4939, min=-3.4340, max=-0.0090, unique=3106
[2025-07-19 00:22:13] INFO train_model: fib_236: mean=163.2300, std=3.4014, min=156.3121, max=173.0891, unique=2150
[2025-07-19 00:22:13] INFO train_model: dist_to_fib_236: mean=-0.3131, std=0.4371, min=-2.4716, max=0.9103, unique=4693
[2025-07-19 00:22:13] INFO train_model: fib_382: mean=163.0343, std=3.4314, min=156.0214, max=172.9945, unique=2150
[2025-07-19 00:22:13] INFO train_model: dist_to_fib_382: mean=-0.1174, std=0.4217, min=-1.8762, max=1.5799, unique=4693
[2025-07-19 00:22:13] INFO train_model: fib_500: mean=162.8762, std=3.4570, min=155.7865, max=172.9180, unique=2110
[2025-07-19 00:22:13] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4220, min=-1.4335, max=2.1210, unique=4391
[2025-07-19 00:22:13] INFO train_model: fib_618: mean=162.7180, std=3.4838, min=155.5516, max=172.8415, unique=2150
[2025-07-19 00:22:13] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4336, min=-1.0813, max=2.6622, unique=4693
[2025-07-19 00:22:13] INFO train_model: fib_786: mean=162.4928, std=3.5241, min=155.2171, max=172.7327, unique=2150
[2025-07-19 00:22:13] INFO train_model: dist_to_fib_786: mean=0.4241, std=0.4679, min=-0.5798, max=3.4326, unique=4693
[2025-07-19 00:22:13] INFO train_model: fib_100: mean=162.2060, std=3.5787, min=154.7910, max=172.5940, unique=1112
[2025-07-19 00:22:13] INFO train_model: dist_to_fib_100: mean=0.7110, std=0.5356, min=0.0000, max=4.4140, unique=3220
[2025-07-19 00:22:13] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=3776
[2025-07-19 00:22:13] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=3825
[2025-07-19 00:22:13] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: trendline_down: mean=0.4723, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: dist_to_high: mean=-0.6273, std=0.5162, min=-3.4340, max=0.3400, unique=3182
[2025-07-19 00:22:13] INFO train_model: dist_to_low: mean=0.7121, std=0.5611, min=-0.9330, max=4.4140, unique=3281
[2025-07-19 00:22:13] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: vol_spike_std: mean=0.1367, std=0.3436, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: supply_zone: mean=0.4773, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: demand_zone: mean=0.4005, std=0.4901, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:13] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:13] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:13] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: choch: mean=0.1507, std=0.3578, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4704
[2025-07-19 00:22:13] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2542, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: regime_zscore: mean=-0.0081, std=0.9939, min=-6.5566, max=5.1800, unique=4624
[2025-07-19 00:22:13] INFO train_model: doji: mean=0.1196, std=0.3245, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: hammer: mean=0.0218, std=0.1461, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bearish_engulfing: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: pin_bar: mean=0.3135, std=0.4640, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bearish_engulfing_bar: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: inside_bar: mean=0.1452, std=0.3524, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: rising_wedge: mean=0.2688, std=0.4434, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: falling_wedge: mean=0.2299, std=0.4208, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bullish_flag: mean=0.0231, std=0.1502, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bearish_flag: mean=0.0229, std=0.1495, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bullish_pennant: mean=0.1376, std=0.3445, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bearish_pennant: mean=0.1304, std=0.3368, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: morning_star: mean=0.0419, std=0.2004, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: evening_star: mean=0.0381, std=0.1915, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bullish_harami: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: bearish_harami: mean=0.0491, std=0.2161, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: dark_cloud_cover: mean=0.1143, std=0.3182, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:13] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 00:22:13] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 00:22:13] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 00:22:13] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 00:22:13] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 00:22:13] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 00:22:13] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 00:22:13] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 00:22:13] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 00:22:13] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 00:22:13] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 00:22:13] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:13] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:13] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:13] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:13] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:22:13] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 00:22:13] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 00:22:13] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 00:22:13] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 00:22:13] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 00:22:13] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:22:13] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:22:13] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:22:13] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:22:13] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:22:13] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 00:22:13] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 00:22:13] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:13] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: regime_label_bear: mean=0.3861, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: regime_label_bull: mean=0.5715, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: market_regime_choppy: mean=0.2517, std=0.4340, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: market_regime_downtrend: mean=0.2189, std=0.4135, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: market_regime_range: mean=0.2949, std=0.4560, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: market_regime_uptrend: mean=0.2345, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:13] INFO train_model: Auditing data quality before training...
[2025-07-19 00:22:13] INFO train_model: Entering audit_data_quality
[2025-07-19 00:22:18] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:22:28] INFO train_model: Model is starting a new training session...
[2025-07-19 00:22:28] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:22:28] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:22:28] INFO train_model: Preparing target variable...
[2025-07-19 00:22:28] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:22:28] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:22:28] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:22:28] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:22:28] INFO train_model: Dropping NaN targets...
[2025-07-19 00:22:28] INFO train_model: Class balance before upsampling: {0: 3067, 1: 1657}
[2025-07-19 00:22:28] INFO train_model: Upsampling successful.
[2025-07-19 00:22:28] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:22:28] INFO train_model: Splitting train/test...
[2025-07-19 00:22:28] INFO train_model: Scaling features...
[2025-07-19 00:22:28] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:22:28] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:22:30] INFO train_model: Model fit complete.
[2025-07-19 00:22:30] INFO train_model: Model Accuracy: 0.8419
[2025-07-19 00:22:30] INFO train_model: 
Classification Report:
[2025-07-19 00:22:30] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.85      0.84       614
           1       0.84      0.84      0.84       613

    accuracy                           0.84      1227
   macro avg       0.84      0.84      0.84      1227
weighted avg       0.84      0.84      0.84      1227

[2025-07-19 00:22:30] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 00:22:30] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': '81cb0af832d014abc50b04a59db67ee5'}}
[2025-07-19 00:22:30] INFO train_model: Feature distributions before training:
[2025-07-19 00:22:30] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8450, unique=4712
[2025-07-19 00:22:30] INFO train_model: volatility_20: mean=0.2228, std=0.2570, min=0.0393, max=3.3152, unique=4702
[2025-07-19 00:22:30] INFO train_model: sma_20: mean=87.3666, std=2.2038, min=81.5998, max=92.2272, unique=4701
[2025-07-19 00:22:30] INFO train_model: sma_50: mean=87.3744, std=2.1956, min=82.0271, max=91.9825, unique=4673
[2025-07-19 00:22:30] INFO train_model: sma_200: mean=87.4223, std=2.1965, min=83.2738, max=91.5912, unique=4521
[2025-07-19 00:22:30] INFO train_model: ema_12: mean=87.3644, std=2.2035, min=81.3860, max=92.2433, unique=4724
[2025-07-19 00:22:30] INFO train_model: ema_26: mean=87.3681, std=2.1958, min=81.7434, max=92.1009, unique=4724
[2025-07-19 00:22:30] INFO train_model: rsi_14: mean=49.9041, std=11.8518, min=11.9091, max=86.8743, unique=4685
[2025-07-19 00:22:30] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4467, unique=4699
[2025-07-19 00:22:30] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4691
[2025-07-19 00:22:30] INFO train_model: bb_high: mean=87.8010, std=2.1265, min=82.3688, max=92.6084, unique=4703
[2025-07-19 00:22:30] INFO train_model: bb_low: mean=86.9322, std=2.3861, min=77.4303, max=92.0349, unique=4703
[2025-07-19 00:22:30] INFO train_model: stoch_k: mean=51.5672, std=26.9451, min=0.7728, max=239.4568, unique=4672
[2025-07-19 00:22:30] INFO train_model: stoch_d: mean=51.5617, std=24.5719, min=3.8824, max=173.4622, unique=4698
[2025-07-19 00:22:30] INFO train_model: fib_0: mean=87.8005, std=2.1197, min=82.4090, max=92.4600, unique=1115
[2025-07-19 00:22:30] INFO train_model: dist_to_fib_0: mean=-0.4378, std=0.4917, min=-6.7800, max=3.6535, unique=2675
[2025-07-19 00:22:30] INFO train_model: fib_236: mean=87.5878, std=2.1510, min=81.9488, max=92.3562, unique=2140
[2025-07-19 00:22:30] INFO train_model: dist_to_fib_236: mean=-0.2251, std=0.4029, min=-5.1658, max=4.4047, unique=4668
[2025-07-19 00:22:30] INFO train_model: fib_382: mean=87.4561, std=2.1757, min=81.6641, max=92.2919, unique=2140
[2025-07-19 00:22:30] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8694, unique=4668
[2025-07-19 00:22:30] INFO train_model: fib_500: mean=87.3498, std=2.1984, min=81.4340, max=92.2400, unique=2084
[2025-07-19 00:22:30] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2450, unique=4266
[2025-07-19 00:22:30] INFO train_model: fib_618: mean=87.2434, std=2.2236, min=81.2039, max=92.1881, unique=2140
[2025-07-19 00:22:30] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6206, unique=4667
[2025-07-19 00:22:30] INFO train_model: fib_786: mean=87.0919, std=2.2636, min=80.8763, max=92.1142, unique=2140
[2025-07-19 00:22:30] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1553, unique=4667
[2025-07-19 00:22:30] INFO train_model: fib_100: mean=86.8990, std=2.3210, min=80.4530, max=92.0200, unique=1084
[2025-07-19 00:22:30] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4822, min=0.0060, max=6.8365, unique=2743
[2025-07-19 00:22:30] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3389
[2025-07-19 00:22:30] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-19 00:22:30] INFO train_model: trendline_up: mean=0.4905, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: trendline_down: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: dist_to_high: mean=-0.4384, std=0.4965, min=-6.7220, max=3.3765, unique=2743
[2025-07-19 00:22:30] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8365, unique=2785
[2025-07-19 00:22:30] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: vol_spike_std: mean=0.1293, std=0.3356, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: supply_zone: mean=0.4138, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: demand_zone: mean=0.3781, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:30] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:30] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:30] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: bos: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: choch: mean=0.1564, std=0.3633, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4704
[2025-07-19 00:22:30] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2420, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: regime_zscore: mean=-0.0107, std=1.0098, min=-7.2839, max=9.1570, unique=4624
[2025-07-19 00:22:30] INFO train_model: doji: mean=0.1228, std=0.3282, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: hammer: mean=0.0220, std=0.1467, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: pin_bar: mean=0.3027, std=0.4595, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: inside_bar: mean=0.1410, std=0.3480, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: head_shoulders: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: double_top: mean=0.0032, std=0.0563, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: double_bottom: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: rising_wedge: mean=0.2699, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: falling_wedge: mean=0.2631, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bullish_flag: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bearish_flag: mean=0.0288, std=0.1672, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bullish_pennant: mean=0.1319, std=0.3384, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bearish_pennant: mean=0.1179, std=0.3225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: morning_star: mean=0.0430, std=0.2028, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: evening_star: mean=0.0366, std=0.1879, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: bullish_harami: mean=0.0472, std=0.2121, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: bearish_harami: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:30] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 00:22:30] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 00:22:30] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 00:22:30] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 00:22:30] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 00:22:30] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 00:22:30] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 00:22:30] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 00:22:30] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 00:22:30] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 00:22:30] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 00:22:30] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:30] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:30] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:30] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:30] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:22:30] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 00:22:30] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 00:22:30] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 00:22:30] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 00:22:30] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 00:22:30] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:22:30] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:22:30] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:22:30] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:22:30] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:22:30] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 00:22:30] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 00:22:30] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:30] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: regime_label_bear: mean=0.4308, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: regime_label_bull: mean=0.5269, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: market_regime_choppy: mean=0.2904, std=0.4540, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: market_regime_downtrend: mean=0.2367, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: market_regime_range: mean=0.2887, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: market_regime_uptrend: mean=0.1842, std=0.3877, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:30] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:30] INFO train_model: Auditing data quality before training...
[2025-07-19 00:22:30] INFO train_model: Entering audit_data_quality
[2025-07-19 00:22:35] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:22:38] INFO train_model: Model is starting a new training session...
[2025-07-19 00:22:38] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:22:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 00:22:38] INFO train_model: Preparing target variable...
[2025-07-19 00:22:38] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:22:38] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:22:38] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 00:22:38] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:22:38] INFO train_model: Dropping NaN targets...
[2025-07-19 00:22:38] INFO train_model: Class balance before upsampling: {0: 3067, 1: 1657}
[2025-07-19 00:22:38] INFO train_model: Upsampling successful.
[2025-07-19 00:22:38] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:22:38] INFO train_model: Splitting train/test...
[2025-07-19 00:22:38] INFO train_model: Scaling features...
[2025-07-19 00:22:38] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:22:38] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:22:40] INFO train_model: Model fit complete.
[2025-07-19 00:22:40] INFO train_model: Model Accuracy: 0.8419
[2025-07-19 00:22:40] INFO train_model: 
Classification Report:
[2025-07-19 00:22:40] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.85      0.84       614
           1       0.84      0.84      0.84       613

    accuracy                           0.84      1227
   macro avg       0.84      0.84      0.84      1227
weighted avg       0.84      0.84      0.84      1227

[2025-07-19 00:22:40] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 00:22:40] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': '81cb0af832d014abc50b04a59db67ee5'}}
[2025-07-19 00:22:40] INFO train_model: Feature distributions before training:
[2025-07-19 00:22:40] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8450, unique=4712
[2025-07-19 00:22:40] INFO train_model: volatility_20: mean=0.2228, std=0.2570, min=0.0393, max=3.3152, unique=4702
[2025-07-19 00:22:40] INFO train_model: sma_20: mean=87.3666, std=2.2038, min=81.5998, max=92.2272, unique=4701
[2025-07-19 00:22:40] INFO train_model: sma_50: mean=87.3744, std=2.1956, min=82.0271, max=91.9825, unique=4673
[2025-07-19 00:22:40] INFO train_model: sma_200: mean=87.4223, std=2.1965, min=83.2738, max=91.5912, unique=4521
[2025-07-19 00:22:40] INFO train_model: ema_12: mean=87.3644, std=2.2035, min=81.3860, max=92.2433, unique=4724
[2025-07-19 00:22:40] INFO train_model: ema_26: mean=87.3681, std=2.1958, min=81.7434, max=92.1009, unique=4724
[2025-07-19 00:22:40] INFO train_model: rsi_14: mean=49.9041, std=11.8518, min=11.9091, max=86.8743, unique=4685
[2025-07-19 00:22:40] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4467, unique=4699
[2025-07-19 00:22:40] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4691
[2025-07-19 00:22:40] INFO train_model: bb_high: mean=87.8010, std=2.1265, min=82.3688, max=92.6084, unique=4703
[2025-07-19 00:22:40] INFO train_model: bb_low: mean=86.9322, std=2.3861, min=77.4303, max=92.0349, unique=4703
[2025-07-19 00:22:40] INFO train_model: stoch_k: mean=51.5672, std=26.9451, min=0.7728, max=239.4568, unique=4672
[2025-07-19 00:22:40] INFO train_model: stoch_d: mean=51.5617, std=24.5719, min=3.8824, max=173.4622, unique=4698
[2025-07-19 00:22:40] INFO train_model: fib_0: mean=87.8005, std=2.1197, min=82.4090, max=92.4600, unique=1115
[2025-07-19 00:22:40] INFO train_model: dist_to_fib_0: mean=-0.4378, std=0.4917, min=-6.7800, max=3.6535, unique=2675
[2025-07-19 00:22:40] INFO train_model: fib_236: mean=87.5878, std=2.1510, min=81.9488, max=92.3562, unique=2140
[2025-07-19 00:22:40] INFO train_model: dist_to_fib_236: mean=-0.2251, std=0.4029, min=-5.1658, max=4.4047, unique=4668
[2025-07-19 00:22:40] INFO train_model: fib_382: mean=87.4561, std=2.1757, min=81.6641, max=92.2919, unique=2140
[2025-07-19 00:22:40] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8694, unique=4668
[2025-07-19 00:22:40] INFO train_model: fib_500: mean=87.3498, std=2.1984, min=81.4340, max=92.2400, unique=2084
[2025-07-19 00:22:40] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2450, unique=4266
[2025-07-19 00:22:40] INFO train_model: fib_618: mean=87.2434, std=2.2236, min=81.2039, max=92.1881, unique=2140
[2025-07-19 00:22:40] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6206, unique=4667
[2025-07-19 00:22:40] INFO train_model: fib_786: mean=87.0919, std=2.2636, min=80.8763, max=92.1142, unique=2140
[2025-07-19 00:22:40] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1553, unique=4667
[2025-07-19 00:22:40] INFO train_model: fib_100: mean=86.8990, std=2.3210, min=80.4530, max=92.0200, unique=1084
[2025-07-19 00:22:40] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4822, min=0.0060, max=6.8365, unique=2743
[2025-07-19 00:22:40] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3389
[2025-07-19 00:22:40] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-19 00:22:40] INFO train_model: trendline_up: mean=0.4905, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: trendline_down: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: dist_to_high: mean=-0.4384, std=0.4965, min=-6.7220, max=3.3765, unique=2743
[2025-07-19 00:22:40] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8365, unique=2785
[2025-07-19 00:22:40] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: vol_spike_std: mean=0.1293, std=0.3356, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: supply_zone: mean=0.4138, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: demand_zone: mean=0.3781, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:40] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:40] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:40] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: bos: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: choch: mean=0.1564, std=0.3633, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4704
[2025-07-19 00:22:40] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2420, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: regime_zscore: mean=-0.0107, std=1.0098, min=-7.2839, max=9.1570, unique=4624
[2025-07-19 00:22:40] INFO train_model: doji: mean=0.1228, std=0.3282, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: hammer: mean=0.0220, std=0.1467, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: pin_bar: mean=0.3027, std=0.4595, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: inside_bar: mean=0.1410, std=0.3480, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: head_shoulders: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: double_top: mean=0.0032, std=0.0563, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: double_bottom: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: rising_wedge: mean=0.2699, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: falling_wedge: mean=0.2631, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bullish_flag: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bearish_flag: mean=0.0288, std=0.1672, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bullish_pennant: mean=0.1319, std=0.3384, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bearish_pennant: mean=0.1179, std=0.3225, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: morning_star: mean=0.0430, std=0.2028, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: evening_star: mean=0.0366, std=0.1879, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: bullish_harami: mean=0.0472, std=0.2121, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: bearish_harami: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:40] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 00:22:40] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 00:22:40] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 00:22:40] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 00:22:40] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 00:22:40] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 00:22:40] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 00:22:40] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 00:22:40] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 00:22:40] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 00:22:40] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 00:22:40] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:40] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:40] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 00:22:40] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:40] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 00:22:40] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 00:22:40] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 00:22:40] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 00:22:40] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 00:22:40] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 00:22:40] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 00:22:40] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 00:22:40] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:22:40] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 00:22:40] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 00:22:40] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 00:22:40] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 00:22:40] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:22:40] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: regime_label_bear: mean=0.4308, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: regime_label_bull: mean=0.5269, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: market_regime_choppy: mean=0.2904, std=0.4540, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: market_regime_downtrend: mean=0.2367, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: market_regime_range: mean=0.2887, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: market_regime_uptrend: mean=0.1842, std=0.3877, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:22:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:22:40] INFO train_model: Auditing data quality before training...
[2025-07-19 00:22:40] INFO train_model: Entering audit_data_quality
[2025-07-19 00:22:45] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:23:02] INFO train_model: Model is starting a new training session...
[2025-07-19 00:23:02] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:23:02] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=123)
[2025-07-19 00:23:02] INFO train_model: Preparing target variable...
[2025-07-19 00:23:02] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:23:02] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:23:02] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=125)
[2025-07-19 00:23:02] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:23:02] INFO train_model: Dropping NaN targets...
[2025-07-19 00:23:02] INFO train_model: Class balance before upsampling: {0: 2414, 1: 2311}
[2025-07-19 00:23:02] INFO train_model: Upsampling successful.
[2025-07-19 00:23:02] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:23:02] INFO train_model: Splitting train/test...
[2025-07-19 00:23:02] INFO train_model: Scaling features...
[2025-07-19 00:23:02] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:23:02] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:23:04] INFO train_model: Model fit complete.
[2025-07-19 00:23:04] INFO train_model: Model Accuracy: 0.8313
[2025-07-19 00:23:04] INFO train_model: 
Classification Report:
[2025-07-19 00:23:04] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.83      0.83       483
           1       0.83      0.83      0.83       483

    accuracy                           0.83       966
   macro avg       0.83      0.83      0.83       966
weighted avg       0.83      0.83      0.83       966

[2025-07-19 00:23:04] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 00:23:04] INFO train_model: Model registered in ModelRegistry for BTCUSD, version 7ab44b7eac436ea313f309fc3039e488
[2025-07-19 00:23:04] INFO train_model: Feature distributions before training:
[2025-07-19 00:23:04] INFO train_model: atr_14: mean=790.2925, std=316.4131, min=248.5360, max=2432.8175, unique=4725
[2025-07-19 00:23:04] INFO train_model: volatility_20: mean=826.8249, std=533.2637, min=141.7903, max=3956.2747, unique=4725
[2025-07-19 00:23:04] INFO train_model: sma_20: mean=94356.7082, std=12268.7071, min=62628.1240, max=121103.9988, unique=4725
[2025-07-19 00:23:04] INFO train_model: sma_50: mean=94197.6233, std=12256.8055, min=62799.2954, max=119557.6389, unique=4725
[2025-07-19 00:23:04] INFO train_model: sma_200: mean=93600.1157, std=12291.7664, min=62183.0844, max=118218.3794, unique=4724
[2025-07-19 00:23:04] INFO train_model: ema_12: mean=94411.1552, std=12263.4838, min=62644.2626, max=121438.5343, unique=4725
[2025-07-19 00:23:04] INFO train_model: ema_26: mean=94330.8663, std=12247.0436, min=62673.5403, max=120532.2026, unique=4725
[2025-07-19 00:23:04] INFO train_model: rsi_14: mean=52.2288, std=12.4379, min=12.9206, max=90.2253, unique=4725
[2025-07-19 00:23:04] INFO train_model: macd: mean=80.2889, std=560.5874, min=-1881.4601, max=2409.3781, unique=4725
[2025-07-19 00:23:04] INFO train_model: macd_signal: mean=76.0059, std=522.8613, min=-1668.9823, max=2004.6298, unique=4725
[2025-07-19 00:23:04] INFO train_model: bb_high: mean=95968.4866, std=12347.6445, min=63008.0505, max=123631.2152, unique=4725
[2025-07-19 00:23:04] INFO train_model: bb_low: mean=92744.9299, std=12277.5908, min=61485.6176, max=119063.2808, unique=4725
[2025-07-19 00:23:04] INFO train_model: stoch_k: mean=53.8668, std=27.2018, min=0.0000, max=100.0000, unique=4708
[2025-07-19 00:23:04] INFO train_model: stoch_d: mean=53.9087, std=24.5302, min=4.8709, max=97.8432, unique=4725
[2025-07-19 00:23:04] INFO train_model: fib_0: mean=96011.1458, std=12315.0639, min=63086.8359, max=123077.6328, unique=1209
[2025-07-19 00:23:04] INFO train_model: dist_to_fib_0: mean=-1525.7156, std=1389.9513, min=-10522.6016, max=0.0000, unique=4700
[2025-07-19 00:23:04] INFO train_model: fib_236: mean=95207.3054, std=12281.0821, min=62841.1609, max=122164.0787, unique=2197
[2025-07-19 00:23:04] INFO train_model: dist_to_fib_236: mean=-721.8751, std=1190.5630, min=-7889.1863, max=2479.4287, unique=4725
[2025-07-19 00:23:04] INFO train_model: fib_382: mean=94710.0142, std=12267.2667, min=62689.1754, max=121598.9138, unique=2197
[2025-07-19 00:23:04] INFO train_model: dist_to_fib_382: mean=-224.5840, std=1130.0725, min=-6260.0396, max=4013.8442, unique=4724
[2025-07-19 00:23:04] INFO train_model: fib_500: mean=94308.0940, std=12260.1433, min=62566.3379, max=121142.1367, unique=2197
[2025-07-19 00:23:04] INFO train_model: dist_to_fib_500: mean=177.3363, std=1123.8300, min=-4943.3320, max=5253.9883, unique=4708
[2025-07-19 00:23:04] INFO train_model: fib_618: mean=93906.1737, std=12256.6406, min=62443.5004, max=120685.3596, unique=2197
[2025-07-19 00:23:04] INFO train_model: dist_to_fib_618: mean=579.2565, std=1156.6193, min=-3626.6244, max=6494.1323, unique=4725
[2025-07-19 00:23:04] INFO train_model: fib_786: mean=93333.9483, std=12257.9063, min=62268.6130, max=120035.0330, unique=2197
[2025-07-19 00:23:04] INFO train_model: dist_to_fib_786: mean=1151.4819, std=1263.9286, min=-1751.9899, max=8259.7611, unique=4725
[2025-07-19 00:23:04] INFO train_model: fib_100: mean=92605.0421, std=12270.1504, min=62045.8398, max=119206.6406, unique=1276
[2025-07-19 00:23:04] INFO train_model: dist_to_fib_100: mean=1880.3881, std=1479.5901, min=0.0000, max=10508.8359, unique=4692
[2025-07-19 00:23:04] INFO train_model: trendline_slope_high: mean=12.6293, std=110.5220, min=-488.7707, max=418.4305, unique=4710
[2025-07-19 00:23:04] INFO train_model: trendline_slope_low: mean=11.3012, std=113.7325, min=-487.6711, max=479.1137, unique=4719
[2025-07-19 00:23:04] INFO train_model: trendline_up: mean=0.5517, std=0.4974, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: trendline_down: mean=0.4415, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: breakout_high: mean=0.0129, std=0.1129, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: breakout_low: mean=0.0131, std=0.1138, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: dist_to_high: mean=-1509.4770, std=1448.7133, min=-10522.6016, max=359.2578, unique=4702
[2025-07-19 00:23:04] INFO train_model: dist_to_low: mean=1889.9598, std=1544.1018, min=-408.2344, max=10508.8359, unique=4706
[2025-07-19 00:23:04] INFO train_model: vol_spike_atr: mean=0.0372, std=0.1894, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: vol_spike_std: mean=0.1793, std=0.3836, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: is_trending: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: supply_zone: mean=0.2180, std=0.4129, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: demand_zone: mean=0.1583, std=0.3651, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:04] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:04] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:04] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: bos: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: choch: mean=0.1547, std=0.3617, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: vol_cluster_std: mean=0.0052, std=0.0026, min=0.0011, max=0.0169, unique=4725
[2025-07-19 00:23:04] INFO train_model: vol_cluster_high: mean=0.1850, std=0.3883, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: regime_zscore: mean=0.0070, std=1.1316, min=-5.7567, max=6.9376, unique=4725
[2025-07-19 00:23:04] INFO train_model: doji: mean=0.0804, std=0.2720, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: hammer: mean=0.0241, std=0.1535, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bullish_engulfing: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bearish_engulfing: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: pin_bar: mean=0.2360, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bullish_engulfing_bar: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bearish_engulfing_bar: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: inside_bar: mean=0.1407, std=0.3478, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: rising_wedge: mean=0.2506, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: falling_wedge: mean=0.2595, std=0.4384, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: fakeout_up: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: fakeout_down: mean=0.0083, std=0.0905, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bullish_flag: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bearish_flag: mean=0.0267, std=0.1611, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bullish_pennant: mean=0.1308, std=0.3372, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bearish_pennant: mean=0.1255, std=0.3313, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: morning_star: mean=0.0394, std=0.1945, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: evening_star: mean=0.0383, std=0.1920, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: bullish_harami: mean=0.0603, std=0.2381, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: bearish_harami: mean=0.0590, std=0.2357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: dark_cloud_cover: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:23:04] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4671
[2025-07-19 00:23:04] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4647
[2025-07-19 00:23:04] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4725
[2025-07-19 00:23:04] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4725
[2025-07-19 00:23:04] INFO train_model: rsi_14_4h: mean=51.1047, std=32.5781, min=0.0000, max=100.0000, unique=1783
[2025-07-19 00:23:04] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4725
[2025-07-19 00:23:04] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4725
[2025-07-19 00:23:04] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4673
[2025-07-19 00:23:04] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4673
[2025-07-19 00:23:04] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4710
[2025-07-19 00:23:04] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4663
[2025-07-19 00:23:04] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:04] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:04] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:04] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:23:04] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:23:04] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4655
[2025-07-19 00:23:04] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4725
[2025-07-19 00:23:04] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4725
[2025-07-19 00:23:04] INFO train_model: rsi_14_1d: mean=47.2804, std=49.9313, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4725
[2025-07-19 00:23:04] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4725
[2025-07-19 00:23:04] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:23:04] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:23:04] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:23:04] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:23:04] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:23:04] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4655
[2025-07-19 00:23:04] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4655
[2025-07-19 00:23:04] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:23:04] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: regime_label_bear: mean=0.3926, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: regime_label_bull: mean=0.6074, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: market_regime_choppy: mean=0.2125, std=0.4091, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: market_regime_downtrend: mean=0.2582, std=0.4377, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: market_regime_range: mean=0.2195, std=0.4139, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: market_regime_uptrend: mean=0.3098, std=0.4625, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:04] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:04] INFO train_model: Auditing data quality before training...
[2025-07-19 00:23:04] INFO train_model: Entering audit_data_quality
[2025-07-19 00:23:09] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:23:14] INFO train_model: Model is starting a new training session...
[2025-07-19 00:23:14] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 00:23:14] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=123)
[2025-07-19 00:23:14] INFO train_model: Preparing target variable...
[2025-07-19 00:23:14] INFO train_model: Entering prepare_target_variable
[2025-07-19 00:23:14] INFO train_model: Exiting prepare_target_variable
[2025-07-19 00:23:14] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=125)
[2025-07-19 00:23:14] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 00:23:14] INFO train_model: Dropping NaN targets...
[2025-07-19 00:23:14] INFO train_model: Class balance before upsampling: {0: 2414, 1: 2311}
[2025-07-19 00:23:14] INFO train_model: Upsampling successful.
[2025-07-19 00:23:14] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 00:23:14] INFO train_model: Splitting train/test...
[2025-07-19 00:23:14] INFO train_model: Scaling features...
[2025-07-19 00:23:14] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 00:23:14] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 00:23:16] INFO train_model: Model fit complete.
[2025-07-19 00:23:16] INFO train_model: Model Accuracy: 0.8313
[2025-07-19 00:23:16] INFO train_model: 
Classification Report:
[2025-07-19 00:23:16] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.83      0.83       483
           1       0.83      0.83      0.83       483

    accuracy                           0.83       966
   macro avg       0.83      0.83      0.83       966
weighted avg       0.83      0.83      0.83       966

[2025-07-19 00:23:16] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 00:23:16] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "7ab44b7eac436ea313f309fc3039e488" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "7ab44b7eac436ea313f309fc3039e488" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_BTCUSD', 'version': '7ab44b7eac436ea313f309fc3039e488'}}
[2025-07-19 00:23:16] INFO train_model: Feature distributions before training:
[2025-07-19 00:23:16] INFO train_model: atr_14: mean=790.2925, std=316.4131, min=248.5360, max=2432.8175, unique=4725
[2025-07-19 00:23:16] INFO train_model: volatility_20: mean=826.8249, std=533.2637, min=141.7903, max=3956.2747, unique=4725
[2025-07-19 00:23:16] INFO train_model: sma_20: mean=94356.7082, std=12268.7071, min=62628.1240, max=121103.9988, unique=4725
[2025-07-19 00:23:16] INFO train_model: sma_50: mean=94197.6233, std=12256.8055, min=62799.2954, max=119557.6389, unique=4725
[2025-07-19 00:23:16] INFO train_model: sma_200: mean=93600.1157, std=12291.7664, min=62183.0844, max=118218.3794, unique=4724
[2025-07-19 00:23:16] INFO train_model: ema_12: mean=94411.1552, std=12263.4838, min=62644.2626, max=121438.5343, unique=4725
[2025-07-19 00:23:16] INFO train_model: ema_26: mean=94330.8663, std=12247.0436, min=62673.5403, max=120532.2026, unique=4725
[2025-07-19 00:23:16] INFO train_model: rsi_14: mean=52.2288, std=12.4379, min=12.9206, max=90.2253, unique=4725
[2025-07-19 00:23:16] INFO train_model: macd: mean=80.2889, std=560.5874, min=-1881.4601, max=2409.3781, unique=4725
[2025-07-19 00:23:16] INFO train_model: macd_signal: mean=76.0059, std=522.8613, min=-1668.9823, max=2004.6298, unique=4725
[2025-07-19 00:23:16] INFO train_model: bb_high: mean=95968.4866, std=12347.6445, min=63008.0505, max=123631.2152, unique=4725
[2025-07-19 00:23:16] INFO train_model: bb_low: mean=92744.9299, std=12277.5908, min=61485.6176, max=119063.2808, unique=4725
[2025-07-19 00:23:16] INFO train_model: stoch_k: mean=53.8668, std=27.2018, min=0.0000, max=100.0000, unique=4708
[2025-07-19 00:23:16] INFO train_model: stoch_d: mean=53.9087, std=24.5302, min=4.8709, max=97.8432, unique=4725
[2025-07-19 00:23:16] INFO train_model: fib_0: mean=96011.1458, std=12315.0639, min=63086.8359, max=123077.6328, unique=1209
[2025-07-19 00:23:16] INFO train_model: dist_to_fib_0: mean=-1525.7156, std=1389.9513, min=-10522.6016, max=0.0000, unique=4700
[2025-07-19 00:23:16] INFO train_model: fib_236: mean=95207.3054, std=12281.0821, min=62841.1609, max=122164.0787, unique=2197
[2025-07-19 00:23:16] INFO train_model: dist_to_fib_236: mean=-721.8751, std=1190.5630, min=-7889.1863, max=2479.4287, unique=4725
[2025-07-19 00:23:16] INFO train_model: fib_382: mean=94710.0142, std=12267.2667, min=62689.1754, max=121598.9138, unique=2197
[2025-07-19 00:23:16] INFO train_model: dist_to_fib_382: mean=-224.5840, std=1130.0725, min=-6260.0396, max=4013.8442, unique=4724
[2025-07-19 00:23:16] INFO train_model: fib_500: mean=94308.0940, std=12260.1433, min=62566.3379, max=121142.1367, unique=2197
[2025-07-19 00:23:16] INFO train_model: dist_to_fib_500: mean=177.3363, std=1123.8300, min=-4943.3320, max=5253.9883, unique=4708
[2025-07-19 00:23:16] INFO train_model: fib_618: mean=93906.1737, std=12256.6406, min=62443.5004, max=120685.3596, unique=2197
[2025-07-19 00:23:16] INFO train_model: dist_to_fib_618: mean=579.2565, std=1156.6193, min=-3626.6244, max=6494.1323, unique=4725
[2025-07-19 00:23:16] INFO train_model: fib_786: mean=93333.9483, std=12257.9063, min=62268.6130, max=120035.0330, unique=2197
[2025-07-19 00:23:16] INFO train_model: dist_to_fib_786: mean=1151.4819, std=1263.9286, min=-1751.9899, max=8259.7611, unique=4725
[2025-07-19 00:23:16] INFO train_model: fib_100: mean=92605.0421, std=12270.1504, min=62045.8398, max=119206.6406, unique=1276
[2025-07-19 00:23:16] INFO train_model: dist_to_fib_100: mean=1880.3881, std=1479.5901, min=0.0000, max=10508.8359, unique=4692
[2025-07-19 00:23:16] INFO train_model: trendline_slope_high: mean=12.6293, std=110.5220, min=-488.7707, max=418.4305, unique=4710
[2025-07-19 00:23:16] INFO train_model: trendline_slope_low: mean=11.3012, std=113.7325, min=-487.6711, max=479.1137, unique=4719
[2025-07-19 00:23:16] INFO train_model: trendline_up: mean=0.5517, std=0.4974, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: trendline_down: mean=0.4415, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: breakout_high: mean=0.0129, std=0.1129, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: breakout_low: mean=0.0131, std=0.1138, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: dist_to_high: mean=-1509.4770, std=1448.7133, min=-10522.6016, max=359.2578, unique=4702
[2025-07-19 00:23:16] INFO train_model: dist_to_low: mean=1889.9598, std=1544.1018, min=-408.2344, max=10508.8359, unique=4706
[2025-07-19 00:23:16] INFO train_model: vol_spike_atr: mean=0.0372, std=0.1894, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: vol_spike_std: mean=0.1793, std=0.3836, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: is_trending: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: supply_zone: mean=0.2180, std=0.4129, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: demand_zone: mean=0.1583, std=0.3651, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:16] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:16] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:16] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: bos: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: choch: mean=0.1547, std=0.3617, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: vol_cluster_std: mean=0.0052, std=0.0026, min=0.0011, max=0.0169, unique=4725
[2025-07-19 00:23:16] INFO train_model: vol_cluster_high: mean=0.1850, std=0.3883, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: regime_zscore: mean=0.0070, std=1.1316, min=-5.7567, max=6.9376, unique=4725
[2025-07-19 00:23:16] INFO train_model: doji: mean=0.0804, std=0.2720, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: hammer: mean=0.0241, std=0.1535, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bullish_engulfing: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bearish_engulfing: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: pin_bar: mean=0.2360, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bullish_engulfing_bar: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bearish_engulfing_bar: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: inside_bar: mean=0.1407, std=0.3478, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: rising_wedge: mean=0.2506, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: falling_wedge: mean=0.2595, std=0.4384, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: fakeout_up: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: fakeout_down: mean=0.0083, std=0.0905, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bullish_flag: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bearish_flag: mean=0.0267, std=0.1611, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bullish_pennant: mean=0.1308, std=0.3372, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bearish_pennant: mean=0.1255, std=0.3313, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: morning_star: mean=0.0394, std=0.1945, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: evening_star: mean=0.0383, std=0.1920, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: bullish_harami: mean=0.0603, std=0.2381, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: bearish_harami: mean=0.0590, std=0.2357, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: dark_cloud_cover: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:23:16] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4671
[2025-07-19 00:23:16] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4647
[2025-07-19 00:23:16] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4725
[2025-07-19 00:23:16] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4725
[2025-07-19 00:23:16] INFO train_model: rsi_14_4h: mean=51.1047, std=32.5781, min=0.0000, max=100.0000, unique=1783
[2025-07-19 00:23:16] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4725
[2025-07-19 00:23:16] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4725
[2025-07-19 00:23:16] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4673
[2025-07-19 00:23:16] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4673
[2025-07-19 00:23:16] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4710
[2025-07-19 00:23:16] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4663
[2025-07-19 00:23:16] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:16] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:16] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 00:23:16] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:23:16] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 00:23:16] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4655
[2025-07-19 00:23:16] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4725
[2025-07-19 00:23:16] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4725
[2025-07-19 00:23:16] INFO train_model: rsi_14_1d: mean=47.2804, std=49.9313, min=0.0000, max=100.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4725
[2025-07-19 00:23:16] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4725
[2025-07-19 00:23:16] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 00:23:16] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 00:23:16] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 00:23:16] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 00:23:16] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 00:23:16] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4655
[2025-07-19 00:23:16] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4655
[2025-07-19 00:23:16] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 00:23:16] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: regime_label_bear: mean=0.3926, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: regime_label_bull: mean=0.6074, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: market_regime_choppy: mean=0.2125, std=0.4091, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: market_regime_downtrend: mean=0.2582, std=0.4377, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: market_regime_range: mean=0.2195, std=0.4139, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: market_regime_uptrend: mean=0.3098, std=0.4625, min=0.0000, max=1.0000, unique=2
[2025-07-19 00:23:16] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 00:23:16] INFO train_model: Auditing data quality before training...
[2025-07-19 00:23:16] INFO train_model: Entering audit_data_quality
[2025-07-19 00:23:21] INFO train_model: Exiting audit_data_quality
[2025-07-19 00:23:53] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:30:09] INFO train_model: Model is starting a new training session...
[2025-07-19 01:30:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:30:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 01:30:09] INFO train_model: Preparing target variable...
[2025-07-19 01:30:09] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:30:09] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:30:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 01:30:09] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:30:09] INFO train_model: Dropping NaN targets...
[2025-07-19 01:30:09] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 01:30:09] INFO train_model: Upsampling successful.
[2025-07-19 01:30:09] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:30:09] INFO train_model: Splitting train/test...
[2025-07-19 01:30:09] INFO train_model: Scaling features...
[2025-07-19 01:30:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:30:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:30:11] INFO train_model: Model fit complete.
[2025-07-19 01:30:11] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 01:30:11] INFO train_model: 
Classification Report:
[2025-07-19 01:30:11] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 01:30:11] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 01:30:11] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 01:30:11] INFO train_model: Feature distributions before training:
[2025-07-19 01:30:11] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 01:30:11] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 01:30:11] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 01:30:11] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 01:30:11] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 01:30:11] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 01:30:11] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 01:30:11] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 01:30:11] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 01:30:11] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 01:30:11] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 01:30:11] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 01:30:11] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 01:30:11] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 01:30:11] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 01:30:11] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 01:30:11] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 01:30:11] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 01:30:11] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 01:30:11] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 01:30:11] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 01:30:11] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 01:30:11] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 01:30:11] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 01:30:11] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 01:30:11] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 01:30:11] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 01:30:11] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 01:30:11] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 01:30:11] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 01:30:11] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 01:30:11] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 01:30:11] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:11] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 01:30:11] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 01:30:11] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:11] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 01:30:11] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 01:30:11] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 01:30:11] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 01:30:11] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 01:30:11] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 01:30:11] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 01:30:11] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 01:30:11] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 01:30:11] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 01:30:11] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 01:30:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:11] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:11] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:30:11] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 01:30:11] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 01:30:11] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 01:30:11] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 01:30:11] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 01:30:11] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:30:11] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:30:11] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:30:11] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:30:11] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:30:11] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 01:30:11] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 01:30:11] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:11] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:11] INFO train_model: Auditing data quality before training...
[2025-07-19 01:30:11] INFO train_model: Entering audit_data_quality
[2025-07-19 01:30:16] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:30:19] INFO train_model: Model is starting a new training session...
[2025-07-19 01:30:19] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:30:19] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 01:30:19] INFO train_model: Preparing target variable...
[2025-07-19 01:30:19] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:30:19] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:30:19] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 01:30:19] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:30:19] INFO train_model: Dropping NaN targets...
[2025-07-19 01:30:19] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 01:30:19] INFO train_model: Upsampling successful.
[2025-07-19 01:30:19] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:30:19] INFO train_model: Splitting train/test...
[2025-07-19 01:30:19] INFO train_model: Scaling features...
[2025-07-19 01:30:19] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:30:19] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:30:21] INFO train_model: Model fit complete.
[2025-07-19 01:30:21] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 01:30:21] INFO train_model: 
Classification Report:
[2025-07-19 01:30:21] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 01:30:21] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 01:30:21] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 01:30:21] INFO train_model: Feature distributions before training:
[2025-07-19 01:30:21] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 01:30:21] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 01:30:21] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 01:30:21] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 01:30:21] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 01:30:21] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 01:30:21] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 01:30:21] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 01:30:21] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 01:30:21] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 01:30:21] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 01:30:21] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 01:30:21] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 01:30:21] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 01:30:21] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 01:30:21] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 01:30:21] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 01:30:21] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 01:30:21] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 01:30:21] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 01:30:21] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 01:30:21] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 01:30:21] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 01:30:21] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 01:30:21] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 01:30:21] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 01:30:21] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 01:30:21] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 01:30:21] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 01:30:21] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 01:30:21] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 01:30:21] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 01:30:21] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:21] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:21] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:21] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 01:30:21] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 01:30:21] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:21] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 01:30:21] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 01:30:21] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 01:30:21] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 01:30:21] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 01:30:21] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 01:30:21] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 01:30:21] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 01:30:21] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 01:30:21] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 01:30:21] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 01:30:21] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:21] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:21] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:30:21] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:21] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:30:21] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 01:30:21] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 01:30:21] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 01:30:21] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 01:30:21] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 01:30:21] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:30:21] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:30:21] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:30:21] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:30:21] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:30:21] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 01:30:21] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 01:30:21] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:21] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:21] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:21] INFO train_model: Auditing data quality before training...
[2025-07-19 01:30:21] INFO train_model: Entering audit_data_quality
[2025-07-19 01:30:27] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:30:36] INFO train_model: Model is starting a new training session...
[2025-07-19 01:30:36] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:30:36] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 01:30:36] INFO train_model: Preparing target variable...
[2025-07-19 01:30:36] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:30:36] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:30:36] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 01:30:36] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:30:36] INFO train_model: Dropping NaN targets...
[2025-07-19 01:30:36] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 01:30:36] INFO train_model: Upsampling successful.
[2025-07-19 01:30:36] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:30:36] INFO train_model: Splitting train/test...
[2025-07-19 01:30:36] INFO train_model: Scaling features...
[2025-07-19 01:30:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:30:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:30:38] INFO train_model: Model fit complete.
[2025-07-19 01:30:38] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 01:30:38] INFO train_model: 
Classification Report:
[2025-07-19 01:30:38] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 01:30:38] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 01:30:38] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd2a3f9696a22ac049479f92536f55c6d'}}
[2025-07-19 01:30:38] INFO train_model: Feature distributions before training:
[2025-07-19 01:30:38] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 01:30:38] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 01:30:38] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 01:30:38] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 01:30:38] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 01:30:38] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 01:30:38] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 01:30:38] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 01:30:38] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 01:30:38] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 01:30:38] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 01:30:38] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 01:30:38] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 01:30:38] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 01:30:38] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 01:30:38] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 01:30:38] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 01:30:38] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 01:30:38] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 01:30:38] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 01:30:38] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 01:30:38] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 01:30:38] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 01:30:38] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 01:30:38] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 01:30:38] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 01:30:38] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 01:30:38] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 01:30:38] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 01:30:38] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 01:30:38] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 01:30:38] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 01:30:38] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:38] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 01:30:38] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 01:30:38] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:38] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 01:30:38] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 01:30:38] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 01:30:38] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 01:30:38] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 01:30:38] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 01:30:38] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 01:30:38] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 01:30:38] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 01:30:38] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 01:30:38] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 01:30:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:38] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:38] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 01:30:38] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 01:30:38] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 01:30:38] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 01:30:38] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 01:30:38] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 01:30:38] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 01:30:38] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 01:30:38] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 01:30:38] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 01:30:38] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 01:30:38] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 01:30:38] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 01:30:38] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:38] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:38] INFO train_model: Auditing data quality before training...
[2025-07-19 01:30:38] INFO train_model: Entering audit_data_quality
[2025-07-19 01:30:43] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:30:46] INFO train_model: Model is starting a new training session...
[2025-07-19 01:30:46] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:30:46] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 01:30:46] INFO train_model: Preparing target variable...
[2025-07-19 01:30:46] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:30:46] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:30:46] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 01:30:46] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:30:46] INFO train_model: Dropping NaN targets...
[2025-07-19 01:30:47] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 01:30:47] INFO train_model: Upsampling successful.
[2025-07-19 01:30:47] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:30:47] INFO train_model: Splitting train/test...
[2025-07-19 01:30:47] INFO train_model: Scaling features...
[2025-07-19 01:30:47] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:30:47] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:30:49] INFO train_model: Model fit complete.
[2025-07-19 01:30:49] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 01:30:49] INFO train_model: 
Classification Report:
[2025-07-19 01:30:49] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 01:30:49] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 01:30:49] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd2a3f9696a22ac049479f92536f55c6d'}}
[2025-07-19 01:30:49] INFO train_model: Feature distributions before training:
[2025-07-19 01:30:49] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 01:30:49] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 01:30:49] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 01:30:49] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 01:30:49] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 01:30:49] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 01:30:49] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 01:30:49] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 01:30:49] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 01:30:49] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 01:30:49] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 01:30:49] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 01:30:49] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 01:30:49] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 01:30:49] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 01:30:49] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 01:30:49] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 01:30:49] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 01:30:49] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 01:30:49] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 01:30:49] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 01:30:49] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 01:30:49] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 01:30:49] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 01:30:49] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 01:30:49] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 01:30:49] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 01:30:49] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 01:30:49] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 01:30:49] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 01:30:49] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 01:30:49] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 01:30:49] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:49] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:49] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:49] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 01:30:49] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 01:30:49] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:49] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 01:30:49] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 01:30:49] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 01:30:49] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 01:30:49] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 01:30:49] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 01:30:49] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 01:30:49] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 01:30:49] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 01:30:49] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 01:30:49] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 01:30:49] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:49] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:49] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 01:30:49] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:49] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 01:30:49] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 01:30:49] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 01:30:49] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 01:30:49] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 01:30:49] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 01:30:49] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 01:30:49] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 01:30:49] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 01:30:49] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 01:30:49] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 01:30:49] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 01:30:49] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 01:30:49] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:30:49] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:30:49] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:30:49] INFO train_model: Auditing data quality before training...
[2025-07-19 01:30:49] INFO train_model: Entering audit_data_quality
[2025-07-19 01:30:54] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:31:04] INFO train_model: Model is starting a new training session...
[2025-07-19 01:31:04] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:31:04] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 01:31:04] INFO train_model: Preparing target variable...
[2025-07-19 01:31:04] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:31:04] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:31:04] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 01:31:04] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:31:04] INFO train_model: Dropping NaN targets...
[2025-07-19 01:31:04] INFO train_model: Class balance before upsampling: {0: 3426, 1: 1272}
[2025-07-19 01:31:04] INFO train_model: Upsampling successful.
[2025-07-19 01:31:04] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:31:04] INFO train_model: Splitting train/test...
[2025-07-19 01:31:04] INFO train_model: Scaling features...
[2025-07-19 01:31:04] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:31:04] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:31:07] INFO train_model: Model fit complete.
[2025-07-19 01:31:07] INFO train_model: Model Accuracy: 0.9059
[2025-07-19 01:31:07] INFO train_model: 
Classification Report:
[2025-07-19 01:31:07] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.90      0.91       686
           1       0.90      0.91      0.91       685

    accuracy                           0.91      1371
   macro avg       0.91      0.91      0.91      1371
weighted avg       0.91      0.91      0.91      1371

[2025-07-19 01:31:07] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 01:31:07] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': 'a36a889b62f1371c96a2129e8900e40e'}}
[2025-07-19 01:31:07] INFO train_model: Feature distributions before training:
[2025-07-19 01:31:07] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4686
[2025-07-19 01:31:07] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4674
[2025-07-19 01:31:07] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4672
[2025-07-19 01:31:07] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4646
[2025-07-19 01:31:07] INFO train_model: sma_200: mean=0.8642, std=0.0363, min=0.7943, max=0.9132, unique=4495
[2025-07-19 01:31:07] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4698
[2025-07-19 01:31:07] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4698
[2025-07-19 01:31:07] INFO train_model: rsi_14: mean=49.8631, std=12.3988, min=7.7095, max=97.7161, unique=4664
[2025-07-19 01:31:07] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4673
[2025-07-19 01:31:07] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4665
[2025-07-19 01:31:07] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4677
[2025-07-19 01:31:07] INFO train_model: bb_low: mean=0.8600, std=0.0381, min=0.7878, max=0.9160, unique=4677
[2025-07-19 01:31:07] INFO train_model: stoch_k: mean=51.0566, std=26.3720, min=0.6580, max=98.9585, unique=4646
[2025-07-19 01:31:07] INFO train_model: stoch_d: mean=51.0798, std=24.0633, min=3.0053, max=95.8670, unique=4679
[2025-07-19 01:31:07] INFO train_model: fib_0: mean=0.8661, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 01:31:07] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=2430
[2025-07-19 01:31:07] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 01:31:07] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4619
[2025-07-19 01:31:07] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 01:31:07] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4619
[2025-07-19 01:31:07] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2040
[2025-07-19 01:31:07] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=4125
[2025-07-19 01:31:07] INFO train_model: fib_618: mean=0.8621, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 01:31:07] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4619
[2025-07-19 01:31:07] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 01:31:07] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4619
[2025-07-19 01:31:07] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 01:31:07] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=2380
[2025-07-19 01:31:07] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=3110
[2025-07-19 01:31:07] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=3122
[2025-07-19 01:31:07] INFO train_model: trendline_up: mean=0.5009, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=2487
[2025-07-19 01:31:07] INFO train_model: dist_to_low: mean=0.0032, std=0.0027, min=-0.0015, max=0.0207, unique=2431
[2025-07-19 01:31:07] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: vol_spike_std: mean=0.1560, std=0.3629, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: supply_zone: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: demand_zone: mean=0.4857, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:07] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:07] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:07] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: choch: mean=0.1620, std=0.3685, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4677
[2025-07-19 01:31:07] INFO train_model: vol_cluster_high: mean=0.1062, std=0.3081, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: regime_zscore: mean=-0.0097, std=1.0052, min=-5.9027, max=7.4977, unique=4598
[2025-07-19 01:31:07] INFO train_model: doji: mean=0.1237, std=0.3292, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bullish_engulfing: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bearish_engulfing: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: pin_bar: mean=0.3125, std=0.4636, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bullish_engulfing_bar: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bearish_engulfing_bar: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: inside_bar: mean=0.1428, std=0.3499, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: head_shoulders: mean=0.0343, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: rising_wedge: mean=0.2252, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: falling_wedge: mean=0.2320, std=0.4222, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: bullish_flag: mean=0.0245, std=0.1545, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bearish_flag: mean=0.0289, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bullish_pennant: mean=0.1337, std=0.3403, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bearish_pennant: mean=0.1433, std=0.3504, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: morning_star: mean=0.0370, std=0.1889, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: evening_star: mean=0.0402, std=0.1965, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bullish_harami: mean=0.0575, std=0.2328, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: bearish_harami: mean=0.0445, std=0.2062, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8249, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:07] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4645
[2025-07-19 01:31:07] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4620
[2025-07-19 01:31:07] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4698
[2025-07-19 01:31:07] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4698
[2025-07-19 01:31:07] INFO train_model: rsi_14_4h: mean=51.1069, std=32.6123, min=0.0000, max=100.0000, unique=1782
[2025-07-19 01:31:07] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4698
[2025-07-19 01:31:07] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4698
[2025-07-19 01:31:07] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4647
[2025-07-19 01:31:07] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4647
[2025-07-19 01:31:07] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4683
[2025-07-19 01:31:07] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4637
[2025-07-19 01:31:07] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:07] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:07] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:07] INFO train_model: structure_trend_4h: mean=0.8169, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:07] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 01:31:07] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4628
[2025-07-19 01:31:07] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4698
[2025-07-19 01:31:07] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4698
[2025-07-19 01:31:07] INFO train_model: rsi_14_1d: mean=47.2116, std=49.9275, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4698
[2025-07-19 01:31:07] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4698
[2025-07-19 01:31:07] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 01:31:07] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 01:31:07] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 01:31:07] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 01:31:07] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 01:31:07] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4628
[2025-07-19 01:31:07] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4628
[2025-07-19 01:31:07] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2842, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:07] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: regime_label_bear: mean=0.4870, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: regime_label_bull: mean=0.4704, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2019, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: market_regime_consolidation: mean=0.0534, std=0.2249, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: market_regime_downtrend: mean=0.2256, std=0.4180, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: market_regime_range: mean=0.5285, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: market_regime_uptrend: mean=0.1645, std=0.3708, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:07] INFO train_model: Auditing data quality before training...
[2025-07-19 01:31:07] INFO train_model: Entering audit_data_quality
[2025-07-19 01:31:12] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:31:15] INFO train_model: Model is starting a new training session...
[2025-07-19 01:31:15] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:31:15] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 01:31:15] INFO train_model: Preparing target variable...
[2025-07-19 01:31:15] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:31:15] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:31:15] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 01:31:15] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:31:15] INFO train_model: Dropping NaN targets...
[2025-07-19 01:31:15] INFO train_model: Class balance before upsampling: {0: 3426, 1: 1272}
[2025-07-19 01:31:15] INFO train_model: Upsampling successful.
[2025-07-19 01:31:15] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:31:15] INFO train_model: Splitting train/test...
[2025-07-19 01:31:15] INFO train_model: Scaling features...
[2025-07-19 01:31:15] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:31:15] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:31:18] INFO train_model: Model fit complete.
[2025-07-19 01:31:18] INFO train_model: Model Accuracy: 0.9059
[2025-07-19 01:31:18] INFO train_model: 
Classification Report:
[2025-07-19 01:31:18] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.90      0.91       686
           1       0.90      0.91      0.91       685

    accuracy                           0.91      1371
   macro avg       0.91      0.91      0.91      1371
weighted avg       0.91      0.91      0.91      1371

[2025-07-19 01:31:18] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 01:31:18] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': 'a36a889b62f1371c96a2129e8900e40e'}}
[2025-07-19 01:31:18] INFO train_model: Feature distributions before training:
[2025-07-19 01:31:18] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4686
[2025-07-19 01:31:18] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4674
[2025-07-19 01:31:18] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4672
[2025-07-19 01:31:18] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4646
[2025-07-19 01:31:18] INFO train_model: sma_200: mean=0.8642, std=0.0363, min=0.7943, max=0.9132, unique=4495
[2025-07-19 01:31:18] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4698
[2025-07-19 01:31:18] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4698
[2025-07-19 01:31:18] INFO train_model: rsi_14: mean=49.8631, std=12.3988, min=7.7095, max=97.7161, unique=4664
[2025-07-19 01:31:18] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4673
[2025-07-19 01:31:18] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4665
[2025-07-19 01:31:18] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4677
[2025-07-19 01:31:18] INFO train_model: bb_low: mean=0.8600, std=0.0381, min=0.7878, max=0.9160, unique=4677
[2025-07-19 01:31:18] INFO train_model: stoch_k: mean=51.0566, std=26.3720, min=0.6580, max=98.9585, unique=4646
[2025-07-19 01:31:18] INFO train_model: stoch_d: mean=51.0798, std=24.0633, min=3.0053, max=95.8670, unique=4679
[2025-07-19 01:31:18] INFO train_model: fib_0: mean=0.8661, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 01:31:18] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=2430
[2025-07-19 01:31:18] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 01:31:18] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4619
[2025-07-19 01:31:18] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 01:31:18] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4619
[2025-07-19 01:31:18] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2040
[2025-07-19 01:31:18] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=4125
[2025-07-19 01:31:18] INFO train_model: fib_618: mean=0.8621, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 01:31:18] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4619
[2025-07-19 01:31:18] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 01:31:18] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4619
[2025-07-19 01:31:18] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 01:31:18] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=2380
[2025-07-19 01:31:18] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=3110
[2025-07-19 01:31:18] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=3122
[2025-07-19 01:31:18] INFO train_model: trendline_up: mean=0.5009, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=2487
[2025-07-19 01:31:18] INFO train_model: dist_to_low: mean=0.0032, std=0.0027, min=-0.0015, max=0.0207, unique=2431
[2025-07-19 01:31:18] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: vol_spike_std: mean=0.1560, std=0.3629, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: supply_zone: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: demand_zone: mean=0.4857, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:18] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:18] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:18] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: choch: mean=0.1620, std=0.3685, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4677
[2025-07-19 01:31:18] INFO train_model: vol_cluster_high: mean=0.1062, std=0.3081, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: regime_zscore: mean=-0.0097, std=1.0052, min=-5.9027, max=7.4977, unique=4598
[2025-07-19 01:31:18] INFO train_model: doji: mean=0.1237, std=0.3292, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bullish_engulfing: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bearish_engulfing: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: pin_bar: mean=0.3125, std=0.4636, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bullish_engulfing_bar: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bearish_engulfing_bar: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: inside_bar: mean=0.1428, std=0.3499, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: head_shoulders: mean=0.0343, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: rising_wedge: mean=0.2252, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: falling_wedge: mean=0.2320, std=0.4222, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: bullish_flag: mean=0.0245, std=0.1545, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bearish_flag: mean=0.0289, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bullish_pennant: mean=0.1337, std=0.3403, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bearish_pennant: mean=0.1433, std=0.3504, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: morning_star: mean=0.0370, std=0.1889, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: evening_star: mean=0.0402, std=0.1965, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bullish_harami: mean=0.0575, std=0.2328, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: bearish_harami: mean=0.0445, std=0.2062, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8249, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:18] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4645
[2025-07-19 01:31:18] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4620
[2025-07-19 01:31:18] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4698
[2025-07-19 01:31:18] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4698
[2025-07-19 01:31:18] INFO train_model: rsi_14_4h: mean=51.1069, std=32.6123, min=0.0000, max=100.0000, unique=1782
[2025-07-19 01:31:18] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4698
[2025-07-19 01:31:18] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4698
[2025-07-19 01:31:18] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4647
[2025-07-19 01:31:18] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4647
[2025-07-19 01:31:18] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4683
[2025-07-19 01:31:18] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4637
[2025-07-19 01:31:18] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:18] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:18] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 01:31:18] INFO train_model: structure_trend_4h: mean=0.8169, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:18] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 01:31:18] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4628
[2025-07-19 01:31:18] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4698
[2025-07-19 01:31:18] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4698
[2025-07-19 01:31:18] INFO train_model: rsi_14_1d: mean=47.2116, std=49.9275, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4698
[2025-07-19 01:31:18] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4698
[2025-07-19 01:31:18] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 01:31:18] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 01:31:18] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 01:31:18] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 01:31:18] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 01:31:18] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4628
[2025-07-19 01:31:18] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4628
[2025-07-19 01:31:18] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2842, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:18] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: regime_label_bear: mean=0.4870, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: regime_label_bull: mean=0.4704, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2019, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: market_regime_consolidation: mean=0.0534, std=0.2249, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: market_regime_downtrend: mean=0.2256, std=0.4180, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: market_regime_range: mean=0.5285, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: market_regime_uptrend: mean=0.1645, std=0.3708, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:18] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:18] INFO train_model: Auditing data quality before training...
[2025-07-19 01:31:18] INFO train_model: Entering audit_data_quality
[2025-07-19 01:31:22] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:31:31] INFO train_model: Model is starting a new training session...
[2025-07-19 01:31:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:31:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 01:31:31] INFO train_model: Preparing target variable...
[2025-07-19 01:31:31] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:31:31] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:31:31] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 01:31:31] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:31:31] INFO train_model: Dropping NaN targets...
[2025-07-19 01:31:31] INFO train_model: Class balance before upsampling: {0: 3092, 1: 1634}
[2025-07-19 01:31:31] INFO train_model: Upsampling successful.
[2025-07-19 01:31:31] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:31:31] INFO train_model: Splitting train/test...
[2025-07-19 01:31:31] INFO train_model: Scaling features...
[2025-07-19 01:31:31] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:31:31] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:31:34] INFO train_model: Model fit complete.
[2025-07-19 01:31:34] INFO train_model: Model Accuracy: 0.8828
[2025-07-19 01:31:34] INFO train_model: 
Classification Report:
[2025-07-19 01:31:34] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       619
           1       0.88      0.88      0.88       618

    accuracy                           0.88      1237
   macro avg       0.88      0.88      0.88      1237
weighted avg       0.88      0.88      0.88      1237

[2025-07-19 01:31:34] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 01:31:34] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '46975954b9064b2dac5cdbcbe3844bca'}}
[2025-07-19 01:31:34] INFO train_model: Feature distributions before training:
[2025-07-19 01:31:34] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4714
[2025-07-19 01:31:34] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4687
[2025-07-19 01:31:34] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4691
[2025-07-19 01:31:34] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4662
[2025-07-19 01:31:34] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4524
[2025-07-19 01:31:34] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4726
[2025-07-19 01:31:34] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4726
[2025-07-19 01:31:34] INFO train_model: rsi_14: mean=49.3849, std=12.3827, min=11.3290, max=91.7839, unique=4589
[2025-07-19 01:31:34] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4701
[2025-07-19 01:31:34] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4693
[2025-07-19 01:31:34] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4693
[2025-07-19 01:31:34] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4693
[2025-07-19 01:31:34] INFO train_model: stoch_k: mean=49.1792, std=28.8128, min=0.0000, max=100.0000, unique=4552
[2025-07-19 01:31:34] INFO train_model: stoch_d: mean=49.2137, std=26.3670, min=2.3676, max=99.2269, unique=4697
[2025-07-19 01:31:34] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-19 01:31:34] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4327
[2025-07-19 01:31:34] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2134
[2025-07-19 01:31:34] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4559
[2025-07-19 01:31:34] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2134
[2025-07-19 01:31:34] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4559
[2025-07-19 01:31:34] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2134
[2025-07-19 01:31:34] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4552
[2025-07-19 01:31:34] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2134
[2025-07-19 01:31:34] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4559
[2025-07-19 01:31:34] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2134
[2025-07-19 01:31:34] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4559
[2025-07-19 01:31:34] INFO train_model: fib_100: mean=0.5818, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-19 01:31:34] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4299
[2025-07-19 01:31:34] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4623
[2025-07-19 01:31:34] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4618
[2025-07-19 01:31:34] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: trendline_down: mean=0.5245, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4313
[2025-07-19 01:31:34] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4297
[2025-07-19 01:31:34] INFO train_model: vol_spike_atr: mean=0.0154, std=0.1233, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: supply_zone: mean=0.4094, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: demand_zone: mean=0.4245, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:34] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:34] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:34] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: bos: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: choch: mean=0.1504, std=0.3575, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4700
[2025-07-19 01:31:34] INFO train_model: vol_cluster_high: mean=0.0751, std=0.2636, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: regime_zscore: mean=0.0090, std=1.0066, min=-7.1754, max=7.0756, unique=4626
[2025-07-19 01:31:34] INFO train_model: doji: mean=0.0961, std=0.2947, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: hammer: mean=0.0174, std=0.1306, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bullish_engulfing: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bearish_engulfing: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: pin_bar: mean=0.2357, std=0.4245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bullish_engulfing_bar: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bearish_engulfing_bar: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: inside_bar: mean=0.1126, std=0.3161, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: double_top: mean=0.0110, std=0.1043, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: double_bottom: mean=0.0229, std=0.1494, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: rising_wedge: mean=0.2391, std=0.4266, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: falling_wedge: mean=0.2482, std=0.4320, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: fakeout_up: mean=0.0066, std=0.0807, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: fakeout_down: mean=0.0076, std=0.0870, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bullish_flag: mean=0.0250, std=0.1560, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bearish_flag: mean=0.0222, std=0.1474, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bullish_pennant: mean=0.1306, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bearish_pennant: mean=0.1242, std=0.3299, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: morning_star: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: evening_star: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bullish_harami: mean=0.0406, std=0.1974, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: bearish_harami: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: dark_cloud_cover: mean=0.0781, std=0.2683, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:34] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 01:31:34] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 01:31:34] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 01:31:34] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 01:31:34] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 01:31:34] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 01:31:34] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 01:31:34] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 01:31:34] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 01:31:34] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 01:31:34] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 01:31:34] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:34] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:34] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:34] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:34] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:31:34] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 01:31:34] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 01:31:34] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 01:31:34] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 01:31:34] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 01:31:34] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:31:34] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:31:34] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:31:34] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:31:34] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:31:34] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 01:31:34] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 01:31:34] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:34] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: regime_label_bear: mean=0.5099, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: regime_label_bull: mean=0.4477, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: market_regime_consolidation: mean=0.2120, std=0.4088, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: market_regime_downtrend: mean=0.1885, std=0.3912, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: market_regime_range: mean=0.4075, std=0.4914, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: market_regime_uptrend: mean=0.1902, std=0.3925, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:34] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:34] INFO train_model: Auditing data quality before training...
[2025-07-19 01:31:34] INFO train_model: Entering audit_data_quality
[2025-07-19 01:31:39] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:31:42] INFO train_model: Model is starting a new training session...
[2025-07-19 01:31:42] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:31:42] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 01:31:42] INFO train_model: Preparing target variable...
[2025-07-19 01:31:42] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:31:42] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:31:42] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 01:31:42] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:31:42] INFO train_model: Dropping NaN targets...
[2025-07-19 01:31:42] INFO train_model: Class balance before upsampling: {0: 3092, 1: 1634}
[2025-07-19 01:31:42] INFO train_model: Upsampling successful.
[2025-07-19 01:31:42] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:31:42] INFO train_model: Splitting train/test...
[2025-07-19 01:31:42] INFO train_model: Scaling features...
[2025-07-19 01:31:42] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:31:42] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:31:44] INFO train_model: Model fit complete.
[2025-07-19 01:31:44] INFO train_model: Model Accuracy: 0.8828
[2025-07-19 01:31:44] INFO train_model: 
Classification Report:
[2025-07-19 01:31:44] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       619
           1       0.88      0.88      0.88       618

    accuracy                           0.88      1237
   macro avg       0.88      0.88      0.88      1237
weighted avg       0.88      0.88      0.88      1237

[2025-07-19 01:31:44] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 01:31:44] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '46975954b9064b2dac5cdbcbe3844bca'}}
[2025-07-19 01:31:44] INFO train_model: Feature distributions before training:
[2025-07-19 01:31:44] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4714
[2025-07-19 01:31:44] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4687
[2025-07-19 01:31:44] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4691
[2025-07-19 01:31:44] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4662
[2025-07-19 01:31:44] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4524
[2025-07-19 01:31:44] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4726
[2025-07-19 01:31:44] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4726
[2025-07-19 01:31:44] INFO train_model: rsi_14: mean=49.3849, std=12.3827, min=11.3290, max=91.7839, unique=4589
[2025-07-19 01:31:44] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4701
[2025-07-19 01:31:44] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4693
[2025-07-19 01:31:44] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4693
[2025-07-19 01:31:44] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4693
[2025-07-19 01:31:44] INFO train_model: stoch_k: mean=49.1792, std=28.8128, min=0.0000, max=100.0000, unique=4552
[2025-07-19 01:31:44] INFO train_model: stoch_d: mean=49.2137, std=26.3670, min=2.3676, max=99.2269, unique=4697
[2025-07-19 01:31:44] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-19 01:31:44] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4327
[2025-07-19 01:31:44] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2134
[2025-07-19 01:31:44] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4559
[2025-07-19 01:31:44] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2134
[2025-07-19 01:31:44] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4559
[2025-07-19 01:31:44] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2134
[2025-07-19 01:31:44] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4552
[2025-07-19 01:31:44] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2134
[2025-07-19 01:31:44] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4559
[2025-07-19 01:31:44] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2134
[2025-07-19 01:31:44] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4559
[2025-07-19 01:31:44] INFO train_model: fib_100: mean=0.5818, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-19 01:31:44] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4299
[2025-07-19 01:31:44] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4623
[2025-07-19 01:31:44] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4618
[2025-07-19 01:31:44] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: trendline_down: mean=0.5245, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4313
[2025-07-19 01:31:44] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4297
[2025-07-19 01:31:44] INFO train_model: vol_spike_atr: mean=0.0154, std=0.1233, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: supply_zone: mean=0.4094, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: demand_zone: mean=0.4245, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:44] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:44] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:44] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: bos: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: choch: mean=0.1504, std=0.3575, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4700
[2025-07-19 01:31:44] INFO train_model: vol_cluster_high: mean=0.0751, std=0.2636, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: regime_zscore: mean=0.0090, std=1.0066, min=-7.1754, max=7.0756, unique=4626
[2025-07-19 01:31:44] INFO train_model: doji: mean=0.0961, std=0.2947, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: hammer: mean=0.0174, std=0.1306, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bullish_engulfing: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bearish_engulfing: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: pin_bar: mean=0.2357, std=0.4245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bullish_engulfing_bar: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bearish_engulfing_bar: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: inside_bar: mean=0.1126, std=0.3161, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: double_top: mean=0.0110, std=0.1043, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: double_bottom: mean=0.0229, std=0.1494, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: rising_wedge: mean=0.2391, std=0.4266, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: falling_wedge: mean=0.2482, std=0.4320, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: fakeout_up: mean=0.0066, std=0.0807, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: fakeout_down: mean=0.0076, std=0.0870, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bullish_flag: mean=0.0250, std=0.1560, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bearish_flag: mean=0.0222, std=0.1474, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bullish_pennant: mean=0.1306, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bearish_pennant: mean=0.1242, std=0.3299, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: morning_star: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: evening_star: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bullish_harami: mean=0.0406, std=0.1974, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: bearish_harami: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: dark_cloud_cover: mean=0.0781, std=0.2683, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:44] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 01:31:44] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 01:31:44] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 01:31:44] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 01:31:44] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 01:31:44] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 01:31:44] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 01:31:44] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 01:31:44] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 01:31:44] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 01:31:44] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 01:31:44] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:44] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:44] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 01:31:44] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:44] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:31:44] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 01:31:44] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 01:31:44] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 01:31:44] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 01:31:44] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 01:31:44] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:31:44] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:31:44] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:31:44] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:31:44] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:31:44] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 01:31:44] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 01:31:44] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:31:44] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: regime_label_bear: mean=0.5099, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: regime_label_bull: mean=0.4477, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: market_regime_consolidation: mean=0.2120, std=0.4088, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: market_regime_downtrend: mean=0.1885, std=0.3912, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: market_regime_range: mean=0.4075, std=0.4914, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: market_regime_uptrend: mean=0.1902, std=0.3925, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:31:44] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:31:44] INFO train_model: Auditing data quality before training...
[2025-07-19 01:31:44] INFO train_model: Entering audit_data_quality
[2025-07-19 01:31:49] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:31:58] INFO train_model: Model is starting a new training session...
[2025-07-19 01:31:58] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:31:58] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 01:31:58] INFO train_model: Preparing target variable...
[2025-07-19 01:31:58] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:31:58] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:31:58] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 01:31:58] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:31:58] INFO train_model: Dropping NaN targets...
[2025-07-19 01:31:58] INFO train_model: Class balance before upsampling: {0: 3158, 1: 1566}
[2025-07-19 01:31:58] INFO train_model: Upsampling successful.
[2025-07-19 01:31:58] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:31:58] INFO train_model: Splitting train/test...
[2025-07-19 01:31:58] INFO train_model: Scaling features...
[2025-07-19 01:31:58] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:31:58] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:32:01] INFO train_model: Model fit complete.
[2025-07-19 01:32:01] INFO train_model: Model Accuracy: 0.8782
[2025-07-19 01:32:01] INFO train_model: 
Classification Report:
[2025-07-19 01:32:01] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       632
           1       0.88      0.88      0.88       632

    accuracy                           0.88      1264
   macro avg       0.88      0.88      0.88      1264
weighted avg       0.88      0.88      0.88      1264

[2025-07-19 01:32:01] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 01:32:01] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '6d8690ed5b572aeaa54af22750c34057'}}
[2025-07-19 01:32:01] INFO train_model: Feature distributions before training:
[2025-07-19 01:32:01] INFO train_model: atr_14: mean=0.3453, std=0.1085, min=0.0000, max=0.8613, unique=4712
[2025-07-19 01:32:01] INFO train_model: volatility_20: mean=0.3104, std=0.1648, min=0.0681, max=1.3557, unique=4704
[2025-07-19 01:32:01] INFO train_model: sma_20: mean=162.8970, std=3.4592, min=155.8359, max=172.8918, unique=4704
[2025-07-19 01:32:01] INFO train_model: sma_50: mean=162.8653, std=3.3929, min=156.1946, max=172.5970, unique=4672
[2025-07-19 01:32:01] INFO train_model: sma_200: mean=162.7251, std=3.0704, min=156.6790, max=172.1544, unique=4521
[2025-07-19 01:32:01] INFO train_model: ema_12: mean=162.9049, std=3.4734, min=155.6248, max=172.9037, unique=4724
[2025-07-19 01:32:01] INFO train_model: ema_26: mean=162.8909, std=3.4369, min=155.9072, max=172.7909, unique=4724
[2025-07-19 01:32:01] INFO train_model: rsi_14: mean=51.0080, std=11.8331, min=16.6264, max=87.9679, unique=4699
[2025-07-19 01:32:01] INFO train_model: macd: mean=0.0142, std=0.2003, min=-0.5343, max=0.7069, unique=4699
[2025-07-19 01:32:01] INFO train_model: macd_signal: mean=0.0136, std=0.1871, min=-0.4700, max=0.6611, unique=4691
[2025-07-19 01:32:01] INFO train_model: bb_high: mean=163.5020, std=3.3766, min=156.6277, max=173.3643, unique=4704
[2025-07-19 01:32:01] INFO train_model: bb_low: mean=162.2919, std=3.5689, min=154.8377, max=172.7094, unique=4704
[2025-07-19 01:32:01] INFO train_model: stoch_k: mean=52.6125, std=26.1493, min=0.0000, max=99.4364, unique=4698
[2025-07-19 01:32:01] INFO train_model: stoch_d: mean=52.6532, std=23.9367, min=3.6709, max=96.7048, unique=4708
[2025-07-19 01:32:01] INFO train_model: fib_0: mean=163.5464, std=3.3571, min=156.7820, max=173.2420, unique=1122
[2025-07-19 01:32:01] INFO train_model: dist_to_fib_0: mean=-0.6294, std=0.4939, min=-3.4340, max=-0.0090, unique=3106
[2025-07-19 01:32:01] INFO train_model: fib_236: mean=163.2300, std=3.4014, min=156.3121, max=173.0891, unique=2150
[2025-07-19 01:32:01] INFO train_model: dist_to_fib_236: mean=-0.3131, std=0.4371, min=-2.4716, max=0.9103, unique=4693
[2025-07-19 01:32:01] INFO train_model: fib_382: mean=163.0343, std=3.4314, min=156.0214, max=172.9945, unique=2150
[2025-07-19 01:32:01] INFO train_model: dist_to_fib_382: mean=-0.1174, std=0.4217, min=-1.8762, max=1.5799, unique=4693
[2025-07-19 01:32:01] INFO train_model: fib_500: mean=162.8762, std=3.4570, min=155.7865, max=172.9180, unique=2110
[2025-07-19 01:32:01] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4220, min=-1.4335, max=2.1210, unique=4391
[2025-07-19 01:32:01] INFO train_model: fib_618: mean=162.7180, std=3.4838, min=155.5516, max=172.8415, unique=2150
[2025-07-19 01:32:01] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4336, min=-1.0813, max=2.6622, unique=4693
[2025-07-19 01:32:01] INFO train_model: fib_786: mean=162.4928, std=3.5241, min=155.2171, max=172.7327, unique=2150
[2025-07-19 01:32:01] INFO train_model: dist_to_fib_786: mean=0.4241, std=0.4679, min=-0.5798, max=3.4326, unique=4693
[2025-07-19 01:32:01] INFO train_model: fib_100: mean=162.2060, std=3.5787, min=154.7910, max=172.5940, unique=1112
[2025-07-19 01:32:01] INFO train_model: dist_to_fib_100: mean=0.7110, std=0.5356, min=0.0000, max=4.4140, unique=3220
[2025-07-19 01:32:01] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=3776
[2025-07-19 01:32:01] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=3825
[2025-07-19 01:32:01] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: trendline_down: mean=0.4723, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: dist_to_high: mean=-0.6273, std=0.5162, min=-3.4340, max=0.3400, unique=3182
[2025-07-19 01:32:01] INFO train_model: dist_to_low: mean=0.7121, std=0.5611, min=-0.9330, max=4.4140, unique=3281
[2025-07-19 01:32:01] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: vol_spike_std: mean=0.1367, std=0.3436, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: supply_zone: mean=0.4773, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: demand_zone: mean=0.4005, std=0.4901, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:01] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:01] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:01] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: choch: mean=0.1507, std=0.3578, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4704
[2025-07-19 01:32:01] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2542, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: regime_zscore: mean=-0.0081, std=0.9939, min=-6.5566, max=5.1800, unique=4624
[2025-07-19 01:32:01] INFO train_model: doji: mean=0.1196, std=0.3245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: hammer: mean=0.0218, std=0.1461, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bearish_engulfing: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: pin_bar: mean=0.3135, std=0.4640, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bearish_engulfing_bar: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: inside_bar: mean=0.1452, std=0.3524, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: rising_wedge: mean=0.2688, std=0.4434, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: falling_wedge: mean=0.2299, std=0.4208, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bullish_flag: mean=0.0231, std=0.1502, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bearish_flag: mean=0.0229, std=0.1495, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bullish_pennant: mean=0.1376, std=0.3445, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bearish_pennant: mean=0.1304, std=0.3368, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: morning_star: mean=0.0419, std=0.2004, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: evening_star: mean=0.0381, std=0.1915, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bullish_harami: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: bearish_harami: mean=0.0491, std=0.2161, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: dark_cloud_cover: mean=0.1143, std=0.3182, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:01] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 01:32:01] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 01:32:01] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 01:32:01] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 01:32:01] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 01:32:01] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 01:32:01] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 01:32:01] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 01:32:01] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 01:32:01] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 01:32:01] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 01:32:01] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:01] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:01] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:01] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:01] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:32:01] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 01:32:01] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 01:32:01] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 01:32:01] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 01:32:01] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 01:32:01] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:32:01] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:32:01] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:32:01] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:32:01] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:32:01] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 01:32:01] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 01:32:01] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:01] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: regime_label_bear: mean=0.3861, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: regime_label_bull: mean=0.5715, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: market_regime_choppy: mean=0.2517, std=0.4340, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: market_regime_downtrend: mean=0.2189, std=0.4135, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: market_regime_range: mean=0.2949, std=0.4560, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: market_regime_uptrend: mean=0.2345, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:01] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:01] INFO train_model: Auditing data quality before training...
[2025-07-19 01:32:01] INFO train_model: Entering audit_data_quality
[2025-07-19 01:32:06] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:32:09] INFO train_model: Model is starting a new training session...
[2025-07-19 01:32:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:32:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 01:32:09] INFO train_model: Preparing target variable...
[2025-07-19 01:32:09] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:32:09] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:32:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 01:32:09] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:32:09] INFO train_model: Dropping NaN targets...
[2025-07-19 01:32:09] INFO train_model: Class balance before upsampling: {0: 3158, 1: 1566}
[2025-07-19 01:32:09] INFO train_model: Upsampling successful.
[2025-07-19 01:32:09] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:32:09] INFO train_model: Splitting train/test...
[2025-07-19 01:32:09] INFO train_model: Scaling features...
[2025-07-19 01:32:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:32:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:32:11] INFO train_model: Model fit complete.
[2025-07-19 01:32:11] INFO train_model: Model Accuracy: 0.8782
[2025-07-19 01:32:11] INFO train_model: 
Classification Report:
[2025-07-19 01:32:11] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       632
           1       0.88      0.88      0.88       632

    accuracy                           0.88      1264
   macro avg       0.88      0.88      0.88      1264
weighted avg       0.88      0.88      0.88      1264

[2025-07-19 01:32:11] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 01:32:11] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '6d8690ed5b572aeaa54af22750c34057'}}
[2025-07-19 01:32:11] INFO train_model: Feature distributions before training:
[2025-07-19 01:32:11] INFO train_model: atr_14: mean=0.3453, std=0.1085, min=0.0000, max=0.8613, unique=4712
[2025-07-19 01:32:11] INFO train_model: volatility_20: mean=0.3104, std=0.1648, min=0.0681, max=1.3557, unique=4704
[2025-07-19 01:32:11] INFO train_model: sma_20: mean=162.8970, std=3.4592, min=155.8359, max=172.8918, unique=4704
[2025-07-19 01:32:11] INFO train_model: sma_50: mean=162.8653, std=3.3929, min=156.1946, max=172.5970, unique=4672
[2025-07-19 01:32:11] INFO train_model: sma_200: mean=162.7251, std=3.0704, min=156.6790, max=172.1544, unique=4521
[2025-07-19 01:32:11] INFO train_model: ema_12: mean=162.9049, std=3.4734, min=155.6248, max=172.9037, unique=4724
[2025-07-19 01:32:11] INFO train_model: ema_26: mean=162.8909, std=3.4369, min=155.9072, max=172.7909, unique=4724
[2025-07-19 01:32:11] INFO train_model: rsi_14: mean=51.0080, std=11.8331, min=16.6264, max=87.9679, unique=4699
[2025-07-19 01:32:11] INFO train_model: macd: mean=0.0142, std=0.2003, min=-0.5343, max=0.7069, unique=4699
[2025-07-19 01:32:11] INFO train_model: macd_signal: mean=0.0136, std=0.1871, min=-0.4700, max=0.6611, unique=4691
[2025-07-19 01:32:11] INFO train_model: bb_high: mean=163.5020, std=3.3766, min=156.6277, max=173.3643, unique=4704
[2025-07-19 01:32:11] INFO train_model: bb_low: mean=162.2919, std=3.5689, min=154.8377, max=172.7094, unique=4704
[2025-07-19 01:32:11] INFO train_model: stoch_k: mean=52.6125, std=26.1493, min=0.0000, max=99.4364, unique=4698
[2025-07-19 01:32:11] INFO train_model: stoch_d: mean=52.6532, std=23.9367, min=3.6709, max=96.7048, unique=4708
[2025-07-19 01:32:11] INFO train_model: fib_0: mean=163.5464, std=3.3571, min=156.7820, max=173.2420, unique=1122
[2025-07-19 01:32:11] INFO train_model: dist_to_fib_0: mean=-0.6294, std=0.4939, min=-3.4340, max=-0.0090, unique=3106
[2025-07-19 01:32:11] INFO train_model: fib_236: mean=163.2300, std=3.4014, min=156.3121, max=173.0891, unique=2150
[2025-07-19 01:32:11] INFO train_model: dist_to_fib_236: mean=-0.3131, std=0.4371, min=-2.4716, max=0.9103, unique=4693
[2025-07-19 01:32:11] INFO train_model: fib_382: mean=163.0343, std=3.4314, min=156.0214, max=172.9945, unique=2150
[2025-07-19 01:32:11] INFO train_model: dist_to_fib_382: mean=-0.1174, std=0.4217, min=-1.8762, max=1.5799, unique=4693
[2025-07-19 01:32:11] INFO train_model: fib_500: mean=162.8762, std=3.4570, min=155.7865, max=172.9180, unique=2110
[2025-07-19 01:32:11] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4220, min=-1.4335, max=2.1210, unique=4391
[2025-07-19 01:32:11] INFO train_model: fib_618: mean=162.7180, std=3.4838, min=155.5516, max=172.8415, unique=2150
[2025-07-19 01:32:11] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4336, min=-1.0813, max=2.6622, unique=4693
[2025-07-19 01:32:11] INFO train_model: fib_786: mean=162.4928, std=3.5241, min=155.2171, max=172.7327, unique=2150
[2025-07-19 01:32:11] INFO train_model: dist_to_fib_786: mean=0.4241, std=0.4679, min=-0.5798, max=3.4326, unique=4693
[2025-07-19 01:32:11] INFO train_model: fib_100: mean=162.2060, std=3.5787, min=154.7910, max=172.5940, unique=1112
[2025-07-19 01:32:11] INFO train_model: dist_to_fib_100: mean=0.7110, std=0.5356, min=0.0000, max=4.4140, unique=3220
[2025-07-19 01:32:11] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=3776
[2025-07-19 01:32:11] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=3825
[2025-07-19 01:32:11] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: trendline_down: mean=0.4723, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: dist_to_high: mean=-0.6273, std=0.5162, min=-3.4340, max=0.3400, unique=3182
[2025-07-19 01:32:11] INFO train_model: dist_to_low: mean=0.7121, std=0.5611, min=-0.9330, max=4.4140, unique=3281
[2025-07-19 01:32:11] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: vol_spike_std: mean=0.1367, std=0.3436, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: supply_zone: mean=0.4773, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: demand_zone: mean=0.4005, std=0.4901, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:11] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: choch: mean=0.1507, std=0.3578, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4704
[2025-07-19 01:32:11] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2542, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: regime_zscore: mean=-0.0081, std=0.9939, min=-6.5566, max=5.1800, unique=4624
[2025-07-19 01:32:11] INFO train_model: doji: mean=0.1196, std=0.3245, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: hammer: mean=0.0218, std=0.1461, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bearish_engulfing: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: pin_bar: mean=0.3135, std=0.4640, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bearish_engulfing_bar: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: inside_bar: mean=0.1452, std=0.3524, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: rising_wedge: mean=0.2688, std=0.4434, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: falling_wedge: mean=0.2299, std=0.4208, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bullish_flag: mean=0.0231, std=0.1502, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bearish_flag: mean=0.0229, std=0.1495, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bullish_pennant: mean=0.1376, std=0.3445, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bearish_pennant: mean=0.1304, std=0.3368, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: morning_star: mean=0.0419, std=0.2004, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: evening_star: mean=0.0381, std=0.1915, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bullish_harami: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: bearish_harami: mean=0.0491, std=0.2161, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: dark_cloud_cover: mean=0.1143, std=0.3182, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:11] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 01:32:11] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 01:32:11] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 01:32:11] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 01:32:11] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 01:32:11] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 01:32:11] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 01:32:11] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 01:32:11] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 01:32:11] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 01:32:11] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 01:32:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:11] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:11] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:32:11] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 01:32:11] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 01:32:11] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 01:32:11] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 01:32:11] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 01:32:11] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:32:11] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:32:11] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:32:11] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:32:11] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:32:11] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 01:32:11] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 01:32:11] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:11] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: regime_label_bear: mean=0.3861, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: regime_label_bull: mean=0.5715, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: market_regime_choppy: mean=0.2517, std=0.4340, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: market_regime_downtrend: mean=0.2189, std=0.4135, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: market_regime_range: mean=0.2949, std=0.4560, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: market_regime_uptrend: mean=0.2345, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:11] INFO train_model: Auditing data quality before training...
[2025-07-19 01:32:11] INFO train_model: Entering audit_data_quality
[2025-07-19 01:32:17] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:32:25] INFO train_model: Model is starting a new training session...
[2025-07-19 01:32:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:32:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 01:32:25] INFO train_model: Preparing target variable...
[2025-07-19 01:32:25] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:32:25] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:32:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 01:32:25] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:32:25] INFO train_model: Dropping NaN targets...
[2025-07-19 01:32:25] INFO train_model: Class balance before upsampling: {0: 3067, 1: 1657}
[2025-07-19 01:32:25] INFO train_model: Upsampling successful.
[2025-07-19 01:32:26] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:32:26] INFO train_model: Splitting train/test...
[2025-07-19 01:32:26] INFO train_model: Scaling features...
[2025-07-19 01:32:26] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:32:26] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:32:28] INFO train_model: Model fit complete.
[2025-07-19 01:32:28] INFO train_model: Model Accuracy: 0.8419
[2025-07-19 01:32:28] INFO train_model: 
Classification Report:
[2025-07-19 01:32:28] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.85      0.84       614
           1       0.84      0.84      0.84       613

    accuracy                           0.84      1227
   macro avg       0.84      0.84      0.84      1227
weighted avg       0.84      0.84      0.84      1227

[2025-07-19 01:32:28] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 01:32:28] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': '81cb0af832d014abc50b04a59db67ee5'}}
[2025-07-19 01:32:28] INFO train_model: Feature distributions before training:
[2025-07-19 01:32:28] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8450, unique=4712
[2025-07-19 01:32:28] INFO train_model: volatility_20: mean=0.2228, std=0.2570, min=0.0393, max=3.3152, unique=4702
[2025-07-19 01:32:28] INFO train_model: sma_20: mean=87.3666, std=2.2038, min=81.5998, max=92.2272, unique=4701
[2025-07-19 01:32:28] INFO train_model: sma_50: mean=87.3744, std=2.1956, min=82.0271, max=91.9825, unique=4673
[2025-07-19 01:32:28] INFO train_model: sma_200: mean=87.4223, std=2.1965, min=83.2738, max=91.5912, unique=4521
[2025-07-19 01:32:28] INFO train_model: ema_12: mean=87.3644, std=2.2035, min=81.3860, max=92.2433, unique=4724
[2025-07-19 01:32:28] INFO train_model: ema_26: mean=87.3681, std=2.1958, min=81.7434, max=92.1009, unique=4724
[2025-07-19 01:32:28] INFO train_model: rsi_14: mean=49.9041, std=11.8518, min=11.9091, max=86.8743, unique=4685
[2025-07-19 01:32:28] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4467, unique=4699
[2025-07-19 01:32:28] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4691
[2025-07-19 01:32:28] INFO train_model: bb_high: mean=87.8010, std=2.1265, min=82.3688, max=92.6084, unique=4703
[2025-07-19 01:32:28] INFO train_model: bb_low: mean=86.9322, std=2.3861, min=77.4303, max=92.0349, unique=4703
[2025-07-19 01:32:28] INFO train_model: stoch_k: mean=51.5672, std=26.9451, min=0.7728, max=239.4568, unique=4672
[2025-07-19 01:32:28] INFO train_model: stoch_d: mean=51.5617, std=24.5719, min=3.8824, max=173.4622, unique=4698
[2025-07-19 01:32:28] INFO train_model: fib_0: mean=87.8005, std=2.1197, min=82.4090, max=92.4600, unique=1115
[2025-07-19 01:32:28] INFO train_model: dist_to_fib_0: mean=-0.4378, std=0.4917, min=-6.7800, max=3.6535, unique=2675
[2025-07-19 01:32:28] INFO train_model: fib_236: mean=87.5878, std=2.1510, min=81.9488, max=92.3562, unique=2140
[2025-07-19 01:32:28] INFO train_model: dist_to_fib_236: mean=-0.2251, std=0.4029, min=-5.1658, max=4.4047, unique=4668
[2025-07-19 01:32:28] INFO train_model: fib_382: mean=87.4561, std=2.1757, min=81.6641, max=92.2919, unique=2140
[2025-07-19 01:32:28] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8694, unique=4668
[2025-07-19 01:32:28] INFO train_model: fib_500: mean=87.3498, std=2.1984, min=81.4340, max=92.2400, unique=2084
[2025-07-19 01:32:28] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2450, unique=4266
[2025-07-19 01:32:28] INFO train_model: fib_618: mean=87.2434, std=2.2236, min=81.2039, max=92.1881, unique=2140
[2025-07-19 01:32:28] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6206, unique=4667
[2025-07-19 01:32:28] INFO train_model: fib_786: mean=87.0919, std=2.2636, min=80.8763, max=92.1142, unique=2140
[2025-07-19 01:32:28] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1553, unique=4667
[2025-07-19 01:32:28] INFO train_model: fib_100: mean=86.8990, std=2.3210, min=80.4530, max=92.0200, unique=1084
[2025-07-19 01:32:28] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4822, min=0.0060, max=6.8365, unique=2743
[2025-07-19 01:32:28] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3389
[2025-07-19 01:32:28] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-19 01:32:28] INFO train_model: trendline_up: mean=0.4905, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: trendline_down: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: dist_to_high: mean=-0.4384, std=0.4965, min=-6.7220, max=3.3765, unique=2743
[2025-07-19 01:32:28] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8365, unique=2785
[2025-07-19 01:32:28] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: vol_spike_std: mean=0.1293, std=0.3356, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: supply_zone: mean=0.4138, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: demand_zone: mean=0.3781, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:28] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:28] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:28] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: bos: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: choch: mean=0.1564, std=0.3633, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4704
[2025-07-19 01:32:28] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2420, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: regime_zscore: mean=-0.0107, std=1.0098, min=-7.2839, max=9.1570, unique=4624
[2025-07-19 01:32:28] INFO train_model: doji: mean=0.1228, std=0.3282, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: hammer: mean=0.0220, std=0.1467, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: pin_bar: mean=0.3027, std=0.4595, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: inside_bar: mean=0.1410, std=0.3480, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: head_shoulders: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: double_top: mean=0.0032, std=0.0563, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: double_bottom: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: rising_wedge: mean=0.2699, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: falling_wedge: mean=0.2631, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bullish_flag: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bearish_flag: mean=0.0288, std=0.1672, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bullish_pennant: mean=0.1319, std=0.3384, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bearish_pennant: mean=0.1179, std=0.3225, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: morning_star: mean=0.0430, std=0.2028, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: evening_star: mean=0.0366, std=0.1879, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: bullish_harami: mean=0.0472, std=0.2121, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: bearish_harami: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:28] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 01:32:28] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 01:32:28] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 01:32:28] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 01:32:28] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 01:32:28] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 01:32:28] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 01:32:28] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 01:32:28] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 01:32:28] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 01:32:28] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 01:32:28] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:28] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:28] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:28] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:28] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:32:28] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 01:32:28] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 01:32:28] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 01:32:28] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 01:32:28] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 01:32:28] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:32:28] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:32:28] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:32:28] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:32:28] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:32:28] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 01:32:28] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 01:32:28] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:28] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: regime_label_bear: mean=0.4308, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: regime_label_bull: mean=0.5269, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: market_regime_choppy: mean=0.2904, std=0.4540, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: market_regime_downtrend: mean=0.2367, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: market_regime_range: mean=0.2887, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: market_regime_uptrend: mean=0.1842, std=0.3877, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:28] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:28] INFO train_model: Auditing data quality before training...
[2025-07-19 01:32:28] INFO train_model: Entering audit_data_quality
[2025-07-19 01:32:33] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:32:35] INFO train_model: Model is starting a new training session...
[2025-07-19 01:32:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:32:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 01:32:35] INFO train_model: Preparing target variable...
[2025-07-19 01:32:35] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:32:35] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:32:35] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 01:32:35] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:32:35] INFO train_model: Dropping NaN targets...
[2025-07-19 01:32:35] INFO train_model: Class balance before upsampling: {0: 3067, 1: 1657}
[2025-07-19 01:32:35] INFO train_model: Upsampling successful.
[2025-07-19 01:32:35] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:32:35] INFO train_model: Splitting train/test...
[2025-07-19 01:32:35] INFO train_model: Scaling features...
[2025-07-19 01:32:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:32:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:32:38] INFO train_model: Model fit complete.
[2025-07-19 01:32:38] INFO train_model: Model Accuracy: 0.8419
[2025-07-19 01:32:38] INFO train_model: 
Classification Report:
[2025-07-19 01:32:38] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.85      0.84       614
           1       0.84      0.84      0.84       613

    accuracy                           0.84      1227
   macro avg       0.84      0.84      0.84      1227
weighted avg       0.84      0.84      0.84      1227

[2025-07-19 01:32:38] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 01:32:38] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': '81cb0af832d014abc50b04a59db67ee5'}}
[2025-07-19 01:32:38] INFO train_model: Feature distributions before training:
[2025-07-19 01:32:38] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8450, unique=4712
[2025-07-19 01:32:38] INFO train_model: volatility_20: mean=0.2228, std=0.2570, min=0.0393, max=3.3152, unique=4702
[2025-07-19 01:32:38] INFO train_model: sma_20: mean=87.3666, std=2.2038, min=81.5998, max=92.2272, unique=4701
[2025-07-19 01:32:38] INFO train_model: sma_50: mean=87.3744, std=2.1956, min=82.0271, max=91.9825, unique=4673
[2025-07-19 01:32:38] INFO train_model: sma_200: mean=87.4223, std=2.1965, min=83.2738, max=91.5912, unique=4521
[2025-07-19 01:32:38] INFO train_model: ema_12: mean=87.3644, std=2.2035, min=81.3860, max=92.2433, unique=4724
[2025-07-19 01:32:38] INFO train_model: ema_26: mean=87.3681, std=2.1958, min=81.7434, max=92.1009, unique=4724
[2025-07-19 01:32:38] INFO train_model: rsi_14: mean=49.9041, std=11.8518, min=11.9091, max=86.8743, unique=4685
[2025-07-19 01:32:38] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4467, unique=4699
[2025-07-19 01:32:38] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4691
[2025-07-19 01:32:38] INFO train_model: bb_high: mean=87.8010, std=2.1265, min=82.3688, max=92.6084, unique=4703
[2025-07-19 01:32:38] INFO train_model: bb_low: mean=86.9322, std=2.3861, min=77.4303, max=92.0349, unique=4703
[2025-07-19 01:32:38] INFO train_model: stoch_k: mean=51.5672, std=26.9451, min=0.7728, max=239.4568, unique=4672
[2025-07-19 01:32:38] INFO train_model: stoch_d: mean=51.5617, std=24.5719, min=3.8824, max=173.4622, unique=4698
[2025-07-19 01:32:38] INFO train_model: fib_0: mean=87.8005, std=2.1197, min=82.4090, max=92.4600, unique=1115
[2025-07-19 01:32:38] INFO train_model: dist_to_fib_0: mean=-0.4378, std=0.4917, min=-6.7800, max=3.6535, unique=2675
[2025-07-19 01:32:38] INFO train_model: fib_236: mean=87.5878, std=2.1510, min=81.9488, max=92.3562, unique=2140
[2025-07-19 01:32:38] INFO train_model: dist_to_fib_236: mean=-0.2251, std=0.4029, min=-5.1658, max=4.4047, unique=4668
[2025-07-19 01:32:38] INFO train_model: fib_382: mean=87.4561, std=2.1757, min=81.6641, max=92.2919, unique=2140
[2025-07-19 01:32:38] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8694, unique=4668
[2025-07-19 01:32:38] INFO train_model: fib_500: mean=87.3498, std=2.1984, min=81.4340, max=92.2400, unique=2084
[2025-07-19 01:32:38] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2450, unique=4266
[2025-07-19 01:32:38] INFO train_model: fib_618: mean=87.2434, std=2.2236, min=81.2039, max=92.1881, unique=2140
[2025-07-19 01:32:38] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6206, unique=4667
[2025-07-19 01:32:38] INFO train_model: fib_786: mean=87.0919, std=2.2636, min=80.8763, max=92.1142, unique=2140
[2025-07-19 01:32:38] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1553, unique=4667
[2025-07-19 01:32:38] INFO train_model: fib_100: mean=86.8990, std=2.3210, min=80.4530, max=92.0200, unique=1084
[2025-07-19 01:32:38] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4822, min=0.0060, max=6.8365, unique=2743
[2025-07-19 01:32:38] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3389
[2025-07-19 01:32:38] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-19 01:32:38] INFO train_model: trendline_up: mean=0.4905, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: trendline_down: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: dist_to_high: mean=-0.4384, std=0.4965, min=-6.7220, max=3.3765, unique=2743
[2025-07-19 01:32:38] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8365, unique=2785
[2025-07-19 01:32:38] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: vol_spike_std: mean=0.1293, std=0.3356, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: supply_zone: mean=0.4138, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: demand_zone: mean=0.3781, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:38] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: bos: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: choch: mean=0.1564, std=0.3633, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4704
[2025-07-19 01:32:38] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2420, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: regime_zscore: mean=-0.0107, std=1.0098, min=-7.2839, max=9.1570, unique=4624
[2025-07-19 01:32:38] INFO train_model: doji: mean=0.1228, std=0.3282, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: hammer: mean=0.0220, std=0.1467, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: pin_bar: mean=0.3027, std=0.4595, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: inside_bar: mean=0.1410, std=0.3480, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: head_shoulders: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: double_top: mean=0.0032, std=0.0563, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: double_bottom: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: rising_wedge: mean=0.2699, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: falling_wedge: mean=0.2631, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bullish_flag: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bearish_flag: mean=0.0288, std=0.1672, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bullish_pennant: mean=0.1319, std=0.3384, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bearish_pennant: mean=0.1179, std=0.3225, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: morning_star: mean=0.0430, std=0.2028, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: evening_star: mean=0.0366, std=0.1879, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: bullish_harami: mean=0.0472, std=0.2121, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: bearish_harami: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:38] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 01:32:38] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 01:32:38] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 01:32:38] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 01:32:38] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 01:32:38] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 01:32:38] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 01:32:38] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 01:32:38] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 01:32:38] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 01:32:38] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 01:32:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 01:32:38] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:38] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 01:32:38] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 01:32:38] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 01:32:38] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 01:32:38] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 01:32:38] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 01:32:38] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 01:32:38] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 01:32:38] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:32:38] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 01:32:38] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 01:32:38] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 01:32:38] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 01:32:38] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:32:38] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: regime_label_bear: mean=0.4308, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: regime_label_bull: mean=0.5269, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: market_regime_choppy: mean=0.2904, std=0.4540, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: market_regime_downtrend: mean=0.2367, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: market_regime_range: mean=0.2887, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: market_regime_uptrend: mean=0.1842, std=0.3877, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:32:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:32:38] INFO train_model: Auditing data quality before training...
[2025-07-19 01:32:38] INFO train_model: Entering audit_data_quality
[2025-07-19 01:32:43] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:33:00] INFO train_model: Model is starting a new training session...
[2025-07-19 01:33:00] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:33:00] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=123)
[2025-07-19 01:33:00] INFO train_model: Preparing target variable...
[2025-07-19 01:33:00] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:33:00] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:33:00] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=125)
[2025-07-19 01:33:00] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:33:00] INFO train_model: Dropping NaN targets...
[2025-07-19 01:33:00] INFO train_model: Class balance before upsampling: {0: 2414, 1: 2311}
[2025-07-19 01:33:00] INFO train_model: Upsampling successful.
[2025-07-19 01:33:00] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:33:00] INFO train_model: Splitting train/test...
[2025-07-19 01:33:00] INFO train_model: Scaling features...
[2025-07-19 01:33:00] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:33:00] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:33:02] INFO train_model: Model fit complete.
[2025-07-19 01:33:02] INFO train_model: Model Accuracy: 0.8313
[2025-07-19 01:33:02] INFO train_model: 
Classification Report:
[2025-07-19 01:33:02] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.83      0.83       483
           1       0.83      0.83      0.83       483

    accuracy                           0.83       966
   macro avg       0.83      0.83      0.83       966
weighted avg       0.83      0.83      0.83       966

[2025-07-19 01:33:02] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 01:33:02] INFO train_model: Model registered in ModelRegistry for BTCUSD, version 4b5adf75f8cb2c49db2ead2ba5f2fc73
[2025-07-19 01:33:02] INFO train_model: Feature distributions before training:
[2025-07-19 01:33:02] INFO train_model: atr_14: mean=790.2925, std=316.4131, min=248.5360, max=2432.8175, unique=4725
[2025-07-19 01:33:02] INFO train_model: volatility_20: mean=826.8249, std=533.2637, min=141.7903, max=3956.2747, unique=4725
[2025-07-19 01:33:02] INFO train_model: sma_20: mean=94356.7082, std=12268.7071, min=62628.1240, max=121103.9988, unique=4725
[2025-07-19 01:33:02] INFO train_model: sma_50: mean=94197.6233, std=12256.8055, min=62799.2954, max=119557.6389, unique=4725
[2025-07-19 01:33:02] INFO train_model: sma_200: mean=93600.1157, std=12291.7664, min=62183.0844, max=118218.3794, unique=4724
[2025-07-19 01:33:02] INFO train_model: ema_12: mean=94411.1552, std=12263.4838, min=62644.2626, max=121438.5343, unique=4725
[2025-07-19 01:33:02] INFO train_model: ema_26: mean=94330.8663, std=12247.0436, min=62673.5403, max=120532.2026, unique=4725
[2025-07-19 01:33:02] INFO train_model: rsi_14: mean=52.2288, std=12.4379, min=12.9206, max=90.2253, unique=4725
[2025-07-19 01:33:02] INFO train_model: macd: mean=80.2889, std=560.5874, min=-1881.4601, max=2409.3781, unique=4725
[2025-07-19 01:33:02] INFO train_model: macd_signal: mean=76.0059, std=522.8613, min=-1668.9823, max=2004.6298, unique=4725
[2025-07-19 01:33:02] INFO train_model: bb_high: mean=95968.4866, std=12347.6445, min=63008.0505, max=123631.2152, unique=4725
[2025-07-19 01:33:02] INFO train_model: bb_low: mean=92744.9299, std=12277.5908, min=61485.6176, max=119063.2808, unique=4725
[2025-07-19 01:33:02] INFO train_model: stoch_k: mean=53.8668, std=27.2018, min=0.0000, max=100.0000, unique=4708
[2025-07-19 01:33:02] INFO train_model: stoch_d: mean=53.9087, std=24.5302, min=4.8709, max=97.8432, unique=4725
[2025-07-19 01:33:02] INFO train_model: fib_0: mean=96011.1458, std=12315.0639, min=63086.8359, max=123077.6328, unique=1209
[2025-07-19 01:33:02] INFO train_model: dist_to_fib_0: mean=-1525.7156, std=1389.9513, min=-10522.6016, max=0.0000, unique=4700
[2025-07-19 01:33:02] INFO train_model: fib_236: mean=95207.3054, std=12281.0821, min=62841.1609, max=122164.0787, unique=2197
[2025-07-19 01:33:02] INFO train_model: dist_to_fib_236: mean=-721.8751, std=1190.5630, min=-7889.1863, max=2479.4287, unique=4725
[2025-07-19 01:33:02] INFO train_model: fib_382: mean=94710.0142, std=12267.2667, min=62689.1754, max=121598.9138, unique=2197
[2025-07-19 01:33:02] INFO train_model: dist_to_fib_382: mean=-224.5840, std=1130.0725, min=-6260.0396, max=4013.8442, unique=4724
[2025-07-19 01:33:02] INFO train_model: fib_500: mean=94308.0940, std=12260.1433, min=62566.3379, max=121142.1367, unique=2197
[2025-07-19 01:33:02] INFO train_model: dist_to_fib_500: mean=177.3363, std=1123.8300, min=-4943.3320, max=5253.9883, unique=4708
[2025-07-19 01:33:02] INFO train_model: fib_618: mean=93906.1737, std=12256.6406, min=62443.5004, max=120685.3596, unique=2197
[2025-07-19 01:33:02] INFO train_model: dist_to_fib_618: mean=579.2565, std=1156.6193, min=-3626.6244, max=6494.1323, unique=4725
[2025-07-19 01:33:02] INFO train_model: fib_786: mean=93333.9483, std=12257.9063, min=62268.6130, max=120035.0330, unique=2197
[2025-07-19 01:33:02] INFO train_model: dist_to_fib_786: mean=1151.4819, std=1263.9286, min=-1751.9899, max=8259.7611, unique=4725
[2025-07-19 01:33:02] INFO train_model: fib_100: mean=92605.0421, std=12270.1504, min=62045.8398, max=119206.6406, unique=1276
[2025-07-19 01:33:02] INFO train_model: dist_to_fib_100: mean=1880.3881, std=1479.5901, min=0.0000, max=10508.8359, unique=4692
[2025-07-19 01:33:02] INFO train_model: trendline_slope_high: mean=12.6293, std=110.5220, min=-488.7707, max=418.4305, unique=4710
[2025-07-19 01:33:02] INFO train_model: trendline_slope_low: mean=11.3012, std=113.7325, min=-487.6711, max=479.1137, unique=4719
[2025-07-19 01:33:02] INFO train_model: trendline_up: mean=0.5517, std=0.4974, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: trendline_down: mean=0.4415, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: breakout_high: mean=0.0129, std=0.1129, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: breakout_low: mean=0.0131, std=0.1138, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: dist_to_high: mean=-1509.4770, std=1448.7133, min=-10522.6016, max=359.2578, unique=4702
[2025-07-19 01:33:02] INFO train_model: dist_to_low: mean=1889.9598, std=1544.1018, min=-408.2344, max=10508.8359, unique=4706
[2025-07-19 01:33:02] INFO train_model: vol_spike_atr: mean=0.0372, std=0.1894, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: vol_spike_std: mean=0.1793, std=0.3836, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: is_trending: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: supply_zone: mean=0.2180, std=0.4129, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: demand_zone: mean=0.1583, std=0.3651, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:02] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:02] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:02] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: bos: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: choch: mean=0.1547, std=0.3617, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: vol_cluster_std: mean=0.0052, std=0.0026, min=0.0011, max=0.0169, unique=4725
[2025-07-19 01:33:02] INFO train_model: vol_cluster_high: mean=0.1850, std=0.3883, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: regime_zscore: mean=0.0070, std=1.1316, min=-5.7567, max=6.9376, unique=4725
[2025-07-19 01:33:02] INFO train_model: doji: mean=0.0804, std=0.2720, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: hammer: mean=0.0241, std=0.1535, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bullish_engulfing: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bearish_engulfing: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: pin_bar: mean=0.2360, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bullish_engulfing_bar: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bearish_engulfing_bar: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: inside_bar: mean=0.1407, std=0.3478, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: rising_wedge: mean=0.2506, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: falling_wedge: mean=0.2595, std=0.4384, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: fakeout_up: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: fakeout_down: mean=0.0083, std=0.0905, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bullish_flag: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bearish_flag: mean=0.0267, std=0.1611, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bullish_pennant: mean=0.1308, std=0.3372, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bearish_pennant: mean=0.1255, std=0.3313, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: morning_star: mean=0.0394, std=0.1945, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: evening_star: mean=0.0383, std=0.1920, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: bullish_harami: mean=0.0603, std=0.2381, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: bearish_harami: mean=0.0590, std=0.2357, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: dark_cloud_cover: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:33:02] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4671
[2025-07-19 01:33:02] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4647
[2025-07-19 01:33:02] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4725
[2025-07-19 01:33:02] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4725
[2025-07-19 01:33:02] INFO train_model: rsi_14_4h: mean=51.1047, std=32.5781, min=0.0000, max=100.0000, unique=1783
[2025-07-19 01:33:02] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4725
[2025-07-19 01:33:02] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4725
[2025-07-19 01:33:02] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4673
[2025-07-19 01:33:02] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4673
[2025-07-19 01:33:02] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4710
[2025-07-19 01:33:02] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4663
[2025-07-19 01:33:02] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:02] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:02] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:02] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:33:02] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 01:33:02] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4655
[2025-07-19 01:33:02] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4725
[2025-07-19 01:33:02] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4725
[2025-07-19 01:33:02] INFO train_model: rsi_14_1d: mean=47.2804, std=49.9313, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4725
[2025-07-19 01:33:02] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4725
[2025-07-19 01:33:02] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 01:33:02] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 01:33:02] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:33:02] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 01:33:02] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 01:33:02] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4655
[2025-07-19 01:33:02] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4655
[2025-07-19 01:33:02] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:33:02] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: regime_label_bear: mean=0.3926, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: regime_label_bull: mean=0.6074, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: market_regime_choppy: mean=0.2125, std=0.4091, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: market_regime_downtrend: mean=0.2582, std=0.4377, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: market_regime_range: mean=0.2195, std=0.4139, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: market_regime_uptrend: mean=0.3098, std=0.4625, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:02] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:02] INFO train_model: Auditing data quality before training...
[2025-07-19 01:33:02] INFO train_model: Entering audit_data_quality
[2025-07-19 01:33:07] INFO train_model: Exiting audit_data_quality
[2025-07-19 01:33:12] INFO train_model: Model is starting a new training session...
[2025-07-19 01:33:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 01:33:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=123)
[2025-07-19 01:33:12] INFO train_model: Preparing target variable...
[2025-07-19 01:33:12] INFO train_model: Entering prepare_target_variable
[2025-07-19 01:33:12] INFO train_model: Exiting prepare_target_variable
[2025-07-19 01:33:12] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=125)
[2025-07-19 01:33:13] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 01:33:13] INFO train_model: Dropping NaN targets...
[2025-07-19 01:33:13] INFO train_model: Class balance before upsampling: {0: 2414, 1: 2311}
[2025-07-19 01:33:13] INFO train_model: Upsampling successful.
[2025-07-19 01:33:13] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 01:33:13] INFO train_model: Splitting train/test...
[2025-07-19 01:33:13] INFO train_model: Scaling features...
[2025-07-19 01:33:13] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 01:33:13] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 01:33:15] INFO train_model: Model fit complete.
[2025-07-19 01:33:15] INFO train_model: Model Accuracy: 0.8313
[2025-07-19 01:33:15] INFO train_model: 
Classification Report:
[2025-07-19 01:33:15] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.83      0.83       483
           1       0.83      0.83      0.83       483

    accuracy                           0.83       966
   macro avg       0.83      0.83      0.83       966
weighted avg       0.83      0.83      0.83       966

[2025-07-19 01:33:15] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 01:33:15] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "4b5adf75f8cb2c49db2ead2ba5f2fc73" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "4b5adf75f8cb2c49db2ead2ba5f2fc73" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_BTCUSD', 'version': '4b5adf75f8cb2c49db2ead2ba5f2fc73'}}
[2025-07-19 01:33:15] INFO train_model: Feature distributions before training:
[2025-07-19 01:33:15] INFO train_model: atr_14: mean=790.2925, std=316.4131, min=248.5360, max=2432.8175, unique=4725
[2025-07-19 01:33:15] INFO train_model: volatility_20: mean=826.8249, std=533.2637, min=141.7903, max=3956.2747, unique=4725
[2025-07-19 01:33:15] INFO train_model: sma_20: mean=94356.7082, std=12268.7071, min=62628.1240, max=121103.9988, unique=4725
[2025-07-19 01:33:15] INFO train_model: sma_50: mean=94197.6233, std=12256.8055, min=62799.2954, max=119557.6389, unique=4725
[2025-07-19 01:33:15] INFO train_model: sma_200: mean=93600.1157, std=12291.7664, min=62183.0844, max=118218.3794, unique=4724
[2025-07-19 01:33:15] INFO train_model: ema_12: mean=94411.1552, std=12263.4838, min=62644.2626, max=121438.5343, unique=4725
[2025-07-19 01:33:15] INFO train_model: ema_26: mean=94330.8663, std=12247.0436, min=62673.5403, max=120532.2026, unique=4725
[2025-07-19 01:33:15] INFO train_model: rsi_14: mean=52.2288, std=12.4379, min=12.9206, max=90.2253, unique=4725
[2025-07-19 01:33:15] INFO train_model: macd: mean=80.2889, std=560.5874, min=-1881.4601, max=2409.3781, unique=4725
[2025-07-19 01:33:15] INFO train_model: macd_signal: mean=76.0059, std=522.8613, min=-1668.9823, max=2004.6298, unique=4725
[2025-07-19 01:33:15] INFO train_model: bb_high: mean=95968.4866, std=12347.6445, min=63008.0505, max=123631.2152, unique=4725
[2025-07-19 01:33:15] INFO train_model: bb_low: mean=92744.9299, std=12277.5908, min=61485.6176, max=119063.2808, unique=4725
[2025-07-19 01:33:15] INFO train_model: stoch_k: mean=53.8668, std=27.2018, min=0.0000, max=100.0000, unique=4708
[2025-07-19 01:33:15] INFO train_model: stoch_d: mean=53.9087, std=24.5302, min=4.8709, max=97.8432, unique=4725
[2025-07-19 01:33:15] INFO train_model: fib_0: mean=96011.1458, std=12315.0639, min=63086.8359, max=123077.6328, unique=1209
[2025-07-19 01:33:15] INFO train_model: dist_to_fib_0: mean=-1525.7156, std=1389.9513, min=-10522.6016, max=0.0000, unique=4700
[2025-07-19 01:33:15] INFO train_model: fib_236: mean=95207.3054, std=12281.0821, min=62841.1609, max=122164.0787, unique=2197
[2025-07-19 01:33:15] INFO train_model: dist_to_fib_236: mean=-721.8751, std=1190.5630, min=-7889.1863, max=2479.4287, unique=4725
[2025-07-19 01:33:15] INFO train_model: fib_382: mean=94710.0142, std=12267.2667, min=62689.1754, max=121598.9138, unique=2197
[2025-07-19 01:33:15] INFO train_model: dist_to_fib_382: mean=-224.5840, std=1130.0725, min=-6260.0396, max=4013.8442, unique=4724
[2025-07-19 01:33:15] INFO train_model: fib_500: mean=94308.0940, std=12260.1433, min=62566.3379, max=121142.1367, unique=2197
[2025-07-19 01:33:15] INFO train_model: dist_to_fib_500: mean=177.3363, std=1123.8300, min=-4943.3320, max=5253.9883, unique=4708
[2025-07-19 01:33:15] INFO train_model: fib_618: mean=93906.1737, std=12256.6406, min=62443.5004, max=120685.3596, unique=2197
[2025-07-19 01:33:15] INFO train_model: dist_to_fib_618: mean=579.2565, std=1156.6193, min=-3626.6244, max=6494.1323, unique=4725
[2025-07-19 01:33:15] INFO train_model: fib_786: mean=93333.9483, std=12257.9063, min=62268.6130, max=120035.0330, unique=2197
[2025-07-19 01:33:15] INFO train_model: dist_to_fib_786: mean=1151.4819, std=1263.9286, min=-1751.9899, max=8259.7611, unique=4725
[2025-07-19 01:33:15] INFO train_model: fib_100: mean=92605.0421, std=12270.1504, min=62045.8398, max=119206.6406, unique=1276
[2025-07-19 01:33:15] INFO train_model: dist_to_fib_100: mean=1880.3881, std=1479.5901, min=0.0000, max=10508.8359, unique=4692
[2025-07-19 01:33:15] INFO train_model: trendline_slope_high: mean=12.6293, std=110.5220, min=-488.7707, max=418.4305, unique=4710
[2025-07-19 01:33:15] INFO train_model: trendline_slope_low: mean=11.3012, std=113.7325, min=-487.6711, max=479.1137, unique=4719
[2025-07-19 01:33:15] INFO train_model: trendline_up: mean=0.5517, std=0.4974, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: trendline_down: mean=0.4415, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: breakout_high: mean=0.0129, std=0.1129, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: breakout_low: mean=0.0131, std=0.1138, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: dist_to_high: mean=-1509.4770, std=1448.7133, min=-10522.6016, max=359.2578, unique=4702
[2025-07-19 01:33:15] INFO train_model: dist_to_low: mean=1889.9598, std=1544.1018, min=-408.2344, max=10508.8359, unique=4706
[2025-07-19 01:33:15] INFO train_model: vol_spike_atr: mean=0.0372, std=0.1894, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: vol_spike_std: mean=0.1793, std=0.3836, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: is_trending: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: supply_zone: mean=0.2180, std=0.4129, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: demand_zone: mean=0.1583, std=0.3651, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:15] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:15] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:15] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: bos: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: choch: mean=0.1547, std=0.3617, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: vol_cluster_std: mean=0.0052, std=0.0026, min=0.0011, max=0.0169, unique=4725
[2025-07-19 01:33:15] INFO train_model: vol_cluster_high: mean=0.1850, std=0.3883, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: regime_zscore: mean=0.0070, std=1.1316, min=-5.7567, max=6.9376, unique=4725
[2025-07-19 01:33:15] INFO train_model: doji: mean=0.0804, std=0.2720, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: hammer: mean=0.0241, std=0.1535, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bullish_engulfing: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bearish_engulfing: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: pin_bar: mean=0.2360, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bullish_engulfing_bar: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bearish_engulfing_bar: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: inside_bar: mean=0.1407, std=0.3478, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: rising_wedge: mean=0.2506, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: falling_wedge: mean=0.2595, std=0.4384, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: fakeout_up: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: fakeout_down: mean=0.0083, std=0.0905, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bullish_flag: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bearish_flag: mean=0.0267, std=0.1611, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bullish_pennant: mean=0.1308, std=0.3372, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bearish_pennant: mean=0.1255, std=0.3313, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: morning_star: mean=0.0394, std=0.1945, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: evening_star: mean=0.0383, std=0.1920, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: bullish_harami: mean=0.0603, std=0.2381, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: bearish_harami: mean=0.0590, std=0.2357, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: dark_cloud_cover: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:33:15] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4671
[2025-07-19 01:33:15] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4647
[2025-07-19 01:33:15] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4725
[2025-07-19 01:33:15] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4725
[2025-07-19 01:33:15] INFO train_model: rsi_14_4h: mean=51.1047, std=32.5781, min=0.0000, max=100.0000, unique=1783
[2025-07-19 01:33:15] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4725
[2025-07-19 01:33:15] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4725
[2025-07-19 01:33:15] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4673
[2025-07-19 01:33:15] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4673
[2025-07-19 01:33:15] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4710
[2025-07-19 01:33:15] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4663
[2025-07-19 01:33:15] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:15] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:15] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 01:33:15] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:33:15] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 01:33:15] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4655
[2025-07-19 01:33:15] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4725
[2025-07-19 01:33:15] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4725
[2025-07-19 01:33:15] INFO train_model: rsi_14_1d: mean=47.2804, std=49.9313, min=0.0000, max=100.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4725
[2025-07-19 01:33:15] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4725
[2025-07-19 01:33:15] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 01:33:15] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 01:33:15] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 01:33:15] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 01:33:15] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 01:33:15] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4655
[2025-07-19 01:33:15] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4655
[2025-07-19 01:33:15] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 01:33:15] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: regime_label_bear: mean=0.3926, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: regime_label_bull: mean=0.6074, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: market_regime_choppy: mean=0.2125, std=0.4091, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: market_regime_downtrend: mean=0.2582, std=0.4377, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: market_regime_range: mean=0.2195, std=0.4139, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: market_regime_uptrend: mean=0.3098, std=0.4625, min=0.0000, max=1.0000, unique=2
[2025-07-19 01:33:15] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 01:33:15] INFO train_model: Auditing data quality before training...
[2025-07-19 01:33:15] INFO train_model: Entering audit_data_quality
[2025-07-19 01:33:20] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:30:18] INFO train_model: Model is starting a new training session...
[2025-07-19 08:30:18] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:30:18] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 08:30:18] INFO train_model: Preparing target variable...
[2025-07-19 08:30:18] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:30:18] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:30:18] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 08:30:18] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:30:18] INFO train_model: Dropping NaN targets...
[2025-07-19 08:30:18] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 08:30:18] INFO train_model: Upsampling successful.
[2025-07-19 08:30:18] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 08:30:18] INFO train_model: Splitting train/test...
[2025-07-19 08:30:18] INFO train_model: Scaling features...
[2025-07-19 08:30:18] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:30:18] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:30:20] INFO train_model: Model fit complete.
[2025-07-19 08:30:20] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 08:30:20] INFO train_model: 
Classification Report:
[2025-07-19 08:30:20] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 08:30:21] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 08:30:21] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 08:30:21] INFO train_model: Feature distributions before training:
[2025-07-19 08:30:21] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 08:30:21] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 08:30:21] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 08:30:21] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 08:30:21] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 08:30:21] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 08:30:21] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 08:30:21] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 08:30:21] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 08:30:21] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 08:30:21] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 08:30:21] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 08:30:21] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 08:30:21] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 08:30:21] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 08:30:21] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 08:30:21] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 08:30:21] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 08:30:21] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 08:30:21] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 08:30:21] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 08:30:21] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 08:30:21] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 08:30:21] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 08:30:21] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 08:30:21] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 08:30:21] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 08:30:21] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 08:30:21] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 08:30:21] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 08:30:21] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 08:30:21] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 08:30:21] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:21] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:21] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:21] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 08:30:21] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 08:30:21] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:30:21] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 08:30:21] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 08:30:21] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 08:30:21] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 08:30:21] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 08:30:21] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 08:30:21] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 08:30:21] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 08:30:21] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 08:30:21] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 08:30:21] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 08:30:21] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:21] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:21] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:21] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:30:21] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 08:30:21] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 08:30:21] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 08:30:21] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 08:30:21] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 08:30:21] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 08:30:21] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 08:30:21] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 08:30:21] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 08:30:21] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 08:30:21] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 08:30:21] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 08:30:21] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 08:30:21] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:30:21] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:21] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:21] INFO train_model: Auditing data quality before training...
[2025-07-19 08:30:21] INFO train_model: Entering audit_data_quality
[2025-07-19 08:30:26] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:30:29] INFO train_model: Model is starting a new training session...
[2025-07-19 08:30:29] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:30:29] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 08:30:29] INFO train_model: Preparing target variable...
[2025-07-19 08:30:29] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:30:29] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:30:29] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 08:30:29] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:30:29] INFO train_model: Dropping NaN targets...
[2025-07-19 08:30:29] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 08:30:29] INFO train_model: Upsampling successful.
[2025-07-19 08:30:29] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 08:30:29] INFO train_model: Splitting train/test...
[2025-07-19 08:30:29] INFO train_model: Scaling features...
[2025-07-19 08:30:29] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:30:29] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:30:32] INFO train_model: Model fit complete.
[2025-07-19 08:30:32] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 08:30:32] INFO train_model: 
Classification Report:
[2025-07-19 08:30:32] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 08:30:32] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 08:30:32] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 08:30:32] INFO train_model: Feature distributions before training:
[2025-07-19 08:30:32] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 08:30:32] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 08:30:32] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 08:30:32] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 08:30:32] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 08:30:32] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 08:30:32] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 08:30:32] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 08:30:32] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 08:30:32] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 08:30:32] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 08:30:32] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 08:30:32] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 08:30:32] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 08:30:32] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 08:30:32] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 08:30:32] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 08:30:32] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 08:30:32] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 08:30:32] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 08:30:32] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 08:30:32] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 08:30:32] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 08:30:32] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 08:30:32] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 08:30:32] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 08:30:32] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 08:30:32] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 08:30:32] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 08:30:32] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 08:30:32] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 08:30:32] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 08:30:32] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:32] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:32] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:32] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 08:30:32] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 08:30:32] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:30:32] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 08:30:32] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 08:30:32] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 08:30:32] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 08:30:32] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 08:30:32] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 08:30:32] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 08:30:32] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 08:30:32] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 08:30:32] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 08:30:32] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 08:30:32] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:32] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:32] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:30:32] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:30:32] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 08:30:32] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 08:30:32] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 08:30:32] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 08:30:32] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 08:30:32] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 08:30:32] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 08:30:32] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 08:30:32] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 08:30:32] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 08:30:32] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 08:30:32] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 08:30:32] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 08:30:32] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:30:32] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:32] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:32] INFO train_model: Auditing data quality before training...
[2025-07-19 08:30:32] INFO train_model: Entering audit_data_quality
[2025-07-19 08:30:37] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:30:53] INFO train_model: Model is starting a new training session...
[2025-07-19 08:30:53] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:30:53] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 08:30:53] INFO train_model: Preparing target variable...
[2025-07-19 08:30:53] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:30:53] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:30:53] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 08:30:53] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:30:53] INFO train_model: Dropping NaN targets...
[2025-07-19 08:30:54] INFO train_model: Class balance before upsampling: {0: 3110, 1: 1592}
[2025-07-19 08:30:54] INFO train_model: Upsampling successful.
[2025-07-19 08:30:54] INFO train_model: Splitting train/test...
[2025-07-19 08:30:54] INFO train_model: Scaling features...
[2025-07-19 08:30:54] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:30:54] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:30:55] INFO train_model: Model fit complete.
[2025-07-19 08:30:55] INFO train_model: Model Accuracy: 0.8207
[2025-07-19 08:30:55] INFO train_model: 
Classification Report:
[2025-07-19 08:30:55] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.81      0.82       622
           1       0.81      0.83      0.82       622

    accuracy                           0.82      1244
   macro avg       0.82      0.82      0.82      1244
weighted avg       0.82      0.82      0.82      1244

[2025-07-19 08:30:55] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 08:30:55] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "b1091431cfcc446e2d165f9167d0771d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "b1091431cfcc446e2d165f9167d0771d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'b1091431cfcc446e2d165f9167d0771d'}}
[2025-07-19 08:30:55] INFO train_model: Feature distributions before training:
[2025-07-19 08:30:55] INFO train_model: atr_14: mean=0.3416, std=0.1040, min=0.0000, max=0.9927, unique=4690
[2025-07-19 08:30:55] INFO train_model: volatility_20: mean=0.3279, std=0.1837, min=0.0344, max=1.3004, unique=4683
[2025-07-19 08:30:55] INFO train_model: sma_20: mean=149.6241, std=4.6995, min=140.5323, max=158.2940, unique=4678
[2025-07-19 08:30:55] INFO train_model: sma_50: mean=149.6263, std=4.6784, min=140.8684, max=158.1650, unique=4652
[2025-07-19 08:30:55] INFO train_model: sma_200: mean=149.6799, std=4.5836, min=142.1838, max=157.7724, unique=4500
[2025-07-19 08:30:55] INFO train_model: ema_12: mean=149.6229, std=4.7011, min=140.4143, max=158.3392, unique=4702
[2025-07-19 08:30:55] INFO train_model: ema_26: mean=149.6240, std=4.6866, min=140.6181, max=158.2242, unique=4702
[2025-07-19 08:30:55] INFO train_model: rsi_14: mean=50.5788, std=12.9257, min=8.6902, max=92.4381, unique=4676
[2025-07-19 08:30:55] INFO train_model: macd: mean=-0.0008, std=0.2229, min=-0.9230, max=0.8730, unique=4677
[2025-07-19 08:30:55] INFO train_model: macd_signal: mean=-0.0012, std=0.2088, min=-0.8065, max=0.7956, unique=4669
[2025-07-19 08:30:55] INFO train_model: bb_high: mean=150.2633, std=4.6767, min=140.9707, max=158.5972, unique=4683
[2025-07-19 08:30:55] INFO train_model: bb_low: mean=148.9849, std=4.7491, min=139.2981, max=158.0618, unique=4683
[2025-07-19 08:30:55] INFO train_model: stoch_k: mean=52.3511, std=27.0512, min=0.0000, max=99.6649, unique=4670
[2025-07-19 08:30:55] INFO train_model: stoch_d: mean=52.3592, std=25.0024, min=3.8543, max=96.6848, unique=4685
[2025-07-19 08:30:55] INFO train_model: fib_0: mean=150.2887, std=4.6576, min=141.0760, max=158.8790, unique=1210
[2025-07-19 08:30:55] INFO train_model: dist_to_fib_0: mean=-0.6650, std=0.5552, min=-5.0610, max=-0.0050, unique=2187
[2025-07-19 08:30:55] INFO train_model: fib_236: mean=149.9633, std=4.6650, min=140.8676, max=158.5797, unique=2255
[2025-07-19 08:30:55] INFO train_model: dist_to_fib_236: mean=-0.3396, std=0.4875, min=-3.8081, max=0.7712, unique=4659
[2025-07-19 08:30:55] INFO train_model: fib_382: mean=149.7620, std=4.6718, min=140.6792, max=158.3946, unique=2255
[2025-07-19 08:30:55] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4631, min=-3.0330, max=1.2871, unique=4659
[2025-07-19 08:30:55] INFO train_model: fib_500: mean=149.5993, std=4.6786, min=140.5270, max=158.2450, unique=2206
[2025-07-19 08:30:55] INFO train_model: dist_to_fib_500: mean=0.0245, std=0.4552, min=-2.4065, max=1.7885, unique=3611
[2025-07-19 08:30:55] INFO train_model: fib_618: mean=149.4365, std=4.6864, min=140.3748, max=158.1640, unique=2255
[2025-07-19 08:30:55] INFO train_model: dist_to_fib_618: mean=0.1872, std=0.4585, min=-1.7800, max=2.2899, unique=4659
[2025-07-19 08:30:55] INFO train_model: fib_786: mean=149.2049, std=4.6994, min=140.1581, max=158.0580, unique=2255
[2025-07-19 08:30:55] INFO train_model: dist_to_fib_786: mean=0.4188, std=0.4819, min=-0.8881, max=3.0037, unique=4659
[2025-07-19 08:30:55] INFO train_model: fib_100: mean=148.9098, std=4.7190, min=139.8820, max=157.9230, unique=1168
[2025-07-19 08:30:55] INFO train_model: dist_to_fib_100: mean=0.7139, std=0.5389, min=0.0000, max=3.9130, unique=2197
[2025-07-19 08:30:55] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=2986
[2025-07-19 08:30:55] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3048
[2025-07-19 08:30:55] INFO train_model: trendline_up: mean=0.5040, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: dist_to_high: mean=-0.6653, std=0.5818, min=-5.0610, max=0.5750, unique=2227
[2025-07-19 08:30:55] INFO train_model: dist_to_low: mean=0.7120, std=0.5649, min=-0.3640, max=3.9130, unique=2274
[2025-07-19 08:30:55] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: supply_zone: mean=0.4370, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: demand_zone: mean=0.3694, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: choch: mean=0.1436, std=0.3507, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4682
[2025-07-19 08:30:55] INFO train_model: vol_cluster_high: mean=0.1014, std=0.3020, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: regime_zscore: mean=-0.0187, std=1.0033, min=-5.8436, max=6.5511, unique=4602
[2025-07-19 08:30:55] INFO train_model: doji: mean=0.1104, std=0.3134, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: hammer: mean=0.0262, std=0.1596, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: pin_bar: mean=0.2890, std=0.4534, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1780, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: rising_wedge: mean=0.2682, std=0.4431, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: falling_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bullish_flag: mean=0.0196, std=0.1385, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bearish_flag: mean=0.0217, std=0.1457, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bullish_pennant: mean=0.1280, std=0.3342, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bearish_pennant: mean=0.1359, std=0.3427, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: morning_star: mean=0.0404, std=0.1969, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: evening_star: mean=0.0362, std=0.1867, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bullish_harami: mean=0.0549, std=0.2278, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: bearish_harami: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: dark_cloud_cover: mean=0.1187, std=0.3234, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: regime_label_bear: mean=0.4828, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: regime_label_bull: mean=0.4747, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: market_regime_choppy: mean=0.2401, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: market_regime_downtrend: mean=0.2886, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: market_regime_range: mean=0.2512, std=0.4337, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: market_regime_uptrend: mean=0.2201, std=0.4144, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:30:55] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:30:55] INFO train_model: Auditing data quality before training...
[2025-07-19 08:30:55] INFO train_model: Entering audit_data_quality
[2025-07-19 08:30:59] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 08:30:59] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 08:30:59] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 08:30:59] INFO train_model: Entering audit_data_quality
[2025-07-19 08:31:02] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:31:02] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:31:02] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:31:02] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-19 08:31:02] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 08:31:03] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 08:31:03] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 08:31:03] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 08:31:06] INFO train_model: Model is starting a new training session...
[2025-07-19 08:31:06] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:31:06] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 08:31:06] INFO train_model: Preparing target variable...
[2025-07-19 08:31:06] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:31:06] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:31:06] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 08:31:06] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:31:06] INFO train_model: Dropping NaN targets...
[2025-07-19 08:31:06] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 08:31:06] INFO train_model: Upsampling successful.
[2025-07-19 08:31:06] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 08:31:06] INFO train_model: Splitting train/test...
[2025-07-19 08:31:06] INFO train_model: Scaling features...
[2025-07-19 08:31:06] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:31:06] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:31:08] INFO train_model: Model fit complete.
[2025-07-19 08:31:08] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 08:31:08] INFO train_model: 
Classification Report:
[2025-07-19 08:31:08] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 08:31:08] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 08:31:08] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd2a3f9696a22ac049479f92536f55c6d'}}
[2025-07-19 08:31:08] INFO train_model: Feature distributions before training:
[2025-07-19 08:31:08] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 08:31:08] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 08:31:08] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 08:31:08] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 08:31:08] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 08:31:08] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 08:31:08] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 08:31:08] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 08:31:08] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 08:31:08] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 08:31:08] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 08:31:08] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 08:31:08] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 08:31:08] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 08:31:08] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 08:31:08] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 08:31:08] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 08:31:08] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 08:31:08] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 08:31:08] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 08:31:08] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 08:31:08] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 08:31:08] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 08:31:08] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 08:31:08] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 08:31:08] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 08:31:08] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 08:31:08] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 08:31:08] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 08:31:08] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 08:31:08] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 08:31:08] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 08:31:08] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 08:31:08] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 08:31:08] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 08:31:08] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 08:31:08] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 08:31:08] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:31:08] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 08:31:08] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 08:31:08] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 08:31:08] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 08:31:08] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 08:31:08] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 08:31:08] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 08:31:08] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 08:31:08] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 08:31:08] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 08:31:08] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 08:31:08] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 08:31:08] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 08:31:08] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 08:31:08] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:31:08] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 08:31:08] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 08:31:08] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 08:31:08] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 08:31:08] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 08:31:08] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 08:31:08] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 08:31:08] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 08:31:08] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 08:31:08] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 08:31:08] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 08:31:08] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 08:31:08] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 08:31:08] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:31:08] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:08] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:08] INFO train_model: Auditing data quality before training...
[2025-07-19 08:31:08] INFO train_model: Entering audit_data_quality
[2025-07-19 08:31:13] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:31:40] INFO train_model: Model is starting a new training session...
[2025-07-19 08:31:40] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:31:40] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-19 08:31:40] INFO train_model: Preparing target variable...
[2025-07-19 08:31:40] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:31:40] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:31:40] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-19 08:31:40] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:31:40] INFO train_model: Dropping NaN targets...
[2025-07-19 08:31:40] INFO train_model: Class balance before upsampling: {0: 3430, 1: 1272}
[2025-07-19 08:31:40] INFO train_model: Upsampling successful.
[2025-07-19 08:31:40] INFO train_model: Splitting train/test...
[2025-07-19 08:31:40] INFO train_model: Scaling features...
[2025-07-19 08:31:40] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:31:40] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:31:42] INFO train_model: Model fit complete.
[2025-07-19 08:31:42] INFO train_model: Model Accuracy: 0.8754
[2025-07-19 08:31:42] INFO train_model: 
Classification Report:
[2025-07-19 08:31:42] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.87      0.87       686
           1       0.87      0.88      0.88       686

    accuracy                           0.88      1372
   macro avg       0.88      0.88      0.88      1372
weighted avg       0.88      0.88      0.88      1372

[2025-07-19 08:31:42] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 08:31:42] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "1c32864d0edae82c3b1b65620192ce7b" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "1c32864d0edae82c3b1b65620192ce7b" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': '1c32864d0edae82c3b1b65620192ce7b'}}
[2025-07-19 08:31:42] INFO train_model: Feature distributions before training:
[2025-07-19 08:31:42] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4690
[2025-07-19 08:31:42] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4678
[2025-07-19 08:31:42] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4654
[2025-07-19 08:31:42] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4641
[2025-07-19 08:31:42] INFO train_model: sma_200: mean=0.8643, std=0.0363, min=0.7943, max=0.9132, unique=4497
[2025-07-19 08:31:42] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4702
[2025-07-19 08:31:42] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4702
[2025-07-19 08:31:42] INFO train_model: rsi_14: mean=49.8641, std=12.3936, min=7.7095, max=97.7161, unique=4663
[2025-07-19 08:31:42] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4677
[2025-07-19 08:31:42] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4669
[2025-07-19 08:31:42] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4678
[2025-07-19 08:31:42] INFO train_model: bb_low: mean=0.8601, std=0.0381, min=0.7878, max=0.9160, unique=4678
[2025-07-19 08:31:42] INFO train_model: stoch_k: mean=51.0515, std=26.3623, min=0.6580, max=98.9585, unique=4614
[2025-07-19 08:31:42] INFO train_model: stoch_d: mean=51.0710, std=24.0553, min=3.0053, max=95.8670, unique=4678
[2025-07-19 08:31:42] INFO train_model: fib_0: mean=0.8662, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 08:31:42] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=1419
[2025-07-19 08:31:42] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 08:31:42] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4613
[2025-07-19 08:31:42] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 08:31:42] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4613
[2025-07-19 08:31:42] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2007
[2025-07-19 08:31:42] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=2761
[2025-07-19 08:31:42] INFO train_model: fib_618: mean=0.8622, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 08:31:42] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4613
[2025-07-19 08:31:42] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 08:31:42] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4613
[2025-07-19 08:31:42] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 08:31:42] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=1367
[2025-07-19 08:31:42] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=2056
[2025-07-19 08:31:42] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=2075
[2025-07-19 08:31:42] INFO train_model: trendline_up: mean=0.5004, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=1453
[2025-07-19 08:31:42] INFO train_model: dist_to_low: mean=0.0031, std=0.0027, min=-0.0015, max=0.0207, unique=1403
[2025-07-19 08:31:42] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: vol_spike_std: mean=0.1559, std=0.3628, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: supply_zone: mean=0.5019, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: demand_zone: mean=0.4862, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: choch: mean=0.1623, std=0.3687, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4681
[2025-07-19 08:31:42] INFO train_model: vol_cluster_high: mean=0.1061, std=0.3080, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: regime_zscore: mean=-0.0095, std=1.0048, min=-5.9027, max=7.4977, unique=4602
[2025-07-19 08:31:42] INFO train_model: doji: mean=0.1236, std=0.3291, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bullish_engulfing: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bearish_engulfing: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: pin_bar: mean=0.3120, std=0.4634, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bullish_engulfing_bar: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bearish_engulfing_bar: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: inside_bar: mean=0.1427, std=0.3498, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: inv_head_shoulders: mean=0.0313, std=0.1740, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: rising_wedge: mean=0.2250, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: falling_wedge: mean=0.2318, std=0.4220, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: bullish_flag: mean=0.0247, std=0.1551, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bearish_flag: mean=0.0289, std=0.1676, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bullish_pennant: mean=0.1338, std=0.3404, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bearish_pennant: mean=0.1433, std=0.3505, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: morning_star: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: evening_star: mean=0.0402, std=0.1964, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bullish_harami: mean=0.0574, std=0.2327, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: bearish_harami: mean=0.0444, std=0.2061, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: dark_cloud_cover: mean=0.1114, std=0.3147, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: regime_label_bear: mean=0.4866, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: regime_label_bull: mean=0.4709, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1646, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: market_regime_consolidation: mean=0.0542, std=0.2265, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: market_regime_downtrend: mean=0.2254, std=0.4179, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: market_regime_range: mean=0.5270, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: market_regime_uptrend: mean=0.1655, std=0.3716, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:42] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:42] INFO train_model: Auditing data quality before training...
[2025-07-19 08:31:42] INFO train_model: Entering audit_data_quality
[2025-07-19 08:31:46] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 08:31:46] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 08:31:46] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 08:31:46] INFO train_model: Entering audit_data_quality
[2025-07-19 08:31:49] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:31:49] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:31:49] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:31:49] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDCHF_features.json
[2025-07-19 08:31:49] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 08:31:49] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 08:31:49] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 08:31:49] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 08:31:52] INFO train_model: Model is starting a new training session...
[2025-07-19 08:31:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:31:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 08:31:52] INFO train_model: Preparing target variable...
[2025-07-19 08:31:52] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:31:52] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:31:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 08:31:52] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:31:52] INFO train_model: Dropping NaN targets...
[2025-07-19 08:31:52] INFO train_model: Class balance before upsampling: {0: 3426, 1: 1272}
[2025-07-19 08:31:52] INFO train_model: Upsampling successful.
[2025-07-19 08:31:52] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 08:31:52] INFO train_model: Splitting train/test...
[2025-07-19 08:31:52] INFO train_model: Scaling features...
[2025-07-19 08:31:52] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:31:52] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:31:55] INFO train_model: Model fit complete.
[2025-07-19 08:31:55] INFO train_model: Model Accuracy: 0.9059
[2025-07-19 08:31:55] INFO train_model: 
Classification Report:
[2025-07-19 08:31:55] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.90      0.91       686
           1       0.90      0.91      0.91       685

    accuracy                           0.91      1371
   macro avg       0.91      0.91      0.91      1371
weighted avg       0.91      0.91      0.91      1371

[2025-07-19 08:31:55] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 08:31:55] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': 'a36a889b62f1371c96a2129e8900e40e'}}
[2025-07-19 08:31:55] INFO train_model: Feature distributions before training:
[2025-07-19 08:31:55] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4686
[2025-07-19 08:31:55] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4674
[2025-07-19 08:31:55] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4672
[2025-07-19 08:31:55] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4646
[2025-07-19 08:31:55] INFO train_model: sma_200: mean=0.8642, std=0.0363, min=0.7943, max=0.9132, unique=4495
[2025-07-19 08:31:55] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4698
[2025-07-19 08:31:55] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4698
[2025-07-19 08:31:55] INFO train_model: rsi_14: mean=49.8631, std=12.3988, min=7.7095, max=97.7161, unique=4664
[2025-07-19 08:31:55] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4673
[2025-07-19 08:31:55] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4665
[2025-07-19 08:31:55] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4677
[2025-07-19 08:31:55] INFO train_model: bb_low: mean=0.8600, std=0.0381, min=0.7878, max=0.9160, unique=4677
[2025-07-19 08:31:55] INFO train_model: stoch_k: mean=51.0566, std=26.3720, min=0.6580, max=98.9585, unique=4646
[2025-07-19 08:31:55] INFO train_model: stoch_d: mean=51.0798, std=24.0633, min=3.0053, max=95.8670, unique=4679
[2025-07-19 08:31:55] INFO train_model: fib_0: mean=0.8661, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 08:31:55] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=2430
[2025-07-19 08:31:55] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 08:31:55] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4619
[2025-07-19 08:31:55] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 08:31:55] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4619
[2025-07-19 08:31:55] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2040
[2025-07-19 08:31:55] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=4125
[2025-07-19 08:31:55] INFO train_model: fib_618: mean=0.8621, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 08:31:55] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4619
[2025-07-19 08:31:55] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 08:31:55] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4619
[2025-07-19 08:31:55] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 08:31:55] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=2380
[2025-07-19 08:31:55] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=3110
[2025-07-19 08:31:55] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=3122
[2025-07-19 08:31:55] INFO train_model: trendline_up: mean=0.5009, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=2487
[2025-07-19 08:31:55] INFO train_model: dist_to_low: mean=0.0032, std=0.0027, min=-0.0015, max=0.0207, unique=2431
[2025-07-19 08:31:55] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: vol_spike_std: mean=0.1560, std=0.3629, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: supply_zone: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: demand_zone: mean=0.4857, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 08:31:55] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 08:31:55] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 08:31:55] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: choch: mean=0.1620, std=0.3685, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4677
[2025-07-19 08:31:55] INFO train_model: vol_cluster_high: mean=0.1062, std=0.3081, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: regime_zscore: mean=-0.0097, std=1.0052, min=-5.9027, max=7.4977, unique=4598
[2025-07-19 08:31:55] INFO train_model: doji: mean=0.1237, std=0.3292, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bullish_engulfing: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bearish_engulfing: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: pin_bar: mean=0.3125, std=0.4636, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bullish_engulfing_bar: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bearish_engulfing_bar: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: inside_bar: mean=0.1428, std=0.3499, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: head_shoulders: mean=0.0343, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: rising_wedge: mean=0.2252, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: falling_wedge: mean=0.2320, std=0.4222, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: bullish_flag: mean=0.0245, std=0.1545, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bearish_flag: mean=0.0289, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bullish_pennant: mean=0.1337, std=0.3403, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bearish_pennant: mean=0.1433, std=0.3504, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: morning_star: mean=0.0370, std=0.1889, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: evening_star: mean=0.0402, std=0.1965, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bullish_harami: mean=0.0575, std=0.2328, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: bearish_harami: mean=0.0445, std=0.2062, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8249, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:31:55] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4645
[2025-07-19 08:31:55] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4620
[2025-07-19 08:31:55] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4698
[2025-07-19 08:31:55] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4698
[2025-07-19 08:31:55] INFO train_model: rsi_14_4h: mean=51.1069, std=32.6123, min=0.0000, max=100.0000, unique=1782
[2025-07-19 08:31:55] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4698
[2025-07-19 08:31:55] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4698
[2025-07-19 08:31:55] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4647
[2025-07-19 08:31:55] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4647
[2025-07-19 08:31:55] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4683
[2025-07-19 08:31:55] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4637
[2025-07-19 08:31:55] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 08:31:55] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 08:31:55] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 08:31:55] INFO train_model: structure_trend_4h: mean=0.8169, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:31:55] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 08:31:55] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4628
[2025-07-19 08:31:55] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4698
[2025-07-19 08:31:55] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4698
[2025-07-19 08:31:55] INFO train_model: rsi_14_1d: mean=47.2116, std=49.9275, min=0.0000, max=100.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4698
[2025-07-19 08:31:55] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4698
[2025-07-19 08:31:55] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 08:31:55] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 08:31:55] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 08:31:55] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 08:31:55] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 08:31:55] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4628
[2025-07-19 08:31:55] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4628
[2025-07-19 08:31:55] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2842, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:31:55] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: regime_label_bear: mean=0.4870, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: regime_label_bull: mean=0.4704, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2019, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: market_regime_consolidation: mean=0.0534, std=0.2249, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: market_regime_downtrend: mean=0.2256, std=0.4180, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: market_regime_range: mean=0.5285, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: market_regime_uptrend: mean=0.1645, std=0.3708, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:31:55] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:31:55] INFO train_model: Auditing data quality before training...
[2025-07-19 08:31:55] INFO train_model: Entering audit_data_quality
[2025-07-19 08:32:00] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:32:24] INFO train_model: Model is starting a new training session...
[2025-07-19 08:32:24] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:32:24] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-19 08:32:24] INFO train_model: Preparing target variable...
[2025-07-19 08:32:24] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:32:24] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:32:24] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-19 08:32:24] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:32:24] INFO train_model: Dropping NaN targets...
[2025-07-19 08:32:24] INFO train_model: Class balance before upsampling: {0: 3122, 1: 1638}
[2025-07-19 08:32:24] INFO train_model: Upsampling successful.
[2025-07-19 08:32:24] INFO train_model: Splitting train/test...
[2025-07-19 08:32:24] INFO train_model: Scaling features...
[2025-07-19 08:32:24] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:32:24] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:32:25] INFO train_model: Model fit complete.
[2025-07-19 08:32:25] INFO train_model: Model Accuracy: 0.8447
[2025-07-19 08:32:25] INFO train_model: 
Classification Report:
[2025-07-19 08:32:25] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.87      0.85       625
           1       0.86      0.82      0.84       624

    accuracy                           0.84      1249
   macro avg       0.85      0.84      0.84      1249
weighted avg       0.85      0.84      0.84      1249

[2025-07-19 08:32:25] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 08:32:25] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "2bfa20aa78505eabdaf0592f69c66f1d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "2bfa20aa78505eabdaf0592f69c66f1d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '2bfa20aa78505eabdaf0592f69c66f1d'}}
[2025-07-19 08:32:25] INFO train_model: Feature distributions before training:
[2025-07-19 08:32:25] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4748
[2025-07-19 08:32:25] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4721
[2025-07-19 08:32:25] INFO train_model: sma_20: mean=0.5842, std=0.0158, min=0.5544, max=0.6102, unique=4719
[2025-07-19 08:32:25] INFO train_model: sma_50: mean=0.5842, std=0.0157, min=0.5560, max=0.6092, unique=4691
[2025-07-19 08:32:25] INFO train_model: sma_200: mean=0.5843, std=0.0154, min=0.5597, max=0.6067, unique=4555
[2025-07-19 08:32:25] INFO train_model: ema_12: mean=0.5842, std=0.0158, min=0.5541, max=0.6105, unique=4760
[2025-07-19 08:32:25] INFO train_model: ema_26: mean=0.5842, std=0.0157, min=0.5554, max=0.6098, unique=4760
[2025-07-19 08:32:25] INFO train_model: rsi_14: mean=49.3336, std=12.4278, min=11.3290, max=91.7839, unique=4589
[2025-07-19 08:32:25] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4735
[2025-07-19 08:32:25] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4727
[2025-07-19 08:32:25] INFO train_model: bb_high: mean=0.5866, std=0.0157, min=0.5570, max=0.6121, unique=4721
[2025-07-19 08:32:25] INFO train_model: bb_low: mean=0.5817, std=0.0160, min=0.5486, max=0.6084, unique=4721
[2025-07-19 08:32:25] INFO train_model: stoch_k: mean=49.3172, std=28.9279, min=0.0000, max=100.0000, unique=4564
[2025-07-19 08:32:25] INFO train_model: stoch_d: mean=49.3608, std=26.4954, min=2.3676, max=100.0000, unique=4718
[2025-07-19 08:32:25] INFO train_model: fib_0: mean=0.5867, std=0.0157, min=0.5573, max=0.6122, unique=811
[2025-07-19 08:32:25] INFO train_model: dist_to_fib_0: mean=-0.0025, std=0.0022, min=-0.0229, max=0.0000, unique=4285
[2025-07-19 08:32:25] INFO train_model: fib_236: mean=0.5855, std=0.0157, min=0.5560, max=0.6113, unique=2149
[2025-07-19 08:32:25] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4578
[2025-07-19 08:32:25] INFO train_model: fib_382: mean=0.5848, std=0.0157, min=0.5547, max=0.6107, unique=2149
[2025-07-19 08:32:25] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4578
[2025-07-19 08:32:25] INFO train_model: fib_500: mean=0.5842, std=0.0157, min=0.5537, max=0.6103, unique=2149
[2025-07-19 08:32:25] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4534
[2025-07-19 08:32:25] INFO train_model: fib_618: mean=0.5836, std=0.0158, min=0.5526, max=0.6098, unique=2149
[2025-07-19 08:32:25] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4578
[2025-07-19 08:32:25] INFO train_model: fib_786: mean=0.5827, std=0.0158, min=0.5511, max=0.6092, unique=2149
[2025-07-19 08:32:25] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4578
[2025-07-19 08:32:25] INFO train_model: fib_100: mean=0.5816, std=0.0159, min=0.5492, max=0.6083, unique=817
[2025-07-19 08:32:25] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4255
[2025-07-19 08:32:25] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4611
[2025-07-19 08:32:25] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4611
[2025-07-19 08:32:25] INFO train_model: trendline_up: mean=0.4624, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: trendline_down: mean=0.5235, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: breakout_high: mean=0.0137, std=0.1161, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: breakout_low: mean=0.0174, std=0.1309, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4275
[2025-07-19 08:32:25] INFO train_model: dist_to_low: mean=0.0025, std=0.0023, min=-0.0067, max=0.0157, unique=4250
[2025-07-19 08:32:25] INFO train_model: vol_spike_atr: mean=0.0153, std=0.1229, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: vol_spike_std: mean=0.1334, std=0.3400, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: is_trending: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: supply_zone: mean=0.4107, std=0.4920, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: demand_zone: mean=0.4258, std=0.4945, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: bos: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: choch: mean=0.1508, std=0.3579, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4733
[2025-07-19 08:32:25] INFO train_model: vol_cluster_high: mean=0.0746, std=0.2627, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: regime_zscore: mean=0.0097, std=1.0032, min=-7.1754, max=7.0756, unique=4657
[2025-07-19 08:32:25] INFO train_model: doji: mean=0.1025, std=0.3034, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: hammer: mean=0.0166, std=0.1278, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bullish_engulfing: mean=0.0351, std=0.1840, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bearish_engulfing: mean=0.0353, std=0.1845, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: pin_bar: mean=0.2342, std=0.4236, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bullish_engulfing_bar: mean=0.0351, std=0.1840, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bearish_engulfing_bar: mean=0.0353, std=0.1845, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: inside_bar: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: double_top: mean=0.0109, std=0.1040, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: double_bottom: mean=0.0227, std=0.1489, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: rising_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: falling_wedge: mean=0.2464, std=0.4310, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: fakeout_up: mean=0.0065, std=0.0804, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: fakeout_down: mean=0.0076, std=0.0866, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bullish_flag: mean=0.0250, std=0.1561, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bearish_flag: mean=0.0223, std=0.1476, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bullish_pennant: mean=0.1317, std=0.3382, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bearish_pennant: mean=0.1237, std=0.3293, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: morning_star: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: evening_star: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0251, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: three_black_crows: mean=0.0004, std=0.0205, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bullish_harami: mean=0.0403, std=0.1968, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: bearish_harami: mean=0.0366, std=0.1877, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: dark_cloud_cover: mean=0.0769, std=0.2664, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: regime_label_bear: mean=0.5128, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: regime_label_bull: mean=0.4452, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: regime_label_neutral: mean=0.0420, std=0.2006, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0410, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: market_regime_consolidation: mean=0.2134, std=0.4098, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: market_regime_downtrend: mean=0.1910, std=0.3931, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: market_regime_range: mean=0.4048, std=0.4909, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: market_regime_uptrend: mean=0.1891, std=0.3916, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:25] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:25] INFO train_model: Auditing data quality before training...
[2025-07-19 08:32:25] INFO train_model: Entering audit_data_quality
[2025-07-19 08:32:29] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 08:32:29] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 08:32:29] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 08:32:29] INFO train_model: Entering audit_data_quality
[2025-07-19 08:32:32] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:32:32] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:32:32] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:32:32] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDUSD_features.json
[2025-07-19 08:32:32] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 08:32:32] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 08:32:32] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 08:32:32] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 08:32:35] INFO train_model: Model is starting a new training session...
[2025-07-19 08:32:35] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:32:35] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 08:32:35] INFO train_model: Preparing target variable...
[2025-07-19 08:32:35] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:32:35] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:32:35] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 08:32:35] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:32:35] INFO train_model: Dropping NaN targets...
[2025-07-19 08:32:35] INFO train_model: Class balance before upsampling: {0: 3092, 1: 1634}
[2025-07-19 08:32:35] INFO train_model: Upsampling successful.
[2025-07-19 08:32:36] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 08:32:36] INFO train_model: Splitting train/test...
[2025-07-19 08:32:36] INFO train_model: Scaling features...
[2025-07-19 08:32:36] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:32:36] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:32:38] INFO train_model: Model fit complete.
[2025-07-19 08:32:38] INFO train_model: Model Accuracy: 0.8828
[2025-07-19 08:32:38] INFO train_model: 
Classification Report:
[2025-07-19 08:32:38] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       619
           1       0.88      0.88      0.88       618

    accuracy                           0.88      1237
   macro avg       0.88      0.88      0.88      1237
weighted avg       0.88      0.88      0.88      1237

[2025-07-19 08:32:38] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 08:32:38] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '46975954b9064b2dac5cdbcbe3844bca'}}
[2025-07-19 08:32:38] INFO train_model: Feature distributions before training:
[2025-07-19 08:32:38] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4714
[2025-07-19 08:32:38] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4687
[2025-07-19 08:32:38] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4691
[2025-07-19 08:32:38] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4662
[2025-07-19 08:32:38] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4524
[2025-07-19 08:32:38] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4726
[2025-07-19 08:32:38] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4726
[2025-07-19 08:32:38] INFO train_model: rsi_14: mean=49.3849, std=12.3827, min=11.3290, max=91.7839, unique=4589
[2025-07-19 08:32:38] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4701
[2025-07-19 08:32:38] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4693
[2025-07-19 08:32:38] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4693
[2025-07-19 08:32:38] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4693
[2025-07-19 08:32:38] INFO train_model: stoch_k: mean=49.1792, std=28.8128, min=0.0000, max=100.0000, unique=4552
[2025-07-19 08:32:38] INFO train_model: stoch_d: mean=49.2137, std=26.3670, min=2.3676, max=99.2269, unique=4697
[2025-07-19 08:32:38] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-19 08:32:38] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4327
[2025-07-19 08:32:38] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2134
[2025-07-19 08:32:38] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4559
[2025-07-19 08:32:38] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2134
[2025-07-19 08:32:38] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4559
[2025-07-19 08:32:38] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2134
[2025-07-19 08:32:38] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4552
[2025-07-19 08:32:38] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2134
[2025-07-19 08:32:38] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4559
[2025-07-19 08:32:38] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2134
[2025-07-19 08:32:38] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4559
[2025-07-19 08:32:38] INFO train_model: fib_100: mean=0.5818, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-19 08:32:38] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4299
[2025-07-19 08:32:38] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4623
[2025-07-19 08:32:38] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4618
[2025-07-19 08:32:38] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: trendline_down: mean=0.5245, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4313
[2025-07-19 08:32:38] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4297
[2025-07-19 08:32:38] INFO train_model: vol_spike_atr: mean=0.0154, std=0.1233, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: supply_zone: mean=0.4094, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: demand_zone: mean=0.4245, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:32:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:32:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:32:38] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: bos: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: choch: mean=0.1504, std=0.3575, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4700
[2025-07-19 08:32:38] INFO train_model: vol_cluster_high: mean=0.0751, std=0.2636, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: regime_zscore: mean=0.0090, std=1.0066, min=-7.1754, max=7.0756, unique=4626
[2025-07-19 08:32:38] INFO train_model: doji: mean=0.0961, std=0.2947, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: hammer: mean=0.0174, std=0.1306, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bullish_engulfing: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bearish_engulfing: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: pin_bar: mean=0.2357, std=0.4245, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bullish_engulfing_bar: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bearish_engulfing_bar: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: inside_bar: mean=0.1126, std=0.3161, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: double_top: mean=0.0110, std=0.1043, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: double_bottom: mean=0.0229, std=0.1494, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: rising_wedge: mean=0.2391, std=0.4266, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: falling_wedge: mean=0.2482, std=0.4320, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: fakeout_up: mean=0.0066, std=0.0807, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: fakeout_down: mean=0.0076, std=0.0870, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bullish_flag: mean=0.0250, std=0.1560, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bearish_flag: mean=0.0222, std=0.1474, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bullish_pennant: mean=0.1306, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bearish_pennant: mean=0.1242, std=0.3299, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: morning_star: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: evening_star: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bullish_harami: mean=0.0406, std=0.1974, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: bearish_harami: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: dark_cloud_cover: mean=0.0781, std=0.2683, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:32:38] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 08:32:38] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 08:32:38] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 08:32:38] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 08:32:38] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 08:32:38] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 08:32:38] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 08:32:38] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 08:32:38] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 08:32:38] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 08:32:38] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 08:32:38] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:32:38] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:32:38] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 08:32:38] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:32:38] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 08:32:38] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 08:32:38] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 08:32:38] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 08:32:38] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 08:32:38] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 08:32:38] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 08:32:38] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 08:32:38] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 08:32:38] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 08:32:38] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 08:32:38] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 08:32:38] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 08:32:38] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:32:38] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: regime_label_bear: mean=0.5099, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: regime_label_bull: mean=0.4477, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: market_regime_consolidation: mean=0.2120, std=0.4088, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: market_regime_downtrend: mean=0.1885, std=0.3912, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: market_regime_range: mean=0.4075, std=0.4914, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: market_regime_uptrend: mean=0.1902, std=0.3925, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:32:38] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:32:38] INFO train_model: Auditing data quality before training...
[2025-07-19 08:32:38] INFO train_model: Entering audit_data_quality
[2025-07-19 08:32:43] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:33:00] INFO train_model: Model is starting a new training session...
[2025-07-19 08:33:00] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:33:00] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 08:33:00] INFO train_model: Preparing target variable...
[2025-07-19 08:33:00] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:33:00] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:33:00] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 08:33:00] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:00] INFO train_model: Dropping NaN targets...
[2025-07-19 08:33:00] INFO train_model: Class balance before upsampling: {0: 3164, 1: 1564}
[2025-07-19 08:33:00] INFO train_model: Upsampling successful.
[2025-07-19 08:33:00] INFO train_model: Splitting train/test...
[2025-07-19 08:33:00] INFO train_model: Scaling features...
[2025-07-19 08:33:00] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:33:00] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:33:02] INFO train_model: Model fit complete.
[2025-07-19 08:33:02] INFO train_model: Model Accuracy: 0.8602
[2025-07-19 08:33:02] INFO train_model: 
Classification Report:
[2025-07-19 08:33:02] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       633
           1       0.86      0.86      0.86       633

    accuracy                           0.86      1266
   macro avg       0.86      0.86      0.86      1266
weighted avg       0.86      0.86      0.86      1266

[2025-07-19 08:33:02] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 08:33:02] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "8fd6ec8353249320693711106689a19a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "8fd6ec8353249320693711106689a19a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '8fd6ec8353249320693711106689a19a'}}
[2025-07-19 08:33:02] INFO train_model: Feature distributions before training:
[2025-07-19 08:33:02] INFO train_model: atr_14: mean=0.3453, std=0.1084, min=0.0000, max=0.8613, unique=4716
[2025-07-19 08:33:02] INFO train_model: volatility_20: mean=0.3102, std=0.1648, min=0.0681, max=1.3557, unique=4708
[2025-07-19 08:33:02] INFO train_model: sma_20: mean=162.8974, std=3.4577, min=155.8359, max=172.8918, unique=4694
[2025-07-19 08:33:02] INFO train_model: sma_50: mean=162.8657, std=3.3915, min=156.1946, max=172.5970, unique=4668
[2025-07-19 08:33:02] INFO train_model: sma_200: mean=162.7246, std=3.0692, min=156.6790, max=172.1544, unique=4525
[2025-07-19 08:33:02] INFO train_model: ema_12: mean=162.9054, std=3.4719, min=155.6248, max=172.9037, unique=4728
[2025-07-19 08:33:02] INFO train_model: ema_26: mean=162.8913, std=3.4355, min=155.9072, max=172.7909, unique=4728
[2025-07-19 08:33:02] INFO train_model: rsi_14: mean=51.0117, std=11.8290, min=16.6264, max=87.9679, unique=4701
[2025-07-19 08:33:02] INFO train_model: macd: mean=0.0142, std=0.2002, min=-0.5343, max=0.7069, unique=4703
[2025-07-19 08:33:02] INFO train_model: macd_signal: mean=0.0136, std=0.1870, min=-0.4700, max=0.6611, unique=4695
[2025-07-19 08:33:02] INFO train_model: bb_high: mean=163.5022, std=3.3752, min=156.6277, max=173.3643, unique=4708
[2025-07-19 08:33:02] INFO train_model: bb_low: mean=162.2927, std=3.5675, min=154.8377, max=172.7094, unique=4708
[2025-07-19 08:33:02] INFO train_model: stoch_k: mean=52.6172, std=26.1445, min=0.0000, max=99.4364, unique=4693
[2025-07-19 08:33:02] INFO train_model: stoch_d: mean=52.6535, std=23.9300, min=3.6709, max=96.7048, unique=4711
[2025-07-19 08:33:02] INFO train_model: fib_0: mean=163.5466, std=3.3557, min=156.7820, max=173.2420, unique=1122
[2025-07-19 08:33:02] INFO train_model: dist_to_fib_0: mean=-0.6291, std=0.4938, min=-3.4340, max=-0.0090, unique=2065
[2025-07-19 08:33:02] INFO train_model: fib_236: mean=163.2304, std=3.4000, min=156.3121, max=173.0891, unique=2150
[2025-07-19 08:33:02] INFO train_model: dist_to_fib_236: mean=-0.3129, std=0.4370, min=-2.4716, max=0.9103, unique=4694
[2025-07-19 08:33:02] INFO train_model: fib_382: mean=163.0348, std=3.4300, min=156.0214, max=172.9945, unique=2150
[2025-07-19 08:33:02] INFO train_model: dist_to_fib_382: mean=-0.1173, std=0.4216, min=-1.8762, max=1.5799, unique=4694
[2025-07-19 08:33:02] INFO train_model: fib_500: mean=162.8767, std=3.4556, min=155.7865, max=172.9180, unique=2063
[2025-07-19 08:33:02] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4218, min=-1.4335, max=2.1210, unique=3518
[2025-07-19 08:33:02] INFO train_model: fib_618: mean=162.7186, std=3.4824, min=155.5516, max=172.8415, unique=2150
[2025-07-19 08:33:02] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4334, min=-1.0813, max=2.6622, unique=4694
[2025-07-19 08:33:02] INFO train_model: fib_786: mean=162.4935, std=3.5227, min=155.2171, max=172.7327, unique=2150
[2025-07-19 08:33:02] INFO train_model: dist_to_fib_786: mean=0.4240, std=0.4677, min=-0.5798, max=3.4326, unique=4694
[2025-07-19 08:33:02] INFO train_model: fib_100: mean=162.2068, std=3.5772, min=154.7910, max=172.5940, unique=1112
[2025-07-19 08:33:02] INFO train_model: dist_to_fib_100: mean=0.7107, std=0.5355, min=0.0000, max=4.4140, unique=2178
[2025-07-19 08:33:02] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=2925
[2025-07-19 08:33:02] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=2961
[2025-07-19 08:33:02] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: trendline_down: mean=0.4719, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: dist_to_high: mean=-0.6269, std=0.5162, min=-3.4340, max=0.3400, unique=2119
[2025-07-19 08:33:02] INFO train_model: dist_to_low: mean=0.7119, std=0.5609, min=-0.9330, max=4.4140, unique=2241
[2025-07-19 08:33:02] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: vol_spike_std: mean=0.1366, std=0.3435, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: supply_zone: mean=0.4778, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: demand_zone: mean=0.4004, std=0.4900, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: choch: mean=0.1508, std=0.3579, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4708
[2025-07-19 08:33:02] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2541, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: regime_zscore: mean=-0.0079, std=0.9935, min=-6.5566, max=5.1800, unique=4628
[2025-07-19 08:33:02] INFO train_model: doji: mean=0.1199, std=0.3249, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: hammer: mean=0.0214, std=0.1446, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bearish_engulfing: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: pin_bar: mean=0.3135, std=0.4639, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bearish_engulfing_bar: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: inside_bar: mean=0.1451, std=0.3522, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: head_shoulders: mean=0.0334, std=0.1797, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: rising_wedge: mean=0.2690, std=0.4435, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bullish_flag: mean=0.0231, std=0.1501, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bearish_flag: mean=0.0231, std=0.1501, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bullish_pennant: mean=0.1375, std=0.3444, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bearish_pennant: mean=0.1305, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: morning_star: mean=0.0419, std=0.2003, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: evening_star: mean=0.0381, std=0.1914, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bullish_harami: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: bearish_harami: mean=0.0491, std=0.2160, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: dark_cloud_cover: mean=0.1140, std=0.3178, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: regime_label_bear: mean=0.3858, std=0.4868, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: regime_label_bull: mean=0.5719, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: market_regime_choppy: mean=0.2523, std=0.4344, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: market_regime_downtrend: mean=0.2187, std=0.4134, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: market_regime_range: mean=0.2946, std=0.4559, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: market_regime_uptrend: mean=0.2343, std=0.4236, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:02] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:02] INFO train_model: Auditing data quality before training...
[2025-07-19 08:33:02] INFO train_model: Entering audit_data_quality
[2025-07-19 08:33:06] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 08:33:06] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 08:33:06] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 08:33:06] INFO train_model: Entering audit_data_quality
[2025-07-19 08:33:09] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:33:09] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:09] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:09] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_EURJPY_features.json
[2025-07-19 08:33:09] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 08:33:09] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 08:33:09] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 08:33:09] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 08:33:12] INFO train_model: Model is starting a new training session...
[2025-07-19 08:33:12] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:33:12] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 08:33:12] INFO train_model: Preparing target variable...
[2025-07-19 08:33:12] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:33:12] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:33:12] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 08:33:12] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:12] INFO train_model: Dropping NaN targets...
[2025-07-19 08:33:12] INFO train_model: Class balance before upsampling: {0: 3158, 1: 1566}
[2025-07-19 08:33:12] INFO train_model: Upsampling successful.
[2025-07-19 08:33:12] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 08:33:12] INFO train_model: Splitting train/test...
[2025-07-19 08:33:12] INFO train_model: Scaling features...
[2025-07-19 08:33:12] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:33:12] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:33:14] INFO train_model: Model fit complete.
[2025-07-19 08:33:14] INFO train_model: Model Accuracy: 0.8782
[2025-07-19 08:33:14] INFO train_model: 
Classification Report:
[2025-07-19 08:33:14] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       632
           1       0.88      0.88      0.88       632

    accuracy                           0.88      1264
   macro avg       0.88      0.88      0.88      1264
weighted avg       0.88      0.88      0.88      1264

[2025-07-19 08:33:14] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 08:33:14] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '6d8690ed5b572aeaa54af22750c34057'}}
[2025-07-19 08:33:14] INFO train_model: Feature distributions before training:
[2025-07-19 08:33:14] INFO train_model: atr_14: mean=0.3453, std=0.1085, min=0.0000, max=0.8613, unique=4712
[2025-07-19 08:33:14] INFO train_model: volatility_20: mean=0.3104, std=0.1648, min=0.0681, max=1.3557, unique=4704
[2025-07-19 08:33:14] INFO train_model: sma_20: mean=162.8970, std=3.4592, min=155.8359, max=172.8918, unique=4704
[2025-07-19 08:33:14] INFO train_model: sma_50: mean=162.8653, std=3.3929, min=156.1946, max=172.5970, unique=4672
[2025-07-19 08:33:14] INFO train_model: sma_200: mean=162.7251, std=3.0704, min=156.6790, max=172.1544, unique=4521
[2025-07-19 08:33:14] INFO train_model: ema_12: mean=162.9049, std=3.4734, min=155.6248, max=172.9037, unique=4724
[2025-07-19 08:33:14] INFO train_model: ema_26: mean=162.8909, std=3.4369, min=155.9072, max=172.7909, unique=4724
[2025-07-19 08:33:14] INFO train_model: rsi_14: mean=51.0080, std=11.8331, min=16.6264, max=87.9679, unique=4699
[2025-07-19 08:33:14] INFO train_model: macd: mean=0.0142, std=0.2003, min=-0.5343, max=0.7069, unique=4699
[2025-07-19 08:33:14] INFO train_model: macd_signal: mean=0.0136, std=0.1871, min=-0.4700, max=0.6611, unique=4691
[2025-07-19 08:33:14] INFO train_model: bb_high: mean=163.5020, std=3.3766, min=156.6277, max=173.3643, unique=4704
[2025-07-19 08:33:14] INFO train_model: bb_low: mean=162.2919, std=3.5689, min=154.8377, max=172.7094, unique=4704
[2025-07-19 08:33:14] INFO train_model: stoch_k: mean=52.6125, std=26.1493, min=0.0000, max=99.4364, unique=4698
[2025-07-19 08:33:14] INFO train_model: stoch_d: mean=52.6532, std=23.9367, min=3.6709, max=96.7048, unique=4708
[2025-07-19 08:33:14] INFO train_model: fib_0: mean=163.5464, std=3.3571, min=156.7820, max=173.2420, unique=1122
[2025-07-19 08:33:14] INFO train_model: dist_to_fib_0: mean=-0.6294, std=0.4939, min=-3.4340, max=-0.0090, unique=3106
[2025-07-19 08:33:14] INFO train_model: fib_236: mean=163.2300, std=3.4014, min=156.3121, max=173.0891, unique=2150
[2025-07-19 08:33:14] INFO train_model: dist_to_fib_236: mean=-0.3131, std=0.4371, min=-2.4716, max=0.9103, unique=4693
[2025-07-19 08:33:14] INFO train_model: fib_382: mean=163.0343, std=3.4314, min=156.0214, max=172.9945, unique=2150
[2025-07-19 08:33:14] INFO train_model: dist_to_fib_382: mean=-0.1174, std=0.4217, min=-1.8762, max=1.5799, unique=4693
[2025-07-19 08:33:14] INFO train_model: fib_500: mean=162.8762, std=3.4570, min=155.7865, max=172.9180, unique=2110
[2025-07-19 08:33:14] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4220, min=-1.4335, max=2.1210, unique=4391
[2025-07-19 08:33:14] INFO train_model: fib_618: mean=162.7180, std=3.4838, min=155.5516, max=172.8415, unique=2150
[2025-07-19 08:33:14] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4336, min=-1.0813, max=2.6622, unique=4693
[2025-07-19 08:33:14] INFO train_model: fib_786: mean=162.4928, std=3.5241, min=155.2171, max=172.7327, unique=2150
[2025-07-19 08:33:14] INFO train_model: dist_to_fib_786: mean=0.4241, std=0.4679, min=-0.5798, max=3.4326, unique=4693
[2025-07-19 08:33:14] INFO train_model: fib_100: mean=162.2060, std=3.5787, min=154.7910, max=172.5940, unique=1112
[2025-07-19 08:33:14] INFO train_model: dist_to_fib_100: mean=0.7110, std=0.5356, min=0.0000, max=4.4140, unique=3220
[2025-07-19 08:33:14] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=3776
[2025-07-19 08:33:14] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=3825
[2025-07-19 08:33:14] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: trendline_down: mean=0.4723, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: dist_to_high: mean=-0.6273, std=0.5162, min=-3.4340, max=0.3400, unique=3182
[2025-07-19 08:33:14] INFO train_model: dist_to_low: mean=0.7121, std=0.5611, min=-0.9330, max=4.4140, unique=3281
[2025-07-19 08:33:14] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: vol_spike_std: mean=0.1367, std=0.3436, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: supply_zone: mean=0.4773, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: demand_zone: mean=0.4005, std=0.4901, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:14] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:14] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:14] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: choch: mean=0.1507, std=0.3578, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4704
[2025-07-19 08:33:14] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2542, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: regime_zscore: mean=-0.0081, std=0.9939, min=-6.5566, max=5.1800, unique=4624
[2025-07-19 08:33:14] INFO train_model: doji: mean=0.1196, std=0.3245, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: hammer: mean=0.0218, std=0.1461, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bearish_engulfing: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: pin_bar: mean=0.3135, std=0.4640, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bearish_engulfing_bar: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: inside_bar: mean=0.1452, std=0.3524, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: rising_wedge: mean=0.2688, std=0.4434, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: falling_wedge: mean=0.2299, std=0.4208, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bullish_flag: mean=0.0231, std=0.1502, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bearish_flag: mean=0.0229, std=0.1495, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bullish_pennant: mean=0.1376, std=0.3445, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bearish_pennant: mean=0.1304, std=0.3368, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: morning_star: mean=0.0419, std=0.2004, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: evening_star: mean=0.0381, std=0.1915, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bullish_harami: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: bearish_harami: mean=0.0491, std=0.2161, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: dark_cloud_cover: mean=0.1143, std=0.3182, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:33:14] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 08:33:14] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 08:33:14] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 08:33:14] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 08:33:14] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 08:33:14] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 08:33:14] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 08:33:14] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 08:33:14] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 08:33:14] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 08:33:14] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 08:33:14] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:14] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:14] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:14] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:33:14] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 08:33:14] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 08:33:14] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 08:33:14] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 08:33:14] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 08:33:14] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 08:33:14] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 08:33:14] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 08:33:14] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 08:33:14] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 08:33:14] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 08:33:14] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 08:33:14] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 08:33:14] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:33:14] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: regime_label_bear: mean=0.3861, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: regime_label_bull: mean=0.5715, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: market_regime_choppy: mean=0.2517, std=0.4340, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: market_regime_downtrend: mean=0.2189, std=0.4135, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: market_regime_range: mean=0.2949, std=0.4560, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: market_regime_uptrend: mean=0.2345, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:14] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:14] INFO train_model: Auditing data quality before training...
[2025-07-19 08:33:14] INFO train_model: Entering audit_data_quality
[2025-07-19 08:33:19] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:33:38] INFO train_model: Model is starting a new training session...
[2025-07-19 08:33:38] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:33:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 08:33:38] INFO train_model: Preparing target variable...
[2025-07-19 08:33:38] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:33:38] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:33:38] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 08:33:38] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:38] INFO train_model: Dropping NaN targets...
[2025-07-19 08:33:38] INFO train_model: Class balance before upsampling: {0: 3070, 1: 1660}
[2025-07-19 08:33:38] INFO train_model: Upsampling successful.
[2025-07-19 08:33:38] INFO train_model: Splitting train/test...
[2025-07-19 08:33:38] INFO train_model: Scaling features...
[2025-07-19 08:33:38] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:33:38] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:33:40] INFO train_model: Model fit complete.
[2025-07-19 08:33:40] INFO train_model: Model Accuracy: 0.8176
[2025-07-19 08:33:40] INFO train_model: 
Classification Report:
[2025-07-19 08:33:40] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.81      0.82       614
           1       0.82      0.82      0.82       614

    accuracy                           0.82      1228
   macro avg       0.82      0.82      0.82      1228
weighted avg       0.82      0.82      0.82      1228

[2025-07-19 08:33:40] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 08:33:40] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "ef37d9c4f3bb1067978918f0c2fc8a3e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "ef37d9c4f3bb1067978918f0c2fc8a3e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': 'ef37d9c4f3bb1067978918f0c2fc8a3e'}}
[2025-07-19 08:33:40] INFO train_model: Feature distributions before training:
[2025-07-19 08:33:40] INFO train_model: atr_14: mean=0.2434, std=0.2274, min=0.0000, max=3.8450, unique=4718
[2025-07-19 08:33:40] INFO train_model: volatility_20: mean=0.2228, std=0.2569, min=0.0393, max=3.3152, unique=4708
[2025-07-19 08:33:40] INFO train_model: sma_20: mean=87.3663, std=2.2031, min=81.5998, max=92.2272, unique=4690
[2025-07-19 08:33:40] INFO train_model: sma_50: mean=87.3741, std=2.1950, min=82.0271, max=91.9825, unique=4673
[2025-07-19 08:33:40] INFO train_model: sma_200: mean=87.4217, std=2.1959, min=83.2738, max=91.5912, unique=4523
[2025-07-19 08:33:40] INFO train_model: ema_12: mean=87.3642, std=2.2029, min=81.3860, max=92.2433, unique=4730
[2025-07-19 08:33:40] INFO train_model: ema_26: mean=87.3679, std=2.1951, min=81.7434, max=92.1009, unique=4730
[2025-07-19 08:33:40] INFO train_model: rsi_14: mean=49.9093, std=11.8533, min=11.9091, max=86.8743, unique=4690
[2025-07-19 08:33:40] INFO train_model: macd: mean=-0.0034, std=0.1378, min=-0.7910, max=1.4467, unique=4705
[2025-07-19 08:33:40] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4697
[2025-07-19 08:33:40] INFO train_model: bb_high: mean=87.8006, std=2.1258, min=82.3688, max=92.6084, unique=4708
[2025-07-19 08:33:40] INFO train_model: bb_low: mean=86.9321, std=2.3853, min=77.4303, max=92.0349, unique=4708
[2025-07-19 08:33:40] INFO train_model: stoch_k: mean=51.5854, std=26.9527, min=0.7728, max=239.4568, unique=4663
[2025-07-19 08:33:40] INFO train_model: stoch_d: mean=51.5699, std=24.5735, min=3.8824, max=173.4622, unique=4703
[2025-07-19 08:33:40] INFO train_model: fib_0: mean=87.8001, std=2.1191, min=82.4090, max=92.4600, unique=1116
[2025-07-19 08:33:40] INFO train_model: dist_to_fib_0: mean=-0.4376, std=0.4915, min=-6.7800, max=3.6535, unique=1671
[2025-07-19 08:33:40] INFO train_model: fib_236: mean=87.5874, std=2.1504, min=81.9488, max=92.3562, unique=2142
[2025-07-19 08:33:40] INFO train_model: dist_to_fib_236: mean=-0.2249, std=0.4027, min=-5.1658, max=4.4047, unique=4670
[2025-07-19 08:33:40] INFO train_model: fib_382: mean=87.4559, std=2.1751, min=81.6641, max=92.2919, unique=2142
[2025-07-19 08:33:40] INFO train_model: dist_to_fib_382: mean=-0.0933, std=0.3701, min=-4.1671, max=4.8694, unique=4670
[2025-07-19 08:33:40] INFO train_model: fib_500: mean=87.3495, std=2.1978, min=81.4340, max=92.2400, unique=2035
[2025-07-19 08:33:40] INFO train_model: dist_to_fib_500: mean=0.0130, std=0.3604, min=-3.3600, max=5.2450, unique=3141
[2025-07-19 08:33:40] INFO train_model: fib_618: mean=87.2432, std=2.2230, min=81.2039, max=92.1881, unique=2142
[2025-07-19 08:33:40] INFO train_model: dist_to_fib_618: mean=0.1194, std=0.3671, min=-2.5529, max=5.6206, unique=4670
[2025-07-19 08:33:40] INFO train_model: fib_786: mean=87.0917, std=2.2630, min=80.8763, max=92.1142, unique=2142
[2025-07-19 08:33:40] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4028, min=-1.4038, max=6.1553, unique=4670
[2025-07-19 08:33:40] INFO train_model: fib_100: mean=86.8989, std=2.3204, min=80.4530, max=92.0200, unique=1085
[2025-07-19 08:33:40] INFO train_model: dist_to_fib_100: mean=0.4636, std=0.4820, min=0.0060, max=6.8365, unique=1692
[2025-07-19 08:33:40] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0292, min=-0.2149, max=0.3140, unique=2446
[2025-07-19 08:33:40] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=2481
[2025-07-19 08:33:40] INFO train_model: trendline_up: mean=0.4907, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: trendline_down: mean=0.5013, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: breakout_high: mean=0.0025, std=0.0503, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: dist_to_high: mean=-0.4382, std=0.4963, min=-6.7220, max=3.3765, unique=1730
[2025-07-19 08:33:40] INFO train_model: dist_to_low: mean=0.4621, std=0.4922, min=-0.4180, max=6.8365, unique=1739
[2025-07-19 08:33:40] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0981, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: vol_spike_std: mean=0.1292, std=0.3354, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: supply_zone: mean=0.4142, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: demand_zone: mean=0.3778, std=0.4849, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: choch: mean=0.1567, std=0.3635, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4709
[2025-07-19 08:33:40] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2418, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: regime_zscore: mean=-0.0102, std=1.0094, min=-7.2839, max=9.1570, unique=4630
[2025-07-19 08:33:40] INFO train_model: doji: mean=0.1233, std=0.3288, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: hammer: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2284, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: pin_bar: mean=0.3021, std=0.4592, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2284, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: inside_bar: mean=0.1408, std=0.3479, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: inv_head_shoulders: mean=0.0304, std=0.1718, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: double_top: mean=0.0032, std=0.0562, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: double_bottom: mean=0.0021, std=0.0459, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: rising_wedge: mean=0.2704, std=0.4442, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: falling_wedge: mean=0.2630, std=0.4403, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bullish_flag: mean=0.0245, std=0.1547, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bearish_flag: mean=0.0290, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bullish_pennant: mean=0.1317, std=0.3382, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bearish_pennant: mean=0.1180, std=0.3226, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: morning_star: mean=0.0429, std=0.2027, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: evening_star: mean=0.0366, std=0.1877, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: bullish_harami: mean=0.0471, std=0.2120, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: bearish_harami: mean=0.0507, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: dark_cloud_cover: mean=0.1110, std=0.3142, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: regime_label_bear: mean=0.4302, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: regime_label_bull: mean=0.5275, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: market_regime_choppy: mean=0.2907, std=0.4541, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: market_regime_downtrend: mean=0.2364, std=0.4249, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: market_regime_range: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: market_regime_uptrend: mean=0.1848, std=0.3882, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:40] INFO train_model: Auditing data quality before training...
[2025-07-19 08:33:40] INFO train_model: Entering audit_data_quality
[2025-07-19 08:33:44] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 08:33:44] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 08:33:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 08:33:44] INFO train_model: Entering audit_data_quality
[2025-07-19 08:33:47] INFO train_model: Exiting audit_data_quality
[2025-07-19 08:33:47] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:47] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:47] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDJPY_features.json
[2025-07-19 08:33:47] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 08:33:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 08:33:47] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 08:33:47] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 08:33:50] INFO train_model: Model is starting a new training session...
[2025-07-19 08:33:50] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 08:33:50] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 08:33:50] INFO train_model: Preparing target variable...
[2025-07-19 08:33:50] INFO train_model: Entering prepare_target_variable
[2025-07-19 08:33:50] INFO train_model: Exiting prepare_target_variable
[2025-07-19 08:33:50] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 08:33:50] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 08:33:50] INFO train_model: Dropping NaN targets...
[2025-07-19 08:33:50] INFO train_model: Class balance before upsampling: {0: 3067, 1: 1657}
[2025-07-19 08:33:50] INFO train_model: Upsampling successful.
[2025-07-19 08:33:50] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 08:33:50] INFO train_model: Splitting train/test...
[2025-07-19 08:33:50] INFO train_model: Scaling features...
[2025-07-19 08:33:50] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 08:33:50] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 08:33:52] INFO train_model: Model fit complete.
[2025-07-19 08:33:52] INFO train_model: Model Accuracy: 0.8419
[2025-07-19 08:33:52] INFO train_model: 
Classification Report:
[2025-07-19 08:33:52] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.85      0.84       614
           1       0.84      0.84      0.84       613

    accuracy                           0.84      1227
   macro avg       0.84      0.84      0.84      1227
weighted avg       0.84      0.84      0.84      1227

[2025-07-19 08:33:52] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 08:33:52] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': '81cb0af832d014abc50b04a59db67ee5'}}
[2025-07-19 08:33:52] INFO train_model: Feature distributions before training:
[2025-07-19 08:33:52] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8450, unique=4712
[2025-07-19 08:33:52] INFO train_model: volatility_20: mean=0.2228, std=0.2570, min=0.0393, max=3.3152, unique=4702
[2025-07-19 08:33:52] INFO train_model: sma_20: mean=87.3666, std=2.2038, min=81.5998, max=92.2272, unique=4701
[2025-07-19 08:33:52] INFO train_model: sma_50: mean=87.3744, std=2.1956, min=82.0271, max=91.9825, unique=4673
[2025-07-19 08:33:52] INFO train_model: sma_200: mean=87.4223, std=2.1965, min=83.2738, max=91.5912, unique=4521
[2025-07-19 08:33:52] INFO train_model: ema_12: mean=87.3644, std=2.2035, min=81.3860, max=92.2433, unique=4724
[2025-07-19 08:33:52] INFO train_model: ema_26: mean=87.3681, std=2.1958, min=81.7434, max=92.1009, unique=4724
[2025-07-19 08:33:52] INFO train_model: rsi_14: mean=49.9041, std=11.8518, min=11.9091, max=86.8743, unique=4685
[2025-07-19 08:33:52] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4467, unique=4699
[2025-07-19 08:33:52] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4691
[2025-07-19 08:33:52] INFO train_model: bb_high: mean=87.8010, std=2.1265, min=82.3688, max=92.6084, unique=4703
[2025-07-19 08:33:52] INFO train_model: bb_low: mean=86.9322, std=2.3861, min=77.4303, max=92.0349, unique=4703
[2025-07-19 08:33:52] INFO train_model: stoch_k: mean=51.5672, std=26.9451, min=0.7728, max=239.4568, unique=4672
[2025-07-19 08:33:52] INFO train_model: stoch_d: mean=51.5617, std=24.5719, min=3.8824, max=173.4622, unique=4698
[2025-07-19 08:33:52] INFO train_model: fib_0: mean=87.8005, std=2.1197, min=82.4090, max=92.4600, unique=1115
[2025-07-19 08:33:52] INFO train_model: dist_to_fib_0: mean=-0.4378, std=0.4917, min=-6.7800, max=3.6535, unique=2675
[2025-07-19 08:33:52] INFO train_model: fib_236: mean=87.5878, std=2.1510, min=81.9488, max=92.3562, unique=2140
[2025-07-19 08:33:52] INFO train_model: dist_to_fib_236: mean=-0.2251, std=0.4029, min=-5.1658, max=4.4047, unique=4668
[2025-07-19 08:33:52] INFO train_model: fib_382: mean=87.4561, std=2.1757, min=81.6641, max=92.2919, unique=2140
[2025-07-19 08:33:52] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8694, unique=4668
[2025-07-19 08:33:52] INFO train_model: fib_500: mean=87.3498, std=2.1984, min=81.4340, max=92.2400, unique=2084
[2025-07-19 08:33:52] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2450, unique=4266
[2025-07-19 08:33:52] INFO train_model: fib_618: mean=87.2434, std=2.2236, min=81.2039, max=92.1881, unique=2140
[2025-07-19 08:33:52] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6206, unique=4667
[2025-07-19 08:33:52] INFO train_model: fib_786: mean=87.0919, std=2.2636, min=80.8763, max=92.1142, unique=2140
[2025-07-19 08:33:52] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1553, unique=4667
[2025-07-19 08:33:52] INFO train_model: fib_100: mean=86.8990, std=2.3210, min=80.4530, max=92.0200, unique=1084
[2025-07-19 08:33:52] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4822, min=0.0060, max=6.8365, unique=2743
[2025-07-19 08:33:52] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3389
[2025-07-19 08:33:52] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-19 08:33:52] INFO train_model: trendline_up: mean=0.4905, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: trendline_down: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: dist_to_high: mean=-0.4384, std=0.4965, min=-6.7220, max=3.3765, unique=2743
[2025-07-19 08:33:52] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8365, unique=2785
[2025-07-19 08:33:52] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: vol_spike_std: mean=0.1293, std=0.3356, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: supply_zone: mean=0.4138, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: demand_zone: mean=0.3781, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:52] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:52] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:52] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: bos: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: choch: mean=0.1564, std=0.3633, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4704
[2025-07-19 08:33:52] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2420, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: regime_zscore: mean=-0.0107, std=1.0098, min=-7.2839, max=9.1570, unique=4624
[2025-07-19 08:33:52] INFO train_model: doji: mean=0.1228, std=0.3282, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: hammer: mean=0.0220, std=0.1467, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: pin_bar: mean=0.3027, std=0.4595, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: inside_bar: mean=0.1410, std=0.3480, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: head_shoulders: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: double_top: mean=0.0032, std=0.0563, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: double_bottom: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: rising_wedge: mean=0.2699, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: falling_wedge: mean=0.2631, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bullish_flag: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bearish_flag: mean=0.0288, std=0.1672, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bullish_pennant: mean=0.1319, std=0.3384, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bearish_pennant: mean=0.1179, std=0.3225, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: morning_star: mean=0.0430, std=0.2028, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: evening_star: mean=0.0366, std=0.1879, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: bullish_harami: mean=0.0472, std=0.2121, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: bearish_harami: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:33:52] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 08:33:52] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 08:33:52] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 08:33:52] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 08:33:52] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 08:33:52] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 08:33:52] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 08:33:52] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 08:33:52] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 08:33:52] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 08:33:52] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 08:33:52] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:52] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:52] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 08:33:52] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:33:52] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 08:33:52] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 08:33:52] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 08:33:52] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 08:33:52] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 08:33:52] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 08:33:52] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 08:33:52] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 08:33:52] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 08:33:52] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 08:33:52] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 08:33:52] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 08:33:52] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 08:33:52] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 08:33:52] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: regime_label_bear: mean=0.4308, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: regime_label_bull: mean=0.5269, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: market_regime_choppy: mean=0.2904, std=0.4540, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: market_regime_downtrend: mean=0.2367, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: market_regime_range: mean=0.2887, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: market_regime_uptrend: mean=0.1842, std=0.3877, min=0.0000, max=1.0000, unique=2
[2025-07-19 08:33:52] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 08:33:52] INFO train_model: Auditing data quality before training...
[2025-07-19 08:33:52] INFO train_model: Entering audit_data_quality
[2025-07-19 08:33:58] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:00:11] INFO train_model: Model is starting a new training session...
[2025-07-19 10:00:11] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:00:11] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 10:00:11] INFO train_model: Preparing target variable...
[2025-07-19 10:00:11] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:00:11] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:00:11] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 10:00:11] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:00:11] INFO train_model: Dropping NaN targets...
[2025-07-19 10:00:11] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 10:00:11] INFO train_model: Upsampling successful.
[2025-07-19 10:00:11] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:00:11] INFO train_model: Splitting train/test...
[2025-07-19 10:00:11] INFO train_model: Scaling features...
[2025-07-19 10:00:11] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:00:11] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:00:13] INFO train_model: Model fit complete.
[2025-07-19 10:00:13] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 10:00:13] INFO train_model: 
Classification Report:
[2025-07-19 10:00:13] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 10:00:13] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 10:00:13] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 10:00:13] INFO train_model: Feature distributions before training:
[2025-07-19 10:00:13] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 10:00:13] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 10:00:13] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 10:00:13] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 10:00:13] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 10:00:13] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 10:00:13] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 10:00:13] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 10:00:13] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 10:00:13] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 10:00:13] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 10:00:13] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 10:00:13] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 10:00:13] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 10:00:13] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 10:00:13] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 10:00:13] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 10:00:13] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 10:00:13] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 10:00:13] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 10:00:13] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 10:00:13] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 10:00:13] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 10:00:13] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 10:00:13] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 10:00:13] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 10:00:13] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 10:00:13] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 10:00:13] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 10:00:13] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 10:00:13] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 10:00:13] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 10:00:13] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:13] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:13] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:13] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 10:00:13] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 10:00:13] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:13] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 10:00:13] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 10:00:13] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 10:00:13] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 10:00:13] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 10:00:13] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 10:00:13] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 10:00:13] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 10:00:13] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 10:00:13] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 10:00:13] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 10:00:13] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:13] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:13] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:13] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:13] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 10:00:13] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 10:00:13] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 10:00:13] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 10:00:13] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 10:00:13] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 10:00:13] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 10:00:13] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 10:00:13] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 10:00:13] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 10:00:13] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 10:00:13] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 10:00:13] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 10:00:13] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:13] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:13] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:13] INFO train_model: Auditing data quality before training...
[2025-07-19 10:00:13] INFO train_model: Entering audit_data_quality
[2025-07-19 10:00:19] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:00:21] INFO train_model: Model is starting a new training session...
[2025-07-19 10:00:21] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:00:21] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 10:00:21] INFO train_model: Preparing target variable...
[2025-07-19 10:00:21] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:00:21] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:00:21] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 10:00:22] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:00:22] INFO train_model: Dropping NaN targets...
[2025-07-19 10:00:22] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 10:00:22] INFO train_model: Upsampling successful.
[2025-07-19 10:00:22] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:00:22] INFO train_model: Splitting train/test...
[2025-07-19 10:00:22] INFO train_model: Scaling features...
[2025-07-19 10:00:22] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:00:22] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:00:24] INFO train_model: Model fit complete.
[2025-07-19 10:00:24] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 10:00:24] INFO train_model: 
Classification Report:
[2025-07-19 10:00:24] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 10:00:24] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 10:00:24] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 10:00:24] INFO train_model: Feature distributions before training:
[2025-07-19 10:00:24] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 10:00:24] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 10:00:24] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 10:00:24] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 10:00:24] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 10:00:24] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 10:00:24] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 10:00:24] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 10:00:24] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 10:00:24] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 10:00:24] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 10:00:24] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 10:00:24] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 10:00:24] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 10:00:24] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 10:00:24] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 10:00:24] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 10:00:24] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 10:00:24] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 10:00:24] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 10:00:24] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 10:00:24] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 10:00:24] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 10:00:24] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 10:00:24] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 10:00:24] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 10:00:24] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 10:00:24] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 10:00:24] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 10:00:24] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 10:00:24] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 10:00:24] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 10:00:24] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:24] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:24] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:24] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 10:00:24] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 10:00:24] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:24] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 10:00:24] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 10:00:24] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 10:00:24] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 10:00:24] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 10:00:24] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 10:00:24] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 10:00:24] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 10:00:24] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 10:00:24] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 10:00:24] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 10:00:24] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:24] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:24] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:00:24] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:24] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 10:00:24] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 10:00:24] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 10:00:24] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 10:00:24] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 10:00:24] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 10:00:24] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 10:00:24] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 10:00:24] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 10:00:24] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 10:00:24] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 10:00:24] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 10:00:24] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 10:00:24] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:24] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:24] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:24] INFO train_model: Auditing data quality before training...
[2025-07-19 10:00:24] INFO train_model: Entering audit_data_quality
[2025-07-19 10:00:29] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:00:39] INFO train_model: Model is starting a new training session...
[2025-07-19 10:00:39] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:00:39] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 10:00:39] INFO train_model: Preparing target variable...
[2025-07-19 10:00:39] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:00:39] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:00:39] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 10:00:39] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:00:39] INFO train_model: Dropping NaN targets...
[2025-07-19 10:00:39] INFO train_model: Class balance before upsampling: {0: 3110, 1: 1592}
[2025-07-19 10:00:39] INFO train_model: Upsampling successful.
[2025-07-19 10:00:39] INFO train_model: Splitting train/test...
[2025-07-19 10:00:39] INFO train_model: Scaling features...
[2025-07-19 10:00:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:00:39] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:00:41] INFO train_model: Model fit complete.
[2025-07-19 10:00:41] INFO train_model: Model Accuracy: 0.8207
[2025-07-19 10:00:41] INFO train_model: 
Classification Report:
[2025-07-19 10:00:41] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.81      0.82       622
           1       0.81      0.83      0.82       622

    accuracy                           0.82      1244
   macro avg       0.82      0.82      0.82      1244
weighted avg       0.82      0.82      0.82      1244

[2025-07-19 10:00:41] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 10:00:41] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "b1091431cfcc446e2d165f9167d0771d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "b1091431cfcc446e2d165f9167d0771d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'b1091431cfcc446e2d165f9167d0771d'}}
[2025-07-19 10:00:41] INFO train_model: Feature distributions before training:
[2025-07-19 10:00:41] INFO train_model: atr_14: mean=0.3416, std=0.1040, min=0.0000, max=0.9927, unique=4690
[2025-07-19 10:00:41] INFO train_model: volatility_20: mean=0.3279, std=0.1837, min=0.0344, max=1.3004, unique=4683
[2025-07-19 10:00:41] INFO train_model: sma_20: mean=149.6241, std=4.6995, min=140.5323, max=158.2940, unique=4678
[2025-07-19 10:00:41] INFO train_model: sma_50: mean=149.6263, std=4.6784, min=140.8684, max=158.1650, unique=4652
[2025-07-19 10:00:41] INFO train_model: sma_200: mean=149.6799, std=4.5836, min=142.1838, max=157.7724, unique=4500
[2025-07-19 10:00:41] INFO train_model: ema_12: mean=149.6229, std=4.7011, min=140.4143, max=158.3392, unique=4702
[2025-07-19 10:00:41] INFO train_model: ema_26: mean=149.6240, std=4.6866, min=140.6181, max=158.2242, unique=4702
[2025-07-19 10:00:41] INFO train_model: rsi_14: mean=50.5788, std=12.9257, min=8.6902, max=92.4381, unique=4676
[2025-07-19 10:00:41] INFO train_model: macd: mean=-0.0008, std=0.2229, min=-0.9230, max=0.8730, unique=4677
[2025-07-19 10:00:41] INFO train_model: macd_signal: mean=-0.0012, std=0.2088, min=-0.8065, max=0.7956, unique=4669
[2025-07-19 10:00:41] INFO train_model: bb_high: mean=150.2633, std=4.6767, min=140.9707, max=158.5972, unique=4683
[2025-07-19 10:00:41] INFO train_model: bb_low: mean=148.9849, std=4.7491, min=139.2981, max=158.0618, unique=4683
[2025-07-19 10:00:41] INFO train_model: stoch_k: mean=52.3511, std=27.0512, min=0.0000, max=99.6649, unique=4670
[2025-07-19 10:00:41] INFO train_model: stoch_d: mean=52.3592, std=25.0024, min=3.8543, max=96.6848, unique=4685
[2025-07-19 10:00:41] INFO train_model: fib_0: mean=150.2887, std=4.6576, min=141.0760, max=158.8790, unique=1210
[2025-07-19 10:00:41] INFO train_model: dist_to_fib_0: mean=-0.6650, std=0.5552, min=-5.0610, max=-0.0050, unique=2187
[2025-07-19 10:00:41] INFO train_model: fib_236: mean=149.9633, std=4.6650, min=140.8676, max=158.5797, unique=2255
[2025-07-19 10:00:41] INFO train_model: dist_to_fib_236: mean=-0.3396, std=0.4875, min=-3.8081, max=0.7712, unique=4659
[2025-07-19 10:00:41] INFO train_model: fib_382: mean=149.7620, std=4.6718, min=140.6792, max=158.3946, unique=2255
[2025-07-19 10:00:41] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4631, min=-3.0330, max=1.2871, unique=4659
[2025-07-19 10:00:41] INFO train_model: fib_500: mean=149.5993, std=4.6786, min=140.5270, max=158.2450, unique=2206
[2025-07-19 10:00:41] INFO train_model: dist_to_fib_500: mean=0.0245, std=0.4552, min=-2.4065, max=1.7885, unique=3611
[2025-07-19 10:00:41] INFO train_model: fib_618: mean=149.4365, std=4.6864, min=140.3748, max=158.1640, unique=2255
[2025-07-19 10:00:41] INFO train_model: dist_to_fib_618: mean=0.1872, std=0.4585, min=-1.7800, max=2.2899, unique=4659
[2025-07-19 10:00:41] INFO train_model: fib_786: mean=149.2049, std=4.6994, min=140.1581, max=158.0580, unique=2255
[2025-07-19 10:00:41] INFO train_model: dist_to_fib_786: mean=0.4188, std=0.4819, min=-0.8881, max=3.0037, unique=4659
[2025-07-19 10:00:41] INFO train_model: fib_100: mean=148.9098, std=4.7190, min=139.8820, max=157.9230, unique=1168
[2025-07-19 10:00:41] INFO train_model: dist_to_fib_100: mean=0.7139, std=0.5389, min=0.0000, max=3.9130, unique=2197
[2025-07-19 10:00:41] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=2986
[2025-07-19 10:00:41] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3048
[2025-07-19 10:00:41] INFO train_model: trendline_up: mean=0.5040, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: dist_to_high: mean=-0.6653, std=0.5818, min=-5.0610, max=0.5750, unique=2227
[2025-07-19 10:00:41] INFO train_model: dist_to_low: mean=0.7120, std=0.5649, min=-0.3640, max=3.9130, unique=2274
[2025-07-19 10:00:41] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: supply_zone: mean=0.4370, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: demand_zone: mean=0.3694, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: choch: mean=0.1436, std=0.3507, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4682
[2025-07-19 10:00:41] INFO train_model: vol_cluster_high: mean=0.1014, std=0.3020, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: regime_zscore: mean=-0.0187, std=1.0033, min=-5.8436, max=6.5511, unique=4602
[2025-07-19 10:00:41] INFO train_model: doji: mean=0.1104, std=0.3134, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: hammer: mean=0.0262, std=0.1596, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: pin_bar: mean=0.2890, std=0.4534, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1780, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: rising_wedge: mean=0.2682, std=0.4431, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: falling_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bullish_flag: mean=0.0196, std=0.1385, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bearish_flag: mean=0.0217, std=0.1457, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bullish_pennant: mean=0.1280, std=0.3342, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bearish_pennant: mean=0.1359, std=0.3427, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: morning_star: mean=0.0404, std=0.1969, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: evening_star: mean=0.0362, std=0.1867, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bullish_harami: mean=0.0549, std=0.2278, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: bearish_harami: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: dark_cloud_cover: mean=0.1187, std=0.3234, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: regime_label_bear: mean=0.4828, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: regime_label_bull: mean=0.4747, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: market_regime_choppy: mean=0.2401, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: market_regime_downtrend: mean=0.2886, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: market_regime_range: mean=0.2512, std=0.4337, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: market_regime_uptrend: mean=0.2201, std=0.4144, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:41] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:41] INFO train_model: Auditing data quality before training...
[2025-07-19 10:00:41] INFO train_model: Entering audit_data_quality
[2025-07-19 10:00:44] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 10:00:44] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 10:00:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 10:00:44] INFO train_model: Entering audit_data_quality
[2025-07-19 10:00:48] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:00:48] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:00:48] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:00:48] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDJPY_features.json
[2025-07-19 10:00:48] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 10:00:48] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 10:00:48] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 10:00:48] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 10:00:51] INFO train_model: Model is starting a new training session...
[2025-07-19 10:00:51] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:00:51] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 10:00:51] INFO train_model: Preparing target variable...
[2025-07-19 10:00:51] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:00:51] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:00:51] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 10:00:51] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:00:51] INFO train_model: Dropping NaN targets...
[2025-07-19 10:00:51] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 10:00:51] INFO train_model: Upsampling successful.
[2025-07-19 10:00:51] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:00:51] INFO train_model: Splitting train/test...
[2025-07-19 10:00:51] INFO train_model: Scaling features...
[2025-07-19 10:00:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:00:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:00:53] INFO train_model: Model fit complete.
[2025-07-19 10:00:53] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 10:00:53] INFO train_model: 
Classification Report:
[2025-07-19 10:00:53] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 10:00:53] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 10:00:53] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d2a3f9696a22ac049479f92536f55c6d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd2a3f9696a22ac049479f92536f55c6d'}}
[2025-07-19 10:00:53] INFO train_model: Feature distributions before training:
[2025-07-19 10:00:53] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 10:00:53] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 10:00:53] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 10:00:53] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 10:00:53] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 10:00:53] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 10:00:53] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 10:00:53] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 10:00:53] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 10:00:53] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 10:00:53] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 10:00:53] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 10:00:53] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 10:00:53] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 10:00:53] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 10:00:53] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 10:00:53] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 10:00:53] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 10:00:53] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 10:00:53] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 10:00:53] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 10:00:53] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 10:00:53] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 10:00:53] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 10:00:53] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 10:00:53] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 10:00:53] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 10:00:53] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 10:00:53] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 10:00:53] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 10:00:53] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 10:00:53] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 10:00:53] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 10:00:53] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 10:00:53] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 10:00:53] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 10:00:53] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 10:00:53] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:53] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 10:00:53] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 10:00:53] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 10:00:53] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 10:00:53] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 10:00:53] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 10:00:53] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 10:00:53] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 10:00:53] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 10:00:53] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 10:00:53] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 10:00:53] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 10:00:53] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 10:00:53] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 10:00:53] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:53] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 10:00:53] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 10:00:53] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 10:00:53] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 10:00:53] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 10:00:53] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 10:00:53] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 10:00:53] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 10:00:53] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 10:00:53] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 10:00:53] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 10:00:53] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 10:00:53] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 10:00:53] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:00:53] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:00:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:00:53] INFO train_model: Auditing data quality before training...
[2025-07-19 10:00:53] INFO train_model: Entering audit_data_quality
[2025-07-19 10:00:58] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:01:09] INFO train_model: Model is starting a new training session...
[2025-07-19 10:01:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:01:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-19 10:01:09] INFO train_model: Preparing target variable...
[2025-07-19 10:01:09] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:01:09] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:01:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-19 10:01:09] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:09] INFO train_model: Dropping NaN targets...
[2025-07-19 10:01:09] INFO train_model: Class balance before upsampling: {0: 3430, 1: 1272}
[2025-07-19 10:01:09] INFO train_model: Upsampling successful.
[2025-07-19 10:01:09] INFO train_model: Splitting train/test...
[2025-07-19 10:01:09] INFO train_model: Scaling features...
[2025-07-19 10:01:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:01:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:01:10] INFO train_model: Model fit complete.
[2025-07-19 10:01:10] INFO train_model: Model Accuracy: 0.8754
[2025-07-19 10:01:10] INFO train_model: 
Classification Report:
[2025-07-19 10:01:10] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.87      0.87       686
           1       0.87      0.88      0.88       686

    accuracy                           0.88      1372
   macro avg       0.88      0.88      0.88      1372
weighted avg       0.88      0.88      0.88      1372

[2025-07-19 10:01:10] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 10:01:10] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "1c32864d0edae82c3b1b65620192ce7b" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "1c32864d0edae82c3b1b65620192ce7b" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': '1c32864d0edae82c3b1b65620192ce7b'}}
[2025-07-19 10:01:10] INFO train_model: Feature distributions before training:
[2025-07-19 10:01:10] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4690
[2025-07-19 10:01:10] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4678
[2025-07-19 10:01:10] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4654
[2025-07-19 10:01:10] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4641
[2025-07-19 10:01:10] INFO train_model: sma_200: mean=0.8643, std=0.0363, min=0.7943, max=0.9132, unique=4497
[2025-07-19 10:01:10] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4702
[2025-07-19 10:01:10] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4702
[2025-07-19 10:01:10] INFO train_model: rsi_14: mean=49.8641, std=12.3936, min=7.7095, max=97.7161, unique=4663
[2025-07-19 10:01:10] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4677
[2025-07-19 10:01:10] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4669
[2025-07-19 10:01:10] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4678
[2025-07-19 10:01:10] INFO train_model: bb_low: mean=0.8601, std=0.0381, min=0.7878, max=0.9160, unique=4678
[2025-07-19 10:01:10] INFO train_model: stoch_k: mean=51.0515, std=26.3623, min=0.6580, max=98.9585, unique=4614
[2025-07-19 10:01:10] INFO train_model: stoch_d: mean=51.0710, std=24.0553, min=3.0053, max=95.8670, unique=4678
[2025-07-19 10:01:10] INFO train_model: fib_0: mean=0.8662, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 10:01:10] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=1419
[2025-07-19 10:01:10] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 10:01:10] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4613
[2025-07-19 10:01:10] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 10:01:10] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4613
[2025-07-19 10:01:10] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2007
[2025-07-19 10:01:10] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=2761
[2025-07-19 10:01:10] INFO train_model: fib_618: mean=0.8622, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 10:01:10] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4613
[2025-07-19 10:01:10] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 10:01:10] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4613
[2025-07-19 10:01:10] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 10:01:10] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=1367
[2025-07-19 10:01:10] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=2056
[2025-07-19 10:01:10] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=2075
[2025-07-19 10:01:10] INFO train_model: trendline_up: mean=0.5004, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=1453
[2025-07-19 10:01:10] INFO train_model: dist_to_low: mean=0.0031, std=0.0027, min=-0.0015, max=0.0207, unique=1403
[2025-07-19 10:01:10] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: vol_spike_std: mean=0.1559, std=0.3628, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: supply_zone: mean=0.5019, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: demand_zone: mean=0.4862, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: choch: mean=0.1623, std=0.3687, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4681
[2025-07-19 10:01:10] INFO train_model: vol_cluster_high: mean=0.1061, std=0.3080, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: regime_zscore: mean=-0.0095, std=1.0048, min=-5.9027, max=7.4977, unique=4602
[2025-07-19 10:01:10] INFO train_model: doji: mean=0.1236, std=0.3291, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bullish_engulfing: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bearish_engulfing: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: pin_bar: mean=0.3120, std=0.4634, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bullish_engulfing_bar: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bearish_engulfing_bar: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: inside_bar: mean=0.1427, std=0.3498, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: inv_head_shoulders: mean=0.0313, std=0.1740, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: rising_wedge: mean=0.2250, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: falling_wedge: mean=0.2318, std=0.4220, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: bullish_flag: mean=0.0247, std=0.1551, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bearish_flag: mean=0.0289, std=0.1676, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bullish_pennant: mean=0.1338, std=0.3404, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bearish_pennant: mean=0.1433, std=0.3505, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: morning_star: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: evening_star: mean=0.0402, std=0.1964, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bullish_harami: mean=0.0574, std=0.2327, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: bearish_harami: mean=0.0444, std=0.2061, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: dark_cloud_cover: mean=0.1114, std=0.3147, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: regime_label_bear: mean=0.4866, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: regime_label_bull: mean=0.4709, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1646, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: market_regime_consolidation: mean=0.0542, std=0.2265, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: market_regime_downtrend: mean=0.2254, std=0.4179, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: market_regime_range: mean=0.5270, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: market_regime_uptrend: mean=0.1655, std=0.3716, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:10] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:10] INFO train_model: Auditing data quality before training...
[2025-07-19 10:01:10] INFO train_model: Entering audit_data_quality
[2025-07-19 10:01:14] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 10:01:14] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 10:01:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 10:01:14] INFO train_model: Entering audit_data_quality
[2025-07-19 10:01:17] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:01:17] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:17] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:17] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_USDCHF_features.json
[2025-07-19 10:01:17] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 10:01:17] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 10:01:17] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 10:01:17] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 10:01:20] INFO train_model: Model is starting a new training session...
[2025-07-19 10:01:20] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:01:20] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 10:01:20] INFO train_model: Preparing target variable...
[2025-07-19 10:01:20] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:01:20] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:01:20] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 10:01:20] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:20] INFO train_model: Dropping NaN targets...
[2025-07-19 10:01:20] INFO train_model: Class balance before upsampling: {0: 3426, 1: 1272}
[2025-07-19 10:01:20] INFO train_model: Upsampling successful.
[2025-07-19 10:01:20] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:01:20] INFO train_model: Splitting train/test...
[2025-07-19 10:01:20] INFO train_model: Scaling features...
[2025-07-19 10:01:20] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:01:20] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:01:23] INFO train_model: Model fit complete.
[2025-07-19 10:01:23] INFO train_model: Model Accuracy: 0.9059
[2025-07-19 10:01:23] INFO train_model: 
Classification Report:
[2025-07-19 10:01:23] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.90      0.91       686
           1       0.90      0.91      0.91       685

    accuracy                           0.91      1371
   macro avg       0.91      0.91      0.91      1371
weighted avg       0.91      0.91      0.91      1371

[2025-07-19 10:01:23] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 10:01:23] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDCHF", version: "a36a889b62f1371c96a2129e8900e40e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDCHF', 'version': 'a36a889b62f1371c96a2129e8900e40e'}}
[2025-07-19 10:01:23] INFO train_model: Feature distributions before training:
[2025-07-19 10:01:23] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4686
[2025-07-19 10:01:23] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4674
[2025-07-19 10:01:23] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4672
[2025-07-19 10:01:23] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4646
[2025-07-19 10:01:23] INFO train_model: sma_200: mean=0.8642, std=0.0363, min=0.7943, max=0.9132, unique=4495
[2025-07-19 10:01:23] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4698
[2025-07-19 10:01:23] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4698
[2025-07-19 10:01:23] INFO train_model: rsi_14: mean=49.8631, std=12.3988, min=7.7095, max=97.7161, unique=4664
[2025-07-19 10:01:23] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4673
[2025-07-19 10:01:23] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4665
[2025-07-19 10:01:23] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4677
[2025-07-19 10:01:23] INFO train_model: bb_low: mean=0.8600, std=0.0381, min=0.7878, max=0.9160, unique=4677
[2025-07-19 10:01:23] INFO train_model: stoch_k: mean=51.0566, std=26.3720, min=0.6580, max=98.9585, unique=4646
[2025-07-19 10:01:23] INFO train_model: stoch_d: mean=51.0798, std=24.0633, min=3.0053, max=95.8670, unique=4679
[2025-07-19 10:01:23] INFO train_model: fib_0: mean=0.8661, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 10:01:23] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=2430
[2025-07-19 10:01:23] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 10:01:23] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4619
[2025-07-19 10:01:23] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 10:01:23] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4619
[2025-07-19 10:01:23] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2040
[2025-07-19 10:01:23] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=4125
[2025-07-19 10:01:23] INFO train_model: fib_618: mean=0.8621, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 10:01:23] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4619
[2025-07-19 10:01:23] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 10:01:23] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4619
[2025-07-19 10:01:23] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 10:01:23] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=2380
[2025-07-19 10:01:23] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=3110
[2025-07-19 10:01:23] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=3122
[2025-07-19 10:01:23] INFO train_model: trendline_up: mean=0.5009, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=2487
[2025-07-19 10:01:23] INFO train_model: dist_to_low: mean=0.0032, std=0.0027, min=-0.0015, max=0.0207, unique=2431
[2025-07-19 10:01:23] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: vol_spike_std: mean=0.1560, std=0.3629, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: supply_zone: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: demand_zone: mean=0.4857, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 10:01:23] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 10:01:23] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 10:01:23] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: choch: mean=0.1620, std=0.3685, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4677
[2025-07-19 10:01:23] INFO train_model: vol_cluster_high: mean=0.1062, std=0.3081, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: regime_zscore: mean=-0.0097, std=1.0052, min=-5.9027, max=7.4977, unique=4598
[2025-07-19 10:01:23] INFO train_model: doji: mean=0.1237, std=0.3292, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bullish_engulfing: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bearish_engulfing: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: pin_bar: mean=0.3125, std=0.4636, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bullish_engulfing_bar: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bearish_engulfing_bar: mean=0.0524, std=0.2228, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: inside_bar: mean=0.1428, std=0.3499, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: head_shoulders: mean=0.0343, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: inv_head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: rising_wedge: mean=0.2252, std=0.4178, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: falling_wedge: mean=0.2320, std=0.4222, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: bullish_flag: mean=0.0245, std=0.1545, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bearish_flag: mean=0.0289, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bullish_pennant: mean=0.1337, std=0.3403, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bearish_pennant: mean=0.1433, std=0.3504, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: morning_star: mean=0.0370, std=0.1889, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: evening_star: mean=0.0402, std=0.1965, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bullish_harami: mean=0.0575, std=0.2328, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: bearish_harami: mean=0.0445, std=0.2062, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8249, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:01:23] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4645
[2025-07-19 10:01:23] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4620
[2025-07-19 10:01:23] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4698
[2025-07-19 10:01:23] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4698
[2025-07-19 10:01:23] INFO train_model: rsi_14_4h: mean=51.1069, std=32.6123, min=0.0000, max=100.0000, unique=1782
[2025-07-19 10:01:23] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4698
[2025-07-19 10:01:23] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4698
[2025-07-19 10:01:23] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4647
[2025-07-19 10:01:23] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4647
[2025-07-19 10:01:23] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4683
[2025-07-19 10:01:23] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4637
[2025-07-19 10:01:23] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 10:01:23] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 10:01:23] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4698, 2)
[2025-07-19 10:01:23] INFO train_model: structure_trend_4h: mean=0.8169, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:01:23] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 10:01:23] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4628
[2025-07-19 10:01:23] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4698
[2025-07-19 10:01:23] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4698
[2025-07-19 10:01:23] INFO train_model: rsi_14_1d: mean=47.2116, std=49.9275, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4698
[2025-07-19 10:01:23] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4698
[2025-07-19 10:01:23] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 10:01:23] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 10:01:23] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 10:01:23] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 10:01:23] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 10:01:23] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4628
[2025-07-19 10:01:23] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4628
[2025-07-19 10:01:23] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2842, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:01:23] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: regime_label_bear: mean=0.4870, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: regime_label_bull: mean=0.4704, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2019, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1647, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: market_regime_consolidation: mean=0.0534, std=0.2249, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: market_regime_downtrend: mean=0.2256, std=0.4180, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: market_regime_range: mean=0.5285, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: market_regime_uptrend: mean=0.1645, std=0.3708, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:23] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:23] INFO train_model: Auditing data quality before training...
[2025-07-19 10:01:23] INFO train_model: Entering audit_data_quality
[2025-07-19 10:01:28] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:01:39] INFO train_model: Model is starting a new training session...
[2025-07-19 10:01:39] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:01:39] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-19 10:01:39] INFO train_model: Preparing target variable...
[2025-07-19 10:01:39] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:01:39] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:01:39] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-19 10:01:39] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:39] INFO train_model: Dropping NaN targets...
[2025-07-19 10:01:39] INFO train_model: Class balance before upsampling: {0: 3122, 1: 1638}
[2025-07-19 10:01:39] INFO train_model: Upsampling successful.
[2025-07-19 10:01:39] INFO train_model: Splitting train/test...
[2025-07-19 10:01:39] INFO train_model: Scaling features...
[2025-07-19 10:01:39] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:01:39] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:01:41] INFO train_model: Model fit complete.
[2025-07-19 10:01:41] INFO train_model: Model Accuracy: 0.8447
[2025-07-19 10:01:41] INFO train_model: 
Classification Report:
[2025-07-19 10:01:41] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.87      0.85       625
           1       0.86      0.82      0.84       624

    accuracy                           0.84      1249
   macro avg       0.85      0.84      0.84      1249
weighted avg       0.85      0.84      0.84      1249

[2025-07-19 10:01:41] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 10:01:41] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "2bfa20aa78505eabdaf0592f69c66f1d" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "2bfa20aa78505eabdaf0592f69c66f1d" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '2bfa20aa78505eabdaf0592f69c66f1d'}}
[2025-07-19 10:01:41] INFO train_model: Feature distributions before training:
[2025-07-19 10:01:41] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4748
[2025-07-19 10:01:41] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4721
[2025-07-19 10:01:41] INFO train_model: sma_20: mean=0.5842, std=0.0158, min=0.5544, max=0.6102, unique=4719
[2025-07-19 10:01:41] INFO train_model: sma_50: mean=0.5842, std=0.0157, min=0.5560, max=0.6092, unique=4691
[2025-07-19 10:01:41] INFO train_model: sma_200: mean=0.5843, std=0.0154, min=0.5597, max=0.6067, unique=4555
[2025-07-19 10:01:41] INFO train_model: ema_12: mean=0.5842, std=0.0158, min=0.5541, max=0.6105, unique=4760
[2025-07-19 10:01:41] INFO train_model: ema_26: mean=0.5842, std=0.0157, min=0.5554, max=0.6098, unique=4760
[2025-07-19 10:01:41] INFO train_model: rsi_14: mean=49.3336, std=12.4278, min=11.3290, max=91.7839, unique=4589
[2025-07-19 10:01:41] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4735
[2025-07-19 10:01:41] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4727
[2025-07-19 10:01:41] INFO train_model: bb_high: mean=0.5866, std=0.0157, min=0.5570, max=0.6121, unique=4721
[2025-07-19 10:01:41] INFO train_model: bb_low: mean=0.5817, std=0.0160, min=0.5486, max=0.6084, unique=4721
[2025-07-19 10:01:41] INFO train_model: stoch_k: mean=49.3172, std=28.9279, min=0.0000, max=100.0000, unique=4564
[2025-07-19 10:01:41] INFO train_model: stoch_d: mean=49.3608, std=26.4954, min=2.3676, max=100.0000, unique=4718
[2025-07-19 10:01:41] INFO train_model: fib_0: mean=0.5867, std=0.0157, min=0.5573, max=0.6122, unique=811
[2025-07-19 10:01:41] INFO train_model: dist_to_fib_0: mean=-0.0025, std=0.0022, min=-0.0229, max=0.0000, unique=4285
[2025-07-19 10:01:41] INFO train_model: fib_236: mean=0.5855, std=0.0157, min=0.5560, max=0.6113, unique=2149
[2025-07-19 10:01:41] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4578
[2025-07-19 10:01:41] INFO train_model: fib_382: mean=0.5848, std=0.0157, min=0.5547, max=0.6107, unique=2149
[2025-07-19 10:01:41] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4578
[2025-07-19 10:01:41] INFO train_model: fib_500: mean=0.5842, std=0.0157, min=0.5537, max=0.6103, unique=2149
[2025-07-19 10:01:41] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4534
[2025-07-19 10:01:41] INFO train_model: fib_618: mean=0.5836, std=0.0158, min=0.5526, max=0.6098, unique=2149
[2025-07-19 10:01:41] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4578
[2025-07-19 10:01:41] INFO train_model: fib_786: mean=0.5827, std=0.0158, min=0.5511, max=0.6092, unique=2149
[2025-07-19 10:01:41] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4578
[2025-07-19 10:01:41] INFO train_model: fib_100: mean=0.5816, std=0.0159, min=0.5492, max=0.6083, unique=817
[2025-07-19 10:01:41] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4255
[2025-07-19 10:01:41] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4611
[2025-07-19 10:01:41] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4611
[2025-07-19 10:01:41] INFO train_model: trendline_up: mean=0.4624, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: trendline_down: mean=0.5235, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: breakout_high: mean=0.0137, std=0.1161, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: breakout_low: mean=0.0174, std=0.1309, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4275
[2025-07-19 10:01:41] INFO train_model: dist_to_low: mean=0.0025, std=0.0023, min=-0.0067, max=0.0157, unique=4250
[2025-07-19 10:01:41] INFO train_model: vol_spike_atr: mean=0.0153, std=0.1229, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: vol_spike_std: mean=0.1334, std=0.3400, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: is_trending: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: supply_zone: mean=0.4107, std=0.4920, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: demand_zone: mean=0.4258, std=0.4945, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: bos: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: choch: mean=0.1508, std=0.3579, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4733
[2025-07-19 10:01:41] INFO train_model: vol_cluster_high: mean=0.0746, std=0.2627, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: regime_zscore: mean=0.0097, std=1.0032, min=-7.1754, max=7.0756, unique=4657
[2025-07-19 10:01:41] INFO train_model: doji: mean=0.1025, std=0.3034, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: hammer: mean=0.0166, std=0.1278, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bullish_engulfing: mean=0.0351, std=0.1840, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bearish_engulfing: mean=0.0353, std=0.1845, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: pin_bar: mean=0.2342, std=0.4236, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bullish_engulfing_bar: mean=0.0351, std=0.1840, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bearish_engulfing_bar: mean=0.0353, std=0.1845, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: inside_bar: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: double_top: mean=0.0109, std=0.1040, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: double_bottom: mean=0.0227, std=0.1489, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: rising_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: falling_wedge: mean=0.2464, std=0.4310, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: fakeout_up: mean=0.0065, std=0.0804, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: fakeout_down: mean=0.0076, std=0.0866, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bullish_flag: mean=0.0250, std=0.1561, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bearish_flag: mean=0.0223, std=0.1476, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bullish_pennant: mean=0.1317, std=0.3382, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bearish_pennant: mean=0.1237, std=0.3293, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: morning_star: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: evening_star: mean=0.0328, std=0.1781, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0251, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: three_black_crows: mean=0.0004, std=0.0205, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bullish_harami: mean=0.0403, std=0.1968, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: bearish_harami: mean=0.0366, std=0.1877, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: dark_cloud_cover: mean=0.0769, std=0.2664, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: regime_label_bear: mean=0.5128, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: regime_label_bull: mean=0.4452, std=0.4970, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: regime_label_neutral: mean=0.0420, std=0.2006, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0410, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: market_regime_consolidation: mean=0.2134, std=0.4098, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: market_regime_downtrend: mean=0.1910, std=0.3931, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: market_regime_range: mean=0.4048, std=0.4909, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: market_regime_uptrend: mean=0.1891, std=0.3916, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:41] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:41] INFO train_model: Auditing data quality before training...
[2025-07-19 10:01:41] INFO train_model: Entering audit_data_quality
[2025-07-19 10:01:44] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 10:01:44] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 10:01:44] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 10:01:44] INFO train_model: Entering audit_data_quality
[2025-07-19 10:01:47] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:01:47] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:47] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:47] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDUSD_features.json
[2025-07-19 10:01:47] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 10:01:47] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 10:01:47] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 10:01:47] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 10:01:50] INFO train_model: Model is starting a new training session...
[2025-07-19 10:01:50] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:01:50] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 10:01:50] INFO train_model: Preparing target variable...
[2025-07-19 10:01:50] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:01:50] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:01:50] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 10:01:50] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:01:50] INFO train_model: Dropping NaN targets...
[2025-07-19 10:01:50] INFO train_model: Class balance before upsampling: {0: 3092, 1: 1634}
[2025-07-19 10:01:50] INFO train_model: Upsampling successful.
[2025-07-19 10:01:51] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:01:51] INFO train_model: Splitting train/test...
[2025-07-19 10:01:51] INFO train_model: Scaling features...
[2025-07-19 10:01:51] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:01:51] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:01:53] INFO train_model: Model fit complete.
[2025-07-19 10:01:53] INFO train_model: Model Accuracy: 0.8828
[2025-07-19 10:01:53] INFO train_model: 
Classification Report:
[2025-07-19 10:01:53] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       619
           1       0.88      0.88      0.88       618

    accuracy                           0.88      1237
   macro avg       0.88      0.88      0.88      1237
weighted avg       0.88      0.88      0.88      1237

[2025-07-19 10:01:53] INFO train_model: Model, scaler, and features saved for NZDUSD
[2025-07-19 10:01:53] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDUSD", version: "46975954b9064b2dac5cdbcbe3844bca" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDUSD', 'version': '46975954b9064b2dac5cdbcbe3844bca'}}
[2025-07-19 10:01:53] INFO train_model: Feature distributions before training:
[2025-07-19 10:01:53] INFO train_model: atr_14: mean=0.0012, std=0.0004, min=0.0000, max=0.0036, unique=4714
[2025-07-19 10:01:53] INFO train_model: volatility_20: mean=0.0013, std=0.0008, min=0.0000, max=0.0071, unique=4687
[2025-07-19 10:01:53] INFO train_model: sma_20: mean=0.5843, std=0.0157, min=0.5544, max=0.6102, unique=4691
[2025-07-19 10:01:53] INFO train_model: sma_50: mean=0.5844, std=0.0157, min=0.5560, max=0.6092, unique=4662
[2025-07-19 10:01:53] INFO train_model: sma_200: mean=0.5845, std=0.0154, min=0.5597, max=0.6067, unique=4524
[2025-07-19 10:01:53] INFO train_model: ema_12: mean=0.5843, std=0.0157, min=0.5541, max=0.6105, unique=4726
[2025-07-19 10:01:53] INFO train_model: ema_26: mean=0.5843, std=0.0157, min=0.5554, max=0.6098, unique=4726
[2025-07-19 10:01:53] INFO train_model: rsi_14: mean=49.3849, std=12.3827, min=11.3290, max=91.7839, unique=4589
[2025-07-19 10:01:53] INFO train_model: macd: mean=-0.0000, std=0.0009, min=-0.0050, max=0.0034, unique=4701
[2025-07-19 10:01:53] INFO train_model: macd_signal: mean=-0.0000, std=0.0008, min=-0.0046, max=0.0032, unique=4693
[2025-07-19 10:01:53] INFO train_model: bb_high: mean=0.5868, std=0.0156, min=0.5570, max=0.6121, unique=4693
[2025-07-19 10:01:53] INFO train_model: bb_low: mean=0.5819, std=0.0160, min=0.5486, max=0.6084, unique=4693
[2025-07-19 10:01:53] INFO train_model: stoch_k: mean=49.1792, std=28.8128, min=0.0000, max=100.0000, unique=4552
[2025-07-19 10:01:53] INFO train_model: stoch_d: mean=49.2137, std=26.3670, min=2.3676, max=99.2269, unique=4697
[2025-07-19 10:01:53] INFO train_model: fib_0: mean=0.5869, std=0.0156, min=0.5573, max=0.6122, unique=805
[2025-07-19 10:01:53] INFO train_model: dist_to_fib_0: mean=-0.0026, std=0.0022, min=-0.0229, max=0.0000, unique=4327
[2025-07-19 10:01:53] INFO train_model: fib_236: mean=0.5857, std=0.0156, min=0.5560, max=0.6113, unique=2134
[2025-07-19 10:01:53] INFO train_model: dist_to_fib_236: mean=-0.0013, std=0.0019, min=-0.0171, max=0.0031, unique=4559
[2025-07-19 10:01:53] INFO train_model: fib_382: mean=0.5849, std=0.0157, min=0.5547, max=0.6107, unique=2134
[2025-07-19 10:01:53] INFO train_model: dist_to_fib_382: mean=-0.0006, std=0.0018, min=-0.0135, max=0.0055, unique=4559
[2025-07-19 10:01:53] INFO train_model: fib_500: mean=0.5843, std=0.0157, min=0.5537, max=0.6103, unique=2134
[2025-07-19 10:01:53] INFO train_model: dist_to_fib_500: mean=0.0000, std=0.0018, min=-0.0106, max=0.0074, unique=4552
[2025-07-19 10:01:53] INFO train_model: fib_618: mean=0.5837, std=0.0157, min=0.5526, max=0.6098, unique=2134
[2025-07-19 10:01:53] INFO train_model: dist_to_fib_618: mean=0.0006, std=0.0018, min=-0.0078, max=0.0093, unique=4559
[2025-07-19 10:01:53] INFO train_model: fib_786: mean=0.5828, std=0.0158, min=0.5511, max=0.6092, unique=2134
[2025-07-19 10:01:53] INFO train_model: dist_to_fib_786: mean=0.0015, std=0.0019, min=-0.0037, max=0.0121, unique=4559
[2025-07-19 10:01:53] INFO train_model: fib_100: mean=0.5818, std=0.0159, min=0.5492, max=0.6083, unique=816
[2025-07-19 10:01:53] INFO train_model: dist_to_fib_100: mean=0.0026, std=0.0022, min=0.0000, max=0.0157, unique=4299
[2025-07-19 10:01:53] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0011, max=0.0007, unique=4623
[2025-07-19 10:01:53] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0012, max=0.0007, unique=4618
[2025-07-19 10:01:53] INFO train_model: trendline_up: mean=0.4625, std=0.4986, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: trendline_down: mean=0.5245, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: breakout_high: mean=0.0138, std=0.1165, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: breakout_low: mean=0.0176, std=0.1314, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: dist_to_high: mean=-0.0026, std=0.0023, min=-0.0229, max=0.0008, unique=4313
[2025-07-19 10:01:53] INFO train_model: dist_to_low: mean=0.0026, std=0.0023, min=-0.0067, max=0.0157, unique=4297
[2025-07-19 10:01:53] INFO train_model: vol_spike_atr: mean=0.0154, std=0.1233, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: vol_spike_std: mean=0.1344, std=0.3411, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: is_trending: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: supply_zone: mean=0.4094, std=0.4918, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: demand_zone: mean=0.4245, std=0.4943, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:01:53] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:01:53] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:01:53] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: bos: mean=0.0313, std=0.1742, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: choch: mean=0.1504, std=0.3575, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0000, max=0.0041, unique=4700
[2025-07-19 10:01:53] INFO train_model: vol_cluster_high: mean=0.0751, std=0.2636, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: regime_zscore: mean=0.0090, std=1.0066, min=-7.1754, max=7.0756, unique=4626
[2025-07-19 10:01:53] INFO train_model: doji: mean=0.0961, std=0.2947, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: hammer: mean=0.0174, std=0.1306, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bullish_engulfing: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bearish_engulfing: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: pin_bar: mean=0.2357, std=0.4245, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bullish_engulfing_bar: mean=0.0353, std=0.1846, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bearish_engulfing_bar: mean=0.0355, std=0.1852, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: inside_bar: mean=0.1126, std=0.3161, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: head_shoulders: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: inv_head_shoulders: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: double_top: mean=0.0110, std=0.1043, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: double_bottom: mean=0.0229, std=0.1494, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: rising_wedge: mean=0.2391, std=0.4266, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: falling_wedge: mean=0.2482, std=0.4320, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: fakeout_up: mean=0.0066, std=0.0807, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: fakeout_down: mean=0.0076, std=0.0870, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bullish_flag: mean=0.0250, std=0.1560, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bearish_flag: mean=0.0222, std=0.1474, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bullish_pennant: mean=0.1306, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bearish_pennant: mean=0.1242, std=0.3299, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: morning_star: mean=0.0332, std=0.1792, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: evening_star: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: three_white_soldiers: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bullish_harami: mean=0.0406, std=0.1974, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: bearish_harami: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: dark_cloud_cover: mean=0.0781, std=0.2683, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:01:53] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 10:01:53] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 10:01:53] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 10:01:53] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 10:01:53] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 10:01:53] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 10:01:53] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 10:01:53] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 10:01:53] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 10:01:53] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 10:01:53] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 10:01:53] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:01:53] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:01:53] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 10:01:53] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:01:53] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 10:01:53] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 10:01:53] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 10:01:53] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 10:01:53] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 10:01:53] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 10:01:53] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 10:01:53] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 10:01:53] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 10:01:53] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 10:01:53] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 10:01:53] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 10:01:53] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 10:01:53] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:01:53] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: regime_label_bear: mean=0.5099, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: regime_label_bull: mean=0.4477, std=0.4973, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: market_regime_choppy: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: market_regime_consolidation: mean=0.2120, std=0.4088, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: market_regime_downtrend: mean=0.1885, std=0.3912, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: market_regime_range: mean=0.4075, std=0.4914, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: market_regime_uptrend: mean=0.1902, std=0.3925, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:01:53] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:01:53] INFO train_model: Auditing data quality before training...
[2025-07-19 10:01:53] INFO train_model: Entering audit_data_quality
[2025-07-19 10:01:58] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:02:09] INFO train_model: Model is starting a new training session...
[2025-07-19 10:02:09] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:02:09] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 10:02:09] INFO train_model: Preparing target variable...
[2025-07-19 10:02:09] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:02:09] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:02:09] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 10:02:09] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:09] INFO train_model: Dropping NaN targets...
[2025-07-19 10:02:09] INFO train_model: Class balance before upsampling: {0: 3164, 1: 1564}
[2025-07-19 10:02:09] INFO train_model: Upsampling successful.
[2025-07-19 10:02:09] INFO train_model: Splitting train/test...
[2025-07-19 10:02:09] INFO train_model: Scaling features...
[2025-07-19 10:02:09] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:02:09] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:02:10] INFO train_model: Model fit complete.
[2025-07-19 10:02:10] INFO train_model: Model Accuracy: 0.8602
[2025-07-19 10:02:10] INFO train_model: 
Classification Report:
[2025-07-19 10:02:10] INFO train_model:               precision    recall  f1-score   support

           0       0.86      0.86      0.86       633
           1       0.86      0.86      0.86       633

    accuracy                           0.86      1266
   macro avg       0.86      0.86      0.86      1266
weighted avg       0.86      0.86      0.86      1266

[2025-07-19 10:02:10] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 10:02:10] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "8fd6ec8353249320693711106689a19a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "8fd6ec8353249320693711106689a19a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '8fd6ec8353249320693711106689a19a'}}
[2025-07-19 10:02:10] INFO train_model: Feature distributions before training:
[2025-07-19 10:02:10] INFO train_model: atr_14: mean=0.3453, std=0.1084, min=0.0000, max=0.8613, unique=4716
[2025-07-19 10:02:10] INFO train_model: volatility_20: mean=0.3102, std=0.1648, min=0.0681, max=1.3557, unique=4708
[2025-07-19 10:02:10] INFO train_model: sma_20: mean=162.8974, std=3.4577, min=155.8359, max=172.8918, unique=4694
[2025-07-19 10:02:10] INFO train_model: sma_50: mean=162.8657, std=3.3915, min=156.1946, max=172.5970, unique=4668
[2025-07-19 10:02:10] INFO train_model: sma_200: mean=162.7246, std=3.0692, min=156.6790, max=172.1544, unique=4525
[2025-07-19 10:02:10] INFO train_model: ema_12: mean=162.9054, std=3.4719, min=155.6248, max=172.9037, unique=4728
[2025-07-19 10:02:10] INFO train_model: ema_26: mean=162.8913, std=3.4355, min=155.9072, max=172.7909, unique=4728
[2025-07-19 10:02:10] INFO train_model: rsi_14: mean=51.0117, std=11.8290, min=16.6264, max=87.9679, unique=4701
[2025-07-19 10:02:10] INFO train_model: macd: mean=0.0142, std=0.2002, min=-0.5343, max=0.7069, unique=4703
[2025-07-19 10:02:10] INFO train_model: macd_signal: mean=0.0136, std=0.1870, min=-0.4700, max=0.6611, unique=4695
[2025-07-19 10:02:10] INFO train_model: bb_high: mean=163.5022, std=3.3752, min=156.6277, max=173.3643, unique=4708
[2025-07-19 10:02:10] INFO train_model: bb_low: mean=162.2927, std=3.5675, min=154.8377, max=172.7094, unique=4708
[2025-07-19 10:02:10] INFO train_model: stoch_k: mean=52.6172, std=26.1445, min=0.0000, max=99.4364, unique=4693
[2025-07-19 10:02:10] INFO train_model: stoch_d: mean=52.6535, std=23.9300, min=3.6709, max=96.7048, unique=4711
[2025-07-19 10:02:10] INFO train_model: fib_0: mean=163.5466, std=3.3557, min=156.7820, max=173.2420, unique=1122
[2025-07-19 10:02:10] INFO train_model: dist_to_fib_0: mean=-0.6291, std=0.4938, min=-3.4340, max=-0.0090, unique=2065
[2025-07-19 10:02:10] INFO train_model: fib_236: mean=163.2304, std=3.4000, min=156.3121, max=173.0891, unique=2150
[2025-07-19 10:02:10] INFO train_model: dist_to_fib_236: mean=-0.3129, std=0.4370, min=-2.4716, max=0.9103, unique=4694
[2025-07-19 10:02:10] INFO train_model: fib_382: mean=163.0348, std=3.4300, min=156.0214, max=172.9945, unique=2150
[2025-07-19 10:02:10] INFO train_model: dist_to_fib_382: mean=-0.1173, std=0.4216, min=-1.8762, max=1.5799, unique=4694
[2025-07-19 10:02:10] INFO train_model: fib_500: mean=162.8767, std=3.4556, min=155.7865, max=172.9180, unique=2063
[2025-07-19 10:02:10] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4218, min=-1.4335, max=2.1210, unique=3518
[2025-07-19 10:02:10] INFO train_model: fib_618: mean=162.7186, std=3.4824, min=155.5516, max=172.8415, unique=2150
[2025-07-19 10:02:10] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4334, min=-1.0813, max=2.6622, unique=4694
[2025-07-19 10:02:10] INFO train_model: fib_786: mean=162.4935, std=3.5227, min=155.2171, max=172.7327, unique=2150
[2025-07-19 10:02:10] INFO train_model: dist_to_fib_786: mean=0.4240, std=0.4677, min=-0.5798, max=3.4326, unique=4694
[2025-07-19 10:02:10] INFO train_model: fib_100: mean=162.2068, std=3.5772, min=154.7910, max=172.5940, unique=1112
[2025-07-19 10:02:10] INFO train_model: dist_to_fib_100: mean=0.7107, std=0.5355, min=0.0000, max=4.4140, unique=2178
[2025-07-19 10:02:10] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=2925
[2025-07-19 10:02:10] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=2961
[2025-07-19 10:02:10] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: trendline_down: mean=0.4719, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: dist_to_high: mean=-0.6269, std=0.5162, min=-3.4340, max=0.3400, unique=2119
[2025-07-19 10:02:10] INFO train_model: dist_to_low: mean=0.7119, std=0.5609, min=-0.9330, max=4.4140, unique=2241
[2025-07-19 10:02:10] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: vol_spike_std: mean=0.1366, std=0.3435, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: supply_zone: mean=0.4778, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: demand_zone: mean=0.4004, std=0.4900, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: choch: mean=0.1508, std=0.3579, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4708
[2025-07-19 10:02:10] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2541, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: regime_zscore: mean=-0.0079, std=0.9935, min=-6.5566, max=5.1800, unique=4628
[2025-07-19 10:02:10] INFO train_model: doji: mean=0.1199, std=0.3249, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: hammer: mean=0.0214, std=0.1446, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bearish_engulfing: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: pin_bar: mean=0.3135, std=0.4639, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bearish_engulfing_bar: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: inside_bar: mean=0.1451, std=0.3522, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: head_shoulders: mean=0.0334, std=0.1797, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: inv_head_shoulders: mean=0.0317, std=0.1753, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: rising_wedge: mean=0.2690, std=0.4435, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: falling_wedge: mean=0.2297, std=0.4207, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bullish_flag: mean=0.0231, std=0.1501, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bearish_flag: mean=0.0231, std=0.1501, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bullish_pennant: mean=0.1375, std=0.3444, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bearish_pennant: mean=0.1305, std=0.3369, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: morning_star: mean=0.0419, std=0.2003, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: evening_star: mean=0.0381, std=0.1914, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bullish_harami: mean=0.0465, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: bearish_harami: mean=0.0491, std=0.2160, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: dark_cloud_cover: mean=0.1140, std=0.3178, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: regime_label_bear: mean=0.3858, std=0.4868, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: regime_label_bull: mean=0.5719, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: market_regime_choppy: mean=0.2523, std=0.4344, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: market_regime_downtrend: mean=0.2187, std=0.4134, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: market_regime_range: mean=0.2946, std=0.4559, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: market_regime_uptrend: mean=0.2343, std=0.4236, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:10] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:10] INFO train_model: Auditing data quality before training...
[2025-07-19 10:02:10] INFO train_model: Entering audit_data_quality
[2025-07-19 10:02:14] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 10:02:14] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 10:02:14] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 10:02:14] INFO train_model: Entering audit_data_quality
[2025-07-19 10:02:18] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:02:18] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:18] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:18] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_EURJPY_features.json
[2025-07-19 10:02:18] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 10:02:18] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 10:02:18] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 10:02:18] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 10:02:21] INFO train_model: Model is starting a new training session...
[2025-07-19 10:02:21] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:02:21] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 10:02:21] INFO train_model: Preparing target variable...
[2025-07-19 10:02:21] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:02:21] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:02:21] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 10:02:21] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:21] INFO train_model: Dropping NaN targets...
[2025-07-19 10:02:21] INFO train_model: Class balance before upsampling: {0: 3158, 1: 1566}
[2025-07-19 10:02:21] INFO train_model: Upsampling successful.
[2025-07-19 10:02:21] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:02:21] INFO train_model: Splitting train/test...
[2025-07-19 10:02:21] INFO train_model: Scaling features...
[2025-07-19 10:02:21] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:02:21] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:02:23] INFO train_model: Model fit complete.
[2025-07-19 10:02:23] INFO train_model: Model Accuracy: 0.8782
[2025-07-19 10:02:23] INFO train_model: 
Classification Report:
[2025-07-19 10:02:23] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.88      0.88       632
           1       0.88      0.88      0.88       632

    accuracy                           0.88      1264
   macro avg       0.88      0.88      0.88      1264
weighted avg       0.88      0.88      0.88      1264

[2025-07-19 10:02:23] INFO train_model: Model, scaler, and features saved for EURJPY
[2025-07-19 10:02:23] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURJPY", version: "6d8690ed5b572aeaa54af22750c34057" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURJPY', 'version': '6d8690ed5b572aeaa54af22750c34057'}}
[2025-07-19 10:02:23] INFO train_model: Feature distributions before training:
[2025-07-19 10:02:23] INFO train_model: atr_14: mean=0.3453, std=0.1085, min=0.0000, max=0.8613, unique=4712
[2025-07-19 10:02:23] INFO train_model: volatility_20: mean=0.3104, std=0.1648, min=0.0681, max=1.3557, unique=4704
[2025-07-19 10:02:23] INFO train_model: sma_20: mean=162.8970, std=3.4592, min=155.8359, max=172.8918, unique=4704
[2025-07-19 10:02:23] INFO train_model: sma_50: mean=162.8653, std=3.3929, min=156.1946, max=172.5970, unique=4672
[2025-07-19 10:02:23] INFO train_model: sma_200: mean=162.7251, std=3.0704, min=156.6790, max=172.1544, unique=4521
[2025-07-19 10:02:23] INFO train_model: ema_12: mean=162.9049, std=3.4734, min=155.6248, max=172.9037, unique=4724
[2025-07-19 10:02:23] INFO train_model: ema_26: mean=162.8909, std=3.4369, min=155.9072, max=172.7909, unique=4724
[2025-07-19 10:02:23] INFO train_model: rsi_14: mean=51.0080, std=11.8331, min=16.6264, max=87.9679, unique=4699
[2025-07-19 10:02:23] INFO train_model: macd: mean=0.0142, std=0.2003, min=-0.5343, max=0.7069, unique=4699
[2025-07-19 10:02:23] INFO train_model: macd_signal: mean=0.0136, std=0.1871, min=-0.4700, max=0.6611, unique=4691
[2025-07-19 10:02:23] INFO train_model: bb_high: mean=163.5020, std=3.3766, min=156.6277, max=173.3643, unique=4704
[2025-07-19 10:02:23] INFO train_model: bb_low: mean=162.2919, std=3.5689, min=154.8377, max=172.7094, unique=4704
[2025-07-19 10:02:23] INFO train_model: stoch_k: mean=52.6125, std=26.1493, min=0.0000, max=99.4364, unique=4698
[2025-07-19 10:02:23] INFO train_model: stoch_d: mean=52.6532, std=23.9367, min=3.6709, max=96.7048, unique=4708
[2025-07-19 10:02:23] INFO train_model: fib_0: mean=163.5464, std=3.3571, min=156.7820, max=173.2420, unique=1122
[2025-07-19 10:02:23] INFO train_model: dist_to_fib_0: mean=-0.6294, std=0.4939, min=-3.4340, max=-0.0090, unique=3106
[2025-07-19 10:02:23] INFO train_model: fib_236: mean=163.2300, std=3.4014, min=156.3121, max=173.0891, unique=2150
[2025-07-19 10:02:23] INFO train_model: dist_to_fib_236: mean=-0.3131, std=0.4371, min=-2.4716, max=0.9103, unique=4693
[2025-07-19 10:02:23] INFO train_model: fib_382: mean=163.0343, std=3.4314, min=156.0214, max=172.9945, unique=2150
[2025-07-19 10:02:23] INFO train_model: dist_to_fib_382: mean=-0.1174, std=0.4217, min=-1.8762, max=1.5799, unique=4693
[2025-07-19 10:02:23] INFO train_model: fib_500: mean=162.8762, std=3.4570, min=155.7865, max=172.9180, unique=2110
[2025-07-19 10:02:23] INFO train_model: dist_to_fib_500: mean=0.0408, std=0.4220, min=-1.4335, max=2.1210, unique=4391
[2025-07-19 10:02:23] INFO train_model: fib_618: mean=162.7180, std=3.4838, min=155.5516, max=172.8415, unique=2150
[2025-07-19 10:02:23] INFO train_model: dist_to_fib_618: mean=0.1989, std=0.4336, min=-1.0813, max=2.6622, unique=4693
[2025-07-19 10:02:23] INFO train_model: fib_786: mean=162.4928, std=3.5241, min=155.2171, max=172.7327, unique=2150
[2025-07-19 10:02:23] INFO train_model: dist_to_fib_786: mean=0.4241, std=0.4679, min=-0.5798, max=3.4326, unique=4693
[2025-07-19 10:02:23] INFO train_model: fib_100: mean=162.2060, std=3.5787, min=154.7910, max=172.5940, unique=1112
[2025-07-19 10:02:23] INFO train_model: dist_to_fib_100: mean=0.7110, std=0.5356, min=0.0000, max=4.4140, unique=3220
[2025-07-19 10:02:23] INFO train_model: trendline_slope_high: mean=0.0020, std=0.0396, min=-0.1298, max=0.1927, unique=3776
[2025-07-19 10:02:23] INFO train_model: trendline_slope_low: mean=0.0020, std=0.0407, min=-0.1359, max=0.2012, unique=3825
[2025-07-19 10:02:23] INFO train_model: trendline_up: mean=0.5176, std=0.4997, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: trendline_down: mean=0.4723, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: breakout_high: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: breakout_low: mean=0.0017, std=0.0411, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: dist_to_high: mean=-0.6273, std=0.5162, min=-3.4340, max=0.3400, unique=3182
[2025-07-19 10:02:23] INFO train_model: dist_to_low: mean=0.7121, std=0.5611, min=-0.9330, max=4.4140, unique=3281
[2025-07-19 10:02:23] INFO train_model: vol_spike_atr: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: vol_spike_std: mean=0.1367, std=0.3436, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: supply_zone: mean=0.4773, std=0.4995, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: demand_zone: mean=0.4005, std=0.4901, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:23] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:23] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:23] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: choch: mean=0.1507, std=0.3578, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: vol_cluster_std: mean=0.0011, std=0.0005, min=0.0003, max=0.0036, unique=4704
[2025-07-19 10:02:23] INFO train_model: vol_cluster_high: mean=0.0694, std=0.2542, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: regime_zscore: mean=-0.0081, std=0.9939, min=-6.5566, max=5.1800, unique=4624
[2025-07-19 10:02:23] INFO train_model: doji: mean=0.1196, std=0.3245, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: hammer: mean=0.0218, std=0.1461, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bullish_engulfing: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bearish_engulfing: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: pin_bar: mean=0.3135, std=0.4640, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bullish_engulfing_bar: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bearish_engulfing_bar: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: inside_bar: mean=0.1452, std=0.3524, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: inv_head_shoulders: mean=0.0318, std=0.1754, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: double_top: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: double_bottom: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: rising_wedge: mean=0.2688, std=0.4434, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: falling_wedge: mean=0.2299, std=0.4208, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: fakeout_up: mean=0.0002, std=0.0145, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: fakeout_down: mean=0.0006, std=0.0252, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bullish_flag: mean=0.0231, std=0.1502, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bearish_flag: mean=0.0229, std=0.1495, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bullish_pennant: mean=0.1376, std=0.3445, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bearish_pennant: mean=0.1304, std=0.3368, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: morning_star: mean=0.0419, std=0.2004, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: evening_star: mean=0.0381, std=0.1915, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: three_black_crows: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bullish_harami: mean=0.0466, std=0.2107, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: bearish_harami: mean=0.0491, std=0.2161, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: dark_cloud_cover: mean=0.1143, std=0.3182, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:02:23] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 10:02:23] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 10:02:23] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 10:02:23] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 10:02:23] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 10:02:23] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 10:02:23] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 10:02:23] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 10:02:23] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 10:02:23] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 10:02:23] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 10:02:23] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:23] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:23] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:23] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:02:23] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 10:02:23] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 10:02:23] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 10:02:23] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 10:02:23] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 10:02:23] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 10:02:23] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 10:02:23] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 10:02:23] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 10:02:23] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 10:02:23] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 10:02:23] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 10:02:23] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 10:02:23] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:02:23] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: regime_label_bear: mean=0.3861, std=0.4869, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: regime_label_bull: mean=0.5715, std=0.4949, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: market_regime_choppy: mean=0.2517, std=0.4340, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: market_regime_downtrend: mean=0.2189, std=0.4135, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: market_regime_range: mean=0.2949, std=0.4560, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: market_regime_uptrend: mean=0.2345, std=0.4238, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:23] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:23] INFO train_model: Auditing data quality before training...
[2025-07-19 10:02:23] INFO train_model: Entering audit_data_quality
[2025-07-19 10:02:28] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:02:38] INFO train_model: Model is starting a new training session...
[2025-07-19 10:02:38] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:02:38] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 10:02:38] INFO train_model: Preparing target variable...
[2025-07-19 10:02:38] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:02:38] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:02:38] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 10:02:38] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:38] INFO train_model: Dropping NaN targets...
[2025-07-19 10:02:38] INFO train_model: Class balance before upsampling: {0: 3070, 1: 1660}
[2025-07-19 10:02:38] INFO train_model: Upsampling successful.
[2025-07-19 10:02:38] INFO train_model: Splitting train/test...
[2025-07-19 10:02:38] INFO train_model: Scaling features...
[2025-07-19 10:02:38] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:02:38] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:02:40] INFO train_model: Model fit complete.
[2025-07-19 10:02:40] INFO train_model: Model Accuracy: 0.8176
[2025-07-19 10:02:40] INFO train_model: 
Classification Report:
[2025-07-19 10:02:40] INFO train_model:               precision    recall  f1-score   support

           0       0.82      0.81      0.82       614
           1       0.82      0.82      0.82       614

    accuracy                           0.82      1228
   macro avg       0.82      0.82      0.82      1228
weighted avg       0.82      0.82      0.82      1228

[2025-07-19 10:02:40] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 10:02:40] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "ef37d9c4f3bb1067978918f0c2fc8a3e" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "ef37d9c4f3bb1067978918f0c2fc8a3e" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': 'ef37d9c4f3bb1067978918f0c2fc8a3e'}}
[2025-07-19 10:02:40] INFO train_model: Feature distributions before training:
[2025-07-19 10:02:40] INFO train_model: atr_14: mean=0.2434, std=0.2274, min=0.0000, max=3.8450, unique=4718
[2025-07-19 10:02:40] INFO train_model: volatility_20: mean=0.2228, std=0.2569, min=0.0393, max=3.3152, unique=4708
[2025-07-19 10:02:40] INFO train_model: sma_20: mean=87.3663, std=2.2031, min=81.5998, max=92.2272, unique=4690
[2025-07-19 10:02:40] INFO train_model: sma_50: mean=87.3741, std=2.1950, min=82.0271, max=91.9825, unique=4673
[2025-07-19 10:02:40] INFO train_model: sma_200: mean=87.4217, std=2.1959, min=83.2738, max=91.5912, unique=4523
[2025-07-19 10:02:40] INFO train_model: ema_12: mean=87.3642, std=2.2029, min=81.3860, max=92.2433, unique=4730
[2025-07-19 10:02:40] INFO train_model: ema_26: mean=87.3679, std=2.1951, min=81.7434, max=92.1009, unique=4730
[2025-07-19 10:02:40] INFO train_model: rsi_14: mean=49.9093, std=11.8533, min=11.9091, max=86.8743, unique=4690
[2025-07-19 10:02:40] INFO train_model: macd: mean=-0.0034, std=0.1378, min=-0.7910, max=1.4467, unique=4705
[2025-07-19 10:02:40] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4697
[2025-07-19 10:02:40] INFO train_model: bb_high: mean=87.8006, std=2.1258, min=82.3688, max=92.6084, unique=4708
[2025-07-19 10:02:40] INFO train_model: bb_low: mean=86.9321, std=2.3853, min=77.4303, max=92.0349, unique=4708
[2025-07-19 10:02:40] INFO train_model: stoch_k: mean=51.5854, std=26.9527, min=0.7728, max=239.4568, unique=4663
[2025-07-19 10:02:40] INFO train_model: stoch_d: mean=51.5699, std=24.5735, min=3.8824, max=173.4622, unique=4703
[2025-07-19 10:02:40] INFO train_model: fib_0: mean=87.8001, std=2.1191, min=82.4090, max=92.4600, unique=1116
[2025-07-19 10:02:40] INFO train_model: dist_to_fib_0: mean=-0.4376, std=0.4915, min=-6.7800, max=3.6535, unique=1671
[2025-07-19 10:02:40] INFO train_model: fib_236: mean=87.5874, std=2.1504, min=81.9488, max=92.3562, unique=2142
[2025-07-19 10:02:40] INFO train_model: dist_to_fib_236: mean=-0.2249, std=0.4027, min=-5.1658, max=4.4047, unique=4670
[2025-07-19 10:02:40] INFO train_model: fib_382: mean=87.4559, std=2.1751, min=81.6641, max=92.2919, unique=2142
[2025-07-19 10:02:40] INFO train_model: dist_to_fib_382: mean=-0.0933, std=0.3701, min=-4.1671, max=4.8694, unique=4670
[2025-07-19 10:02:40] INFO train_model: fib_500: mean=87.3495, std=2.1978, min=81.4340, max=92.2400, unique=2035
[2025-07-19 10:02:40] INFO train_model: dist_to_fib_500: mean=0.0130, std=0.3604, min=-3.3600, max=5.2450, unique=3141
[2025-07-19 10:02:40] INFO train_model: fib_618: mean=87.2432, std=2.2230, min=81.2039, max=92.1881, unique=2142
[2025-07-19 10:02:40] INFO train_model: dist_to_fib_618: mean=0.1194, std=0.3671, min=-2.5529, max=5.6206, unique=4670
[2025-07-19 10:02:40] INFO train_model: fib_786: mean=87.0917, std=2.2630, min=80.8763, max=92.1142, unique=2142
[2025-07-19 10:02:40] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4028, min=-1.4038, max=6.1553, unique=4670
[2025-07-19 10:02:40] INFO train_model: fib_100: mean=86.8989, std=2.3204, min=80.4530, max=92.0200, unique=1085
[2025-07-19 10:02:40] INFO train_model: dist_to_fib_100: mean=0.4636, std=0.4820, min=0.0060, max=6.8365, unique=1692
[2025-07-19 10:02:40] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0292, min=-0.2149, max=0.3140, unique=2446
[2025-07-19 10:02:40] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=2481
[2025-07-19 10:02:40] INFO train_model: trendline_up: mean=0.4907, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: trendline_down: mean=0.5013, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: breakout_high: mean=0.0025, std=0.0503, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: dist_to_high: mean=-0.4382, std=0.4963, min=-6.7220, max=3.3765, unique=1730
[2025-07-19 10:02:40] INFO train_model: dist_to_low: mean=0.4621, std=0.4922, min=-0.4180, max=6.8365, unique=1739
[2025-07-19 10:02:40] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0981, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: vol_spike_std: mean=0.1292, std=0.3354, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: is_trending: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: supply_zone: mean=0.4142, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: demand_zone: mean=0.3778, std=0.4849, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: bos: mean=0.0034, std=0.0581, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: choch: mean=0.1567, std=0.3635, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4709
[2025-07-19 10:02:40] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2418, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: regime_zscore: mean=-0.0102, std=1.0094, min=-7.2839, max=9.1570, unique=4630
[2025-07-19 10:02:40] INFO train_model: doji: mean=0.1233, std=0.3288, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: hammer: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2284, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: pin_bar: mean=0.3021, std=0.4592, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2284, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2097, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: inside_bar: mean=0.1408, std=0.3479, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: head_shoulders: mean=0.0330, std=0.1786, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: inv_head_shoulders: mean=0.0304, std=0.1718, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: double_top: mean=0.0032, std=0.0562, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: double_bottom: mean=0.0021, std=0.0459, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: rising_wedge: mean=0.2704, std=0.4442, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: falling_wedge: mean=0.2630, std=0.4403, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bullish_flag: mean=0.0245, std=0.1547, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bearish_flag: mean=0.0290, std=0.1677, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bullish_pennant: mean=0.1317, std=0.3382, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bearish_pennant: mean=0.1180, std=0.3226, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: morning_star: mean=0.0429, std=0.2027, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: evening_star: mean=0.0366, std=0.1877, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: bullish_harami: mean=0.0471, std=0.2120, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: bearish_harami: mean=0.0507, std=0.2195, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: dark_cloud_cover: mean=0.1110, std=0.3142, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: regime_label_bear: mean=0.4302, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: regime_label_bull: mean=0.5275, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: market_regime_choppy: mean=0.2907, std=0.4541, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: market_regime_downtrend: mean=0.2364, std=0.4249, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: market_regime_range: mean=0.2882, std=0.4530, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: market_regime_uptrend: mean=0.1848, std=0.3882, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:40] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:40] INFO train_model: Auditing data quality before training...
[2025-07-19 10:02:40] INFO train_model: Entering audit_data_quality
[2025-07-19 10:02:43] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 10:02:43] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 10:02:43] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 10:02:43] INFO train_model: Entering audit_data_quality
[2025-07-19 10:02:46] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:02:46] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:46] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:46] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_NZDJPY_features.json
[2025-07-19 10:02:46] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 10:02:46] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 10:02:46] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 10:02:46] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 10:02:49] INFO train_model: Model is starting a new training session...
[2025-07-19 10:02:49] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:02:49] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 10:02:49] INFO train_model: Preparing target variable...
[2025-07-19 10:02:49] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:02:49] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:02:49] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 10:02:49] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:02:49] INFO train_model: Dropping NaN targets...
[2025-07-19 10:02:49] INFO train_model: Class balance before upsampling: {0: 3067, 1: 1657}
[2025-07-19 10:02:49] INFO train_model: Upsampling successful.
[2025-07-19 10:02:49] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:02:49] INFO train_model: Splitting train/test...
[2025-07-19 10:02:49] INFO train_model: Scaling features...
[2025-07-19 10:02:49] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:02:49] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:02:52] INFO train_model: Model fit complete.
[2025-07-19 10:02:52] INFO train_model: Model Accuracy: 0.8419
[2025-07-19 10:02:52] INFO train_model: 
Classification Report:
[2025-07-19 10:02:52] INFO train_model:               precision    recall  f1-score   support

           0       0.84      0.85      0.84       614
           1       0.84      0.84      0.84       613

    accuracy                           0.84      1227
   macro avg       0.84      0.84      0.84      1227
weighted avg       0.84      0.84      0.84      1227

[2025-07-19 10:02:52] INFO train_model: Model, scaler, and features saved for NZDJPY
[2025-07-19 10:02:52] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_NZDJPY", version: "81cb0af832d014abc50b04a59db67ee5" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_NZDJPY', 'version': '81cb0af832d014abc50b04a59db67ee5'}}
[2025-07-19 10:02:52] INFO train_model: Feature distributions before training:
[2025-07-19 10:02:52] INFO train_model: atr_14: mean=0.2435, std=0.2275, min=0.0000, max=3.8450, unique=4712
[2025-07-19 10:02:52] INFO train_model: volatility_20: mean=0.2228, std=0.2570, min=0.0393, max=3.3152, unique=4702
[2025-07-19 10:02:52] INFO train_model: sma_20: mean=87.3666, std=2.2038, min=81.5998, max=92.2272, unique=4701
[2025-07-19 10:02:52] INFO train_model: sma_50: mean=87.3744, std=2.1956, min=82.0271, max=91.9825, unique=4673
[2025-07-19 10:02:52] INFO train_model: sma_200: mean=87.4223, std=2.1965, min=83.2738, max=91.5912, unique=4521
[2025-07-19 10:02:52] INFO train_model: ema_12: mean=87.3644, std=2.2035, min=81.3860, max=92.2433, unique=4724
[2025-07-19 10:02:52] INFO train_model: ema_26: mean=87.3681, std=2.1958, min=81.7434, max=92.1009, unique=4724
[2025-07-19 10:02:52] INFO train_model: rsi_14: mean=49.9041, std=11.8518, min=11.9091, max=86.8743, unique=4685
[2025-07-19 10:02:52] INFO train_model: macd: mean=-0.0035, std=0.1378, min=-0.7910, max=1.4467, unique=4699
[2025-07-19 10:02:52] INFO train_model: macd_signal: mean=-0.0039, std=0.1245, min=-0.6881, max=0.9530, unique=4691
[2025-07-19 10:02:52] INFO train_model: bb_high: mean=87.8010, std=2.1265, min=82.3688, max=92.6084, unique=4703
[2025-07-19 10:02:52] INFO train_model: bb_low: mean=86.9322, std=2.3861, min=77.4303, max=92.0349, unique=4703
[2025-07-19 10:02:52] INFO train_model: stoch_k: mean=51.5672, std=26.9451, min=0.7728, max=239.4568, unique=4672
[2025-07-19 10:02:52] INFO train_model: stoch_d: mean=51.5617, std=24.5719, min=3.8824, max=173.4622, unique=4698
[2025-07-19 10:02:52] INFO train_model: fib_0: mean=87.8005, std=2.1197, min=82.4090, max=92.4600, unique=1115
[2025-07-19 10:02:52] INFO train_model: dist_to_fib_0: mean=-0.4378, std=0.4917, min=-6.7800, max=3.6535, unique=2675
[2025-07-19 10:02:52] INFO train_model: fib_236: mean=87.5878, std=2.1510, min=81.9488, max=92.3562, unique=2140
[2025-07-19 10:02:52] INFO train_model: dist_to_fib_236: mean=-0.2251, std=0.4029, min=-5.1658, max=4.4047, unique=4668
[2025-07-19 10:02:52] INFO train_model: fib_382: mean=87.4561, std=2.1757, min=81.6641, max=92.2919, unique=2140
[2025-07-19 10:02:52] INFO train_model: dist_to_fib_382: mean=-0.0935, std=0.3702, min=-4.1671, max=4.8694, unique=4668
[2025-07-19 10:02:52] INFO train_model: fib_500: mean=87.3498, std=2.1984, min=81.4340, max=92.2400, unique=2084
[2025-07-19 10:02:52] INFO train_model: dist_to_fib_500: mean=0.0129, std=0.3606, min=-3.3600, max=5.2450, unique=4266
[2025-07-19 10:02:52] INFO train_model: fib_618: mean=87.2434, std=2.2236, min=81.2039, max=92.1881, unique=2140
[2025-07-19 10:02:52] INFO train_model: dist_to_fib_618: mean=0.1193, std=0.3673, min=-2.5529, max=5.6206, unique=4667
[2025-07-19 10:02:52] INFO train_model: fib_786: mean=87.0919, std=2.2636, min=80.8763, max=92.1142, unique=2140
[2025-07-19 10:02:52] INFO train_model: dist_to_fib_786: mean=0.2708, std=0.4030, min=-1.4038, max=6.1553, unique=4667
[2025-07-19 10:02:52] INFO train_model: fib_100: mean=86.8990, std=2.3210, min=80.4530, max=92.0200, unique=1084
[2025-07-19 10:02:52] INFO train_model: dist_to_fib_100: mean=0.4637, std=0.4822, min=0.0060, max=6.8365, unique=2743
[2025-07-19 10:02:52] INFO train_model: trendline_slope_high: mean=-0.0004, std=0.0293, min=-0.2149, max=0.3140, unique=3389
[2025-07-19 10:02:52] INFO train_model: trendline_slope_low: mean=-0.0004, std=0.0330, min=-0.2838, max=0.3242, unique=3454
[2025-07-19 10:02:52] INFO train_model: trendline_up: mean=0.4905, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: trendline_down: mean=0.5015, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: breakout_high: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: breakout_low: mean=0.0008, std=0.0291, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: dist_to_high: mean=-0.4384, std=0.4965, min=-6.7220, max=3.3765, unique=2743
[2025-07-19 10:02:52] INFO train_model: dist_to_low: mean=0.4621, std=0.4924, min=-0.4180, max=6.8365, unique=2785
[2025-07-19 10:02:52] INFO train_model: vol_spike_atr: mean=0.0097, std=0.0982, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: vol_spike_std: mean=0.1293, std=0.3356, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: is_trending: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: supply_zone: mean=0.4138, std=0.4926, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: demand_zone: mean=0.3781, std=0.4850, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:52] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:52] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:52] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: bos: mean=0.0030, std=0.0544, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: choch: mean=0.1564, std=0.3633, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: vol_cluster_std: mean=0.0016, std=0.0031, min=0.0004, max=0.0435, unique=4704
[2025-07-19 10:02:52] INFO train_model: vol_cluster_high: mean=0.0624, std=0.2420, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: regime_zscore: mean=-0.0107, std=1.0098, min=-7.2839, max=9.1570, unique=4624
[2025-07-19 10:02:52] INFO train_model: doji: mean=0.1228, std=0.3282, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: hammer: mean=0.0220, std=0.1467, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bullish_engulfing: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bearish_engulfing: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: pin_bar: mean=0.3027, std=0.4595, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bullish_engulfing_bar: mean=0.0552, std=0.2285, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bearish_engulfing_bar: mean=0.0461, std=0.2098, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: inside_bar: mean=0.1410, std=0.3480, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: head_shoulders: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: inv_head_shoulders: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: double_top: mean=0.0032, std=0.0563, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: double_bottom: mean=0.0021, std=0.0460, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: rising_wedge: mean=0.2699, std=0.4440, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: falling_wedge: mean=0.2631, std=0.4404, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: fakeout_up: mean=0.0011, std=0.0325, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bullish_flag: mean=0.0246, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bearish_flag: mean=0.0288, std=0.1672, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bullish_pennant: mean=0.1319, std=0.3384, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bearish_pennant: mean=0.1179, std=0.3225, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: morning_star: mean=0.0430, std=0.2028, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: evening_star: mean=0.0366, std=0.1879, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: bullish_harami: mean=0.0472, std=0.2121, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: bearish_harami: mean=0.0508, std=0.2196, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: dark_cloud_cover: mean=0.1113, std=0.3146, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8252, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:02:52] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4670
[2025-07-19 10:02:52] INFO train_model: sma_50_4h: mean=1.0901, std=0.0458, min=1.0239, max=1.1794, unique=4646
[2025-07-19 10:02:52] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4724
[2025-07-19 10:02:52] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4724
[2025-07-19 10:02:52] INFO train_model: rsi_14_4h: mean=51.1067, std=32.5782, min=0.0000, max=100.0000, unique=1782
[2025-07-19 10:02:52] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4724
[2025-07-19 10:02:52] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4724
[2025-07-19 10:02:52] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4672
[2025-07-19 10:02:52] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4672
[2025-07-19 10:02:52] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4709
[2025-07-19 10:02:52] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4662
[2025-07-19 10:02:52] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:52] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:52] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4724, 2)
[2025-07-19 10:02:52] INFO train_model: structure_trend_4h: mean=0.8163, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:02:52] INFO train_model: sma_20_1d: mean=1.0896, std=0.0460, min=1.0244, max=1.1806, unique=3910
[2025-07-19 10:02:52] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4654
[2025-07-19 10:02:52] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4724
[2025-07-19 10:02:52] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4724
[2025-07-19 10:02:52] INFO train_model: rsi_14_1d: mean=47.2693, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4724
[2025-07-19 10:02:52] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4724
[2025-07-19 10:02:52] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 10:02:52] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 10:02:52] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 10:02:52] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 10:02:52] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 10:02:52] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4654
[2025-07-19 10:02:52] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4654
[2025-07-19 10:02:52] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2835, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:02:52] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: regime_label_bear: mean=0.4308, std=0.4952, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: regime_label_bull: mean=0.5269, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2014, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: market_regime_choppy: mean=0.2904, std=0.4540, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: market_regime_downtrend: mean=0.2367, std=0.4251, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: market_regime_range: mean=0.2887, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: market_regime_uptrend: mean=0.1842, std=0.3877, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:02:52] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:02:52] INFO train_model: Auditing data quality before training...
[2025-07-19 10:02:52] INFO train_model: Entering audit_data_quality
[2025-07-19 10:02:57] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:03:14] INFO train_model: Model is starting a new training session...
[2025-07-19 10:03:14] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:03:14] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 10:03:14] INFO train_model: Preparing target variable...
[2025-07-19 10:03:14] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:03:14] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:03:14] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 10:03:14] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:03:14] INFO train_model: Dropping NaN targets...
[2025-07-19 10:03:14] INFO train_model: Class balance before upsampling: {0: 4715, 1: 4030}
[2025-07-19 10:03:14] INFO train_model: Upsampling successful.
[2025-07-19 10:03:14] INFO train_model: Splitting train/test...
[2025-07-19 10:03:14] INFO train_model: Scaling features...
[2025-07-19 10:03:14] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:03:14] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:03:15] INFO train_model: Model fit complete.
[2025-07-19 10:03:15] INFO train_model: Model Accuracy: 0.7545
[2025-07-19 10:03:15] INFO train_model: 
Classification Report:
[2025-07-19 10:03:15] INFO train_model:               precision    recall  f1-score   support

           0       0.77      0.73      0.75       943
           1       0.74      0.78      0.76       943

    accuracy                           0.75      1886
   macro avg       0.76      0.75      0.75      1886
weighted avg       0.76      0.75      0.75      1886

[2025-07-19 10:03:15] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 10:03:15] INFO train_model: Model registered in ModelRegistry for BTCUSD, version 0db65f379d2791c379598319f6aeaa21
[2025-07-19 10:03:15] INFO train_model: Feature distributions before training:
[2025-07-19 10:03:15] INFO train_model: atr_14: mean=663.2938, std=308.2912, min=0.0000, max=2432.8175, unique=8733
[2025-07-19 10:03:15] INFO train_model: volatility_20: mean=672.6243, std=490.0500, min=61.2969, max=3956.2747, unique=8726
[2025-07-19 10:03:15] INFO train_model: sma_20: mean=86648.9565, std=17657.1323, min=53086.6750, max=121103.9988, unique=8726
[2025-07-19 10:03:15] INFO train_model: sma_50: mean=86560.7996, std=17599.1659, min=54150.0817, max=119557.6389, unique=8696
[2025-07-19 10:03:15] INFO train_model: sma_200: mean=86115.8594, std=17318.6413, min=56019.7319, max=118481.7440, unique=8545
[2025-07-19 10:03:15] INFO train_model: ema_12: mean=86672.2703, std=17666.8051, min=52717.5253, max=121438.5343, unique=8745
[2025-07-19 10:03:15] INFO train_model: ema_26: mean=86630.8287, std=17635.0827, min=54289.5561, max=120532.2026, unique=8745
[2025-07-19 10:03:15] INFO train_model: rsi_14: mean=51.1728, std=11.8523, min=12.9206, max=90.2253, unique=8732
[2025-07-19 10:03:15] INFO train_model: macd: mean=41.8034, std=478.9586, min=-2308.6514, max=2409.3781, unique=8720
[2025-07-19 10:03:15] INFO train_model: macd_signal: mean=41.7981, std=447.7678, min=-2026.1798, max=2004.6298, unique=8712
[2025-07-19 10:03:15] INFO train_model: bb_high: mean=87960.1427, std=17826.4639, min=54657.4325, max=123631.2152, unique=8726
[2025-07-19 10:03:15] INFO train_model: bb_low: mean=85337.7704, std=17538.2712, min=48580.8019, max=119063.2808, unique=8726
[2025-07-19 10:03:15] INFO train_model: stoch_k: mean=52.4691, std=26.6081, min=0.0000, max=100.0000, unique=8698
[2025-07-19 10:03:15] INFO train_model: stoch_d: mean=52.4798, std=23.9439, min=2.7373, max=97.8432, unique=8730
[2025-07-19 10:03:15] INFO train_model: fib_0: mean=88010.3149, std=17823.0489, min=54452.7734, max=123077.6328, unique=2137
[2025-07-19 10:03:15] INFO train_model: dist_to_fib_0: mean=-1303.8152, std=1231.4798, min=-10522.6016, max=0.0000, unique=8623
[2025-07-19 10:03:15] INFO train_model: fib_236: mean=87349.5457, std=17739.9195, min=54022.4864, max=122164.0787, unique=3952
[2025-07-19 10:03:15] INFO train_model: dist_to_fib_236: mean=-643.0460, std=1025.9123, min=-7889.1863, max=2479.4287, unique=8726
[2025-07-19 10:03:15] INFO train_model: fib_382: mean=86940.7648, std=17692.8456, min=53222.5085, max=121598.9138, unique=3952
[2025-07-19 10:03:15] INFO train_model: dist_to_fib_382: mean=-234.2651, std=962.4813, min=-6260.0396, max=4013.8442, unique=8725
[2025-07-19 10:03:15] INFO train_model: fib_500: mean=86610.3803, std=17657.2537, min=52526.8008, max=121142.1367, unique=3952
[2025-07-19 10:03:15] INFO train_model: dist_to_fib_500: mean=96.1195, std=956.2088, min=-4943.3320, max=5253.9883, unique=8683
[2025-07-19 10:03:15] INFO train_model: fib_618: mean=86279.9957, std=17623.8702, min=51831.0931, max=120685.3596, unique=3952
[2025-07-19 10:03:15] INFO train_model: dist_to_fib_618: mean=426.5040, std=991.2960, min=-3626.6244, max=6494.1323, unique=8726
[2025-07-19 10:03:15] INFO train_model: fib_786: mean=85809.6176, std=17580.1760, min=50840.5939, max=120035.0330, unique=3952
[2025-07-19 10:03:15] INFO train_model: dist_to_fib_786: mean=896.8821, std=1103.9101, min=-1889.2530, max=8259.7611, unique=8726
[2025-07-19 10:03:15] INFO train_model: fib_100: mean=85210.4456, std=17531.0899, min=49578.8867, max=119206.6406, unique=2226
[2025-07-19 10:03:15] INFO train_model: dist_to_fib_100: mean=1496.0541, std=1324.7986, min=0.0000, max=10508.8359, unique=8620
[2025-07-19 10:03:15] INFO train_model: trendline_slope_high: mean=5.6492, std=94.1233, min=-488.7707, max=449.7492, unique=8686
[2025-07-19 10:03:15] INFO train_model: trendline_slope_low: mean=5.6563, std=96.8747, min=-554.4365, max=479.1137, unique=8687
[2025-07-19 10:03:15] INFO train_model: trendline_up: mean=0.5130, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: trendline_down: mean=0.4662, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: breakout_high: mean=0.0111, std=0.1047, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: breakout_low: mean=0.0117, std=0.1074, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: dist_to_high: mean=-1298.2369, std=1276.1604, min=-10522.6016, max=359.2578, unique=8656
[2025-07-19 10:03:15] INFO train_model: dist_to_low: mean=1499.9535, std=1378.8966, min=-408.2344, max=10508.8359, unique=8662
[2025-07-19 10:03:15] INFO train_model: vol_spike_atr: mean=0.0324, std=0.1770, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: vol_spike_std: mean=0.1660, std=0.3721, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: is_trending: mean=0.0228, std=0.1491, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: supply_zone: mean=0.2072, std=0.4053, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: demand_zone: mean=0.1775, std=0.3821, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: bos: mean=0.0228, std=0.1491, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: choch: mean=0.1597, std=0.3664, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: vol_cluster_std: mean=0.0047, std=0.0026, min=0.0006, max=0.0222, unique=8725
[2025-07-19 10:03:15] INFO train_model: vol_cluster_high: mean=0.1310, std=0.3375, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: regime_zscore: mean=0.0012, std=1.0151, min=-6.5962, max=6.9376, unique=8645
[2025-07-19 10:03:15] INFO train_model: doji: mean=0.0812, std=0.2731, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: hammer: mean=0.0269, std=0.1617, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bullish_engulfing: mean=0.0533, std=0.2246, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bearish_engulfing: mean=0.0580, std=0.2337, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: pin_bar: mean=0.2329, std=0.4227, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bullish_engulfing_bar: mean=0.0533, std=0.2246, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bearish_engulfing_bar: mean=0.0580, std=0.2337, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: inside_bar: mean=0.1472, std=0.3543, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: head_shoulders: mean=0.0337, std=0.1806, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: inv_head_shoulders: mean=0.0330, std=0.1788, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: rising_wedge: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: falling_wedge: mean=0.2516, std=0.4339, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: fakeout_up: mean=0.0056, std=0.0746, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: fakeout_down: mean=0.0069, std=0.0826, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bullish_flag: mean=0.0261, std=0.1594, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bearish_flag: mean=0.0257, std=0.1583, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bullish_pennant: mean=0.1417, std=0.3487, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bearish_pennant: mean=0.1320, std=0.3385, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: morning_star: mean=0.0362, std=0.1869, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: evening_star: mean=0.0369, std=0.1886, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: bullish_harami: mean=0.0629, std=0.2428, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: bearish_harami: mean=0.0597, std=0.2369, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: dark_cloud_cover: mean=0.1134, std=0.3171, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: regime_label_bear: mean=0.3951, std=0.4889, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: regime_label_bull: mean=0.5820, std=0.4933, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: regime_label_neutral: mean=0.0229, std=0.1495, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: market_regime_choppy: mean=0.2252, std=0.4177, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: market_regime_downtrend: mean=0.2751, std=0.4466, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: market_regime_range: mean=0.2156, std=0.4112, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: market_regime_uptrend: mean=0.2842, std=0.4510, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:15] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:15] INFO train_model: Auditing data quality before training...
[2025-07-19 10:03:15] INFO train_model: Entering audit_data_quality
[2025-07-19 10:03:20] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: is_ranging
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: price_vs_sma20_4h
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: price_vs_sma50_4h
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: trend_strength_4h
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: news_sentiment
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: fib_levels
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: wyckoff_phases
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: wyckoff_accumulation
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: wyckoff_distribution
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: wyckoff_markup
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: wyckoff_markdown
[2025-07-19 10:03:20] WARNING train_model: Removing constant feature: wyckoff_unknown
[2025-07-19 10:03:20] INFO train_model: Auditing data quality after removing constant features...
[2025-07-19 10:03:20] INFO train_model: Entering audit_data_quality
[2025-07-19 10:03:25] INFO train_model: Exiting audit_data_quality
[2025-07-19 10:03:25] WARNING train_model: [Feature Consistency] Features in training data but not in feature_cols: ['is_ranging', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'fib_levels', 'wyckoff_phases', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:03:25] INFO train_model: [DEBUG] About to save feature columns: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:03:25] INFO train_model: [DEBUG] Feature columns saved to models/saved_models/signal_model_BTCUSD_features.json
[2025-07-19 10:03:25] INFO train_model: Model is engineering features and studying candlestick patterns...
[2025-07-19 10:03:25] WARNING train_model: CalibratedClassifierCV has no base_estimator_ attribute after fitting.
[2025-07-19 10:03:25] INFO train_model: Model is analyzing feature importance and explainability (SHAP)...
[2025-07-19 10:03:25] INFO train_model: Model training complete! Ready for new predictions.
[2025-07-19 10:03:31] INFO train_model: Model is starting a new training session...
[2025-07-19 10:03:31] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 10:03:31] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'trend_strength_1d', 'structure_trend_1d', 'fib_levels',
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=123)
[2025-07-19 10:03:31] INFO train_model: Preparing target variable...
[2025-07-19 10:03:31] INFO train_model: Entering prepare_target_variable
[2025-07-19 10:03:31] INFO train_model: Exiting prepare_target_variable
[2025-07-19 10:03:31] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object', length=125)
[2025-07-19 10:03:31] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 10:03:31] INFO train_model: Dropping NaN targets...
[2025-07-19 10:03:31] INFO train_model: Class balance before upsampling: {0: 2414, 1: 2311}
[2025-07-19 10:03:31] INFO train_model: Upsampling successful.
[2025-07-19 10:03:32] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 10:03:32] INFO train_model: Splitting train/test...
[2025-07-19 10:03:32] INFO train_model: Scaling features...
[2025-07-19 10:03:32] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 10:03:32] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 10:03:36] INFO train_model: Model fit complete.
[2025-07-19 10:03:36] INFO train_model: Model Accuracy: 0.8313
[2025-07-19 10:03:36] INFO train_model: 
Classification Report:
[2025-07-19 10:03:36] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.83      0.83       483
           1       0.83      0.83      0.83       483

    accuracy                           0.83       966
   macro avg       0.83      0.83      0.83       966
weighted avg       0.83      0.83      0.83       966

[2025-07-19 10:03:36] INFO train_model: Model, scaler, and features saved for BTCUSD
[2025-07-19 10:03:36] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "4b5adf75f8cb2c49db2ead2ba5f2fc73" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_BTCUSD", version: "4b5adf75f8cb2c49db2ead2ba5f2fc73" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_BTCUSD', 'version': '4b5adf75f8cb2c49db2ead2ba5f2fc73'}}
[2025-07-19 10:03:36] INFO train_model: Feature distributions before training:
[2025-07-19 10:03:36] INFO train_model: atr_14: mean=790.2925, std=316.4131, min=248.5360, max=2432.8175, unique=4725
[2025-07-19 10:03:36] INFO train_model: volatility_20: mean=826.8249, std=533.2637, min=141.7903, max=3956.2747, unique=4725
[2025-07-19 10:03:36] INFO train_model: sma_20: mean=94356.7082, std=12268.7071, min=62628.1240, max=121103.9988, unique=4725
[2025-07-19 10:03:36] INFO train_model: sma_50: mean=94197.6233, std=12256.8055, min=62799.2954, max=119557.6389, unique=4725
[2025-07-19 10:03:36] INFO train_model: sma_200: mean=93600.1157, std=12291.7664, min=62183.0844, max=118218.3794, unique=4724
[2025-07-19 10:03:36] INFO train_model: ema_12: mean=94411.1552, std=12263.4838, min=62644.2626, max=121438.5343, unique=4725
[2025-07-19 10:03:36] INFO train_model: ema_26: mean=94330.8663, std=12247.0436, min=62673.5403, max=120532.2026, unique=4725
[2025-07-19 10:03:36] INFO train_model: rsi_14: mean=52.2288, std=12.4379, min=12.9206, max=90.2253, unique=4725
[2025-07-19 10:03:36] INFO train_model: macd: mean=80.2889, std=560.5874, min=-1881.4601, max=2409.3781, unique=4725
[2025-07-19 10:03:36] INFO train_model: macd_signal: mean=76.0059, std=522.8613, min=-1668.9823, max=2004.6298, unique=4725
[2025-07-19 10:03:36] INFO train_model: bb_high: mean=95968.4866, std=12347.6445, min=63008.0505, max=123631.2152, unique=4725
[2025-07-19 10:03:36] INFO train_model: bb_low: mean=92744.9299, std=12277.5908, min=61485.6176, max=119063.2808, unique=4725
[2025-07-19 10:03:36] INFO train_model: stoch_k: mean=53.8668, std=27.2018, min=0.0000, max=100.0000, unique=4708
[2025-07-19 10:03:36] INFO train_model: stoch_d: mean=53.9087, std=24.5302, min=4.8709, max=97.8432, unique=4725
[2025-07-19 10:03:36] INFO train_model: fib_0: mean=96011.1458, std=12315.0639, min=63086.8359, max=123077.6328, unique=1209
[2025-07-19 10:03:36] INFO train_model: dist_to_fib_0: mean=-1525.7156, std=1389.9513, min=-10522.6016, max=0.0000, unique=4700
[2025-07-19 10:03:36] INFO train_model: fib_236: mean=95207.3054, std=12281.0821, min=62841.1609, max=122164.0787, unique=2197
[2025-07-19 10:03:36] INFO train_model: dist_to_fib_236: mean=-721.8751, std=1190.5630, min=-7889.1863, max=2479.4287, unique=4725
[2025-07-19 10:03:36] INFO train_model: fib_382: mean=94710.0142, std=12267.2667, min=62689.1754, max=121598.9138, unique=2197
[2025-07-19 10:03:36] INFO train_model: dist_to_fib_382: mean=-224.5840, std=1130.0725, min=-6260.0396, max=4013.8442, unique=4724
[2025-07-19 10:03:36] INFO train_model: fib_500: mean=94308.0940, std=12260.1433, min=62566.3379, max=121142.1367, unique=2197
[2025-07-19 10:03:36] INFO train_model: dist_to_fib_500: mean=177.3363, std=1123.8300, min=-4943.3320, max=5253.9883, unique=4708
[2025-07-19 10:03:36] INFO train_model: fib_618: mean=93906.1737, std=12256.6406, min=62443.5004, max=120685.3596, unique=2197
[2025-07-19 10:03:36] INFO train_model: dist_to_fib_618: mean=579.2565, std=1156.6193, min=-3626.6244, max=6494.1323, unique=4725
[2025-07-19 10:03:36] INFO train_model: fib_786: mean=93333.9483, std=12257.9063, min=62268.6130, max=120035.0330, unique=2197
[2025-07-19 10:03:36] INFO train_model: dist_to_fib_786: mean=1151.4819, std=1263.9286, min=-1751.9899, max=8259.7611, unique=4725
[2025-07-19 10:03:36] INFO train_model: fib_100: mean=92605.0421, std=12270.1504, min=62045.8398, max=119206.6406, unique=1276
[2025-07-19 10:03:36] INFO train_model: dist_to_fib_100: mean=1880.3881, std=1479.5901, min=0.0000, max=10508.8359, unique=4692
[2025-07-19 10:03:36] INFO train_model: trendline_slope_high: mean=12.6293, std=110.5220, min=-488.7707, max=418.4305, unique=4710
[2025-07-19 10:03:36] INFO train_model: trendline_slope_low: mean=11.3012, std=113.7325, min=-487.6711, max=479.1137, unique=4719
[2025-07-19 10:03:36] INFO train_model: trendline_up: mean=0.5517, std=0.4974, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: trendline_down: mean=0.4415, std=0.4966, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: breakout_high: mean=0.0129, std=0.1129, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: breakout_low: mean=0.0131, std=0.1138, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: dist_to_high: mean=-1509.4770, std=1448.7133, min=-10522.6016, max=359.2578, unique=4702
[2025-07-19 10:03:36] INFO train_model: dist_to_low: mean=1889.9598, std=1544.1018, min=-408.2344, max=10508.8359, unique=4706
[2025-07-19 10:03:36] INFO train_model: vol_spike_atr: mean=0.0372, std=0.1894, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: vol_spike_std: mean=0.1793, std=0.3836, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: is_trending: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: supply_zone: mean=0.2180, std=0.4129, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: demand_zone: mean=0.1583, std=0.3651, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 10:03:36] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 10:03:36] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 10:03:36] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: bos: mean=0.0260, std=0.1592, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: choch: mean=0.1547, std=0.3617, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: vol_cluster_std: mean=0.0052, std=0.0026, min=0.0011, max=0.0169, unique=4725
[2025-07-19 10:03:36] INFO train_model: vol_cluster_high: mean=0.1850, std=0.3883, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: regime_zscore: mean=0.0070, std=1.1316, min=-5.7567, max=6.9376, unique=4725
[2025-07-19 10:03:36] INFO train_model: doji: mean=0.0804, std=0.2720, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: hammer: mean=0.0241, std=0.1535, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bullish_engulfing: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bearish_engulfing: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: pin_bar: mean=0.2360, std=0.4247, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bullish_engulfing_bar: mean=0.0559, std=0.2297, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bearish_engulfing_bar: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: inside_bar: mean=0.1407, std=0.3478, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: head_shoulders: mean=0.0334, std=0.1798, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: double_bottom: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: rising_wedge: mean=0.2506, std=0.4334, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: falling_wedge: mean=0.2595, std=0.4384, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: fakeout_up: mean=0.0057, std=0.0754, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: fakeout_down: mean=0.0083, std=0.0905, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bullish_flag: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bearish_flag: mean=0.0267, std=0.1611, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bullish_pennant: mean=0.1308, std=0.3372, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bearish_pennant: mean=0.1255, std=0.3313, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: morning_star: mean=0.0394, std=0.1945, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: evening_star: mean=0.0383, std=0.1920, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: bullish_harami: mean=0.0603, std=0.2381, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: bearish_harami: mean=0.0590, std=0.2357, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: dark_cloud_cover: mean=0.1122, std=0.3156, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:03:36] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4671
[2025-07-19 10:03:36] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4647
[2025-07-19 10:03:36] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4725
[2025-07-19 10:03:36] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4725
[2025-07-19 10:03:36] INFO train_model: rsi_14_4h: mean=51.1047, std=32.5781, min=0.0000, max=100.0000, unique=1783
[2025-07-19 10:03:36] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4725
[2025-07-19 10:03:36] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4725
[2025-07-19 10:03:36] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4673
[2025-07-19 10:03:36] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4673
[2025-07-19 10:03:36] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4710
[2025-07-19 10:03:36] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4663
[2025-07-19 10:03:36] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 10:03:36] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 10:03:36] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4725, 2)
[2025-07-19 10:03:36] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:03:36] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 10:03:36] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4655
[2025-07-19 10:03:36] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4725
[2025-07-19 10:03:36] INFO train_model: ema_26_1d: mean=1.0891, std=0.0496, min=0.0000, max=1.1801, unique=4725
[2025-07-19 10:03:36] INFO train_model: rsi_14_1d: mean=47.2804, std=49.9313, min=0.0000, max=100.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4725
[2025-07-19 10:03:36] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4725
[2025-07-19 10:03:36] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 10:03:36] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 10:03:36] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 10:03:36] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 10:03:36] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 10:03:36] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4655
[2025-07-19 10:03:36] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4655
[2025-07-19 10:03:36] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 10:03:36] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: regime_label_bear: mean=0.3926, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: regime_label_bull: mean=0.6074, std=0.4884, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: market_regime_choppy: mean=0.2125, std=0.4091, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: market_regime_downtrend: mean=0.2582, std=0.4377, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: market_regime_range: mean=0.2195, std=0.4139, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: market_regime_uptrend: mean=0.3098, std=0.4625, min=0.0000, max=1.0000, unique=2
[2025-07-19 10:03:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 10:03:36] INFO train_model: Auditing data quality before training...
[2025-07-19 10:03:36] INFO train_model: Entering audit_data_quality
[2025-07-19 10:03:44] INFO train_model: Exiting audit_data_quality
[2025-07-19 15:16:45] INFO train_model: Model is starting a new training session...
[2025-07-19 15:16:45] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 15:16:45] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 15:16:45] INFO train_model: Preparing target variable...
[2025-07-19 15:16:45] INFO train_model: Entering prepare_target_variable
[2025-07-19 15:16:45] INFO train_model: Exiting prepare_target_variable
[2025-07-19 15:16:45] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 15:16:45] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 15:16:45] INFO train_model: Dropping NaN targets...
[2025-07-19 15:16:45] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 15:16:45] INFO train_model: Upsampling successful.
[2025-07-19 15:16:45] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 15:16:45] INFO train_model: Splitting train/test...
[2025-07-19 15:16:45] INFO train_model: Scaling features...
[2025-07-19 15:16:45] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 15:16:45] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 15:16:54] INFO train_model: Model fit complete.
[2025-07-19 15:16:54] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 15:16:54] INFO train_model: 
Classification Report:
[2025-07-19 15:16:54] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 15:16:54] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 15:16:54] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "c91140e1dc00d2cb1ca730fcaf6eed6a" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': 'c91140e1dc00d2cb1ca730fcaf6eed6a'}}
[2025-07-19 15:16:54] INFO train_model: Feature distributions before training:
[2025-07-19 15:16:54] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 15:16:54] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 15:16:54] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 15:16:54] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 15:16:54] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 15:16:54] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 15:16:54] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 15:16:54] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 15:16:54] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 15:16:54] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 15:16:54] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 15:16:54] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 15:16:54] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 15:16:54] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 15:16:54] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 15:16:54] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 15:16:54] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 15:16:54] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 15:16:54] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 15:16:54] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 15:16:54] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 15:16:54] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 15:16:54] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 15:16:54] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 15:16:54] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 15:16:54] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 15:16:54] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 15:16:54] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 15:16:54] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 15:16:54] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 15:16:54] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 15:16:54] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 15:16:54] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 15:16:54] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 15:16:54] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 15:16:54] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 15:16:54] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 15:16:54] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 15:16:54] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 15:16:54] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 15:16:54] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 15:16:54] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 15:16:54] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 15:16:54] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 15:16:54] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 15:16:54] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 15:16:54] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 15:16:54] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 15:16:54] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 15:16:54] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 15:16:54] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 15:16:54] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 15:16:54] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 15:16:54] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 15:16:54] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 15:16:54] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 15:16:54] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 15:16:54] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 15:16:54] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 15:16:54] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 15:16:54] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 15:16:54] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 15:16:54] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 15:16:54] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 15:16:54] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 15:16:54] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 15:16:54] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 15:16:54] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 15:16:54] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 15:16:54] INFO train_model: Auditing data quality before training...
[2025-07-19 15:16:54] INFO train_model: Entering audit_data_quality
[2025-07-19 16:35:20] INFO train_model: Model is starting a new training session...
[2025-07-19 16:35:20] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 16:35:20] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 16:35:20] INFO train_model: Preparing target variable...
[2025-07-19 16:35:20] INFO train_model: Entering prepare_target_variable
[2025-07-19 16:35:20] INFO train_model: Exiting prepare_target_variable
[2025-07-19 16:35:20] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 16:35:20] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 16:35:20] INFO train_model: Dropping NaN targets...
[2025-07-19 16:35:20] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 16:35:20] INFO train_model: Upsampling successful.
[2025-07-19 16:35:20] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 16:35:20] INFO train_model: Splitting train/test...
[2025-07-19 16:35:20] INFO train_model: Scaling features...
[2025-07-19 16:35:20] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 16:35:20] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 16:35:22] INFO train_model: Model fit complete.
[2025-07-19 16:35:22] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 16:35:22] INFO train_model: 
Classification Report:
[2025-07-19 16:35:22] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 16:35:22] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 16:35:22] INFO train_model: Model registered in ModelRegistry for EURUSD, version 41d681c2894b102c337037fd1bcf44e9
[2025-07-19 16:35:22] INFO train_model: Feature distributions before training:
[2025-07-19 16:35:22] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 16:35:22] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 16:35:22] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 16:35:22] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 16:35:22] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 16:35:22] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 16:35:22] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 16:35:22] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 16:35:22] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 16:35:22] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 16:35:22] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 16:35:22] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 16:35:22] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 16:35:22] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 16:35:22] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 16:35:22] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 16:35:22] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 16:35:22] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 16:35:22] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 16:35:22] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 16:35:22] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 16:35:22] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 16:35:22] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 16:35:22] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 16:35:22] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 16:35:22] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 16:35:22] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 16:35:22] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 16:35:22] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 16:35:22] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 16:35:22] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 16:35:22] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 16:35:22] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 16:35:22] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 16:35:22] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 16:35:22] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 16:35:22] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 16:35:22] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 16:35:22] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 16:35:22] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 16:35:22] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 16:35:22] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 16:35:22] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 16:35:22] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 16:35:22] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 16:35:22] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 16:35:22] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 16:35:22] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 16:35:22] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 16:35:22] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 16:35:22] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 16:35:22] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 16:35:22] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 16:35:22] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 16:35:22] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 16:35:22] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 16:35:22] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 16:35:22] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 16:35:22] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 16:35:22] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 16:35:22] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 16:35:22] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 16:35:22] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 16:35:22] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 16:35:22] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 16:35:22] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 16:35:22] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 16:35:22] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 16:35:22] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 16:35:22] INFO train_model: Auditing data quality before training...
[2025-07-19 16:35:22] INFO train_model: Entering audit_data_quality
[2025-07-19 17:42:25] INFO train_model: Model is starting a new training session...
[2025-07-19 17:42:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 17:42:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 17:42:25] INFO train_model: Preparing target variable...
[2025-07-19 17:42:25] INFO train_model: Entering prepare_target_variable
[2025-07-19 17:42:25] INFO train_model: Exiting prepare_target_variable
[2025-07-19 17:42:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 17:42:25] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 17:42:25] INFO train_model: Dropping NaN targets...
[2025-07-19 17:42:25] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 17:42:25] INFO train_model: Upsampling successful.
[2025-07-19 17:42:25] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 17:42:25] INFO train_model: Splitting train/test...
[2025-07-19 17:42:25] INFO train_model: Scaling features...
[2025-07-19 17:42:25] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 17:42:25] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 17:42:27] INFO train_model: Model fit complete.
[2025-07-19 17:42:27] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 17:42:27] INFO train_model: 
Classification Report:
[2025-07-19 17:42:27] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 17:42:27] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 17:42:27] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd6e3be744efa17b9ae37e0677c855588'}}
[2025-07-19 17:42:27] INFO train_model: Feature distributions before training:
[2025-07-19 17:42:27] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 17:42:27] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 17:42:27] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 17:42:27] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 17:42:27] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 17:42:27] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 17:42:27] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 17:42:27] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 17:42:27] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 17:42:27] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 17:42:27] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 17:42:27] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 17:42:27] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 17:42:27] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 17:42:27] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 17:42:27] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 17:42:27] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 17:42:27] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 17:42:27] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 17:42:27] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 17:42:27] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 17:42:27] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 17:42:27] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 17:42:27] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 17:42:27] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 17:42:27] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 17:42:27] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 17:42:27] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 17:42:27] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 17:42:27] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 17:42:27] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 17:42:27] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 17:42:27] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 17:42:27] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 17:42:27] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 17:42:27] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 17:42:27] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 17:42:27] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 17:42:27] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 17:42:27] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 17:42:27] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 17:42:27] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 17:42:27] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 17:42:27] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 17:42:27] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 17:42:27] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 17:42:27] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 17:42:27] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 17:42:27] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 17:42:27] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 17:42:27] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 17:42:27] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 17:42:27] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 17:42:27] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 17:42:27] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 17:42:27] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 17:42:27] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 17:42:27] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 17:42:27] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 17:42:27] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 17:42:27] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 17:42:27] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 17:42:27] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 17:42:27] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 17:42:27] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 17:42:27] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 17:42:27] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 17:42:27] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:42:27] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:42:27] INFO train_model: Auditing data quality before training...
[2025-07-19 17:42:28] INFO train_model: Entering audit_data_quality
[2025-07-19 17:54:52] INFO train_model: Model is starting a new training session...
[2025-07-19 17:54:52] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 17:54:52] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 17:54:52] INFO train_model: Preparing target variable...
[2025-07-19 17:54:52] INFO train_model: Entering prepare_target_variable
[2025-07-19 17:54:52] INFO train_model: Exiting prepare_target_variable
[2025-07-19 17:54:52] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 17:54:52] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 17:54:52] INFO train_model: Dropping NaN targets...
[2025-07-19 17:54:52] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 17:54:52] INFO train_model: Upsampling successful.
[2025-07-19 17:54:52] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 17:54:52] INFO train_model: Splitting train/test...
[2025-07-19 17:54:52] INFO train_model: Scaling features...
[2025-07-19 17:54:52] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 17:54:52] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 17:54:55] INFO train_model: Model fit complete.
[2025-07-19 17:54:55] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 17:54:55] INFO train_model: 
Classification Report:
[2025-07-19 17:54:55] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 17:54:55] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 17:54:55] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': '41d681c2894b102c337037fd1bcf44e9'}}
[2025-07-19 17:54:55] INFO train_model: Feature distributions before training:
[2025-07-19 17:54:55] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 17:54:55] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 17:54:55] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 17:54:55] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 17:54:55] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 17:54:55] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 17:54:55] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 17:54:55] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 17:54:55] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 17:54:55] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 17:54:55] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 17:54:55] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 17:54:55] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 17:54:55] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 17:54:55] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 17:54:55] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 17:54:55] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 17:54:55] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 17:54:55] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 17:54:55] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 17:54:55] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 17:54:55] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 17:54:55] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 17:54:55] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 17:54:55] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 17:54:55] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 17:54:55] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 17:54:55] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 17:54:55] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 17:54:55] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 17:54:55] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 17:54:55] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 17:54:55] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 17:54:55] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 17:54:55] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 17:54:55] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 17:54:55] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 17:54:55] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 17:54:55] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 17:54:55] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 17:54:55] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 17:54:55] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 17:54:55] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 17:54:55] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 17:54:55] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 17:54:55] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 17:54:55] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 17:54:55] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 17:54:55] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 17:54:55] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 17:54:55] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 17:54:55] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 17:54:55] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 17:54:55] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 17:54:55] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 17:54:55] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 17:54:55] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 17:54:55] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 17:54:55] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 17:54:55] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 17:54:55] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 17:54:55] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 17:54:55] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 17:54:55] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 17:54:55] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 17:54:55] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 17:54:55] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 17:54:55] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 17:54:55] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 17:54:55] INFO train_model: Auditing data quality before training...
[2025-07-19 17:54:55] INFO train_model: Entering audit_data_quality
[2025-07-19 18:27:34] INFO train_model: Model is starting a new training session...
[2025-07-19 18:27:34] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:27:34] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 18:27:34] INFO train_model: Preparing target variable...
[2025-07-19 18:27:34] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:27:34] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:27:34] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 18:27:34] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:27:34] INFO train_model: Dropping NaN targets...
[2025-07-19 18:27:34] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 18:27:34] INFO train_model: Upsampling successful.
[2025-07-19 18:27:34] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 18:27:34] INFO train_model: Splitting train/test...
[2025-07-19 18:27:34] INFO train_model: Scaling features...
[2025-07-19 18:27:34] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:27:34] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:27:36] INFO train_model: Model fit complete.
[2025-07-19 18:27:36] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 18:27:36] INFO train_model: 
Classification Report:
[2025-07-19 18:27:36] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 18:27:36] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 18:27:36] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': '41d681c2894b102c337037fd1bcf44e9'}}
[2025-07-19 18:27:36] INFO train_model: Feature distributions before training:
[2025-07-19 18:27:36] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 18:27:36] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 18:27:36] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 18:27:36] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 18:27:36] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 18:27:36] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 18:27:36] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 18:27:36] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 18:27:36] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 18:27:36] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 18:27:36] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 18:27:36] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 18:27:36] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 18:27:36] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 18:27:36] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 18:27:36] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 18:27:36] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 18:27:36] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 18:27:36] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 18:27:36] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 18:27:36] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 18:27:36] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 18:27:36] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 18:27:36] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 18:27:36] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 18:27:36] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 18:27:36] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 18:27:36] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 18:27:36] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 18:27:36] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 18:27:36] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 18:27:36] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 18:27:36] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:27:36] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:27:36] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:27:36] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 18:27:36] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 18:27:36] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:27:36] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 18:27:36] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 18:27:36] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 18:27:36] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 18:27:36] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 18:27:36] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 18:27:36] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 18:27:36] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 18:27:36] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 18:27:36] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 18:27:36] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 18:27:36] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:27:36] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:27:36] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:27:36] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:27:36] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 18:27:36] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 18:27:36] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 18:27:36] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 18:27:36] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 18:27:36] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 18:27:36] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 18:27:36] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 18:27:36] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 18:27:36] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 18:27:36] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 18:27:36] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 18:27:36] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 18:27:36] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:27:36] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:27:36] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:27:36] INFO train_model: Auditing data quality before training...
[2025-07-19 18:27:37] INFO train_model: Entering audit_data_quality
[2025-07-19 18:28:05] INFO train_model: Exiting audit_data_quality
[2025-07-19 18:28:08] INFO train_model: Model is starting a new training session...
[2025-07-19 18:28:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:28:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 18:28:08] INFO train_model: Preparing target variable...
[2025-07-19 18:28:08] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:28:08] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:28:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 18:28:08] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:28:08] INFO train_model: Dropping NaN targets...
[2025-07-19 18:28:08] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 18:28:08] INFO train_model: Upsampling successful.
[2025-07-19 18:28:08] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 18:28:08] INFO train_model: Splitting train/test...
[2025-07-19 18:28:08] INFO train_model: Scaling features...
[2025-07-19 18:28:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:28:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:28:11] INFO train_model: Model fit complete.
[2025-07-19 18:28:11] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 18:28:11] INFO train_model: 
Classification Report:
[2025-07-19 18:28:11] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 18:28:11] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 18:28:11] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': '41d681c2894b102c337037fd1bcf44e9'}}
[2025-07-19 18:28:11] INFO train_model: Feature distributions before training:
[2025-07-19 18:28:11] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 18:28:11] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 18:28:11] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 18:28:11] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 18:28:11] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 18:28:11] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 18:28:11] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 18:28:11] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 18:28:11] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 18:28:11] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 18:28:11] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 18:28:11] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 18:28:11] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 18:28:11] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 18:28:11] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 18:28:11] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 18:28:11] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 18:28:11] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 18:28:11] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 18:28:11] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 18:28:11] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 18:28:11] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 18:28:11] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 18:28:11] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 18:28:11] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 18:28:11] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 18:28:11] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 18:28:11] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 18:28:11] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 18:28:11] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 18:28:11] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 18:28:11] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 18:28:11] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:28:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:28:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:28:11] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 18:28:11] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 18:28:11] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:28:11] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 18:28:11] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 18:28:11] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 18:28:11] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 18:28:11] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 18:28:11] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 18:28:11] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 18:28:11] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 18:28:11] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 18:28:11] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 18:28:11] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 18:28:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:28:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:28:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:28:11] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:28:11] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 18:28:11] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 18:28:11] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 18:28:11] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 18:28:11] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 18:28:11] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 18:28:11] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 18:28:11] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 18:28:11] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 18:28:11] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 18:28:11] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 18:28:11] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 18:28:11] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 18:28:11] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:28:11] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:28:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:28:11] INFO train_model: Auditing data quality before training...
[2025-07-19 18:28:11] INFO train_model: Entering audit_data_quality
[2025-07-19 18:29:34] INFO train_model: Model is starting a new training session...
[2025-07-19 18:29:34] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:29:34] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 18:29:34] INFO train_model: Preparing target variable...
[2025-07-19 18:29:34] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:29:34] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:29:34] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 18:29:35] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:29:35] INFO train_model: Dropping NaN targets...
[2025-07-19 18:29:35] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 18:29:35] INFO train_model: Upsampling successful.
[2025-07-19 18:29:35] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 18:29:35] INFO train_model: Splitting train/test...
[2025-07-19 18:29:35] INFO train_model: Scaling features...
[2025-07-19 18:29:35] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:29:35] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:29:37] INFO train_model: Model fit complete.
[2025-07-19 18:29:37] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 18:29:37] INFO train_model: 
Classification Report:
[2025-07-19 18:29:37] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 18:29:37] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 18:29:37] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': '41d681c2894b102c337037fd1bcf44e9'}}
[2025-07-19 18:29:37] INFO train_model: Feature distributions before training:
[2025-07-19 18:29:37] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 18:29:37] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 18:29:37] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 18:29:37] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 18:29:37] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 18:29:37] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 18:29:37] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 18:29:37] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 18:29:37] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 18:29:37] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 18:29:37] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 18:29:37] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 18:29:37] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 18:29:37] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 18:29:37] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 18:29:37] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 18:29:37] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 18:29:37] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 18:29:37] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 18:29:37] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 18:29:37] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 18:29:37] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 18:29:37] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 18:29:37] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 18:29:37] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 18:29:37] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 18:29:37] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 18:29:37] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 18:29:37] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 18:29:37] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 18:29:37] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 18:29:37] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 18:29:37] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:29:37] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:29:37] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:29:37] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 18:29:37] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 18:29:37] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:29:37] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 18:29:37] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 18:29:37] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 18:29:37] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 18:29:37] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 18:29:37] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 18:29:37] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 18:29:37] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 18:29:37] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 18:29:37] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 18:29:37] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 18:29:37] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:29:37] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:29:37] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:29:37] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:29:37] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 18:29:37] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 18:29:37] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 18:29:37] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 18:29:37] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 18:29:37] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 18:29:37] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 18:29:37] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 18:29:37] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 18:29:37] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 18:29:37] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 18:29:37] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 18:29:37] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 18:29:37] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:29:37] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:29:37] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:29:37] INFO train_model: Auditing data quality before training...
[2025-07-19 18:29:37] INFO train_model: Entering audit_data_quality
[2025-07-19 18:31:54] INFO train_model: Exiting audit_data_quality
[2025-07-19 18:31:56] INFO train_model: Exiting audit_data_quality
[2025-07-19 18:31:57] INFO train_model: Model is starting a new training session...
[2025-07-19 18:31:57] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:31:57] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=125)
[2025-07-19 18:31:57] INFO train_model: Preparing target variable...
[2025-07-19 18:31:57] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:31:57] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:31:57] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_consolidation',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=127)
[2025-07-19 18:31:57] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:31:57] INFO train_model: Dropping NaN targets...
[2025-07-19 18:31:57] INFO train_model: Class balance before upsampling: {0: 3313, 1: 1413}
[2025-07-19 18:31:57] INFO train_model: Upsampling successful.
[2025-07-19 18:31:57] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 18:31:57] INFO train_model: Splitting train/test...
[2025-07-19 18:31:57] INFO train_model: Scaling features...
[2025-07-19 18:31:57] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:31:57] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:31:59] INFO train_model: Model fit complete.
[2025-07-19 18:31:59] INFO train_model: Model Accuracy: 0.8997
[2025-07-19 18:31:59] INFO train_model: 
Classification Report:
[2025-07-19 18:31:59] INFO train_model:               precision    recall  f1-score   support

           0       0.91      0.89      0.90       663
           1       0.89      0.91      0.90       663

    accuracy                           0.90      1326
   macro avg       0.90      0.90      0.90      1326
weighted avg       0.90      0.90      0.90      1326

[2025-07-19 18:31:59] INFO train_model: Model, scaler, and features saved for EURUSD
[2025-07-19 18:31:59] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_EURUSD", version: "41d681c2894b102c337037fd1bcf44e9" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_EURUSD', 'version': '41d681c2894b102c337037fd1bcf44e9'}}
[2025-07-19 18:31:59] INFO train_model: Feature distributions before training:
[2025-07-19 18:31:59] INFO train_model: atr_14: mean=0.0019, std=0.0007, min=0.0000, max=0.0064, unique=4714
[2025-07-19 18:31:59] INFO train_model: volatility_20: mean=0.0019, std=0.0012, min=0.0004, max=0.0094, unique=4659
[2025-07-19 18:31:59] INFO train_model: sma_20: mean=1.0903, std=0.0460, min=1.0215, max=1.1800, unique=4667
[2025-07-19 18:31:59] INFO train_model: sma_50: mean=1.0901, std=0.0457, min=1.0239, max=1.1795, unique=4650
[2025-07-19 18:31:59] INFO train_model: sma_200: mean=1.0887, std=0.0443, min=1.0288, max=1.1759, unique=4518
[2025-07-19 18:31:59] INFO train_model: ema_12: mean=1.0904, std=0.0460, min=1.0212, max=1.1801, unique=4726
[2025-07-19 18:31:59] INFO train_model: ema_26: mean=1.0903, std=0.0459, min=1.0226, max=1.1796, unique=4726
[2025-07-19 18:31:59] INFO train_model: rsi_14: mean=50.2956, std=12.2295, min=12.4560, max=90.7375, unique=4457
[2025-07-19 18:31:59] INFO train_model: macd: mean=0.0001, std=0.0014, min=-0.0047, max=0.0075, unique=4701
[2025-07-19 18:31:59] INFO train_model: macd_signal: mean=0.0001, std=0.0013, min=-0.0041, max=0.0070, unique=4693
[2025-07-19 18:31:59] INFO train_model: bb_high: mean=1.0940, std=0.0462, min=1.0240, max=1.1830, unique=4667
[2025-07-19 18:31:59] INFO train_model: bb_low: mean=1.0866, std=0.0459, min=1.0146, max=1.1790, unique=4667
[2025-07-19 18:31:59] INFO train_model: stoch_k: mean=50.0430, std=27.4336, min=0.0000, max=100.0000, unique=4355
[2025-07-19 18:31:59] INFO train_model: stoch_d: mean=50.0673, std=24.8748, min=2.6519, max=97.5215, unique=4679
[2025-07-19 18:31:59] INFO train_model: fib_0: mean=1.0943, std=0.0463, min=1.0248, max=1.1832, unique=634
[2025-07-19 18:31:59] INFO train_model: dist_to_fib_0: mean=-0.0039, std=0.0031, min=-0.0248, max=0.0000, unique=3779
[2025-07-19 18:31:59] INFO train_model: fib_236: mean=1.0924, std=0.0461, min=1.0232, max=1.1818, unique=1861
[2025-07-19 18:31:59] INFO train_model: dist_to_fib_236: mean=-0.0020, std=0.0027, min=-0.0188, max=0.0060, unique=4267
[2025-07-19 18:31:59] INFO train_model: fib_382: mean=1.0913, std=0.0460, min=1.0223, max=1.1809, unique=1861
[2025-07-19 18:31:59] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0026, min=-0.0151, max=0.0108, unique=4267
[2025-07-19 18:31:59] INFO train_model: fib_500: mean=1.0904, std=0.0460, min=1.0215, max=1.1802, unique=1861
[2025-07-19 18:31:59] INFO train_model: dist_to_fib_500: mean=0.0001, std=0.0026, min=-0.0121, max=0.0146, unique=4261
[2025-07-19 18:31:59] INFO train_model: fib_618: mean=1.0894, std=0.0459, min=1.0207, max=1.1797, unique=1861
[2025-07-19 18:31:59] INFO train_model: dist_to_fib_618: mean=0.0010, std=0.0027, min=-0.0091, max=0.0192, unique=4267
[2025-07-19 18:31:59] INFO train_model: fib_786: mean=1.0881, std=0.0459, min=1.0196, max=1.1793, unique=1861
[2025-07-19 18:31:59] INFO train_model: dist_to_fib_786: mean=0.0023, std=0.0031, min=-0.0049, max=0.0258, unique=4267
[2025-07-19 18:31:59] INFO train_model: fib_100: mean=1.0864, std=0.0458, min=1.0182, max=1.1787, unique=671
[2025-07-19 18:31:59] INFO train_model: dist_to_fib_100: mean=0.0040, std=0.0036, min=0.0000, max=0.0341, unique=3815
[2025-07-19 18:31:59] INFO train_model: trendline_slope_high: mean=0.0000, std=0.0003, min=-0.0011, max=0.0018, unique=4444
[2025-07-19 18:31:59] INFO train_model: trendline_slope_low: mean=0.0000, std=0.0003, min=-0.0012, max=0.0016, unique=4460
[2025-07-19 18:31:59] INFO train_model: trendline_up: mean=0.4693, std=0.4991, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: trendline_down: mean=0.4972, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: breakout_high: mean=0.0080, std=0.0893, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: breakout_low: mean=0.0072, std=0.0845, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: dist_to_high: mean=-0.0038, std=0.0032, min=-0.0248, max=0.0037, unique=3775
[2025-07-19 18:31:59] INFO train_model: dist_to_low: mean=0.0040, std=0.0038, min=-0.0107, max=0.0345, unique=3780
[2025-07-19 18:31:59] INFO train_model: vol_spike_atr: mean=0.0245, std=0.1548, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: vol_spike_std: mean=0.1570, std=0.3638, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: is_trending: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: supply_zone: mean=0.4826, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: demand_zone: mean=0.4661, std=0.4989, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:31:59] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:31:59] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:31:59] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: bos: mean=0.0152, std=0.1225, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: choch: mean=0.1606, std=0.3672, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0005, min=0.0003, max=0.0033, unique=4684
[2025-07-19 18:31:59] INFO train_model: vol_cluster_high: mean=0.1007, std=0.3010, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: regime_zscore: mean=0.0205, std=1.0068, min=-7.9456, max=6.5525, unique=4623
[2025-07-19 18:31:59] INFO train_model: doji: mean=0.1052, std=0.3068, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: hammer: mean=0.0209, std=0.1432, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bullish_engulfing: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bearish_engulfing: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: pin_bar: mean=0.2624, std=0.4400, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bullish_engulfing_bar: mean=0.0212, std=0.1439, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bearish_engulfing_bar: mean=0.0252, std=0.1567, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: inside_bar: mean=0.1083, std=0.3108, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: head_shoulders: mean=0.0303, std=0.1713, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: inv_head_shoulders: mean=0.0294, std=0.1690, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: double_top: mean=0.0330, std=0.1787, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: double_bottom: mean=0.0438, std=0.2047, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: rising_wedge: mean=0.2361, std=0.4248, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: falling_wedge: mean=0.2287, std=0.4201, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: fakeout_up: mean=0.0038, std=0.0616, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: fakeout_down: mean=0.0042, std=0.0649, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bullish_flag: mean=0.0254, std=0.1573, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bearish_flag: mean=0.0216, std=0.1453, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bullish_pennant: mean=0.1471, std=0.3542, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bearish_pennant: mean=0.1231, std=0.3286, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: morning_star: mean=0.0307, std=0.1725, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: evening_star: mean=0.0275, std=0.1636, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: three_black_crows: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: bullish_harami: mean=0.0305, std=0.1719, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: bearish_harami: mean=0.0224, std=0.1481, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: dark_cloud_cover: mean=0.0868, std=0.2815, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: structure_trend_1h: mean=0.9884, std=0.8251, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:31:59] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4672
[2025-07-19 18:31:59] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4648
[2025-07-19 18:31:59] INFO train_model: ema_12_4h: mean=1.0904, std=0.0461, min=1.0207, max=1.1802, unique=4726
[2025-07-19 18:31:59] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4726
[2025-07-19 18:31:59] INFO train_model: rsi_14_4h: mean=51.0976, std=32.5783, min=0.0000, max=100.0000, unique=1783
[2025-07-19 18:31:59] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4726
[2025-07-19 18:31:59] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4726
[2025-07-19 18:31:59] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4674
[2025-07-19 18:31:59] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4674
[2025-07-19 18:31:59] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4711
[2025-07-19 18:31:59] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4664
[2025-07-19 18:31:59] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:31:59] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:31:59] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4726, 2)
[2025-07-19 18:31:59] INFO train_model: structure_trend_4h: mean=0.8159, std=0.8412, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:31:59] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3910
[2025-07-19 18:31:59] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4656
[2025-07-19 18:31:59] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4726
[2025-07-19 18:31:59] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4726
[2025-07-19 18:31:59] INFO train_model: rsi_14_1d: mean=47.2704, std=49.9307, min=0.0000, max=100.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4726
[2025-07-19 18:31:59] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4726
[2025-07-19 18:31:59] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3910
[2025-07-19 18:31:59] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3910
[2025-07-19 18:31:59] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2859
[2025-07-19 18:31:59] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3703
[2025-07-19 18:31:59] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3718
[2025-07-19 18:31:59] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4656
[2025-07-19 18:31:59] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4656
[2025-07-19 18:31:59] INFO train_model: structure_trend_1d: mean=0.0493, std=0.2834, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:31:59] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: regime_label_bear: mean=0.4727, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: regime_label_bull: mean=0.4850, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: regime_label_neutral: mean=0.0423, std=0.2013, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: market_regime_choppy: mean=0.0544, std=0.2268, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: market_regime_consolidation: mean=0.0296, std=0.1696, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: market_regime_downtrend: mean=0.2131, std=0.4095, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: market_regime_range: mean=0.4562, std=0.4981, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: market_regime_uptrend: mean=0.2467, std=0.4311, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:31:59] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:31:59] INFO train_model: Auditing data quality before training...
[2025-07-19 18:31:59] INFO train_model: Entering audit_data_quality
[2025-07-19 18:32:08] INFO train_model: Model is starting a new training session...
[2025-07-19 18:32:08] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:32:08] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 18:32:08] INFO train_model: Preparing target variable...
[2025-07-19 18:32:08] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:32:08] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:32:08] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 18:32:08] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:32:08] INFO train_model: Dropping NaN targets...
[2025-07-19 18:32:08] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 18:32:08] INFO train_model: Upsampling successful.
[2025-07-19 18:32:08] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 18:32:08] INFO train_model: Splitting train/test...
[2025-07-19 18:32:08] INFO train_model: Scaling features...
[2025-07-19 18:32:08] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:32:08] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:32:11] INFO train_model: Model fit complete.
[2025-07-19 18:32:11] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 18:32:11] INFO train_model: 
Classification Report:
[2025-07-19 18:32:11] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 18:32:11] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 18:32:11] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd6e3be744efa17b9ae37e0677c855588'}}
[2025-07-19 18:32:11] INFO train_model: Feature distributions before training:
[2025-07-19 18:32:11] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 18:32:11] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 18:32:11] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 18:32:11] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 18:32:11] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 18:32:11] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 18:32:11] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 18:32:11] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 18:32:11] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 18:32:11] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 18:32:11] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 18:32:11] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 18:32:11] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 18:32:11] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 18:32:11] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 18:32:11] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 18:32:11] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 18:32:11] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 18:32:11] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 18:32:11] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 18:32:11] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 18:32:11] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 18:32:11] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 18:32:11] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 18:32:11] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 18:32:11] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 18:32:11] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 18:32:11] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 18:32:11] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 18:32:11] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 18:32:11] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 18:32:11] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 18:32:11] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:11] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 18:32:11] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 18:32:11] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:32:11] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 18:32:11] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 18:32:11] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 18:32:11] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 18:32:11] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 18:32:11] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 18:32:11] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 18:32:11] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 18:32:11] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 18:32:11] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 18:32:11] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 18:32:11] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:11] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:11] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:11] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:32:11] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 18:32:11] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 18:32:11] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 18:32:11] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 18:32:11] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 18:32:11] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 18:32:11] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 18:32:11] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 18:32:11] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 18:32:11] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 18:32:11] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 18:32:11] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 18:32:11] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 18:32:11] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:32:11] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:11] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:11] INFO train_model: Auditing data quality before training...
[2025-07-19 18:32:11] INFO train_model: Entering audit_data_quality
[2025-07-19 18:32:19] INFO train_model: Exiting audit_data_quality
[2025-07-19 18:32:22] INFO train_model: Model is starting a new training session...
[2025-07-19 18:32:22] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:32:22] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 18:32:22] INFO train_model: Preparing target variable...
[2025-07-19 18:32:22] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:32:22] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:32:22] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 18:32:22] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:32:22] INFO train_model: Dropping NaN targets...
[2025-07-19 18:32:22] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 18:32:22] INFO train_model: Upsampling successful.
[2025-07-19 18:32:22] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 18:32:22] INFO train_model: Splitting train/test...
[2025-07-19 18:32:22] INFO train_model: Scaling features...
[2025-07-19 18:32:22] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:32:22] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:32:24] INFO train_model: Model fit complete.
[2025-07-19 18:32:24] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 18:32:24] INFO train_model: 
Classification Report:
[2025-07-19 18:32:24] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 18:32:24] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 18:32:24] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd6e3be744efa17b9ae37e0677c855588'}}
[2025-07-19 18:32:24] INFO train_model: Feature distributions before training:
[2025-07-19 18:32:24] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 18:32:24] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 18:32:24] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 18:32:24] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 18:32:24] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 18:32:24] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 18:32:24] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 18:32:24] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 18:32:24] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 18:32:24] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 18:32:24] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 18:32:24] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 18:32:24] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 18:32:24] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 18:32:24] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 18:32:24] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 18:32:24] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 18:32:24] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 18:32:24] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 18:32:24] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 18:32:24] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 18:32:24] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 18:32:24] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 18:32:24] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 18:32:24] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 18:32:24] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 18:32:24] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 18:32:24] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 18:32:24] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 18:32:24] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 18:32:24] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 18:32:24] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 18:32:24] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:24] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:24] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:24] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 18:32:24] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 18:32:24] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:32:24] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 18:32:24] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 18:32:24] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 18:32:24] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 18:32:24] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 18:32:24] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 18:32:24] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 18:32:24] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 18:32:24] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 18:32:24] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 18:32:24] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 18:32:24] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:24] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:24] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:32:24] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:32:24] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 18:32:24] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 18:32:24] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 18:32:24] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 18:32:24] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 18:32:24] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 18:32:24] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 18:32:24] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 18:32:24] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 18:32:24] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 18:32:24] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 18:32:24] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 18:32:24] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 18:32:24] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:32:24] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:32:24] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:32:24] INFO train_model: Auditing data quality before training...
[2025-07-19 18:32:24] INFO train_model: Entering audit_data_quality
[2025-07-19 18:32:41] INFO train_model: Exiting audit_data_quality
[2025-07-19 18:32:44] INFO train_model: Exiting audit_data_quality
[2025-07-19 18:33:04] INFO train_model: Model is starting a new training session...
[2025-07-19 18:33:04] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:33:04] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'structure_trend_1d', 'fib_levels', 'wyckoff_phases',
       'regime_label_bear', 'regime_label_bull', 'regime_label_neutral',
       'market_regime_choppy', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object', length=124)
[2025-07-19 18:33:04] INFO train_model: Preparing target variable...
[2025-07-19 18:33:04] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:33:04] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:33:04] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200',
       ...
       'wyckoff_phases', 'regime_label_bear', 'regime_label_bull',
       'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object', length=126)
[2025-07-19 18:33:04] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'structure_trend_1h', 'sma_20_4h', 'sma_50_4h', 'ema_12_4h', 'ema_26_4h', 'rsi_14_4h', 'macd_4h', 'macd_signal_4h', 'bb_high_4h', 'bb_low_4h', 'atr_14_4h', 'volatility_20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'structure_trend_4h', 'sma_20_1d', 'sma_50_1d', 'ema_12_1d', 'ema_26_1d', 'rsi_14_1d', 'macd_1d', 'macd_signal_1d', 'bb_high_1d', 'bb_low_1d', 'atr_14_1d', 'volatility_20_1d', 'price_vs_sma20_1d', 'price_vs_sma50_1d', 'trend_strength_1d', 'structure_trend_1d', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:33:04] INFO train_model: Dropping NaN targets...
[2025-07-19 18:33:05] INFO train_model: Class balance before upsampling: {0: 3104, 1: 1592}
[2025-07-19 18:33:05] INFO train_model: Upsampling successful.
[2025-07-19 18:33:05] WARNING train_model: Dropping non-numeric columns after upsampling: ['price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h', 'trend_strength_4h']
[2025-07-19 18:33:05] INFO train_model: Splitting train/test...
[2025-07-19 18:33:05] INFO train_model: Scaling features...
[2025-07-19 18:33:05] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:33:05] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:33:07] INFO train_model: Model fit complete.
[2025-07-19 18:33:07] INFO train_model: Model Accuracy: 0.8671
[2025-07-19 18:33:07] INFO train_model: 
Classification Report:
[2025-07-19 18:33:07] INFO train_model:               precision    recall  f1-score   support

           0       0.87      0.86      0.87       621
           1       0.87      0.87      0.87       621

    accuracy                           0.87      1242
   macro avg       0.87      0.87      0.87      1242
weighted avg       0.87      0.87      0.87      1242

[2025-07-19 18:33:07] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 18:33:07] ERROR train_model: Failed to register model in ModelRegistry: Failed to register model: E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: forex_ai.model_registry index: model_type_1_version_-1 dup key: { model_type: "signal_model_USDJPY", version: "d6e3be744efa17b9ae37e0677c855588" }', 'keyPattern': {'model_type': 1, 'version': -1}, 'keyValue': {'model_type': 'signal_model_USDJPY', 'version': 'd6e3be744efa17b9ae37e0677c855588'}}
[2025-07-19 18:33:07] INFO train_model: Feature distributions before training:
[2025-07-19 18:33:07] INFO train_model: atr_14: mean=0.3418, std=0.1040, min=0.0000, max=0.9927, unique=4684
[2025-07-19 18:33:07] INFO train_model: volatility_20: mean=0.3281, std=0.1836, min=0.0344, max=1.3004, unique=4677
[2025-07-19 18:33:07] INFO train_model: sma_20: mean=149.6159, std=4.6959, min=140.5323, max=158.2940, unique=4675
[2025-07-19 18:33:07] INFO train_model: sma_50: mean=149.6181, std=4.6750, min=140.8684, max=158.1650, unique=4647
[2025-07-19 18:33:07] INFO train_model: sma_200: mean=149.6739, std=4.5828, min=142.1838, max=157.7724, unique=4496
[2025-07-19 18:33:07] INFO train_model: ema_12: mean=149.6147, std=4.6976, min=140.4143, max=158.3392, unique=4696
[2025-07-19 18:33:07] INFO train_model: ema_26: mean=149.6159, std=4.6831, min=140.6181, max=158.2242, unique=4696
[2025-07-19 18:33:07] INFO train_model: rsi_14: mean=50.5814, std=12.9312, min=8.6902, max=92.4381, unique=4673
[2025-07-19 18:33:07] INFO train_model: macd: mean=-0.0008, std=0.2231, min=-0.9230, max=0.8730, unique=4671
[2025-07-19 18:33:07] INFO train_model: macd_signal: mean=-0.0012, std=0.2089, min=-0.8065, max=0.7956, unique=4663
[2025-07-19 18:33:07] INFO train_model: bb_high: mean=150.2556, std=4.6739, min=140.9707, max=158.5972, unique=4677
[2025-07-19 18:33:07] INFO train_model: bb_low: mean=148.9762, std=4.7449, min=139.2981, max=158.0618, unique=4677
[2025-07-19 18:33:07] INFO train_model: stoch_k: mean=52.3551, std=27.0592, min=0.0000, max=99.6649, unique=4672
[2025-07-19 18:33:07] INFO train_model: stoch_d: mean=52.3620, std=25.0043, min=3.8543, max=96.6848, unique=4679
[2025-07-19 18:33:07] INFO train_model: fib_0: mean=150.2810, std=4.6548, min=141.0760, max=158.8790, unique=1210
[2025-07-19 18:33:07] INFO train_model: dist_to_fib_0: mean=-0.6654, std=0.5553, min=-5.0610, max=-0.0050, unique=3221
[2025-07-19 18:33:07] INFO train_model: fib_236: mean=149.9554, std=4.6619, min=140.8676, max=158.5797, unique=2255
[2025-07-19 18:33:07] INFO train_model: dist_to_fib_236: mean=-0.3397, std=0.4877, min=-3.8081, max=0.7712, unique=4658
[2025-07-19 18:33:07] INFO train_model: fib_382: mean=149.7539, std=4.6685, min=140.6792, max=158.3946, unique=2255
[2025-07-19 18:33:07] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4633, min=-3.0330, max=1.2871, unique=4658
[2025-07-19 18:33:07] INFO train_model: fib_500: mean=149.5910, std=4.6750, min=140.5270, max=158.2450, unique=2224
[2025-07-19 18:33:07] INFO train_model: dist_to_fib_500: mean=0.0246, std=0.4555, min=-2.4065, max=1.7885, unique=4396
[2025-07-19 18:33:07] INFO train_model: fib_618: mean=149.4282, std=4.6827, min=140.3748, max=158.1640, unique=2255
[2025-07-19 18:33:07] INFO train_model: dist_to_fib_618: mean=0.1874, std=0.4588, min=-1.7800, max=2.2899, unique=4658
[2025-07-19 18:33:07] INFO train_model: fib_786: mean=149.1964, std=4.6954, min=140.1581, max=158.0580, unique=2255
[2025-07-19 18:33:07] INFO train_model: dist_to_fib_786: mean=0.4192, std=0.4821, min=-0.8881, max=3.0037, unique=4658
[2025-07-19 18:33:07] INFO train_model: fib_100: mean=148.9011, std=4.7147, min=139.8820, max=157.9230, unique=1168
[2025-07-19 18:33:07] INFO train_model: dist_to_fib_100: mean=0.7145, std=0.5390, min=0.0000, max=3.9130, unique=3225
[2025-07-19 18:33:07] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=3786
[2025-07-19 18:33:07] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3835
[2025-07-19 18:33:07] INFO train_model: trendline_up: mean=0.5045, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: dist_to_high: mean=-0.6657, std=0.5819, min=-5.0610, max=0.5750, unique=3247
[2025-07-19 18:33:07] INFO train_model: dist_to_low: mean=0.7127, std=0.5650, min=-0.3640, max=3.9130, unique=3337
[2025-07-19 18:33:07] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: supply_zone: mean=0.4365, std=0.4960, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: demand_zone: mean=0.3686, std=0.4825, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:33:07] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:33:07] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:33:07] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: choch: mean=0.1435, std=0.3506, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4676
[2025-07-19 18:33:07] INFO train_model: vol_cluster_high: mean=0.1016, std=0.3021, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: regime_zscore: mean=-0.0186, std=1.0039, min=-5.8436, max=6.5511, unique=4596
[2025-07-19 18:33:07] INFO train_model: doji: mean=0.1099, std=0.3128, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: hammer: mean=0.0266, std=0.1610, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: pin_bar: mean=0.2896, std=0.4536, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2215, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2245, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: head_shoulders: mean=0.0311, std=0.1736, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: inv_head_shoulders: mean=0.0326, std=0.1776, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: double_bottom: mean=0.0009, std=0.0292, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: rising_wedge: mean=0.2685, std=0.4432, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: falling_wedge: mean=0.2398, std=0.4270, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bullish_flag: mean=0.0196, std=0.1386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bearish_flag: mean=0.0217, std=0.1458, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bullish_pennant: mean=0.1282, std=0.3343, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bearish_pennant: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: morning_star: mean=0.0405, std=0.1971, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: evening_star: mean=0.0364, std=0.1873, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bullish_harami: mean=0.0549, std=0.2279, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: bearish_harami: mean=0.0460, std=0.2095, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: dark_cloud_cover: mean=0.1190, std=0.3239, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: structure_trend_1h: mean=0.9879, std=0.8248, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:33:07] INFO train_model: sma_20_4h: mean=1.0903, std=0.0460, min=1.0209, max=1.1802, unique=4643
[2025-07-19 18:33:07] INFO train_model: sma_50_4h: mean=1.0901, std=0.0457, min=1.0239, max=1.1794, unique=4618
[2025-07-19 18:33:07] INFO train_model: ema_12_4h: mean=1.0904, std=0.0460, min=1.0207, max=1.1802, unique=4696
[2025-07-19 18:33:07] INFO train_model: ema_26_4h: mean=1.0903, std=0.0459, min=1.0222, max=1.1797, unique=4696
[2025-07-19 18:33:07] INFO train_model: rsi_14_4h: mean=51.1192, std=32.6201, min=0.0000, max=100.0000, unique=1781
[2025-07-19 18:33:07] INFO train_model: macd_4h: mean=0.0001, std=0.0014, min=-0.0050, max=0.0072, unique=4696
[2025-07-19 18:33:07] INFO train_model: macd_signal_4h: mean=0.0001, std=0.0013, min=-0.0042, max=0.0064, unique=4696
[2025-07-19 18:33:07] INFO train_model: bb_high_4h: mean=1.0940, std=0.0462, min=1.0227, max=1.1833, unique=4645
[2025-07-19 18:33:07] INFO train_model: bb_low_4h: mean=1.0866, std=0.0459, min=1.0138, max=1.1796, unique=4645
[2025-07-19 18:33:07] INFO train_model: atr_14_4h: mean=0.0034, std=0.0016, min=0.0009, max=0.0139, unique=4681
[2025-07-19 18:33:07] INFO train_model: volatility_20_4h: mean=0.0018, std=0.0013, min=0.0001, max=0.0102, unique=4635
[2025-07-19 18:33:07] INFO train_model: price_vs_sma20_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:33:07] INFO train_model: price_vs_sma50_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:33:07] INFO train_model: trend_strength_4h: DataFrame with 2 columns, shape=(4696, 2)
[2025-07-19 18:33:07] INFO train_model: structure_trend_4h: mean=0.8167, std=0.8413, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:33:07] INFO train_model: sma_20_1d: mean=1.0896, std=0.0459, min=1.0244, max=1.1806, unique=3909
[2025-07-19 18:33:07] INFO train_model: sma_50_1d: mean=1.0894, std=0.0456, min=1.0257, max=1.1802, unique=4626
[2025-07-19 18:33:07] INFO train_model: ema_12_1d: mean=1.0893, std=0.0495, min=0.0000, max=1.1805, unique=4696
[2025-07-19 18:33:07] INFO train_model: ema_26_1d: mean=1.0890, std=0.0496, min=0.0000, max=1.1801, unique=4696
[2025-07-19 18:33:07] INFO train_model: rsi_14_1d: mean=47.2104, std=49.9274, min=0.0000, max=100.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: macd_1d: mean=0.0003, std=0.0023, min=-0.0051, max=0.0341, unique=4696
[2025-07-19 18:33:07] INFO train_model: macd_signal_1d: mean=0.0003, std=0.0023, min=-0.0045, max=0.0307, unique=4696
[2025-07-19 18:33:07] INFO train_model: bb_high_1d: mean=1.0946, std=0.0540, min=1.0244, max=1.5265, unique=3909
[2025-07-19 18:33:07] INFO train_model: bb_low_1d: mean=1.0846, std=0.0577, min=0.5493, max=1.1806, unique=3909
[2025-07-19 18:33:07] INFO train_model: atr_14_1d: mean=0.0080, std=0.0055, min=0.0024, max=0.0813, unique=2858
[2025-07-19 18:33:07] INFO train_model: volatility_20_1d: mean=0.0025, std=0.0159, min=0.0000, max=0.2443, unique=3702
[2025-07-19 18:33:07] INFO train_model: price_vs_sma20_1d: mean=0.0003, std=0.0044, min=-0.0175, max=0.0526, unique=3717
[2025-07-19 18:33:07] INFO train_model: price_vs_sma50_1d: mean=0.0005, std=0.0048, min=-0.0155, max=0.0261, unique=4626
[2025-07-19 18:33:07] INFO train_model: trend_strength_1d: mean=0.0022, std=0.0026, min=0.0000, max=0.0196, unique=4626
[2025-07-19 18:33:07] INFO train_model: structure_trend_1d: mean=0.0496, std=0.2843, min=0.0000, max=2.0000, unique=3
[2025-07-19 18:33:07] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: regime_label_bear: mean=0.4834, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: regime_label_bull: mean=0.4740, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: regime_label_neutral: mean=0.0426, std=0.2020, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: market_regime_choppy: mean=0.2400, std=0.4271, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: market_regime_downtrend: mean=0.2888, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: market_regime_range: mean=0.2509, std=0.4335, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: market_regime_uptrend: mean=0.2204, std=0.4146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:07] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:07] INFO train_model: Auditing data quality before training...
[2025-07-19 18:33:07] INFO train_model: Entering audit_data_quality
[2025-07-19 18:33:25] INFO train_model: Model is starting a new training session...
[2025-07-19 18:33:25] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:33:25] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend'],
      dtype='object')
[2025-07-19 18:33:25] INFO train_model: Preparing target variable...
[2025-07-19 18:33:25] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:33:25] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:33:25] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_consolidation', 'market_regime_downtrend',
       'market_regime_range', 'market_regime_uptrend', 'future_return',
       'target'],
      dtype='object')
[2025-07-19 18:33:25] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_consolidation', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:33:25] INFO train_model: Dropping NaN targets...
[2025-07-19 18:33:25] INFO train_model: Class balance before upsampling: {0: 3430, 1: 1272}
[2025-07-19 18:33:25] INFO train_model: Upsampling successful.
[2025-07-19 18:33:25] INFO train_model: Splitting train/test...
[2025-07-19 18:33:25] INFO train_model: Scaling features...
[2025-07-19 18:33:25] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:33:25] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:33:26] INFO train_model: Model fit complete.
[2025-07-19 18:33:26] INFO train_model: Model Accuracy: 0.8754
[2025-07-19 18:33:26] INFO train_model: 
Classification Report:
[2025-07-19 18:33:26] INFO train_model:               precision    recall  f1-score   support

           0       0.88      0.87      0.87       686
           1       0.87      0.88      0.88       686

    accuracy                           0.88      1372
   macro avg       0.88      0.88      0.88      1372
weighted avg       0.88      0.88      0.88      1372

[2025-07-19 18:33:26] INFO train_model: Model, scaler, and features saved for USDCHF
[2025-07-19 18:33:26] INFO train_model: Model registered in ModelRegistry for USDCHF, version 8dfc78e8a1c878e0c5aaf5f3f86fed79
[2025-07-19 18:33:26] INFO train_model: Feature distributions before training:
[2025-07-19 18:33:26] INFO train_model: atr_14: mean=0.0016, std=0.0007, min=0.0000, max=0.0059, unique=4690
[2025-07-19 18:33:26] INFO train_model: volatility_20: mean=0.0015, std=0.0011, min=0.0002, max=0.0118, unique=4678
[2025-07-19 18:33:26] INFO train_model: sma_20: mean=0.8630, std=0.0378, min=0.7908, max=0.9174, unique=4654
[2025-07-19 18:33:26] INFO train_model: sma_50: mean=0.8632, std=0.0375, min=0.7914, max=0.9167, unique=4641
[2025-07-19 18:33:26] INFO train_model: sma_200: mean=0.8643, std=0.0363, min=0.7943, max=0.9132, unique=4497
[2025-07-19 18:33:26] INFO train_model: ema_12: mean=0.8629, std=0.0378, min=0.7904, max=0.9179, unique=4702
[2025-07-19 18:33:26] INFO train_model: ema_26: mean=0.8630, std=0.0377, min=0.7916, max=0.9171, unique=4702
[2025-07-19 18:33:26] INFO train_model: rsi_14: mean=49.8641, std=12.3936, min=7.7095, max=97.7161, unique=4663
[2025-07-19 18:33:26] INFO train_model: macd: mean=-0.0001, std=0.0011, min=-0.0074, max=0.0038, unique=4677
[2025-07-19 18:33:26] INFO train_model: macd_signal: mean=-0.0001, std=0.0011, min=-0.0068, max=0.0033, unique=4669
[2025-07-19 18:33:26] INFO train_model: bb_high: mean=0.8659, std=0.0375, min=0.7927, max=0.9210, unique=4678
[2025-07-19 18:33:26] INFO train_model: bb_low: mean=0.8601, std=0.0381, min=0.7878, max=0.9160, unique=4678
[2025-07-19 18:33:26] INFO train_model: stoch_k: mean=51.0515, std=26.3623, min=0.6580, max=98.9585, unique=4614
[2025-07-19 18:33:26] INFO train_model: stoch_d: mean=51.0710, std=24.0553, min=3.0053, max=95.8670, unique=4678
[2025-07-19 18:33:26] INFO train_model: fib_0: mean=0.8662, std=0.0374, min=0.7936, max=0.9200, unique=1082
[2025-07-19 18:33:26] INFO train_model: dist_to_fib_0: mean=-0.0033, std=0.0033, min=-0.0391, max=-0.0000, unique=1419
[2025-07-19 18:33:26] INFO train_model: fib_236: mean=0.8646, std=0.0375, min=0.7921, max=0.9189, unique=2086
[2025-07-19 18:33:26] INFO train_model: dist_to_fib_236: mean=-0.0018, std=0.0027, min=-0.0289, max=0.0039, unique=4613
[2025-07-19 18:33:26] INFO train_model: fib_382: mean=0.8637, std=0.0376, min=0.7911, max=0.9183, unique=2086
[2025-07-19 18:33:26] INFO train_model: dist_to_fib_382: mean=-0.0008, std=0.0024, min=-0.0225, max=0.0071, unique=4613
[2025-07-19 18:33:26] INFO train_model: fib_500: mean=0.8629, std=0.0377, min=0.7904, max=0.9177, unique=2007
[2025-07-19 18:33:26] INFO train_model: dist_to_fib_500: mean=-0.0000, std=0.0022, min=-0.0174, max=0.0097, unique=2761
[2025-07-19 18:33:26] INFO train_model: fib_618: mean=0.8622, std=0.0378, min=0.7896, max=0.9172, unique=2086
[2025-07-19 18:33:26] INFO train_model: dist_to_fib_618: mean=0.0007, std=0.0022, min=-0.0128, max=0.0123, unique=4613
[2025-07-19 18:33:26] INFO train_model: fib_786: mean=0.8611, std=0.0379, min=0.7886, max=0.9164, unique=2086
[2025-07-19 18:33:26] INFO train_model: dist_to_fib_786: mean=0.0018, std=0.0022, min=-0.0070, max=0.0160, unique=4613
[2025-07-19 18:33:26] INFO train_model: fib_100: mean=0.8597, std=0.0381, min=0.7872, max=0.9154, unique=1036
[2025-07-19 18:33:26] INFO train_model: dist_to_fib_100: mean=0.0032, std=0.0026, min=0.0001, max=0.0207, unique=1367
[2025-07-19 18:33:26] INFO train_model: trendline_slope_high: mean=-0.0000, std=0.0002, min=-0.0018, max=0.0010, unique=2056
[2025-07-19 18:33:26] INFO train_model: trendline_slope_low: mean=-0.0000, std=0.0002, min=-0.0019, max=0.0009, unique=2075
[2025-07-19 18:33:26] INFO train_model: trendline_up: mean=0.5004, std=0.5001, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: trendline_down: mean=0.4900, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: breakout_high: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: breakout_low: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: dist_to_high: mean=-0.0033, std=0.0034, min=-0.0391, max=0.0035, unique=1453
[2025-07-19 18:33:26] INFO train_model: dist_to_low: mean=0.0031, std=0.0027, min=-0.0015, max=0.0207, unique=1403
[2025-07-19 18:33:26] INFO train_model: vol_spike_atr: mean=0.0134, std=0.1150, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: vol_spike_std: mean=0.1559, std=0.3628, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: is_trending: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: supply_zone: mean=0.5019, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: demand_zone: mean=0.4862, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: bos: mean=0.0013, std=0.0357, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: choch: mean=0.1623, std=0.3687, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: vol_cluster_std: mean=0.0010, std=0.0006, min=0.0003, max=0.0045, unique=4681
[2025-07-19 18:33:26] INFO train_model: vol_cluster_high: mean=0.1061, std=0.3080, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: regime_zscore: mean=-0.0095, std=1.0048, min=-5.9027, max=7.4977, unique=4602
[2025-07-19 18:33:26] INFO train_model: doji: mean=0.1236, std=0.3291, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: hammer: mean=0.0264, std=0.1603, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bullish_engulfing: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bearish_engulfing: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: pin_bar: mean=0.3120, std=0.4634, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bullish_engulfing_bar: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bearish_engulfing_bar: mean=0.0523, std=0.2227, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: inside_bar: mean=0.1427, std=0.3498, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: head_shoulders: mean=0.0342, std=0.1819, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: inv_head_shoulders: mean=0.0313, std=0.1740, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: double_top: mean=0.0017, std=0.0412, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: double_bottom: mean=0.0083, std=0.0907, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: rising_wedge: mean=0.2250, std=0.4176, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: falling_wedge: mean=0.2318, std=0.4220, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: fakeout_up: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: fakeout_down: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: bullish_flag: mean=0.0247, std=0.1551, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bearish_flag: mean=0.0289, std=0.1676, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bullish_pennant: mean=0.1338, std=0.3404, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bearish_pennant: mean=0.1433, std=0.3505, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: morning_star: mean=0.0368, std=0.1883, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: evening_star: mean=0.0402, std=0.1964, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bullish_harami: mean=0.0574, std=0.2327, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: bearish_harami: mean=0.0444, std=0.2061, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: dark_cloud_cover: mean=0.1114, std=0.3147, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: regime_label_bear: mean=0.4866, std=0.4999, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: regime_label_bull: mean=0.4709, std=0.4992, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: market_regime_choppy: mean=0.0279, std=0.1646, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: market_regime_consolidation: mean=0.0542, std=0.2265, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: market_regime_downtrend: mean=0.2254, std=0.4179, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: market_regime_range: mean=0.5270, std=0.4993, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: market_regime_uptrend: mean=0.1655, std=0.3716, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:33:26] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:33:26] INFO train_model: Auditing data quality before training...
[2025-07-19 18:33:26] INFO train_model: Entering audit_data_quality
[2025-07-19 18:41:29] INFO train_model: Exiting audit_data_quality
[2025-07-19 18:41:41] INFO train_model: Model is starting a new training session...
[2025-07-19 18:41:41] INFO train_model: Model is cleaning and preparing data...
[2025-07-19 18:41:41] INFO train_model: features_df columns before prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend'],
      dtype='object')
[2025-07-19 18:41:41] INFO train_model: Preparing target variable...
[2025-07-19 18:41:41] INFO train_model: Entering prepare_target_variable
[2025-07-19 18:41:41] INFO train_model: Exiting prepare_target_variable
[2025-07-19 18:41:41] INFO train_model: df columns after prepare_target_variable: Index(['Open', 'High', 'Low', 'Close', 'Volume', 'atr_14', 'volatility_20',
       'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd',
       'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0',
       'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382',
       'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618',
       'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100',
       'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low',
       'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low',
       'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std',
       'is_trending', 'is_ranging', 'supply_zone', 'demand_zone',
       'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h',
       'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high',
       'regime_zscore', 'doji', 'hammer', 'bullish_engulfing',
       'bearish_engulfing', 'shooting_star', 'pin_bar',
       'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar',
       'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom',
       'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down',
       'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant',
       'morning_star', 'evening_star', 'three_white_soldiers',
       'three_black_crows', 'bullish_harami', 'bearish_harami',
       'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear',
       'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy',
       'market_regime_downtrend', 'market_regime_range',
       'market_regime_uptrend', 'future_return', 'target'],
      dtype='object')
[2025-07-19 18:41:41] INFO train_model: [DEBUG] Final feature columns used for training: ['atr_14', 'volatility_20', 'sma_20', 'sma_50', 'sma_200', 'ema_12', 'ema_26', 'rsi_14', 'macd', 'macd_signal', 'bb_high', 'bb_low', 'stoch_k', 'stoch_d', 'fib_0', 'dist_to_fib_0', 'fib_236', 'dist_to_fib_236', 'fib_382', 'dist_to_fib_382', 'fib_500', 'dist_to_fib_500', 'fib_618', 'dist_to_fib_618', 'fib_786', 'dist_to_fib_786', 'fib_100', 'dist_to_fib_100', 'trendline_slope_high', 'trendline_slope_low', 'trendline_up', 'trendline_down', 'breakout_high', 'breakout_low', 'dist_to_high', 'dist_to_low', 'vol_spike_atr', 'vol_spike_std', 'is_trending', 'is_ranging', 'supply_zone', 'demand_zone', 'price_vs_sma20_4h', 'price_vs_sma50_4h', 'trend_strength_4h', 'news_sentiment', 'bos', 'choch', 'vol_cluster_std', 'vol_cluster_high', 'regime_zscore', 'doji', 'hammer', 'bullish_engulfing', 'bearish_engulfing', 'shooting_star', 'pin_bar', 'bullish_engulfing_bar', 'bearish_engulfing_bar', 'inside_bar', 'head_shoulders', 'inv_head_shoulders', 'double_top', 'double_bottom', 'rising_wedge', 'falling_wedge', 'fakeout_up', 'fakeout_down', 'bullish_flag', 'bearish_flag', 'bullish_pennant', 'bearish_pennant', 'morning_star', 'evening_star', 'three_white_soldiers', 'three_black_crows', 'bullish_harami', 'bearish_harami', 'dark_cloud_cover', 'fib_levels', 'wyckoff_phases', 'regime_label_bear', 'regime_label_bull', 'regime_label_neutral', 'market_regime_choppy', 'market_regime_downtrend', 'market_regime_range', 'market_regime_uptrend', 'wyckoff_accumulation', 'wyckoff_distribution', 'wyckoff_markup', 'wyckoff_markdown', 'wyckoff_unknown']
[2025-07-19 18:41:41] INFO train_model: Dropping NaN targets...
[2025-07-19 18:41:41] INFO train_model: Class balance before upsampling: {0: 3110, 1: 1592}
[2025-07-19 18:41:41] INFO train_model: Upsampling successful.
[2025-07-19 18:41:41] INFO train_model: Splitting train/test...
[2025-07-19 18:41:41] INFO train_model: Scaling features...
[2025-07-19 18:41:41] INFO train_model: Initializing models (XGBoost, LightGBM, VotingClassifier)...
[2025-07-19 18:41:41] INFO train_model: Model is fitting ensemble (XGBoost + LightGBM) and calibrating probabilities...
[2025-07-19 18:41:43] INFO train_model: Model fit complete.
[2025-07-19 18:41:43] INFO train_model: Model Accuracy: 0.8207
[2025-07-19 18:41:43] INFO train_model: 
Classification Report:
[2025-07-19 18:41:43] INFO train_model:               precision    recall  f1-score   support

           0       0.83      0.81      0.82       622
           1       0.81      0.83      0.82       622

    accuracy                           0.82      1244
   macro avg       0.82      0.82      0.82      1244
weighted avg       0.82      0.82      0.82      1244

[2025-07-19 18:41:43] INFO train_model: Model, scaler, and features saved for USDJPY
[2025-07-19 18:41:43] INFO train_model: Model registered in ModelRegistry for USDJPY, version 6ebd847012138f6e86680d8ddf4dd9f5
[2025-07-19 18:41:43] INFO train_model: Feature distributions before training:
[2025-07-19 18:41:43] INFO train_model: atr_14: mean=0.3416, std=0.1040, min=0.0000, max=0.9927, unique=4690
[2025-07-19 18:41:43] INFO train_model: volatility_20: mean=0.3279, std=0.1837, min=0.0344, max=1.3004, unique=4683
[2025-07-19 18:41:43] INFO train_model: sma_20: mean=149.6241, std=4.6995, min=140.5323, max=158.2940, unique=4678
[2025-07-19 18:41:43] INFO train_model: sma_50: mean=149.6263, std=4.6784, min=140.8684, max=158.1650, unique=4652
[2025-07-19 18:41:43] INFO train_model: sma_200: mean=149.6799, std=4.5836, min=142.1838, max=157.7724, unique=4500
[2025-07-19 18:41:43] INFO train_model: ema_12: mean=149.6229, std=4.7011, min=140.4143, max=158.3392, unique=4702
[2025-07-19 18:41:43] INFO train_model: ema_26: mean=149.6240, std=4.6866, min=140.6181, max=158.2242, unique=4702
[2025-07-19 18:41:43] INFO train_model: rsi_14: mean=50.5788, std=12.9257, min=8.6902, max=92.4381, unique=4676
[2025-07-19 18:41:43] INFO train_model: macd: mean=-0.0008, std=0.2229, min=-0.9230, max=0.8730, unique=4677
[2025-07-19 18:41:43] INFO train_model: macd_signal: mean=-0.0012, std=0.2088, min=-0.8065, max=0.7956, unique=4669
[2025-07-19 18:41:43] INFO train_model: bb_high: mean=150.2633, std=4.6767, min=140.9707, max=158.5972, unique=4683
[2025-07-19 18:41:43] INFO train_model: bb_low: mean=148.9849, std=4.7491, min=139.2981, max=158.0618, unique=4683
[2025-07-19 18:41:43] INFO train_model: stoch_k: mean=52.3511, std=27.0512, min=0.0000, max=99.6649, unique=4670
[2025-07-19 18:41:43] INFO train_model: stoch_d: mean=52.3592, std=25.0024, min=3.8543, max=96.6848, unique=4685
[2025-07-19 18:41:43] INFO train_model: fib_0: mean=150.2887, std=4.6576, min=141.0760, max=158.8790, unique=1210
[2025-07-19 18:41:43] INFO train_model: dist_to_fib_0: mean=-0.6650, std=0.5552, min=-5.0610, max=-0.0050, unique=2187
[2025-07-19 18:41:43] INFO train_model: fib_236: mean=149.9633, std=4.6650, min=140.8676, max=158.5797, unique=2255
[2025-07-19 18:41:43] INFO train_model: dist_to_fib_236: mean=-0.3396, std=0.4875, min=-3.8081, max=0.7712, unique=4659
[2025-07-19 18:41:43] INFO train_model: fib_382: mean=149.7620, std=4.6718, min=140.6792, max=158.3946, unique=2255
[2025-07-19 18:41:43] INFO train_model: dist_to_fib_382: mean=-0.1383, std=0.4631, min=-3.0330, max=1.2871, unique=4659
[2025-07-19 18:41:43] INFO train_model: fib_500: mean=149.5993, std=4.6786, min=140.5270, max=158.2450, unique=2206
[2025-07-19 18:41:43] INFO train_model: dist_to_fib_500: mean=0.0245, std=0.4552, min=-2.4065, max=1.7885, unique=3611
[2025-07-19 18:41:43] INFO train_model: fib_618: mean=149.4365, std=4.6864, min=140.3748, max=158.1640, unique=2255
[2025-07-19 18:41:43] INFO train_model: dist_to_fib_618: mean=0.1872, std=0.4585, min=-1.7800, max=2.2899, unique=4659
[2025-07-19 18:41:43] INFO train_model: fib_786: mean=149.2049, std=4.6994, min=140.1581, max=158.0580, unique=2255
[2025-07-19 18:41:43] INFO train_model: dist_to_fib_786: mean=0.4188, std=0.4819, min=-0.8881, max=3.0037, unique=4659
[2025-07-19 18:41:43] INFO train_model: fib_100: mean=148.9098, std=4.7190, min=139.8820, max=157.9230, unique=1168
[2025-07-19 18:41:43] INFO train_model: dist_to_fib_100: mean=0.7139, std=0.5389, min=0.0000, max=3.9130, unique=2197
[2025-07-19 18:41:43] INFO train_model: trendline_slope_high: mean=-0.0001, std=0.0436, min=-0.2118, max=0.1646, unique=2986
[2025-07-19 18:41:43] INFO train_model: trendline_slope_low: mean=-0.0001, std=0.0447, min=-0.2367, max=0.1591, unique=3048
[2025-07-19 18:41:43] INFO train_model: trendline_up: mean=0.5040, std=0.5000, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: trendline_down: mean=0.4783, std=0.4996, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: breakout_high: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: breakout_low: mean=0.0015, std=0.0386, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: dist_to_high: mean=-0.6653, std=0.5818, min=-5.0610, max=0.5750, unique=2227
[2025-07-19 18:41:43] INFO train_model: dist_to_low: mean=0.7120, std=0.5649, min=-0.3640, max=3.9130, unique=2274
[2025-07-19 18:41:43] INFO train_model: vol_spike_atr: mean=0.0104, std=0.1016, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: vol_spike_std: mean=0.1506, std=0.3577, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: is_trending: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: is_ranging: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: supply_zone: mean=0.4370, std=0.4961, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: demand_zone: mean=0.3694, std=0.4827, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: price_vs_sma20_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: price_vs_sma50_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: trend_strength_4h: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: news_sentiment: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: bos: mean=0.0030, std=0.0545, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: choch: mean=0.1436, std=0.3507, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: vol_cluster_std: mean=0.0012, std=0.0005, min=0.0002, max=0.0043, unique=4682
[2025-07-19 18:41:43] INFO train_model: vol_cluster_high: mean=0.1014, std=0.3020, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: regime_zscore: mean=-0.0187, std=1.0033, min=-5.8436, max=6.5511, unique=4602
[2025-07-19 18:41:43] INFO train_model: doji: mean=0.1104, std=0.3134, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: hammer: mean=0.0262, std=0.1596, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bullish_engulfing: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bearish_engulfing: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: shooting_star: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: pin_bar: mean=0.2890, std=0.4534, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bullish_engulfing_bar: mean=0.0517, std=0.2214, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bearish_engulfing_bar: mean=0.0532, std=0.2244, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: inside_bar: mean=0.1361, std=0.3429, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: head_shoulders: mean=0.0311, std=0.1735, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: inv_head_shoulders: mean=0.0328, std=0.1780, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: double_top: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: double_bottom: mean=0.0011, std=0.0326, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: rising_wedge: mean=0.2682, std=0.4431, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: falling_wedge: mean=0.2403, std=0.4273, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: fakeout_up: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: fakeout_down: mean=0.0004, std=0.0206, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bullish_flag: mean=0.0196, std=0.1385, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bearish_flag: mean=0.0217, std=0.1457, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bullish_pennant: mean=0.1280, std=0.3342, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bearish_pennant: mean=0.1359, std=0.3427, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: morning_star: mean=0.0404, std=0.1969, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: evening_star: mean=0.0362, std=0.1867, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: three_white_soldiers: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: three_black_crows: mean=0.0002, std=0.0146, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bullish_harami: mean=0.0549, std=0.2278, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: bearish_harami: mean=0.0459, std=0.2094, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: dark_cloud_cover: mean=0.1187, std=0.3234, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: fib_levels: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: wyckoff_phases: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: regime_label_bear: mean=0.4828, std=0.4998, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: regime_label_bull: mean=0.4747, std=0.4994, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: regime_label_neutral: mean=0.0425, std=0.2018, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: market_regime_choppy: mean=0.2401, std=0.4272, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: market_regime_downtrend: mean=0.2886, std=0.4532, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: market_regime_range: mean=0.2512, std=0.4337, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: market_regime_uptrend: mean=0.2201, std=0.4144, min=0.0000, max=1.0000, unique=2
[2025-07-19 18:41:43] INFO train_model: wyckoff_accumulation: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: wyckoff_distribution: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: wyckoff_markup: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: wyckoff_markdown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: wyckoff_unknown: mean=0.0000, std=0.0000, min=0.0000, max=0.0000, unique=1
[2025-07-19 18:41:43] INFO train_model: Auditing data quality before training...
[2025-07-19 18:41:43] INFO train_model: Entering audit_data_quality
